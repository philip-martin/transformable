{"version":3,"file":"transformable.dev.umd.js","mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;;;;;;;;;;;ACVA;;;;;;;;;;;;;;;;;;;;ACAiC;AACF;AAAA,IAEzBE,QAAQ;EACV,SAAAA,SAAYC,IAAI,EAAE;IAAAC,eAAA,OAAAF,QAAA;IACd,IAAI,CAACG,KAAK,GAAG,EAAE;IACf,IAAI,CAACC,IAAI,CAACH,IAAI,EAAEA,IAAI,CAACI,OAAO,CAAC;IAC7B,IAAI,CAACC,IAAI,GAAGL,IAAI;IAChB,IAAI,CAACM,KAAK,CAAC,CAAC;EAChB;EAAC,OAAAC,YAAA,CAAAR,QAAA;IAAAS,GAAA;IAAAC,KAAA,EAED,SAAAC,UAAUA,CAAA,EAAG;MACT,OAAO,IAAIZ,iDAAK,CAACa,MAAM,CAACC,WAAW,IAAIC,QAAQ,CAACC,eAAe,CAACC,UAAU,EAAEJ,MAAM,CAACK,WAAW,IAAIH,QAAQ,CAACC,eAAe,CAACG,SAAS,CAAC;IACzI;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAAT,GAAA;IAAAC,KAAA,EAKA,SAAAS,cAAcA,CAACC,EAAE,EAAEC,EAAE,EAAE;MACnBA,EAAE,GAAGA,EAAE,IAAIC,gBAAgB,CAACF,EAAE,CAAC;MAE/B,IAAMG,IAAI,GAAGC,UAAU,CAACH,EAAE,CAACE,IAAI,CAAC;MAChC,IAAME,GAAG,GAAGD,UAAU,CAACH,EAAE,CAACI,GAAG,CAAC;MAC9B,IAAMC,CAAC,GAAGF,UAAU,CAACH,EAAE,CAACM,KAAK,CAAC;MAC9B,IAAMC,CAAC,GAAGJ,UAAU,CAACH,EAAE,CAACQ,MAAM,CAAC;MAE/B,OAAO;QACHC,MAAM,EAAE,IAAI/B,iDAAK,CAACwB,IAAI,IAAI,CAAC,EAAEE,GAAG,IAAI,CAAC,CAAC;QACtCE,KAAK,EAAED,CAAC;QACRG,MAAM,EAAED,CAAC;QACTG,OAAO,EAAE,IAAIhC,iDAAK,CAAC,CAAC,EAAE,CAAC,CAAC;QACxBiC,QAAQ,EAAE,IAAIjC,iDAAK,CAAC2B,CAAC,EAAE,CAAC,CAAC;QACzBO,WAAW,EAAE,IAAIlC,iDAAK,CAAC2B,CAAC,EAAEE,CAAC,CAAC;QAC5BM,UAAU,EAAE,IAAInC,iDAAK,CAAC,CAAC,EAAE6B,CAAC;MAC9B,CAAC;IACL;;IAEA;AACJ;AACA;EAFI;IAAAnB,GAAA;IAAAC,KAAA,EAGA,SAAAyB,MAAMA,CAAA,EAAG;MACL,IAAI,CAAChC,KAAK,CAACiC,OAAO,CAAC,UAAUC,CAAC,EAAEC,CAAC,EAAE;QAC/BC,OAAO,CAACC,GAAG,CAACH,CAAC,CAACI,MAAM,CAACC,QAAQ,CAAC;MAClC,CAAC,CAAC;MACF,IAAI,CAACvC,KAAK,CAACiC,OAAO,CAAC,UAAUC,CAAC,EAAEC,CAAC,EAAE;QAC/BC,OAAO,CAACC,GAAG,CAAC,CAACH,CAAC,CAAChC,OAAO,CAAC,CAAC;MAC5B,CAAC,CAAC;IACN;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAAI,GAAA;IAAAC,KAAA,EAKA,SAAAiC,OAAOA,CAAA,EAAG;MACN,IAAI,CAACxC,KAAK,GAAG,EAAE;MACf,IAAI,CAACC,IAAI,CAAC,IAAI,CAACE,IAAI,EAAE,IAAI,CAACA,IAAI,CAACD,OAAO,CAAC;MACvC;MACA,IAAI,CAACE,KAAK,CAAC,CAAC;IAChB;;IAEA;AACJ;AACA;AACA;EAHI;IAAAE,GAAA;IAAAC,KAAA,EAIA,SAAAkC,UAAUA,CAACP,CAAC,EAAE;MAAE,OAAOA,CAAC,CAACQ,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;IAAE;;IAE5C;AACJ;AACA;AACA;EAHI;IAAApC,GAAA;IAAAC,KAAA,EAIA,SAAAoC,OAAOA,CAACT,CAAC,EAAE;MAAE,OAAOA,CAAC,IAAI,MAAM;IAAE;;IAEjC;AACJ;AACA;AACA;AACA;AACA;EALI;IAAA5B,GAAA;IAAAC,KAAA,EAMA,SAAAqC,gBAAgBA,CAACC,CAAC,EAAEC,GAAG,EAAE5B,EAAE,EAAE;MACzB,IAAI4B,GAAG,KAAK,IAAI,EAAE,OAAO,CAAC;MAC1B,IAAIZ,CAAC,GAAGb,UAAU,CAACyB,GAAG,CAAC;MACvB,QAAQD,CAAC;QACL,KAAK,MAAM;UACPX,CAAC,GAAGb,UAAU,CAACH,EAAE,CAACM,KAAK,CAAC,GAAGU,CAAC,GAAG,GAAG;UAClC;QACJ,KAAK,KAAK;UACNA,CAAC,GAAGb,UAAU,CAACH,EAAE,CAACQ,MAAM,CAAC,GAAGQ,CAAC,GAAG,GAAG;UACnC;MACR;MACA,OAAOA,CAAC;IACZ;;IAEA;AACJ;AACA;AACA;EAHI;IAAA5B,GAAA;IAAAC,KAAA,EAIA,SAAAwC,eAAeA,CAAC9B,EAAE,EAAE;MAChB,IAAMC,EAAE,GAAGC,gBAAgB,CAACF,EAAE,CAAC;MAC/B,IAAM+B,GAAG,GAAG9B,EAAE,CAAC+B,SAAS;MACxB,IAAMC,GAAG,GAAGhC,EAAE,CAACiC,UAAU;MACzB,IAAIC,EAAE,GAAGlC,EAAE,CAACE,IAAI;MAChB,IAAIiC,EAAE,GAAGnC,EAAE,CAACI,GAAG;MACf,IAAMgC,KAAK,GAAG,IAAI,CAACb,UAAU,CAACW,EAAE,CAAC;MACjC,IAAMG,IAAI,GAAG,IAAI,CAACd,UAAU,CAACY,EAAE,CAAC;MAChC,IAAMG,EAAE,GAAG,SAALA,EAAEA,CAAatB,CAAC,EAAE;QAAE,OAAOb,UAAU,CAACa,CAAC,CAAC;MAAE,CAAC;MACjD,IAAIuB,CAAC,EAAEC,CAAC,EAAEC,GAAG;MAEb,IAAI,IAAI,CAAChB,OAAO,CAACS,EAAE,CAAC,EAAEA,EAAE,GAAG,CAAC;MAC5B,IAAI,IAAI,CAACT,OAAO,CAACU,EAAE,CAAC,EAAEA,EAAE,GAAG,CAAC;MAE5B,IAAIC,KAAK,IAAIC,IAAI,EACbI,GAAG,GAAGxC,gBAAgB,CAACF,EAAE,CAAC2C,UAAU,CAAC;MAEzC,IAAIN,KAAK,EAAEG,CAAC,GAAG,IAAI,CAACb,gBAAgB,CAAC,MAAM,EAAEQ,EAAE,EAAEO,GAAG,CAAC;MACrD,IAAIJ,IAAI,EAAEG,CAAC,GAAG,IAAI,CAACd,gBAAgB,CAAC,KAAK,EAAES,EAAE,EAAEM,GAAG,CAAC;MAAC;MAEpD,OAAO;QACHvC,IAAI,EAAE,OAAOqC,CAAC,IAAI,WAAW,GAAGA,CAAC,GAAGD,EAAE,CAACJ,EAAE,CAAC;QAC1C9B,GAAG,EAAE,OAAOoC,CAAC,IAAI,WAAW,GAAGA,CAAC,GAAGF,EAAE,CAACH,EAAE,CAAC;QACzCF,UAAU,EAAEK,EAAE,CAACN,GAAG,CAAC;QACnBD,SAAS,EAAEO,EAAE,CAACR,GAAG,CAAC;QAClBa,SAAS,EAAE3C,EAAE,CAAC2C;MAClB,CAAC;IACL;;IAEA;AACJ;AACA;AACA;EAHI;IAAAvD,GAAA;IAAAC,KAAA,EAIA,SAAAH,KAAKA,CAAA,EAAG;MACJ,IAAIsD,CAAC;QAAEI,GAAG;QAAEC,EAAE;QAAEC,GAAG;QAAEC,EAAE;QAAEhD,EAAE,GAAG,IAAI,CAACd,IAAI,CAACD,OAAO;MAC/C,OAAOe,EAAE,CAAC2C,UAAU,IAAI,CAAC3C,EAAE,CAAC2C,UAAU,CAACM,IAAI,EAAE;QAEzC,IAAMhD,EAAE,GAAG,IAAI,CAAC6B,eAAe,CAAC9B,EAAE,CAAC2C,UAAU,CAAC;QAC9CF,CAAC,GAAGxC,EAAE,CAAC2C,SAAS;QAChBC,GAAG,GAAG,2BAA2B,CAACK,IAAI,CAACT,CAAC,CAAC;QAEzC,IAAMpC,GAAG,GAAGJ,EAAE,CAACI,GAAG;QAClB,IAAIF,IAAI,GAAGF,EAAE,CAACE,IAAI;UAClBgD,SAAS,GAAGlD,EAAE,CAAC+B,SAAS;UACxBoB,UAAU,GAAGnD,EAAE,CAACiC,UAAU;QAE1B,IAAIW,GAAG,IAAI7C,EAAE,CAAC2C,UAAU,CAACU,SAAS,CAACC,QAAQ,CAAC,eAAe,CAAC,IAAItD,EAAE,CAACqD,SAAS,CAACC,QAAQ,CAAC,eAAe,CAAC,IAC/FjD,GAAG,IAAI,CAAC,IAAIF,IAAI,IAAI,CAAC,IACrBgD,SAAS,IAAI,CAAC,IACdC,UAAU,IAAI,CAAC,EAChB;UACF,IAAIL,GAAG,GAAG/C,EAAE,CAAC2C,UAAU,CAACY,YAAY,CAAC,uBAAuB,CAAC,EAAE;YAC3DT,EAAE,GAAGU,aAAa,CAACC,QAAQ,CAACV,GAAG,CAAC;YAChC,IAAID,EAAE,EACF,IAAI,CAAC9D,IAAI,CAAC8D,EAAE,CAAC;UACrB,CAAC,MAAM;YACH,IAAIY,EAAE,GAAGb,GAAG,GAAG,IAAInE,kDAAM,CAAC,IAAI,CAACQ,IAAI,CAACyE,iBAAiB,CAAClB,CAAC,CAAC,CAAC,GAAG,KAAK;YAEjE,IAAII,GAAG,IAAIxC,GAAG,IAAI,CAAC,IAAIF,IAAI,IAAI,CAAC,IAAIgD,SAAS,IAAI,CAAC,IAAIC,UAAU,IAAI,CAAC,IAAIpD,EAAE,CAACqD,SAAS,CAACC,QAAQ,CAAC,eAAe,CAAC,EAAE;cAC7GN,EAAE,GAAG,IAAItE,kDAAM,CAAC,CAAC;cACjBsE,EAAE,CAACY,SAAS,CAACzD,IAAI,IAAE,CAAC,EAAEE,GAAG,IAAE,CAAC,CAAC,CAACuD,SAAS,CAACR,UAAU,IAAE,CAAC,EAAED,SAAS,IAAE,CAAC,CAAC;cAEpE,IAAIO,EAAE,EACFV,EAAE,CAACa,QAAQ,CAACH,EAAE,CAACpC,QAAQ,CAAC;cAE5B,IAAIwC,KAAK,GAAG,IAAI,CAAC/D,cAAc,CAACC,EAAE,CAAC2C,UAAU,CAAC;cAE9C3C,EAAE,CAAC2C,UAAU,CAACoB,KAAK,CAAC1D,GAAG,GAAG,CAAC;cAC3BL,EAAE,CAAC2C,UAAU,CAACoB,KAAK,CAAC5D,IAAI,GAAG,CAAC;cAC5BH,EAAE,CAAC2C,UAAU,CAACoB,KAAK,CAAC7B,UAAU,GAAG,CAAC;cAClClC,EAAE,CAAC2C,UAAU,CAACoB,KAAK,CAAC/B,SAAS,GAAG,CAAC;cACjChC,EAAE,CAAC2C,UAAU,CAACoB,KAAK,CAACC,eAAe,GAAG,KAAK;cAC3ChE,EAAE,CAAC2C,UAAU,CAACoB,KAAK,CAACnB,SAAS,GAAG,IAAI,CAAC1D,IAAI,CAAC+E,iBAAiB,CAACjB,EAAE,CAAC1B,QAAQ,CAAC;cAExE,IAAI,CAACtC,IAAI,CAACgE,EAAE,EAAEhD,EAAE,CAAC2C,UAAU,EAAEmB,KAAK,CAAC;YACvC;UACJ;QACJ;QACA9D,EAAE,GAAGA,EAAE,CAAC2C,UAAU;MACtB;IACJ;;IAEA;AACJ;AACA;EAFI;IAAAtD,GAAA;IAAAC,KAAA,EAGA,SAAA4E,UAAUA,CAAA,EAAI;MACV,IAAI,CAACC,MAAM,GAAG,IAAI,CAAC5E,UAAU,CAAC,CAAC;MAC/B,IAAG,IAAI,CAACmB,MAAM,EAAE;MAChB,IAAI0D,GAAG,EAAElD,CAAC;MACV,IAAMmD,KAAK,GAAG,IAAI3F,kDAAM,CAAC,CAAC;MAC1B,KAAKwC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACnC,KAAK,CAACuF,MAAM,EAAEpD,CAAC,EAAE,EAClCmD,KAAK,CAACT,SAAS,CAAC,IAAI,CAAC7E,KAAK,CAACmC,CAAC,CAAC,CAACG,MAAM,CAACkD,WAAW,CAAC,CAAC,CAAC;MAEvD,KAAKrD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACnC,KAAK,CAACuF,MAAM,EAAEpD,CAAC,EAAE,EAAE;QACpCkD,GAAG,GAAG,IAAI,CAACrF,KAAK,CAACmC,CAAC,CAAC;QACnB,IAAIkD,GAAG,CAACnF,OAAO,CAACoE,SAAS,CAACC,QAAQ,CAAC,eAAe,CAAC,EAAE;UACjD,IAAI,CAAC5C,MAAM,GAAG0D,GAAG,CAACI,aAAa,CAAC9D,MAAM,CAAC+D,GAAG,CAACJ,KAAK,CAACE,WAAW,CAAC,CAAC,CAAC;UAC/D;QACJ;MACJ;IACJ;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAAlF,GAAA;IAAAC,KAAA,EAKA,SAAAN,IAAIA,CAACyD,CAAC,EAAEzC,EAAE,EAAE;MACR,IAAIyC,CAAC,YAAYe,aAAa,EAAE;QAC5B,IAAI,CAACzE,KAAK,CAAC2F,OAAO,CAAC;UAAErD,MAAM,EAAEoB,CAAC,CAACpB,MAAM;UAAEpC,OAAO,EAAEe,EAAE,IAAIyC,CAAC,CAACxD,OAAO;UAAE0F,IAAI,EAAElC,CAAC,CAACmC,KAAK,CAAC3F,OAAO,CAAC4F,OAAO;UAAEL,aAAa,EAAE/B;QAAE,CAAC,CAAC;MACvH;MACA,IAAIA,CAAC,YAAY/D,kDAAM,EAAE;QACrB,IAAI,CAACK,KAAK,CAAC2F,OAAO,CAAC;UAAErD,MAAM,EAAEoB,CAAC;UAAExD,OAAO,EAAEe,EAAE;UAAE2E,IAAI,EAAE,IAAI,CAAC5E,cAAc,CAACC,EAAE;QAAE,CAAC,CAAC;MACjF;IACJ;;IAEA;AACJ;AACA;AACA;EAHI;IAAAX,GAAA;IAAAC,KAAA,EAIA,SAAAwF,UAAUA,CAAA,EAAG;MACT,IAAIC,CAAC,GAAG,EAAE;MACV;MACA,IAAI,CAAChG,KAAK,CAACiC,OAAO,CAAC,UAAUC,CAAC,EAAEC,CAAC,EAAE;QAC/B,IAAIuB,CAAC,GAAGxB,CAAC,CAACuD,aAAa;UAAEQ,CAAC;UAAEC,EAAE;QAC9B,IAAI,CAACxC,CAAC,EACF,IAAIwC,EAAE,GAAGhE,CAAC,CAAChC,OAAO,CAACsE,YAAY,CAAC,uBAAuB,CAAC,EAAE;UACtDd,CAAC,GAAGe,aAAa,CAACC,QAAQ,CAACwB,EAAE,CAAC;UAC9BhE,CAAC,CAACuD,aAAa,GAAG/B,CAAC;QACvB;QAEJuC,CAAC,GAAGvC,CAAC,GAAGA,CAAC,CAACpB,MAAM,GAAGJ,CAAC,CAACI,MAAM;QAC3B0D,CAAC,CAACG,IAAI,CAAC;UACHxG,MAAM,EAAEsG,CAAC;UACTG,OAAO,EAAEH,CAAC,CAACI,OAAO,CAAC,CAAC;UACpBC,OAAO,EAAEpE,CAAC,CAAChC;QACf,CAAC,CAAC;MACN,CAAC,CAAC;MACF,OAAO8F,CAAC;IACZ;;IAEA;AACJ;AACA;AACA;EAHI;IAAA1F,GAAA;IAAAC,KAAA,EAIA,SAAAgG,gBAAgBA,CAACC,CAAC,EAAE;MAChB,IAAMC,GAAG,GAAG,IAAI,CAACC,SAAS,CAAC,CAAC;MAC5B,OAAO;QACH5E,WAAW,EAAE2E,GAAG,CAACE,cAAc,CAACH,CAAC,CAAC1E,WAAW,CAAC;QAC9CC,UAAU,EAAE0E,GAAG,CAACE,cAAc,CAACH,CAAC,CAACzE,UAAU,CAAC;QAC5CF,QAAQ,EAAE4E,GAAG,CAACE,cAAc,CAACH,CAAC,CAAC3E,QAAQ,CAAC;QACxCD,OAAO,EAAE6E,GAAG,CAACE,cAAc,CAACH,CAAC,CAAC5E,OAAO;MACzC,CAAC;IACL;;IAEA;AACJ;AACA;EAFI;IAAAtB,GAAA;IAAAC,KAAA,EAGA,SAAAqG,WAAWA,CAAA,EAAG;MACV,IAAMlD,CAAC,GAAG,IAAI;QAAEvB,CAAC,GAAGuB,CAAC,CAAC1D,KAAK;QAAEyD,CAAC,GAAGtB,CAAC,CAACoD,MAAM;MACzC,IAAMsB,GAAG,GAAGpD,CAAC,GAAG,CAAC,GAAGtB,CAAC,CAACsB,CAAC,GAAG,CAAC,CAAC,GAAG,KAAK;MAEpC,OAAOoD,GAAG;IACd;;IAEA;AACJ;AACA;EAFI;IAAAvG,GAAA;IAAAC,KAAA,EAGA,SAAAmG,SAASA,CAAA,EAAG;MACR,IAAID,GAAG,GAAG9G,kDAAM,CAACmH,QAAQ,CAAC,CAAC;MAC3B,IAAI,CAAC9G,KAAK,CAACiC,OAAO,CAAC,UAAUC,CAAC,EAAEC,CAAC,EAAE;QAC/BsE,GAAG,CAAC3B,QAAQ,CAAC5C,CAAC,CAACI,MAAM,CAACC,QAAQ,CAAC;MACnC,CAAC,CAAC;MACF,OAAOkE,GAAG;IACd;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAAnG,GAAA;IAAAC,KAAA,EAKA,SAAAwG,eAAeA,CAACC,CAAC,EAAEC,IAAI,EAAE;MACrBA,IAAI,GAAGA,IAAI,IAAI,IAAI,CAAClB,UAAU,CAAC,CAAC;MAChC,IAAI,CAACZ,UAAU,CAAC,CAAC;MACjB,IAAI+B,EAAE,GAAGF,CAAC;QAAE3B,GAAG;QAAEoB,GAAG,GAAG9G,kDAAM,CAACmH,QAAQ,CAAC,CAAC,CAACjC,SAAS,CAAC,IAAI,CAAClD,MAAM,CAAC;MAE/D,KAAK,IAAIQ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG8E,IAAI,CAAC1B,MAAM,EAAEpD,CAAC,EAAE,EAAE;QAClCkD,GAAG,GAAG4B,IAAI,CAAC9E,CAAC,CAAC;QACbsE,GAAG,CAAC3B,QAAQ,CAACO,GAAG,CAAC1F,MAAM,CAAC4C,QAAQ,CAAC;MACrC;MAEA,IAAM4E,MAAM,GAAGV,GAAG,CAACJ,OAAO,CAAC,CAAC;MAC5Ba,EAAE,GAAGC,MAAM,CAACR,cAAc,CAACO,EAAE,CAAC;MAE9B,OAAOA,EAAE;IACb;EAAC;AAAA;AAIL,+DAAerH,QAAQ,E;;;;;;;;;;;;AC1SQ;AAE/B,IAAIF,OAAM,GAAG,SAATA,MAAMA,CAAayH,CAAC,EAAE;EACtB,IAAIA,CAAC,IAAI,IAAI,IAAI,OAAOA,CAAC,IAAI,WAAW,EACpC,OAAOzH,OAAM,CAACmH,QAAQ,CAAC,CAAC;EAE5B,IAAIM,CAAC,YAAYC,KAAK,EAAE;IACpB,IAAI,CAAC9E,QAAQ,GAAG6E,CAAC,CAACE,KAAK,CAAC,CAAC,CAAC;EAC9B,CAAC,MAAM;IACH,IAAGF,CAAC,YAAYzH,OAAM,EAAE;MACpB,IAAI,CAAC4C,QAAQ,GAAG6E,CAAC,CAAC7E,QAAQ,CAAC+E,KAAK,CAAC,CAAC,CAAC;IACvC,CAAC,MAAM;MACH,IAAIC,SAAS,CAAChC,MAAM,IAAI,CAAC,EAAE;QACvB,IAAI,CAAChD,QAAQ,GAAG,EAAE;QAClB,IAAIJ,CAAC,GAAG,CAAC;QACT,OAAOA,CAAC,GAAGoF,SAAS,CAAChC,MAAM,EACvB,IAAI,CAAChD,QAAQ,CAAC4D,IAAI,CAACoB,SAAS,CAACpF,CAAC,EAAE,CAAC,CAAC;MAC1C,CAAC,MACG,MAAM,IAAIqF,KAAK,CAAC,2FAA2F,CAAC;IACpH;EACJ;EACA,IAAI,CAACC,OAAO,GAAG;IAAEC,IAAI,EAAE,EAAE;IAAEC,IAAI,EAAE;EAAG,CAAC;EAErC,OAAO,IAAI;AACf,CAAC;AACDhI,OAAM,CAACmH,QAAQ,GAAG,YAAY;EAC1B,OAAO,IAAInH,OAAM,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AACzC,CAAC;AACDA,OAAM,CAACiI,SAAS,GAAG;EACfjB,cAAc,EAAE,SAAhBA,cAAcA,CAAY5C,EAAE,EAAE;IAC1B,IAAIkC,CAAC,GAAG,IAAI,CAAC1D,QAAQ;IAC3B,OAAO,IAAI3C,iDAAK,CACfmE,EAAE,CAAC8D,CAAC,GAAG5B,CAAC,CAAC,CAAC,CAAC,GAAGlC,EAAE,CAAC+D,CAAC,GAAG7B,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,EAChClC,EAAE,CAAC8D,CAAC,GAAG5B,CAAC,CAAC,CAAC,CAAC,GAAGlC,EAAE,CAAC+D,CAAC,GAAG7B,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAChC,CAAC;EACC,CAAC;EACDnB,QAAQ,EAAE,SAAVA,QAAQA,CAAWiD,GAAG,EAAE;IACpB,IAAIC,EAAE,GAAG,IAAI,CAACzF,QAAQ;IACtB,IAAI0F,EAAE,GAAGD,EAAE,CAAC,CAAC,CAAC;MACnBE,EAAE,GAAGF,EAAE,CAAC,CAAC,CAAC;MACVG,EAAE,GAAGH,EAAE,CAAC,CAAC,CAAC;MACVI,EAAE,GAAGJ,EAAE,CAAC,CAAC,CAAC;MACVK,EAAE,GAAGL,EAAE,CAAC,CAAC,CAAC;MACVM,EAAE,GAAGN,EAAE,CAAC,CAAC,CAAC;MACDO,EAAE,GAAGR,GAAG,CAAC,CAAC,CAAC;MACXS,EAAE,GAAGT,GAAG,CAAC,CAAC,CAAC;MACXU,EAAE,GAAGV,GAAG,CAAC,CAAC,CAAC;MACXW,EAAE,GAAGX,GAAG,CAAC,CAAC,CAAC;MACXY,EAAE,GAAGZ,GAAG,CAAC,CAAC,CAAC;MACXa,EAAE,GAAGb,GAAG,CAAC,CAAC,CAAC;;IAGrB;AACF;AACA;AACA;AACA;IACE,IAAI,CAACxF,QAAQ,GAAG,CACN0F,EAAE,GAAGM,EAAE,GAAGJ,EAAE,GAAGK,EAAE,EACjBN,EAAE,GAAGK,EAAE,GAAGH,EAAE,GAAGI,EAAE,EACjBP,EAAE,GAAGQ,EAAE,GAAGN,EAAE,GAAGO,EAAE,EACjBR,EAAE,GAAGO,EAAE,GAAGL,EAAE,GAAGM,EAAE,EACjBT,EAAE,GAAGU,EAAE,GAAGR,EAAE,GAAGS,EAAE,GAAGP,EAAE,EACtBH,EAAE,GAAGS,EAAE,GAAGP,EAAE,GAAGQ,EAAE,GAAGN,EAAE,CAC/B;IAED,OAAO,IAAI;EACT,CAAC;EACDO,aAAa,EAAE,SAAfA,aAAaA,CAAYzB,CAAC,EAAE0B,CAAC,EAAE;IAC3B,IAAI,CAAC1B,CAAC,IAAI,CAAC0B,CAAC,EAAE,OAAO,KAAK;IAC1B,OACA1B,CAAC,CAAC,CAAC,CAAC,IAAI0B,CAAC,CAAC,CAAC,CAAC,IACZ1B,CAAC,CAAC,CAAC,CAAC,IAAI0B,CAAC,CAAC,CAAC,CAAC,IACZ1B,CAAC,CAAC,CAAC,CAAC,IAAI0B,CAAC,CAAC,CAAC,CAAC,IACZ1B,CAAC,CAAC,CAAC,CAAC,IAAI0B,CAAC,CAAC,CAAC,CAAC,IACZ1B,CAAC,CAAC,CAAC,CAAC,IAAI0B,CAAC,CAAC,CAAC,CAAC,IACZ1B,CAAC,CAAC,CAAC,CAAC,IAAI0B,CAAC,CAAC,CAAC,CAAC;EAChB,CAAC;EACDC,IAAI,EAAE,SAANA,IAAIA,CAAYhB,GAAG,EAAE;IACjB,IAAItG,CAAC,GAAG,IAAI,CAACgG,OAAO;MAAEuB,IAAI;MACtBnG,CAAC,GAAG,OAAOkF,GAAG,KAAK,QAAQ,GAAGA,GAAG,GAAG,KAAK;IAE7C,IAAI,CAACA,GAAG,IAAIlF,CAAC,EACTkF,GAAG,GAAG,IAAI,CAACxF,QAAQ;IAEvByG,IAAI,GAAGvH,CAAC,CAACiG,IAAI,CAACjG,CAAC,CAACiG,IAAI,CAACnC,MAAM,GAAG,CAAC,CAAC;IAEhC,IAAI,CAAC,IAAI,CAACsD,aAAa,CAACd,GAAG,EAAEiB,IAAI,CAAC,EAAE;MAChC,IAAIvF,CAAC,GAAGhC,CAAC,CAACiG,IAAI,CAACvB,IAAI,CAAC4B,GAAG,CAACT,KAAK,CAAC,CAAC,CAAC,CAAC;MACjC7F,CAAC,CAACkG,IAAI,GAAG,EAAE;MACX,IAAI9E,CAAC,EACDpB,CAAC,CAACiG,IAAI,CAAC7E,CAAC,CAAC,GAAGpB,CAAC,CAACiG,IAAI,CAACjE,CAAC,GAAG,CAAC,CAAC;IACjC,CAAC,MACG,IAAIZ,CAAC,EAAE;MACHpB,CAAC,CAACiG,IAAI,CAAC7E,CAAC,CAAC,GAAGmG,IAAI;IACpB;EACR,CAAC;EACDtB,IAAI,EAAE,SAANA,IAAIA,CAAY7E,CAAC,EAAE;IACf,IAAIpB,CAAC,GAAG,IAAI,CAACgG,OAAO,CAACC,IAAI;MACrBuB,GAAG,GAAGxH,CAAC,CAAC8D,MAAM;MACdF,GAAG,GAAG5D,CAAC,CAACyH,GAAG,CAAC,CAAC;MACbC,IAAI,GAAG,OAAOtG,CAAC,IAAI,QAAQ,GAAGpB,CAAC,CAACoB,CAAC,CAAC,GAAGpB,CAAC,CAACA,CAAC,CAAC8D,MAAM,GAAG,CAAC,CAAC;IAExD,IAAIF,GAAG,EACH,IAAI,CAACoC,OAAO,CAACE,IAAI,CAAChC,OAAO,CAACN,GAAG,CAAC;IAElC,IAAI,CAAC9C,QAAQ,GAAG4G,IAAI,GAAGA,IAAI,CAAC7B,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC8B,QAAQ,CAAC,CAAC;EAC1D,CAAC;EACDzB,IAAI,EAAE,SAANA,IAAIA,CAAA,EAAc;IACd,IAAIlG,CAAC,GAAG,IAAI,CAACgG,OAAO,CAACE,IAAI;MACrBsB,GAAG,GAAGxH,CAAC,CAAC8D,MAAM;MACdF,GAAG,GAAG5D,CAAC,CAACyH,GAAG,CAAC,CAAC;MACbC,IAAI,GAAG1H,CAAC,CAACA,CAAC,CAAC8D,MAAM,GAAG,CAAC,CAAC;IAE1B,IAAIF,GAAG,EACH,IAAI,CAACoC,OAAO,CAACC,IAAI,CAAC/B,OAAO,CAACN,GAAG,CAAC;IAElC,IAAI,CAAC9C,QAAQ,GAAG4G,IAAI,GAAGA,IAAI,CAAC7B,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC8B,QAAQ,CAAC,CAAC;EAC1D,CAAC;EACDC,KAAK,EAAE,SAAPA,KAAKA,CAAA,EAAc;IACf,IAAI,CAAC9G,QAAQ,GAAG,IAAI,CAAC6G,QAAQ,CAAC,CAAC;IAC/B,OAAO,IAAI;EACf,CAAC;EACDE,WAAW,EAAE,SAAbA,WAAWA,CAAA,EAAc;IACrB,IAAIrD,CAAC,GAAG,IAAI,CAAC1D,QAAQ;IACrB,OAAO0D,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC;EACpC,CAAC;EACJI,OAAO,EAAE,SAATA,OAAOA,CAAA,EAAa;IAEnB,IAAI2B,EAAE,GAAG,IAAI,CAACzF,QAAQ;MACrB0D,CAAC,GAAI,IAAI,CAACmD,QAAQ,CAAC,CAAC;MACpBG,EAAE,GAAG,IAAI,CAACD,WAAW,CAAC,CAAC;IAExB,IAAIC,EAAE,GAAG,KAAK,EACb,MAAM,wBAAwB;IAE/BtD,CAAC,CAAC,CAAC,CAAC,GAAG+B,EAAE,CAAC,CAAC,CAAC,GAAGuB,EAAE;IACjBtD,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC+B,EAAE,CAAC,CAAC,CAAC,GAAGuB,EAAE;IAClBtD,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC+B,EAAE,CAAC,CAAC,CAAC,GAAGuB,EAAE;IAClBtD,CAAC,CAAC,CAAC,CAAC,GAAG+B,EAAE,CAAC,CAAC,CAAC,GAAGuB,EAAE;IACjBtD,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC+B,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE,CAAC,CAAC,CAAC,IAAIuB,EAAE;IAC3CtD,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE+B,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE,CAAC,CAAC,CAAC,CAAC,GAAGuB,EAAE;IAE5C,OAAO,IAAI5J,OAAM,CAACsG,CAAC,CAAC;EACrB,CAAC;EACDuD,MAAM,EAAE,SAARA,MAAMA,CAAA,EAAc;IACb,OAAO,IAAI,CAAC1E,QAAQ,CAAC,IAAI,CAACuB,OAAO,CAAC,CAAC,CAAC9D,QAAQ,CAAC;EACpD,CAAC;EACE6G,QAAQ,EAAE,SAAVA,QAAQA,CAAA,EAAc;IAClB,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAC7B,CAAC;EACDK,UAAU,EAAE,SAAZA,UAAUA,CAAA,EAAc;IACpB,IAAIxD,CAAC,GAAG,IAAI,CAAC1D,QAAQ;IACrB,OAAO0D,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;EAC3F,CAAC;EACDpB,SAAS,EAAE,SAAXA,SAASA,CAAYgD,CAAC,EAAEC,CAAC,EAAE;IACvB,IAAID,CAAC,YAAYjI,iDAAK,IAAI,CAACkI,CAAC,EACxB,OAAO,IAAI,CAAChD,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE+C,CAAC,CAACA,CAAC,EAAEA,CAAC,CAACC,CAAC,CAAC,CAAC;IAEhD,OAAO,IAAI,CAAChD,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE+C,CAAC,EAAEC,CAAC,CAAC,CAAC;EAC5C,CAAC;EACD4B,KAAK,EAAE,SAAPA,KAAKA,CAAY3F,EAAE,EAAE4F,CAAC,EAAE;IACpB,IAAI,CAAC7E,QAAQ,CAAC,CAAC6E,CAAC,EAAE,CAAC,EAAE,CAAC,EAAEA,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACjC,IAAIC,EAAE,GAAG7F,EAAE,CAAC2B,GAAG,CAAC3B,EAAE,CAAC2F,KAAK,CAACC,CAAC,CAAC,CAAC,CAACD,KAAK,CAAC,CAAC,GAACC,CAAC,CAAC,CAAC,CAAC;IACzC,OAAO,IAAI,CAAC9E,SAAS,CAAC+E,EAAE,CAAC;EAC7B,CAAC;EACDC,gBAAgB,EAAE,SAAlBA,gBAAgBA,CAAY9F,EAAE,EAAEqD,CAAC,EAAE;IAC/B,IAAIpB,CAAC,GAAGoB,CAAC,GAAG0C,IAAI,CAACC,EAAE,GAAG,GAAG;IACzB,OAAO,IAAI,CAACjF,QAAQ,CAAC,CACjBgF,IAAI,CAACE,GAAG,CAAChE,CAAC,CAAC,EACX8D,IAAI,CAACG,GAAG,CAACjE,CAAC,CAAC,EACX,CAAC8D,IAAI,CAACG,GAAG,CAACjE,CAAC,CAAC,EACZ8D,IAAI,CAACE,GAAG,CAAChE,CAAC,CAAC,EACXjC,EAAE,CAAC8D,CAAC,GAAGiC,IAAI,CAACE,GAAG,CAAChE,CAAC,CAAC,GAAGjC,EAAE,CAAC8D,CAAC,GAAG,CAACiC,IAAI,CAACG,GAAG,CAACjE,CAAC,CAAC,GAAGjC,EAAE,CAAC+D,CAAC,EAC/C/D,EAAE,CAAC+D,CAAC,GAAGgC,IAAI,CAACG,GAAG,CAACjE,CAAC,CAAC,GAAGjC,EAAE,CAAC8D,CAAC,GAAGiC,IAAI,CAACE,GAAG,CAAChE,CAAC,CAAC,GAAGjC,EAAE,CAAC+D,CAAC,CACjD,CAAC;EACN,CAAC;EACDoC,MAAM,EAAE,SAARA,MAAMA,CAAY9C,CAAC,EAAC0B,CAAC,EAAE;IACnB,IAAI1B,CAAC,YAAYxH,iDAAK,EAClB,OAAO,IAAI,CAACiK,gBAAgB,CAACzC,CAAC,EAAE0B,CAAC,CAAC;IAEtC,IAAI9C,CAAC,GAAGoB,CAAC,GAAG0C,IAAI,CAACC,EAAE,GAAG,GAAG;IACzB,OAAO,IAAI,CAACjF,QAAQ,CAAC,CAACgF,IAAI,CAACE,GAAG,CAAChE,CAAC,CAAC,EAAE8D,IAAI,CAACG,GAAG,CAACjE,CAAC,CAAC,EAAE,CAAC8D,IAAI,CAACG,GAAG,CAACjE,CAAC,CAAC,EAAE8D,IAAI,CAACE,GAAG,CAAChE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;EACrF,CAAC;EACDmE,YAAY,EAAE,SAAdA,YAAYA,CAAYnE,CAAC,EAAE;IACvB,OAAOA,CAAC,GAAG,CAAC,GAAGA,CAAC,GAAG,GAAG,GAAGA,CAAC;EAC9B,CAAC;EACDoE,QAAQ,EAAE,SAAVA,QAAQA,CAAYC,IAAI,EAAE;IACtB,IAAI5G,CAAC,GAAG,IAAI,CAAClB,QAAQ;MAAEyD,CAAC,GAAG8D,IAAI,CAACQ,KAAK,CAAC7G,CAAC,CAAC,CAAC,CAAC,EAAEA,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGqG,IAAI,CAACC,EAAE;IAEjE,OAAOM,IAAI,GAAG,IAAI,CAACF,YAAY,CAACnE,CAAC,CAAC,GAAGA,CAAC;EAC1C,CAAC;EACDuE,OAAO,EAAE,SAATA,OAAOA,CAAA,EAAc;IACjB,OAAOT,IAAI,CAACU,IAAI,CAACV,IAAI,CAACW,GAAG,CAAC,IAAI,CAAClI,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAGuH,IAAI,CAACW,GAAG,CAAC,IAAI,CAAClI,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EACnF,CAAC;EACDiD,WAAW,EAAE,SAAbA,WAAWA,CAAA,EAAc;IACrB,OAAO,IAAI5F,iDAAK,CAAC,IAAI,CAAC2C,QAAQ,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,QAAQ,CAAC,CAAC,CAAC,CAAC;EACxD;AACJ,CAAC;AAED,+DAAe5C,OAAM,E;;;;;;;;;;;;;;;;;ICxMfC,KAAK;EACT,SAAAA,MAAYiI,CAAC,EAAS;IAAA,IAAPC,CAAC,GAAAP,SAAA,CAAAhC,MAAA,QAAAgC,SAAA,QAAAmD,SAAA,GAAAnD,SAAA,MAAGM,CAAC;IAAA9H,eAAA,OAAAH,KAAA;IAClB,IAAI,CAACiI,CAAC,GAAGA,CAAC;IACV,IAAI,CAACC,CAAC,GAAGA,CAAC;EACZ;EAAC,OAAAzH,YAAA,CAAAT,KAAA;IAAAU,GAAA;IAAAC,KAAA,EAED,SAAAmJ,KAAKA,CAACiB,MAAM,EAAE;MACZ,OAAO,IAAI/K,KAAK,CAAC,IAAI,CAACiI,CAAC,GAAG8C,MAAM,EAAE,IAAI,CAAC7C,CAAC,GAAG6C,MAAM,CAAC;IACpD;EAAC;IAAArK,GAAA;IAAAC,KAAA,EAED,SAAAqK,KAAKA,CAAA,EAAgB;MAAA,IAAfC,SAAS,GAAAtD,SAAA,CAAAhC,MAAA,QAAAgC,SAAA,QAAAmD,SAAA,GAAAnD,SAAA,MAAG,CAAC;MACjB,IAAMoD,MAAM,GAAGE,SAAS,GAAGf,IAAI,CAACW,GAAG,CAAC,EAAE,EAAEI,SAAS,CAAC,GAAG,CAAC;MACtD,OAAO,IAAIjL,KAAK,CACdkK,IAAI,CAACc,KAAK,CAAC,IAAI,CAAC/C,CAAC,GAAG8C,MAAM,CAAC,GAAGA,MAAM,EACpCb,IAAI,CAACc,KAAK,CAAC,IAAI,CAAC9C,CAAC,GAAG6C,MAAM,CAAC,GAAGA,MAChC,CAAC;IACH;EAAC;IAAArK,GAAA;IAAAC,KAAA,EAED,SAAAmF,GAAGA,CAACsB,CAAC,EAAE;MACL,OAAO,IAAIpH,KAAK,CAAC,IAAI,CAACiI,CAAC,GAAGb,CAAC,CAACa,CAAC,EAAE,IAAI,CAACC,CAAC,GAAGd,CAAC,CAACc,CAAC,CAAC;IAC9C;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAAuK,GAAGA,CAAC9D,CAAC,EAAE;MACL,OAAO,IAAIpH,KAAK,CAAC,IAAI,CAACiI,CAAC,GAAGb,CAAC,CAACa,CAAC,EAAE,IAAI,CAACC,CAAC,GAAGd,CAAC,CAACc,CAAC,CAAC;IAC9C;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAAwK,IAAIA,CAAC/D,CAAC,EAAE;MACN,OAAO,IAAIpH,KAAK,CAAC,IAAI,CAACiI,CAAC,GAAGb,CAAC,CAACa,CAAC,EAAE,IAAI,CAACC,CAAC,GAAGd,CAAC,CAACc,CAAC,CAAC;IAC9C;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAAyK,MAAMA,CAAChE,CAAC,EAAE;MACR,OAAO,IAAIpH,KAAK,CAAC,IAAI,CAACiI,CAAC,GAAGb,CAAC,CAACa,CAAC,EAAE,IAAI,CAACC,CAAC,GAAGd,CAAC,CAACc,CAAC,CAAC;IAC9C;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAA0K,OAAOA,CAAA,EAAG;MACR,OAAO,IAAI,CAACpD,CAAC,KAAK,CAAC,IAAI,IAAI,CAACC,CAAC,KAAK,CAAC;IACrC;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAA2K,MAAMA,CAAClE,CAAC,EAAE;MACR,OAAO,IAAI,CAACa,CAAC,KAAKb,CAAC,CAACa,CAAC,IAAI,IAAI,CAACC,CAAC,KAAKd,CAAC,CAACc,CAAC;IACzC;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAA4K,QAAQA,CAACnE,CAAC,EAAE;MACV,OAAO;QAAEa,CAAC,EAAE,IAAI,CAACA,CAAC,IAAIb,CAAC,CAACa,CAAC;QAAEC,CAAC,EAAE,IAAI,CAACA,CAAC,IAAId,CAAC,CAACc;MAAE,CAAC;IAC/C;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAA6K,QAAQA,CAACpE,CAAC,EAAE;MACV,OAAO;QAAEa,CAAC,EAAE,IAAI,CAACA,CAAC,IAAIb,CAAC,CAACa,CAAC;QAAEC,CAAC,EAAE,IAAI,CAACA,CAAC,IAAId,CAAC,CAACc;MAAE,CAAC;IAC/C;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAA8K,GAAGA,CAACrE,CAAC,EAAE;MACL,OAAO,IAAI,CAACa,CAAC,GAAGb,CAAC,CAACa,CAAC,GAAG,IAAI,CAACC,CAAC,GAAGd,CAAC,CAACc,CAAC;IACpC;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAA+K,UAAUA,CAACC,EAAE,EAAEC,EAAE,EAAE;MACjB,IAAM3I,CAAC,GAAG,CAAC,CAAC2I,EAAE,CAAC1D,CAAC,GAAGyD,EAAE,CAACzD,CAAC,KAAK,IAAI,CAACD,CAAC,GAAG0D,EAAE,CAAC1D,CAAC,CAAC,GAAG,CAAC2D,EAAE,CAAC3D,CAAC,GAAG0D,EAAE,CAAC1D,CAAC,KAAK,IAAI,CAACC,CAAC,GAAGyD,EAAE,CAACzD,CAAC,CAAC,KACzEgC,IAAI,CAACW,GAAG,CAACe,EAAE,CAAC1D,CAAC,GAAGyD,EAAE,CAACzD,CAAC,EAAE,CAAC,CAAC,GAAGgC,IAAI,CAACW,GAAG,CAACe,EAAE,CAAC3D,CAAC,GAAG0D,EAAE,CAAC1D,CAAC,EAAE,CAAC,CAAC,CAAC;MACvD,IAAM4D,EAAE,GAAG,IAAI,CAAC5D,CAAC,GAAGhF,CAAC,IAAI2I,EAAE,CAAC1D,CAAC,GAAGyD,EAAE,CAACzD,CAAC,CAAC;MACrC,IAAM4D,EAAE,GAAG,IAAI,CAAC5D,CAAC,GAAGjF,CAAC,IAAI2I,EAAE,CAAC3D,CAAC,GAAG0D,EAAE,CAAC1D,CAAC,CAAC;MACrC,OAAO,IAAIjI,KAAK,CAAC6L,EAAE,EAAEC,EAAE,CAAC;IAC1B;EAAC;IAAApL,GAAA;IAAAC,KAAA,EAED,SAAAoL,GAAGA,CAAA,EAAG;MACJ,OAAO7B,IAAI,CAACU,IAAI,CAAC,IAAI,CAAC3C,CAAC,GAAG,IAAI,CAACA,CAAC,GAAG,IAAI,CAACC,CAAC,GAAG,IAAI,CAACA,CAAC,CAAC;IACrD;;IAEA;IACA;IACA;EAAA;AAAA;AAGF,+DAAelI,KAAK,E;;;;;;UCvEpB;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D,E;;;;;;;;;;;;;;;ACNkC;AACD;AACI;AACN;;AAE/B;AACA,CAAC,UAAUa,MAAM,EAAEE,QAAQ,EAAE;EAEzB,IAAIiL,MAAM,GAAG,EAAE;IAAEC,iBAAiB;IAAEC,OAAO;;EAE3C;EACA,IAAKrL,MAAM,CAACsL,gBAAgB,EAAG;IAC3BF,iBAAiB,GAAG,kBAAkB;EAC1C,CAAC,MAAM;IACHA,iBAAiB,GAAG,aAAa;IACjCD,MAAM,GAAG,IAAI;EACjB;;EAEA;EACAE,OAAO,GAAG,SAAS,IAAInL,QAAQ,CAACqL,aAAa,CAAC,KAAK,CAAC,GAAG,OAAO;EAAG;EACrDrL,QAAQ,CAACsL,YAAY,KAAKvB,SAAS,GAAG,YAAY;EAAG;EACrD,gBAAgB,CAAC,CAAC;;EAE9BjK,MAAM,CAACyL,gBAAgB,GAAG,UAAUC,IAAI,EAAEC,QAAQ,EAAEC,UAAU,EAAG;IAC7DC,iBAAiB,CAAEH,IAAI,EAAEL,OAAO,EAAEM,QAAQ,EAAEC,UAAW,CAAC;;IAExD;IACA,IAAIP,OAAO,IAAI,gBAAgB,EAAG;MAC9BQ,iBAAiB,CAAEH,IAAI,EAAE,qBAAqB,EAAEC,QAAQ,EAAEC,UAAW,CAAC;IAC1E;EACJ,CAAC;EAED,SAASC,iBAAiBA,CAAEH,IAAI,EAAEI,SAAS,EAAEH,QAAQ,EAAEC,UAAU,EAAG;IAChEF,IAAI,CAAEN,iBAAiB,CAAE,CAAED,MAAM,GAAGW,SAAS,EAAET,OAAO,IAAI,OAAO,GAAGM,QAAQ,GAAG,UAAUI,aAAa,EAAG;MACrG,CAACA,aAAa,KAAMA,aAAa,GAAG/L,MAAM,CAACgM,KAAK,CAAE;;MAElD;MACA,IAAIA,KAAK,GAAG;QACR;QACAD,aAAa,EAAEA,aAAa;QAC5BE,MAAM,EAAEF,aAAa,CAACE,MAAM,IAAIF,aAAa,CAACG,UAAU;QACxDC,IAAI,EAAE,OAAO;QACbC,SAAS,EAAEL,aAAa,CAACI,IAAI,IAAI,qBAAqB,GAAG,CAAC,GAAG,CAAC;QAC9DE,MAAM,EAAE,CAAC;QACTC,MAAM,EAAE,CAAC;QACTC,MAAM,EAAE,CAAC;QACTC,cAAc,EAAE,SAAhBA,cAAcA,CAAA,EAAa;UACvBT,aAAa,CAACS,cAAc,GACxBT,aAAa,CAACS,cAAc,CAAC,CAAC,GAC9BT,aAAa,CAACU,WAAW,GAAG,KAAK;QACzC,CAAC;QACDC,eAAe,EAAE,SAAjBA,eAAeA,CAAA,EAAc;UACzBX,aAAa,CAACW,eAAe,GACzBX,aAAa,CAACW,eAAe,CAAC,CAAC,GAC/BX,aAAa,CAACU,WAAW,GAAG,KAAK;QACzC;MACJ,CAAC;;MAED;MACA,IAAKpB,OAAO,IAAI,YAAY,EAAG;QAC3BW,KAAK,CAACM,MAAM,GAAG,CAAE,CAAC,GAAC,EAAE,GAAGP,aAAa,CAACY,UAAU;QAChD;QACAZ,aAAa,CAACa,WAAW,KAAMZ,KAAK,CAACK,MAAM,GAAG,CAAE,CAAC,GAAC,EAAE,GAAGN,aAAa,CAACa,WAAW,CAAE;MACtF,CAAC,MAAM;QACHZ,KAAK,CAACM,MAAM,GAAGP,aAAa,CAACc,MAAM;MACvC;;MAEA;MACA,OAAOlB,QAAQ,CAAEK,KAAM,CAAC;IAE5B,CAAC,EAAEJ,UAAU,IAAI,KAAM,CAAC;EAC5B;AAEJ,CAAC,EAAE5L,MAAM,EAAEE,QAAQ,CAAC;;AAEpB;AACA;AACA;AACA;AACA;AACA,IAAI8D,cAAa,GAAG,SAAhBA,aAAaA,CAAaxD,EAAE,EAAEsM,IAAI,EAAE;EACpCA,IAAI,GAAGA,IAAI,IAAI,CAAC,CAAC;EACjB,IAAItM,EAAE,CAACsE,MAAM,EACTtE,EAAE,GAAGA,EAAE,CAAC,CAAC,CAAC;EACd,IAAI,CAACuM,OAAO,GAAGD,IAAI;EACnB,IAAI,CAACrN,OAAO,GAAGe,EAAE;EACjB,IAAI,CAACf,OAAO,CAACoE,SAAS,CAACwG,GAAG,CAAC,eAAe,CAAC;EAC3C,IAAI,CAAC2C,MAAM,GAAGxM,EAAE,CAAC2C,UAAU;EAE3B,IAAI,CAAC8J,eAAe,CAAC,CAAC;EAEtB,IAAIH,IAAI,IAAIA,IAAI,CAACjL,MAAM,EAAE;IACrB,IAAIqL,MAAM,GAAG;MAAE9F,CAAC,EAAC,CAAC;MAAEC,CAAC,EAAC;IAAE,CAAC;IACzB,IAAIyF,IAAI,CAACK,YAAY,KAAKL,IAAI,CAACK,YAAY,CAACpM,KAAK,IAAI+L,IAAI,CAACK,YAAY,CAACC,KAAK,CAAC,EAAE;MAC3E;MACA;MACA;MACA;MACA;MACA,IAAIC,KAAK,GAAG;QACRtM,KAAK,EAAE+L,IAAI,CAACK,YAAY,CAACpM,KAAK,IAAI+L,IAAI,CAACK,YAAY,CAACC,KAAK;QACzDnM,MAAM,EAAE6L,IAAI,CAACK,YAAY,CAAClM,MAAM,IAAI6L,IAAI,CAACK,YAAY,CAACG;MAC1D,CAAC;MACD,IAAIC,KAAK,GAAG,IAAI,CAACnI,KAAK,CAAC3F,OAAO,CAAC4F,OAAO;MACtC6H,MAAM,CAAC9F,CAAC,GAAGmG,KAAK,CAACxM,KAAK,GAAGsM,KAAK,CAACtM,KAAK;MACpCmM,MAAM,CAAC7F,CAAC,GAAGkG,KAAK,CAACtM,MAAM,GAAGoM,KAAK,CAACpM,MAAM;IAC1C;IACA,IAAI6L,IAAI,CAACjL,MAAM,YAAY+E,KAAK,IAAIkG,IAAI,CAACjL,MAAM,CAACiD,MAAM,IAAI,CAAC,EAAE;MACzDgI,IAAI,CAACjL,MAAM,CAAC,CAAC,CAAC,IAAIqL,MAAM,CAAC9F,CAAC;MAC1B0F,IAAI,CAACjL,MAAM,CAAC,CAAC,CAAC,IAAIqL,MAAM,CAAC7F,CAAC;MAC1B,IAAI,CAACmG,UAAU,CAAC,IAAItO,kDAAM,CAAC4N,IAAI,CAACjL,MAAM,CAAC,CAAC;IAC5C,CAAC,MAAM,IAAIiL,IAAI,CAACjL,MAAM,YAAY3C,kDAAM,EAAE;MACtC4N,IAAI,CAACjL,MAAM,CAACC,QAAQ,CAAC,CAAC,CAAC,IAAIoL,MAAM,CAAC9F,CAAC;MACnC0F,IAAI,CAACjL,MAAM,CAACC,QAAQ,CAAC,CAAC,CAAC,IAAIoL,MAAM,CAAC7F,CAAC;MACnC,IAAI,CAACmG,UAAU,CAACV,IAAI,CAACjL,MAAM,CAAC;IAChC;EACJ;EACA,IAAI,CAACA,MAAM,GAAG,IAAI,CAAC4L,UAAU,CAAC,CAAC;EAC/B,IAAI,CAACC,kBAAkB,GAAG,IAAI,CAACC,sBAAsB,CAAC,CAAC;EACvD,IAAI,CAACvO,QAAQ,GAAG,IAAIA,oDAAQ,CAAC,IAAI,CAAC;EAElC,IAAI,CAACwO,UAAU,CAAC,CAAC;EAEjB,IAAI,CAACxO,QAAQ,CAACsF,UAAU,CAAC,CAAC;EAE1B,IAAI,CAACmJ,QAAQ,GAAG,KAAK,CAAC,CAAC;EACvB,IAAI,CAACC,KAAK,GAAG,IAAI;EACjB,IAAI,CAACC,IAAI,GAAG,IAAI;EAChB,IAAI,CAACC,KAAK,GAAG,KAAK;EAElB,IAAI,CAACC,MAAM,GAAG;IACVH,KAAK,EAAEhB,IAAI,CAACgB,KAAK;IACjBI,IAAI,EAAEpB,IAAI,CAACoB,IAAI;IACfC,IAAI,EAAErB,IAAI,CAACqB,IAAI;IACfC,GAAG,EAAEtB,IAAI,CAACsB,GAAG;IACbC,UAAU,EAAEvB,IAAI,CAACuB;EACrB,CAAC;EAED,IAAI,CAAC5O,OAAO,CAAC6O,YAAY,CAAC,uBAAuB,EAAEtK,cAAa,CAACC,QAAQ,CAACyB,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;EACzF,IAAG6I,SAAS,CAACC,SAAS,CAACvM,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,EACxC,IAAI,CAACxC,OAAO,CAAC6O,YAAY,CAAC,WAAW,EAAE,KAAK,CAAC;EAEjD,IAAI,CAAC,OAAOxB,IAAI,CAAC2B,YAAY,IAAI,WAAW,IAAI3B,IAAI,CAAC2B,YAAY,KAAK,IAAI,KAAK3B,IAAI,CAAC4B,QAAQ,KAAK,KAAK,EAAE;IACpG,IAAI,CAACC,UAAU,CAAC,CAAC;IAEjB,IAAI7B,IAAI,CAAC8B,MAAM,EACX,IAAI,CAACC,mBAAmB,CAAC/B,IAAI,CAAC8B,MAAM,CAAC;IAEzC,IAAI,CAAC9B,IAAI,CAACgC,OAAO,IAAIhC,IAAI,CAACgC,OAAO,IAAI,CAAChC,IAAI,CAACgC,OAAO,CAACrF,MAAM,EACrD,IAAI,CAACsF,mBAAmB,CAAC,CAAC;IAE9B,IAAIjC,IAAI,CAACkC,MAAM,IAAIlC,IAAI,CAACX,IAAI,IAAI,aAAa,EACzC,IAAI,CAAC8C,gBAAgB,CAACnC,IAAI,CAACkC,MAAM,CAAC;EAC1C;AACJ,CAAC;AACD;AACA;AACA;AACA;AACA;AACAhL,cAAa,CAACC,QAAQ,GAAG,EAAE;AAC3B;AACA;AACA;AACA;AACAD,cAAa,CAACmD,SAAS,CAACwG,sBAAsB,GAAG,YAAY;EACzD,IAAI1K,CAAC,GAAGvC,gBAAgB,CAAC,IAAI,CAACjB,OAAO,CAAC,CAAC,YAAY,CAAC;IAAEyP,EAAE,GAAGjM,CAAC,CAACkM,KAAK,CAAC,GAAG,CAAC;IAAE5J,CAAC,GAAG,EAAE;EAC/E,KAAK,IAAI7D,CAAC,IAAIwN,EAAE,EAAE;IACd,IAAIA,EAAE,CAACxN,CAAC,CAAC,CAACO,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,EACjCsD,CAAC,CAACG,IAAI,CAACwJ,EAAE,CAACxN,CAAC,CAAC,CAAC;EACrB;EACA,OAAO6D,CAAC,CAAC6J,IAAI,CAAC,GAAG,CAAC;AACtB,CAAC;AACD;AACA;AACA;AACA;AACApL,cAAa,CAACmD,SAAS,CAACkI,GAAG,GAAG,UAAUC,GAAG,EAAE;EACzC,IAAI/J,CAAC,GAAGrF,QAAQ,CAACqL,aAAa,CAAC,KAAK,CAAC;EACrChG,CAAC,CAACgK,SAAS,GAAGD,GAAG;EACjB,OAAO/J,CAAC,CAACiK,UAAU;AACvB,CAAC;AACD;AACA;AACA;AACA;AACAxL,cAAa,CAACmD,SAAS,CAAC4H,mBAAmB,GAAG,UAAUU,GAAG,EAAE;EACzD,IAAK,CAACA,GAAG,IAAIA,GAAG,IAAI,QAAQ,EAAG;IAC3B,IAAIC,GAAG,GAAG,IAAI,CAACL,GAAG,CAAC,gDAAgD,CAAC;MAChEM,GAAG,GAAG,IAAI,CAACN,GAAG,CAAC,0sDAA0sD,CAAC;MAC1tDO,GAAG,GAAG,IAAI,CAACP,GAAG,CAAC,w/BAAw/B,CAAC;MACxgCQ,GAAG,GAAG,IAAI,CAACR,GAAG,CAAC,iDAAiD,CAAC;MACjES,IAAI,GAAG,IAAI;IAGfJ,GAAG,CAACK,WAAW,CAACF,GAAG,CAAC;IACpBH,GAAG,CAACK,WAAW,CAACH,GAAG,CAAC;IACpBF,GAAG,CAACK,WAAW,CAACJ,GAAG,CAAC;IACpBD,GAAG,CAACK,WAAW,CAAC,IAAI,CAACV,GAAG,CAAC,gDAAgD,CAAC,CAAC;IAE3E,IAAG,IAAI,CAAC5P,OAAO,CAACuQ,QAAQ,IAAE,KAAK,EAC3B,IAAI,CAAChD,MAAM,CAAC+C,WAAW,CAACL,GAAG,CAAC,CAAC,KAE7B,IAAI,CAACjQ,OAAO,CAACsQ,WAAW,CAACL,GAAG,CAAC;;IAEjC;IACAA,GAAG,CAACpE,gBAAgB,CAAC,OAAO,EAAE,UAAU2E,CAAC,EAAE;MAAEA,CAAC,CAACvD,eAAe,CAAC,CAAC;MAAE,OAAO,KAAK;IAAE,CAAC,CAAC;IAElF,IAAI,CAACwD,UAAU,GAAG,IAAIlM,cAAa,CAAC0L,GAAG,EAAE;MAAEvD,IAAI,EAAE,aAAa;MAAEgE,YAAY,EAAE,IAAI;MAAEnB,MAAM,EAAEW,GAAG;MAAEb,OAAO,EAAE;QAAEsB,IAAI,EAAE,IAAI;QAAE3G,MAAM,EAAE,IAAI;QAAEmF,MAAM,EAAE;MAAK;IAAE,CAAC,CAAC;IAEvJ,IACAyB,UAAU,GAAG,SAAbA,UAAUA,CAAA,EAAe;QACrB,IAAIP,IAAI,CAACI,UAAU,EACf,IAAGJ,IAAI,CAACI,UAAU,CAAClD,MAAM,EACrB8C,IAAI,CAACI,UAAU,CAAClD,MAAM,CAACnJ,SAAS,CAACyM,MAAM,CAAC,yBAAyB,CAAC;QAE1E,IAAI7M,IAAI,GAAGvD,QAAQ,CAACqQ,aAAa,CAAC,MAAM,CAAC;QACzCT,IAAI,CAACU,GAAG,CAAC/M,IAAI,EAAE,sBAAsB,CAAC;MAC1C,CAAC;MACDgN,YAAY,GAAG,SAAfA,YAAYA,CAAA,EAAe;QACvB,IAAI,CAAC5M,SAAS,CAACwG,GAAG,CAAC,yBAAyB,CAAC;QAC7C,IAAI5G,IAAI,GAAGvD,QAAQ,CAACqQ,aAAa,CAAC,MAAM,CAAC;QACzCT,IAAI,CAACY,EAAE,CAACjN,IAAI,EAAE,sBAAsB,EAAE4M,UAAU,CAAC;MACrD,CAAC;MACDM,aAAa,GAAG,SAAhBA,aAAaA,CAAA,EAAe;QACxB,IAAIb,IAAI,CAACc,UAAU,EACfC,YAAY,CAACf,IAAI,CAACc,UAAU,CAAC;;QAEjC;QACA;QACA;QACA;QACAd,IAAI,CAACgB,YAAY,GAAGC,UAAU,CAAC,YAAY;UACvCjB,IAAI,CAACrQ,OAAO,CAACoE,SAAS,CAACyM,MAAM,CAAC,2BAA2B,CAAC;QAC9D,CAAC,EAAE,GAAG,CAAC;QAEP,IAAI,CAACzM,SAAS,CAACyM,MAAM,CAAC,2BAA2B,CAAC;QAClD,IAAI,CAACzM,SAAS,CAACyM,MAAM,CAAC,oBAAoB,CAAC;MAC/C,CAAC;MACDU,aAAa,GAAG,SAAhBA,aAAaA,CAAaC,GAAG,EAAE;QAC3B,IAAIA,GAAG,CAACvE,eAAe,EACnBuE,GAAG,CAACvE,eAAe,CAAC,CAAC;QAEzB,IAAIoD,IAAI,CAACgB,YAAY,EACjBD,YAAY,CAACf,IAAI,CAACgB,YAAY,CAAC;QAEnC,IAAI,CAACjN,SAAS,CAACwG,GAAG,CAAC,oBAAoB,CAAC;QACxC,IAAI,CAACxG,SAAS,CAACwG,GAAG,CAAC,2BAA2B,CAAC;QAE/CyF,IAAI,CAAC1Q,QAAQ,CAACG,KAAK,CAACiC,OAAO,CAAC,UAAUC,CAAC,EAAEC,CAAC,EAAE;UACxC,IAAID,CAAC,CAACmP,UAAU,EACZC,YAAY,CAACpP,CAAC,CAACmP,UAAU,CAAC;QAClC,CAAC,CAAC;QAEFd,IAAI,CAACc,UAAU,GAAGG,UAAU,CAAC,YAAY;UACrC,IACIG,EAAE,GAAGpB,IAAI,CAACI,UAAU;YACpBN,GAAG,GAAGsB,EAAE,CAAC9R,QAAQ;YACjBkE,EAAE,GAAGsM,GAAG,CAACzJ,WAAW,CAAC,CAAC;YACtBgL,EAAE,GAAG,CAAC;UACV;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;UAGgB,IAAGvQ,UAAU,CAACF,gBAAgB,CAACwQ,EAAE,CAACzR,OAAO,CAAC,CAACsB,KAAK,CAAC,IAAI,EAAE,EACnDmQ,EAAE,CAAClE,MAAM,CAACnJ,SAAS,CAACwG,GAAG,CAAC,2BAA2B,CAAC;UAExD,IAAIrH,CAAC,GAAG4M,GAAG,CAACrQ,KAAK,CAACuF,MAAM;UACxB8K,GAAG,CAACrQ,KAAK,CAACiC,OAAO,CAAC,UAAUC,CAAC,EAAEC,CAAC,EAAE;YAC9B,IAAIA,CAAC,GAAGsB,CAAC,GAAC,CAAC,EAAE;cACTvB,CAAC,CAAChC,OAAO,CAACoE,SAAS,CAACyM,MAAM,CAAC,2BAA2B,CAAC;YAC3D;UACJ,CAAC,CAAC;QAEN,CAAC,EAAE,OAAOW,GAAI,IAAI,QAAQ,GAAGA,GAAG,GAAG,IAAI,CAAC;MAE5C,CAAC;IAED,IAAIG,SAAS,GAAG,IAAI,CAAClB,UAAU,CAAClD,MAAM;IAEtC,IAAI,CAAC0D,EAAE,CAACU,SAAS,EAAE,yBAAyB,EAAEJ,aAAa,CAAC;IAC5D,IAAI,CAACN,EAAE,CAACU,SAAS,EAAE,yBAAyB,EAAET,aAAa,CAAC;IAC5D,IAAI,CAACD,EAAE,CAACU,SAAS,EAAE,wBAAwB,EAAEX,YAAY,CAAC;IAC1D,IAAI,CAACC,EAAE,CAACU,SAAS,EAAE,oBAAoB,EAAE,YAAY;MAAEJ,aAAa,CAACK,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;IAAE,CAAC,CAAC;EAC7F;AACJ,CAAC;AACD;AACA;AACA;AACA;AACArN,cAAa,CAACmD,SAAS,CAAC0H,mBAAmB,GAAG,UAAUY,GAAG,EAAE;EACzD;EACA,IAAIA,GAAG,IAAI,OAAO,EAAE;IAChB,IACI6B,EAAE,GAAG,IAAI,CAACjC,GAAG,CAAC,8yEAA8yE,CAAC;MAC7zEkC,EAAE,GAAG,IAAI,CAAClC,GAAG,CAAC,uiDAAuiD,CAAC;IAC1jD,IACImC,GAAG,GAAG,IAAI,CAACnC,GAAG,CAAC,iDAAiD,CAAC;MACjEoC,GAAG,GAAGD,GAAG,CAACE,SAAS,CAAC,CAAC;IAEzBF,GAAG,CAAC3N,SAAS,CAACwG,GAAG,CAAC,IAAI,CAAC;IACvBmH,GAAG,CAACzB,WAAW,CAACuB,EAAE,CAAC;IACnBG,GAAG,CAAC5N,SAAS,CAACwG,GAAG,CAAC,IAAI,CAAC;IACvBoH,GAAG,CAAC1B,WAAW,CAACwB,EAAE,CAAC;IAEnB,IAAI,CAACI,SAAS,GAAGH,GAAG;IACpB,IAAI,CAACI,SAAS,GAAGH,GAAG;IAEpB,IAAI,CAAChS,OAAO,CAACsQ,WAAW,CAACyB,GAAG,CAAC;IAC7B,IAAI,CAAC/R,OAAO,CAACsQ,WAAW,CAAC0B,GAAG,CAAC;IAC7B,IAAI,CAACI,gBAAgB,CAACL,GAAG,EAAEC,GAAG,CAAC;EACnC;AACJ,CAAC;AACD;AACA;AACA;AACA;AACAzN,cAAa,CAACmD,SAAS,CAACiJ,IAAI,GAAG,UAAU0B,GAAG,EAAE;EAC1C,IAAI5Q,MAAM,GAAG,IAAI,CAAC9B,QAAQ,CAACkH,eAAe,CAAC,IAAI,CAACyL,mBAAmB,CAAC,CAAC,CAAC;EACtE,IAAI,CAAC9I,KAAK,CAAC/H,MAAM,EAAE,CAAC,GAAG4Q,GAAG,GAAG,IAAI,CAAC;EAElC,OAAO,IAAI;AACf,CAAC;AACD;AACA;AACA;AACA;AACA;AACA9N,cAAa,CAACmD,SAAS,CAAC8B,KAAK,GAAG,UAAU1C,CAAC,EAAE2C,CAAC,EAAE;EAC5C,IAAI,CAACrH,MAAM,CAACoH,KAAK,CAAC1C,CAAC,EAAE2C,CAAC,CAAC;EACvB,IAAI,CAAC8I,aAAa,CAAC,IAAI,CAAC;EACxB,IAAI,CAACC,cAAc,CAAC,CAAC;EACrB;EACA,OAAO,IAAI;AACf,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACAjO,cAAa,CAACmD,SAAS,CAAC/C,SAAS,GAAG,UAAUgD,CAAC,EAACC,CAAC,EAAEgH,UAAU,EAAE;EAC3D,IAAI,CAACxM,MAAM,CAACuC,SAAS,CAACgD,CAAC,EAAEC,CAAC,CAAC;EAC3B,IAAI,CAAC2K,aAAa,CAAC3D,UAAU,CAAC;EAC9B,IAAI,CAAC4D,cAAc,CAAC,CAAC;EACrB,OAAO,IAAI;AACf,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAjO,cAAa,CAACmD,SAAS,CAACsC,MAAM,GAAG,UAAUlD,CAAC,EAAEI,CAAC,EAAE9B,KAAK,EAAEqN,QAAQ,EAAE;EAC9D,IAAI,EAAE3L,CAAC,YAAYpH,iDAAK,CAAC,IAAI,CAACoH,CAAC,IAAI,OAAOA,CAAC,IAAI,WAAW,EACtDA,CAAC,GAAG,IAAI,CAACnH,QAAQ,CAACkH,eAAe,CAAC,IAAI,CAACyL,mBAAmB,CAAC,CAAC,CAAC;EAEjE,IAAIxL,CAAC,YAAYpH,iDAAK,IAAI+S,QAAQ,EAC9B3L,CAAC,GAAG,IAAI,CAACnH,QAAQ,CAACkH,eAAe,CAACC,CAAC,CAAC;EAExC,IAAI,CAAC1E,MAAM,CAAC4H,MAAM,CAAClD,CAAC,EAAEI,CAAC,CAAC;EACxB,IAAI,CAACwL,iBAAiB,GAAG5L,CAAC;EAC1B,IAAI,OAAO1B,KAAK,IAAI,WAAW,IAAIA,KAAK,KAAK,KAAK,EAC9C,IAAI,CAACmN,aAAa,CAAC,KAAK,CAAC;EAE7B,IAAI,CAACC,cAAc,CAAC,CAAC;EACrB,OAAO,IAAI;AACf,CAAC;AACD;AACA;AACA;AACAjO,cAAa,CAACmD,SAAS,CAACiL,UAAU,GAAG,YAAY;EAC7C,IAAI7M,CAAC,GAAG,IAAI,CAAC1D,MAAM,CAAC8H,QAAQ,CAAC,CAAC;EAC9B,IAAI,CAACF,MAAM,CAAC,IAAItK,iDAAK,CAAC,IAAI,CAACiG,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACtE,KAAK,GAAG,CAAC,EAAE,IAAI,CAACqE,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACpE,MAAM,GAAG,CAAC,CAAC,EAAE,CAACsE,CAAC,EAAE,IAAI,CAAC;EAC7G,OAAO,IAAI;AACf,CAAC;AACD;AACA;AACA;AACAvB,cAAa,CAACmD,SAAS,CAACkL,WAAW,GAAG,YAAY;EAC9C,IAAIC,EAAE,GAAG,IAAInT,iDAAK,CAAC,IAAI,CAACiG,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACtE,KAAK,EAAE,IAAI,CAACqE,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACpE,MAAM,CAAC;IACnF2O,GAAG,GAAG,IAAI,CAACxQ,QAAQ;IACnBoH,IAAI,GAAGoJ,GAAG,CAACtK,UAAU,CAAC,CAAC;IACvBiN,OAAO,GAAG3C,GAAG,CAACzJ,WAAW,CAAC,CAAC;IAC3BqM,EAAE,GAAGD,OAAO,CAACpN,IAAI;IACjBK,CAAC,GAAG,IAAI,CAAC3D,MAAM,CAAC+D,OAAO,CAAC,CAAC;IACzB0L,EAAE,GAAG9L,CAAC,CAACU,cAAc,CAACsM,EAAE,CAACrR,OAAO,CAAC;IACjCsR,EAAE,GAAGjN,CAAC,CAACU,cAAc,CAACsM,EAAE,CAACpR,QAAQ,CAAC;IAClCsR,EAAE,GAAGlN,CAAC,CAACU,cAAc,CAACsM,EAAE,CAAClR,UAAU,CAAC;IACpCiQ,EAAE,GAAG/L,CAAC,CAACU,cAAc,CAACsM,EAAE,CAACnR,WAAW,CAAC;IACrCsR,IAAI,GAAG,IAAIxT,iDAAK,CAAC,IAAI,CAACyT,sBAAsB,CAACtB,EAAE,EAAEmB,EAAE,CAAC,EAAE,IAAI,CAACG,sBAAsB,CAACtB,EAAE,EAAEoB,EAAE,CAAC,CAAC;EAE9F,IAAIG,EAAE,GAAGF,IAAI,CAACpI,MAAM,CAAC+H,EAAE,CAAC;IAAErJ,KAAK,GAAGI,IAAI,CAACyJ,GAAG,CAACD,EAAE,CAACzL,CAAC,EAAEyL,EAAE,CAACxL,CAAC,CAAC;EACtD,IAAI,CAAC4B,KAAK,CAAC,IAAI9J,iDAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE8J,KAAK,CAAC;EAClC,IAAI,CAAC8J,cAAc,CAAC,IAAI,EAAEvM,IAAI,CAAC;EAC/B,IAAI,CAAC4L,UAAU,CAAC,CAAC;EAEjB,OAAO,IAAI;AACf,CAAC;AACD;AACA;AACA;AACA;AACApO,cAAa,CAACmD,SAAS,CAAC6L,YAAY,GAAG,YAAY;EAC/C,IAAIV,EAAE,GAAG,IAAInT,iDAAK,CAAC,IAAI,CAACiG,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACtE,KAAK,EAAE,IAAI,CAACqE,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACpE,MAAM,CAAC;IACvF2O,GAAG,GAAG,IAAI,CAACxQ,QAAQ;IACnBoH,IAAI,GAAGoJ,GAAG,CAACtK,UAAU,CAAC,CAAC;IACvBiN,OAAO,GAAG3C,GAAG,CAACzJ,WAAW,CAAC,CAAC;IAC3BqM,EAAE,GAAGD,OAAO,CAACpN,IAAI;IACjBK,CAAC,GAAG,IAAI,CAAC3D,MAAM,CAAC+D,OAAO,CAAC,CAAC;IACzB0L,EAAE,GAAG9L,CAAC,CAACU,cAAc,CAACsM,EAAE,CAACrR,OAAO,CAAC;IACjCsR,EAAE,GAAGjN,CAAC,CAACU,cAAc,CAACsM,EAAE,CAACpR,QAAQ,CAAC;IAClCsR,EAAE,GAAGlN,CAAC,CAACU,cAAc,CAACsM,EAAE,CAAClR,UAAU,CAAC;IACpCiQ,EAAE,GAAG/L,CAAC,CAACU,cAAc,CAACsM,EAAE,CAACnR,WAAW,CAAC;IACrCsR,IAAI,GAAG,IAAIxT,iDAAK,CAAC,IAAI,CAACyT,sBAAsB,CAACtB,EAAE,EAAEmB,EAAE,CAAC,EAAE,IAAI,CAACG,sBAAsB,CAACtB,EAAE,EAAEoB,EAAE,CAAC,CAAC;EAE1F,IAAIG,EAAE,GAAGF,IAAI,CAACpI,MAAM,CAAC+H,EAAE,CAAC;IACpBrJ,KAAK,GAAGI,IAAI,CAAC4J,GAAG,CAACJ,EAAE,CAACzL,CAAC,EAAEyL,EAAE,CAACxL,CAAC,CAAC;EAEhC,IAAI,CAAC4B,KAAK,CAAC,IAAI9J,iDAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE8J,KAAK,CAAC;EAClC,IAAI,CAAC8J,cAAc,CAAC,IAAI,EAAEvM,IAAI,CAAC;EAC/B,IAAI,CAAC4L,UAAU,CAAC,CAAC;EAEjB,OAAO,IAAI;AACf,CAAC;AACD;AACA;AACA;AACA;AACApO,cAAa,CAACmD,SAAS,CAAC+L,QAAQ,GAAG,UAAU1S,EAAE,EAAE;EAC7C,OAAOA,EAAE,CAAC2S,qBAAqB,CAAC,CAAC;AACrC,CAAC;AACD;AACA;AACA;AACA;AACAnP,cAAa,CAACmD,SAAS,CAACyB,KAAK,GAAG,UAAU/D,KAAK,EAAE;EAC7C,IAAI,CAAC,IAAI,CAACuO,aAAa,EACnB,IAAI,CAACvR,MAAM,CAAC+G,KAAK,CAAC,CAAC,CAAC,KAEpB,IAAI,CAAC/G,MAAM,CAACC,QAAQ,GAAG,IAAI,CAACsR,aAAa,CAACvM,KAAK,CAAC,CAAC,CAAC;;EAEtD;EACA;;EAEA,IAAI,CAACmL,aAAa,CAAC,OAAOnN,KAAK,IAAI,WAAW,GAAG,IAAI,GAAGA,KAAK,CAAC;EAC9D,IAAI,IAAI,CAACwJ,UAAU,EAAE;IACjB,IAAIyB,IAAI,GAAG,IAAI;IAEf,IAAI,IAAI,CAACuD,KAAK,KAAK,IAAI,CAACA,KAAK,CAACjM,CAAC,IAAI,IAAI,CAACiM,KAAK,CAAChM,CAAC,CAAC,EAAE;MAAE;MAChD,IAAI,CAAC5H,OAAO,CAACoE,SAAS,CAACwG,GAAG,CAAC,qBAAqB,CAAC;MACjD,IAAI,CAACqG,EAAE,CAAC,IAAI,CAACjR,OAAO,EAAE,qBAAqB,EAAE,YAAY;QACrD,IAAI,CAACoE,SAAS,CAACyM,MAAM,CAAC,qBAAqB,CAAC;QAC5CR,IAAI,CAACU,GAAG,CAAC,IAAI,EAAE,qBAAqB,CAAC;MACzC,CAAC,CAAC;IACN;IACA;IACA;IACA;IACA;IACA;EACJ;EACA,IAAI,CAACyB,cAAc,CAAC,CAAC;EACrB,OAAO,IAAI;AACf,CAAC;AACD;AACA;AACA;AACA;AACAjO,cAAa,CAACmD,SAAS,CAACmM,aAAa,GAAG,UAAUlR,CAAC,EAAE;EACjD,OAAO,IAAI,CAACP,MAAM,CAACmF,OAAO,CAACC,IAAI,CAAC7E,CAAC,CAAC,YAAYwE,KAAK;AACvD,CAAC;AACD;AACA;AACA;AACA;AACA5C,cAAa,CAACmD,SAAS,CAACF,IAAI,GAAG,UAAU7E,CAAC,EAAE;EACxC,IAAI,CAACP,MAAM,CAACoF,IAAI,CAAC7E,CAAC,CAAC;EACnB,IAAI,CAAC4P,aAAa,CAAC,IAAI,CAAC;EACxB,IAAI,CAACC,cAAc,CAAC,CAAC;EACrB,OAAO,IAAI;AACf,CAAC;;AAED;AACA;AACA;AACAjO,cAAa,CAACmD,SAAS,CAACD,IAAI,GAAG,YAAY;EACvC,IAAI,CAACrF,MAAM,CAACqF,IAAI,CAAC,CAAC;EAClB,IAAI,CAAC8K,aAAa,CAAC,IAAI,CAAC;EACxB,IAAI,CAACC,cAAc,CAAC,CAAC;EACrB,OAAO,IAAI;AACf,CAAC;;AAED;AACA;AACA;AACAjO,cAAa,CAACmD,SAAS,CAAC8F,eAAe,GAAG,YAAY;EAClD,IAAI,IAAI,CAAC7H,KAAK,EAAE;EAChB,IACI3E,EAAE,GAAGT,MAAM,CAACU,gBAAgB,CAAC,IAAI,CAACjB,OAAO,CAAC;IAC1CqB,CAAC,GAAGF,UAAU,CAACH,EAAE,CAACM,KAAK,CAAC;IACxBC,CAAC,GAAGJ,UAAU,CAACH,EAAE,CAACQ,MAAM,CAAC;IACzB+B,CAAC,GAAGpC,UAAU,CAACH,EAAE,CAACE,IAAI,CAAC;IACvBsC,CAAC,GAAGrC,UAAU,CAACH,EAAE,CAACI,GAAG,CAAC,CAAC,CAAC;;EAE5B,IAAI,CAACuE,KAAK,GAAG;IACT3F,OAAO,EAAE;MACL4F,OAAO,EAAE;QACLnE,MAAM,EAAE,IAAI/B,iDAAK,CAAC6D,CAAC,EAAEC,CAAC,CAAC;QACvBlC,KAAK,EAAED,CAAC;QACRG,MAAM,EAAED,CAAC;QACTG,OAAO,EAAE,IAAIhC,iDAAK,CAAC,CAAC,EAAE,CAAC,CAAC;QACxBiC,QAAQ,EAAE,IAAIjC,iDAAK,CAAC2B,CAAC,EAAE,CAAC,CAAC;QACzBO,WAAW,EAAE,IAAIlC,iDAAK,CAAC2B,CAAC,EAAEE,CAAC,CAAC;QAC5BM,UAAU,EAAE,IAAInC,iDAAK,CAAC,CAAC,EAAE6B,CAAC;MAC9B;IACJ,CAAC;IACDhB,MAAM,EAAE;MAAEe,KAAK,EAAEH,UAAU,CAACF,gBAAgB,CAACR,QAAQ,CAACuD,IAAI,CAACN,UAAU,CAAC,CAACpC,KAAK;IAAE;EAClF,CAAC;AACL,CAAC;;AAED;AACA;AACA;AACA;AACAiD,cAAa,CAACmD,SAAS,CAACoM,UAAU,GAAG,UAAU/S,EAAE,EAAE;EAC/C,IAAIgT,EAAE,GAAG,IAAI,CAACN,QAAQ,CAAC1S,EAAE,CAAC;IAAEmE,MAAM,GAAG,IAAI,CAACvF,QAAQ,CAACW,UAAU,CAAC,CAAC;EAE/D,IAAIU,EAAE,GAAGC,gBAAgB,CAACF,EAAE,CAAC;IACzBiT,GAAG,GAAG,IAAItU,iDAAK,CAACyB,UAAU,CAACH,EAAE,CAACE,IAAI,CAAC,EAAEC,UAAU,CAACH,EAAE,CAACI,GAAG,CAAC,CAAC;IACxD6S,EAAE,GAAG,IAAIvU,iDAAK,CAACqU,EAAE,CAAC7S,IAAI,GAAGgE,MAAM,CAACyC,CAAC,EAAEoM,EAAE,CAAC3S,GAAG,GAAG8D,MAAM,CAAC0C,CAAC,CAAC;IACrDkK,EAAE,GAAG,IAAIpS,iDAAK,CAACqU,EAAE,CAACG,KAAK,EAAEH,EAAE,CAACI,MAAM,CAAC;IACnCnB,EAAE,GAAG,IAAItT,iDAAK,CAACqU,EAAE,CAACG,KAAK,EAAEH,EAAE,CAAC3S,GAAG,CAAC;IAChC6R,EAAE,GAAG,IAAIvT,iDAAK,CAACqU,EAAE,CAAC7S,IAAI,EAAE6S,EAAE,CAACI,MAAM,CAAC;EAEtC,OAAO;IAAE1S,MAAM,EAAEwS,EAAE;IAAEvS,OAAO,EAAEuS,EAAE;IAAErS,WAAW,EAAEkQ,EAAE;IAAEnQ,QAAQ,EAAEqR,EAAE;IAAEnR,UAAU,EAAEoR,EAAE;IAAEe,GAAG,EAAEA;EAAK,CAAC;AAChG,CAAC;;AAED;AACA;AACA;AACAzP,cAAa,CAACmD,SAAS,CAACyG,UAAU,GAAG,YAAY;EAC7C;EACA,IAAI,CAAC,IAAI,CAAC1M,MAAM,EAAE;IACd,IAAI2S,GAAG,GAAG,IAAI,CAACN,UAAU,CAAC,IAAI,CAAC9T,OAAO,EAAE,IAAI,CAAC;IAE7C,IAAI,CAACyB,MAAM,GAAG2S,GAAG,CAAC3S,MAAM;IACxB,IAAI,CAAC4S,aAAa,GAAGD,GAAG,CAAC3S,MAAM;IAC/B;EACJ;AACJ,CAAC;;AAED;AACA;AACA;AACA;AACA8C,cAAa,CAACmD,SAAS,CAAChD,iBAAiB,GAAG,UAAUlB,CAAC,EAAE;EACrD,IAAIuC,CAAC,GAAGvC,CAAC,CAAC8Q,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC5E,KAAK,CAAC,IAAI,CAAC;EAC7C3J,CAAC,CAAChE,OAAO,CAAC,UAAUC,CAAC,EAACC,CAAC,EAAE;IACrB8D,CAAC,CAAC9D,CAAC,CAAC,GAAGd,UAAU,CAACa,CAAC,CAAC;EACxB,CAAC,CAAC;EACF,OAAO+D,CAAC;AACZ,CAAC;;AAED;AACA;AACA;AACA;AACAxB,cAAa,CAACmD,SAAS,CAAC1C,iBAAiB,GAAG,UAAUkC,CAAC,EAAE;EACrD,OAAO,SAAS,GAAGA,CAAC,CAACyI,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG;AACxC,CAAC;;AAED;AACA;AACA;AACA;AACA;AACApL,cAAa,CAACmD,SAAS,CAACsG,UAAU,GAAG,UAAUjN,EAAE,EAAE;EAC/C,IAAIkL,IAAI,GAAGlL,EAAE,IAAI,IAAI,CAACf,OAAO;IACzBgB,EAAE,GAAGC,gBAAgB,CAACgL,IAAI,CAAC;IAC3BxI,GAAG,GAAGxC,gBAAgB,CAAC,IAAI,CAACsM,MAAM,CAAC;IACnC/J,CAAC,GAAGxC,EAAE,CAAC2C,SAAS;IAChBvC,GAAG,GAAGJ,EAAE,CAACI,GAAG,CAACoB,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAGrB,UAAU,CAACsC,GAAG,CAACjC,MAAM,CAAC,GAACL,UAAU,CAACH,EAAE,CAACI,GAAG,CAAC,GAAC,GAAG,GAAGD,UAAU,CAACH,EAAE,CAACI,GAAG,CAAC;IAAE;IACrGF,IAAI,GAAGF,EAAE,CAACE,IAAI,CAACsB,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAGrB,UAAU,CAACsC,GAAG,CAACnC,KAAK,CAAC,GAACH,UAAU,CAACH,EAAE,CAACE,IAAI,CAAC,GAAC,GAAG,GAAGC,UAAU,CAACH,EAAE,CAACE,IAAI,CAAC;IAAE;IACxGgD,SAAS,GAAG/C,UAAU,CAACH,EAAE,CAAC+B,SAAS,CAAC;IACpCoB,UAAU,GAAGhD,UAAU,CAACH,EAAE,CAACiC,UAAU,CAAC;IACtCsR,SAAS,GAAGpT,UAAU,CAACH,EAAE,CAACwT,cAAc,CAAC;IACzCC,UAAU,GAAGtT,UAAU,CAACH,EAAE,CAAC0T,eAAe,CAAC;IAC3C3O,CAAC;IAAE4O,MAAM,GAAG,2BAA2B,CAAC1Q,IAAI,CAACT,CAAC,CAAC;EAEnD,IAAImR,MAAM,EAAE;IACR,IAAI5O,CAAC,GAAG,IAAI,CAACrB,iBAAiB,CAAClB,CAAC,CAAC;IACjC,IAAI,CAAC,IAAI,CAACmQ,aAAa,EACnB,IAAI,CAACA,aAAa,GAAG5N,CAAC,CAACqB,KAAK,CAAC,CAAC,CAAC;EACvC;EACArB,CAAC,GAAG,IAAItG,kDAAM,CAACsG,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;EACvC,IAAI6O,IAAI,GAAG,IAAI,CAACtH,OAAO,CAACZ,IAAI,IAAI,aAAa;EAC7C,IAAIxL,IAAI,IAAIE,GAAG,IAAI8C,SAAS,IAAIC,UAAU,IAAIoQ,SAAS,IAAIE,UAAU,EAAE;IACnE1O,CAAC,CAACpB,SAAS,CAACzD,IAAI,IAAI,CAAC,EAAEE,GAAG,IAAI,CAAC,CAAC;IAChC2E,CAAC,CAACpB,SAAS,CAACR,UAAU,IAAI,CAAC,EAAED,SAAS,IAAI,CAAC,CAAC;IAC5C6B,CAAC,CAACpB,SAAS,CAAC8P,UAAU,IAAI,CAAC,EAAEF,SAAS,IAAI,CAAC,CAAC;IAC5CtI,IAAI,CAACnH,KAAK,CAAC/B,SAAS,GAAG,CAAC;IACxBkJ,IAAI,CAACnH,KAAK,CAAC7B,UAAU,GAAG,CAAC;IACzBgJ,IAAI,CAACnH,KAAK,CAAC1D,GAAG,GAAG,CAAC;IAClB6K,IAAI,CAACnH,KAAK,CAAC5D,IAAI,GAAG,CAAC;IACnB+K,IAAI,CAACnH,KAAK,CAAC/B,SAAS,GAAI,EAAEwR,SAAS,IAAI,CAAC,CAAC,GAAI,IAAI;IACjDtI,IAAI,CAACnH,KAAK,CAAC7B,UAAU,GAAI,EAAEsR,SAAS,IAAI,CAAC,CAAC,GAAI,IAAI;IAElD,IAAI,CAACnS,MAAM,GAAG2D,CAAC;IACf,IAAI,CAACyM,cAAc,CAAC,CAAC;IAErB,IAAI,CAACmB,aAAa,GAAG5N,CAAC,CAAC1D,QAAQ,CAAC+E,KAAK,CAAC,CAAC,CAAC;EAC5C;EACA,OAAOrB,CAAC;AACZ,CAAC;;AAED;AACA;AACA;AACA;AACA;AACAxB,cAAa,CAACmD,SAAS,CAAC6K,aAAa,GAAG,UAAUsC,IAAI,EAAE;EACpD,IAAG,OAAOA,IAAI,IAAI,SAAS,EAAE;IACzB,IAAIC,GAAG,GAAG,IAAI,CAAClG,UAAU;MACrBzJ,GAAG,GAAG,IAAI,CAAC8I,kBAAkB;MAC7B8G,GAAG,GAAG5P,GAAG,GAAGA,GAAG,CAACuK,KAAK,CAAC,GAAG,CAAC,GAAE,EAAE;IAElC,IAAGmF,IAAI,IAAI,IAAI,EAAE;MACb,IAAIC,GAAG,IAAID,IAAI,EAAE;QACbE,GAAG,CAAC9O,IAAI,CAAC,gBAAgB,CAAC;QAC1B,IAAI,CAACjG,OAAO,CAAC8E,KAAK,CAAC8J,UAAU,GAAGmG,GAAG,CAACpF,IAAI,CAAC,GAAG,CAAC;MACjD;IACJ;IACA,IAAGkF,IAAI,IAAI,KAAK,EAAE;MACd,IAAIC,GAAG,IAAID,IAAI,EAAE;QACbE,GAAG,CAAC9O,IAAI,CAAC,cAAc,CAAC;QACxB,IAAI,CAACjG,OAAO,CAAC8E,KAAK,CAAC8J,UAAU,GAAGmG,GAAG,CAACpF,IAAI,CAAC,GAAG,CAAC;MACjD;IACJ;IACA,IAAI,CAACf,UAAU,GAAGiG,IAAI;EAC1B;AACJ,CAAC;;AAED;AACA;AACA;AACAtQ,cAAa,CAACmD,SAAS,CAAC8K,cAAc,GAAG,YAAY;EACjD,IAAIzM,CAAC,GAAG,IAAI,CAAC3D,MAAM;IAAE4S,GAAG,GAAG,SAAS,GAAGjP,CAAC,CAAC1D,QAAQ,CAACsN,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG;EAEjE,IAAI,CAAC3P,OAAO,CAAC8E,KAAK,CAACnB,SAAS,GAAGqR,GAAG;AACtC,CAAC;;AAED;AACA;AACA;AACAzQ,cAAa,CAACmD,SAAS,CAACuN,YAAY,GAAG,YAAY;EAC/C,IAAI,CAAC7S,MAAM,CAACyG,IAAI,CAAC,CAAC;AACtB,CAAC;;AAED;AACA;AACA;AACA;AACAtE,cAAa,CAACmD,SAAS,CAACqG,UAAU,GAAG,UAAUhI,CAAC,EAAE;EAC9C,IAAI,CAAC3D,MAAM,GAAG2D,CAAC;EACf,IAAI,CAACyM,cAAc,CAACzM,CAAC,CAAC;AAC1B,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACAxB,cAAa,CAACmD,SAAS,CAACwN,UAAU,GAAG,UAAU1E,CAAC,EAAE2E,OAAO,EAAE;EACvD,IAAIC,EAAE,EAAEC,GAAG,EAAEhK,EAAE,EAAEC,EAAE;EACnB,IAAI6J,OAAO;IACP,IAAIA,OAAO,CAAC9P,MAAM,IAAI,CAAC,EAAE;MACrB+P,EAAE,GAAG,IAAI,CAACE,UAAU,CAACH,OAAO,CAAC;MAC7BE,GAAG,GAAG,IAAI,CAACE,YAAY,CAACJ,OAAO,CAAC;MAChC9J,EAAE,GAAG,IAAI3L,iDAAK,CAACyV,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,EAAEL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC;MAClDnK,EAAE,GAAG,IAAI5L,iDAAK,CAACyV,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,EAAEL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC;IACtD,CAAC,MACI;MACDL,EAAE,GAAI,IAAI1V,iDAAK,CAACyV,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,EAAEL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAE;MACpDJ,GAAG,GAAG,IAAI,CAACjT,MAAM,CAAC8H,QAAQ,CAAC,CAAC;IAChC;EAAC,OACA;IACDkL,EAAE,GAAI,IAAI1V,iDAAK,CAAC8Q,CAAC,CAACgF,KAAK,EAAEhF,CAAC,CAACiF,KAAK,CAAE;IAClCJ,GAAG,GAAG,IAAI,CAACjT,MAAM,CAAC8H,QAAQ,CAAC,CAAC;EAChC;EACA,OAAO;IACHwL,KAAK,EAAEN,EAAE;IACTO,KAAK,EAAEN,GAAG;IACVhK,EAAE,EAAEA,EAAE;IACNC,EAAE,EAAEA;EACR,CAAC;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA/G,cAAa,CAACmD,SAAS,CAACkO,UAAU,GAAG,UAAUpF,CAAC,EAAE2E,OAAO,EAAE;EACvD,IACIU,GAAG,GAAG,IAAI,CAACX,UAAU,CAAC1E,CAAC,EAAE2E,OAAO,CAAC;IAAEW,OAAO,GAAG,IAAI;IACjD3F,GAAG,GAAG,IAAI,CAACxQ,QAAQ;IACnBoH,IAAI,GAAGoJ,GAAG,CAACtK,UAAU,CAAC,CAAC;IACvBmB,EAAE,GAAGmJ,GAAG,CAACtJ,eAAe,CAACgP,GAAG,CAACH,KAAK,EAAE3O,IAAI,CAAC;IACzCgP,IAAI,GAAGF,GAAG,CAACxK,EAAE,IAAIwK,GAAG,CAACvK,EAAE,GACnB,IAAI,CAAC6H,sBAAsB,CACvBhD,GAAG,CAACtJ,eAAe,CAACgP,GAAG,CAACxK,EAAE,EAAEtE,IAAI,CAAC,EACjCoJ,GAAG,CAACtJ,eAAe,CAACgP,GAAG,CAACvK,EAAE,EAAEvE,IAAI,CACpC,CAAC,GAAG,CAAC;EAEb,IAAI,OAAOyJ,CAAC,CAAC5D,MAAO,IAAI,WAAW,EAC/BkJ,OAAO,GAAG,IAAIpW,iDAAK,CAAC8Q,CAAC,CAAC5D,MAAM,EAAE4D,CAAC,CAAC3D,MAAM,CAAC;EAE3C,OAAO;IACHpL,MAAM,EAAEuF,EAAE;IACVgP,MAAM,EAAEH,GAAG,CAACH,KAAK;IACjBF,KAAK,EAAEK,GAAG,CAACH,KAAK,CAAC/N,CAAC;IAClB8N,KAAK,EAAEI,GAAG,CAACH,KAAK,CAAC9N,CAAC;IAClB+N,KAAK,EAAEE,GAAG,CAACF,KAAK;IAChBM,QAAQ,EAAEF,IAAI;IACdD,OAAO,EAAEA;EACb,CAAC;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACAvR,cAAa,CAACmD,SAAS,CAACyL,sBAAsB,GAAG,UAAUjM,CAAC,EAAE0B,CAAC,EAAE;EAC7D,IAAIsN,IAAI,GAAGhP,CAAC,CAACsO,KAAK,GAAG;IAAC7N,CAAC,EAAC,OAAO;IAAEC,CAAC,EAAC;EAAO,CAAC,GAAG;IAACD,CAAC,EAAC,GAAG;IAAEC,CAAC,EAAC;EAAG,CAAC;EAC5D,OAAOgC,IAAI,CAACU,IAAI,CAACV,IAAI,CAACW,GAAG,CAACX,IAAI,CAACuM,GAAG,CAACvN,CAAC,CAACsN,IAAI,CAACvO,CAAC,CAAC,GAAGT,CAAC,CAACgP,IAAI,CAACvO,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAGiC,IAAI,CAACW,GAAG,CAACX,IAAI,CAACuM,GAAG,CAACvN,CAAC,CAACsN,IAAI,CAACtO,CAAC,CAAC,GAAGV,CAAC,CAACgP,IAAI,CAACtO,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACjH,CAAC;;AAED;AACA;AACA;AACA;AACArD,cAAa,CAACmD,SAAS,CAAC4N,UAAU,GAAG,UAAUH,OAAO,EAAE;EACpD,IAAIiB,MAAM,GAAGjB,OAAO,CAAC,CAAC,CAAC;EACvB,IAAIkB,MAAM,GAAGlB,OAAO,CAAC,CAAC,CAAC;EACvB,IAAImB,EAAE,GAAI,CAACD,MAAM,CAACb,KAAK,GAAGY,MAAM,CAACZ,KAAK,IAAI,CAAC,GAAIY,MAAM,CAACZ,KAAK;EAC3D,IAAIe,EAAE,GAAI,CAACF,MAAM,CAACZ,KAAK,GAAGW,MAAM,CAACX,KAAK,IAAI,CAAC,GAAIW,MAAM,CAACX,KAAK;EAE3D,OAAO,IAAI/V,iDAAK,CAAC4W,EAAE,EAAEC,EAAE,CAAC;AAC5B,CAAC;;AAED;AACA;AACA;AACA;AACA;AACAhS,cAAa,CAACmD,SAAS,CAAC8O,aAAa,GAAG,UAAUrB,OAAO,EAAEpO,IAAI,EAAE;EAC7D,IAAIoJ,GAAG,GAAG,IAAI,CAACxQ,QAAQ;EACvBoH,IAAI,GAAGA,IAAI,IAAIoJ,GAAG,CAACtK,UAAU,CAAC,CAAC;EAC/B,IAAI4Q,EAAE,GAAGtG,GAAG,CAACtJ,eAAe,CAAC,IAAInH,iDAAK,CAACyV,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,EAAEL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC,EAAE1O,IAAI,CAAC;EACjF,IAAI2P,EAAE,GAAGvG,GAAG,CAACtJ,eAAe,CAAC,IAAInH,iDAAK,CAACyV,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,EAAEL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC,EAAE1O,IAAI,CAAC;EAEjF,OAAO,IAAI,CAACoM,sBAAsB,CAACsD,EAAE,EAAEC,EAAE,CAAC;AAC9C,CAAC;;AAED;AACA;AACA;AACA;AACA;AACAnS,cAAa,CAACmD,SAAS,CAAC6N,YAAY,GAAG,UAAUJ,OAAO,EAAEhL,IAAI,EAAE;EAC5D,IAAIrE,CAAC;EAELA,CAAC,GAAG8D,IAAI,CAACQ,KAAK,CAAC,CAAC+K,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,IAAEN,OAAO,CAAC,CAAC,CAAC,CAACvN,CAAC,KAAKuN,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,IAAEN,OAAO,CAAC,CAAC,CAAC,CAACvN,CAAC,CAAC,EAAE,CAACuN,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,IAAEL,OAAO,CAAC,CAAC,CAAC,CAACxN,CAAC,KAAKwN,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,IAAEL,OAAO,CAAC,CAAC,CAAC,CAACxN,CAAC,CAAC,CAAC,GAAE,GAAG,GAAGiC,IAAI,CAACC,EAAE;EAEvK,OAAOM,IAAI,GAAG,IAAI,CAAC/H,MAAM,CAAC6H,YAAY,CAACnE,CAAC,CAAC,GAAGA,CAAC;AACjD,CAAC;;AAED;AACA;AACA;AACAvB,cAAa,CAACmD,SAAS,CAACiP,YAAY,GAAG,YAAY;EAC/C,IAAI,IAAI,CAACrJ,OAAO,CAAC+B,OAAO,IAAI,IAAI,CAAC/B,OAAO,CAAC+B,OAAO,CAACrF,MAAM,EACnD;EAEJ,IAAIlE,CAAC,GAAG,IAAI,CAAC1D,MAAM,CAAC8H,QAAQ,CAAC,CAAC;IAAEnE,CAAC,GAAGD,CAAC,GAAE,EAAE,GAAC8D,IAAI,CAACc,KAAK,CAAC5E,CAAC,GAAC,EAAE,CAAE;IAAE8Q,EAAE,GAAGhN,IAAI,CAACuM,GAAG,CAACpQ,CAAC,CAAC;IAAE8Q,GAAG,GAAG,IAAI,CAAClR,KAAK,CAAC3F,OAAO,CAAC4F,OAAO;EAC/G,IAAI,CAAC2M,aAAa,CAAC,IAAI,CAAC;EAExB,IAAIqE,EAAE,IAAI,CAAC,IAAIA,EAAE,GAAG,CAAC,EAAE;IACnB,IAAI/S,EAAE,GAAG,IAAI,CAAC6O,iBAAiB,IAAI,IAAIhT,iDAAK,CAACmX,GAAG,CAACvV,KAAK,GAAG,CAAC,EAAEuV,GAAG,CAACrV,MAAM,GAAG,CAAC,CAAC;IAC3E,IAAI,CAACwI,MAAM,CAACnG,EAAE,EAAE,CAACkC,CAAC,CAAC;IACnB,IAAI,CAAC+Q,qBAAqB,GAAGtM,SAAS;IACtC,IAAI,CAACyK,YAAY,CAAC,CAAC;EACvB;EACA,IAAI8B,GAAG;EACPjR,CAAC,GAAG,IAAI,CAAC1D,MAAM,CAAC8H,QAAQ,CAAC,CAAC;EAC1B,QAAQN,IAAI,CAACuM,GAAG,CAACvM,IAAI,CAACc,KAAK,CAAC5E,CAAC,GAAC,EAAE,CAAC,GAAC,EAAE,CAAC;IACjC,KAAK,CAAC;IACN,KAAK,GAAG;MACJiR,GAAG,GAAG,YAAY;MAClB;IACJ,KAAK,EAAE;MACHA,GAAG,GAAG,UAAU;MAChB;IACJ;MACIA,GAAG,GAAG,YAAY,GAAInN,IAAI,CAACc,KAAK,CAAC5E,CAAC,GAAC,EAAE,CAAC,GAAC,EAAG,GAAG,OAAO;EAC5D;EACA,IAAI,CAACkR,WAAW,CAACD,GAAG,EAAE,QAAQ,EAAE,IAAI,CAAC;AACzC,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACAxS,cAAa,CAACmD,SAAS,CAACsP,WAAW,GAAG,UAAUjR,CAAC,EAAEO,CAAC,EAAE9C,CAAC,EAAE;EACrDtB,OAAO,CAACC,GAAG,CAAC4D,CAAC,CAAC;AAClB,CAAC;;AAED;AACA;AACA;AACAxB,cAAa,CAACmD,SAAS,CAAC4K,mBAAmB,GAAG,YAAY;EACtD,IAAIzN,KAAK,GAAG,IAAI,CAAC4O,QAAQ,CAAC,IAAI,CAAClG,MAAM,CAAC;EACtC,OAAO,IAAI7N,iDAAK,CAACmF,KAAK,CAAC3D,IAAI,GAAG2D,KAAK,CAACvD,KAAK,GAAG,CAAC,EAAEuD,KAAK,CAACzD,GAAG,GAAGyD,KAAK,CAACrD,MAAM,GAAG,CAAC,CAAC;AAChF,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA+C,cAAa,CAACmD,SAAS,CAAC4L,cAAc,GAAG,UAAU1E,UAAU,EAAE7H,IAAI,EAAE;EAEjE,IAAI+N,GAAG,GAAG,IAAI,CAAClG,UAAU;IAAEuB,GAAG,GAAG,IAAI,CAACxQ,QAAQ;EAC9C,IAAI,CAAC4S,aAAa,CAAC3D,UAAU,CAAC;EAE9B7H,IAAI,GAAGA,IAAI,IAAIoJ,GAAG,CAACtK,UAAU,CAAC,CAAC;EAE/B,IAAIpC,GAAG,GAAGxC,gBAAgB,CAAC,IAAI,CAACsM,MAAM,CAAC;IAAE0J,YAAY,GAAG,IAAIvX,iDAAK,CAACyB,UAAU,CAACsC,GAAG,CAACnC,KAAK,CAAC,GAAG,CAAC,EAAEH,UAAU,CAACsC,GAAG,CAACjC,MAAM,CAAC,GAAG,CAAC,CAAC;EACxH,IAAI0V,YAAY,GAAG,IAAI,CAAC9U,MAAM,CAAC+D,OAAO,CAAC,CAAC,CAACM,cAAc,CAACwQ,YAAY,CAAC;EAErE,IAAI,CAACtS,SAAS,CAAEuS,YAAY,CAAC1R,GAAG,CAAC,IAAI9F,iDAAK,CAAC,IAAI,CAACiG,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACtE,KAAK,GAAG,CAAC,EAAE,IAAI,CAACqE,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACpE,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;EACzH,IAAI,CAAC+Q,aAAa,CAACuC,GAAG,CAAC;AAC3B,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAvQ,cAAa,CAACmD,SAAS,CAACyP,gBAAgB,GAAG,UAASrQ,CAAC,EAAEI,CAAC,EAAE0B,CAAC,EAAEtC,CAAC,EAAE8Q,CAAC,EAAE;EAC/D,IAAIC,EAAE,GAAGzO,CAAC,CAACpD,GAAG,CAAC0B,CAAC,CAAC;IACboQ,EAAE,GAAGxQ,CAAC,CAACtB,GAAG,CAAC0B,CAAC,CAAC;IACbqQ,EAAE,GAAGjR,CAAC,CAACd,GAAG,CAACoD,CAAC,CAAC;IACb4O,EAAE,GAAG1Q,CAAC,CAACtB,GAAG,CAACoD,CAAC,CAAC;IACb6O,QAAQ,GAAGJ,EAAE,CAAClM,GAAG,CAACmM,EAAE,CAAC;IACrBI,QAAQ,GAAGL,EAAE,CAAClM,GAAG,CAACkM,EAAE,CAAC;IACrBM,QAAQ,GAAGJ,EAAE,CAACpM,GAAG,CAACqM,EAAE,CAAC;IACrBI,QAAQ,GAAGL,EAAE,CAACpM,GAAG,CAACoM,EAAE,CAAC;EAEzB,IAAIzR,CAAC,GAAG;IACJ2R,QAAQ,EAAEA,QAAQ;IAClBC,QAAQ,EAAEA,QAAQ;IAClBC,QAAQ,EAAEA,QAAQ;IAClBC,QAAQ,EAAEA,QAAQ;IAClBC,EAAE,EAAE,CAAC,IAAIJ,QAAQ,IAAK7N,IAAI,CAACc,KAAK,CAAC+M,QAAQ,GAAG,EAAE,CAAC,GAAG,EAAE,IAAM7N,IAAI,CAACc,KAAK,CAACgN,QAAQ,GAAG,EAAE,CAAC,GAAG,EAAG,IAAI,CAAC,IAAIC,QAAQ,IAAK/N,IAAI,CAACc,KAAK,CAACiN,QAAQ,GAAC,EAAE,CAAC,GAAC,EAAE,IAAM/N,IAAI,CAACc,KAAK,CAACkN,QAAQ,GAAC,EAAE,CAAC,GAAC;EAC3K,CAAC;EAED,OAAO9R,CAAC;AACZ,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACAvB,cAAa,CAACmD,SAAS,CAACoQ,OAAO,GAAG,UAAUC,CAAC,EAAExL,KAAK,EAAE;EAClD,IAAI,OAAO,IAAI,CAACiC,MAAM,CAACuJ,CAAC,CAAC,IAAI,UAAU,EACnC,IAAI,CAACvJ,MAAM,CAACuJ,CAAC,CAAC,CAACnG,KAAK,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC5R,OAAO,EAAEuM,KAAK,CAAC,CAAC;AACzD,CAAC;;AAED;AACA;AACA;AACA;AACA;AACAhI,cAAa,CAACmD,SAAS,CAACsQ,iBAAiB,GAAG,UAAUxH,CAAC,EAAEzJ,IAAI,EAAE;EAC3D,IAAIkR,MAAM;IACNC,MAAM,GAAG,IAAI,CAACC,MAAM,CAACC,EAAE;IACvBjD,OAAO,GAAG3E,CAAC,CAAC2E,OAAO;IACnBhF,GAAG,GAAG,IAAI,CAACxQ,QAAQ;EAEvBoH,IAAI,GAAGA,IAAI,IAAIoJ,GAAG,CAACtK,UAAU,CAAC,CAAC;EAE/BsK,GAAG,CAAClL,UAAU,CAAC,CAAC;EAEhB,IAAIkQ,OAAO,EACP8C,MAAM,GAAI,IAAIvY,iDAAK,CAACyV,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,EAAEL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAE,CAAC,KAEzDwC,MAAM,GAAI,IAAIvY,iDAAK,CAAC8Q,CAAC,CAACgF,KAAK,EAAEhF,CAAC,CAACiF,KAAK,CAAE;EAE1C,IAAIE,KAAK,GAAG/L,IAAI,CAACc,KAAK,CAAC,IAAI,CAAC6K,YAAY,CAAC,CAAC2C,MAAM,CAACtN,GAAG,CAACuF,GAAG,CAACjL,MAAM,CAAC,EAAE+S,MAAM,CAAC,EAAE,KAAK,CAAC,GAAG,GAAG,CAAC,GAAC,GAAG,CAAC,CAAC;;EAE9F,OAAO;IACHnC,OAAO,EAAE,IAAI;IACbrU,MAAM,EAAE0O,GAAG,CAACtJ,eAAe,CAACoR,MAAM,EAAElR,IAAI,CAAC;IACzCiP,MAAM,EAAEiC,MAAM;IACdzC,KAAK,EAAEyC,MAAM,CAACtQ,CAAC;IACf8N,KAAK,EAAEwC,MAAM,CAACrQ,CAAC;IACf+N,KAAK,EAAEA,KAAK;IACZM,QAAQ,EAAE;EACf,CAAC;AACJ,CAAC;;AAED;AACA;AACA;AACA;AACA1R,cAAa,CAACmD,SAAS,CAAC8H,gBAAgB,GAAG,UAAU6I,GAAG,EAAE;EACtD,IAAIhI,IAAI,GAAG,IAAI;IAAEd,MAAM,GAAG8I,GAAG;EAC7B,IACIC,OAAO,GAAG,SAAVA,OAAOA,CAAa9H,CAAC,EAAE;MACnB,IAAI,CAACH,IAAI,CAACkI,aAAa,EAAE,OAAO,KAAK;MACrClI,IAAI,CAACmI,cAAc,GAAG,IAAI;MAC1BhI,CAAC,CAACzD,cAAc,CAAC,CAAC;MAClByD,CAAC,CAACvD,eAAe,CAAC,CAAC;MACnB,IAAIkI,OAAO,GAAG3E,CAAC,CAAC2E,OAAO;QAAEsD,QAAQ,GAAG,KAAK;MAEzC,IAAItD,OAAO,EACP,IAAIA,OAAO,CAAC9P,MAAM,IAAI,CAAC,EACnB,OAAO,KAAK;MAEpB,IAAIqQ,KAAK,GAAGrF,IAAI,CAAC2H,iBAAiB,CAACxH,CAAC,CAAC;QACjClC,IAAI,GAAG+B,IAAI,CAACqI,UAAU;QACtBrK,KAAK,GAAGgC,IAAI,CAACsI,WAAW;QACxB5S,CAAC,GAAGsK,IAAI,CAACjO,MAAM;MAEnB,IAAIwR,KAAK,GAAG;QACR+B,KAAK,EAAE/L,IAAI,CAACc,KAAK,CAAC,CAACgL,KAAK,CAACC,KAAK,GAAGtH,KAAK,CAACsH,KAAK,IAAI,GAAG,CAAC,GAAG;MAC3D,CAAC;MAED,IAAI/B,KAAK,CAAC+B,KAAK,IAAI,CAAC,EAAE;QAClB,IAAItF,IAAI,CAAC9C,MAAM,IAAI8C,IAAI,CAAC/C,OAAO,CAACoD,YAAY,CAAC1Q,OAAO,EAAE;UAClD+F,CAAC,CAAC4D,gBAAgB,CAAC,IAAIjK,iDAAK,CAAC,CAAC,CAAC,EAAEkU,KAAK,CAAC+B,KAAK,CAAC;UAC7C8C,QAAQ,GAAG,IAAI;QACnB;QACA,IAAIpI,IAAI,CAAC/C,OAAO,CAACoD,YAAY,YAAYnM,cAAa,EAClD8L,IAAI,CAAC/C,OAAO,CAACoD,YAAY,CAAC1G,MAAM,CAACqG,IAAI,CAAC8H,MAAM,CAACC,EAAE,CAACxN,GAAG,CAACyF,IAAI,CAAC1Q,QAAQ,CAACuF,MAAM,CAAC,EAAE0O,KAAK,CAAC+B,KAAK,EAAE,KAAK,EAAE,IAAI,CAAC;MAE5G;MAEA,IAAI8C,QAAQ,EACRpI,IAAI,CAACmC,cAAc,CAACzM,CAAC,CAAC;MAE1BsK,IAAI,CAACsI,WAAW,CAAChD,KAAK,GAAGD,KAAK,CAACC,KAAK;IACxC,CAAC;IACDiD,QAAO,GAAG,SAAVA,OAAOA,CAAapI,CAAC,EAAE;MACnBA,CAAC,CAACzD,cAAc,CAAC,CAAC;MAClByD,CAAC,CAACvD,eAAe,CAAC,CAAC;MAEnBoD,IAAI,CAACrQ,OAAO,CAACoE,SAAS,CAACyM,MAAM,CAAC,sBAAsB,CAAC;MAErDR,IAAI,CAACkI,aAAa,GAAG,KAAK;MAC1BlI,IAAI,CAACmI,cAAc,GAAG,KAAK;MAE3BnI,IAAI,CAACU,GAAG,CAACtQ,QAAQ,CAACqQ,aAAa,CAAC,MAAM,CAAC,EAAE,6CAA6C,EAAE8H,QAAO,CAAC;MAEhG,IAAIvI,IAAI,CAAC/C,OAAO,CAACoD,YAAY,YAAYnM,cAAa,EAAE;QACpD,IAAI8L,IAAI,CAAC/C,OAAO,CAACoD,YAAY,CAAClC,MAAM,CAACE,IAAI,EACrC2B,IAAI,CAAC/C,OAAO,CAACoD,YAAY,CAACoH,OAAO,CAAC,MAAM,EAAEtH,CAAC,CAAC;QAEhDH,IAAI,CAAC/C,OAAO,CAACoD,YAAY,CAACiG,YAAY,CAAC,CAAC;MAC5C;MACA,IAAItG,IAAI,CAAC7B,MAAM,CAACE,IAAI,EAChB2B,IAAI,CAACyH,OAAO,CAAC,MAAM,EAAEtH,CAAC,CAAC;MAE3BH,IAAI,CAACsG,YAAY,CAAC,CAAC;IACvB,CAAC;IACDkC,QAAQ,GAAG,SAAXA,QAAQA,CAAarI,CAAC,EAAE;MACpB,IAAIH,IAAI,CAAC/C,OAAO,CAACwL,QAAQ,KAAK,IAAI,EAC9B,OAAO,KAAK;MAChB,IAAIzI,IAAI,CAAC0I,aAAa,EAClB,OAAO,KAAK;MAChB,IAAItY,QAAQ,CAACuY,gBAAgB,CAAC,uBAAuB,CAAC,CAAC3T,MAAM,IAAI,CAAC,EAC9DgL,IAAI,CAACrQ,OAAO,CAACoE,SAAS,CAACwG,GAAG,CAAC,sBAAsB,CAAC;;MAEtD;MACA;;MAEA;;MAEA,IAAI7E,CAAC,GAAGsK,IAAI,CAACjO,MAAM;MAEnBiO,IAAI,CAACqI,UAAU,GAAG;QACdtT,KAAK,EAAE,IAAI1F,iDAAK,CAACqG,CAAC,CAAC1D,QAAQ,CAAC,CAAC,CAAC,EAAE0D,CAAC,CAAC1D,QAAQ,CAAC,CAAC,CAAC,CAAC;QAC9CsT,KAAK,EAAE5P,CAAC,CAACmE,QAAQ,CAAC,IAAI,CAAC;QACvBV,KAAK,EAAEzD,CAAC,CAACsE,OAAO,CAAC;MACrB,CAAC;MAED,IAAI8K,OAAO,GAAG3E,CAAC,CAAC2E,OAAO;MACvB,IAAIA,OAAO,IAAIA,OAAO,CAAC9P,MAAM,IAAI,CAAC,EAC9B,IAAI8P,OAAO,CAAC,CAAC,CAAC,CAAC3I,MAAM,IAAI2I,OAAO,CAAC,CAAC,CAAC,CAAC3I,MAAM,EACtC,IAAI2I,OAAO,CAAC,CAAC,CAAC,CAAC3I,MAAM,KAAK2I,OAAO,CAAC,CAAC,CAAC,CAAC3I,MAAM,EAAE;QACzCtK,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;QAChD,OAAO,KAAK;MAChB;MAERkO,IAAI,CAAC8H,MAAM,GAAG9H,IAAI,CAAC8H,MAAM,IAAI,CAAC,CAAC;MAC/B9H,IAAI,CAAC8H,MAAM,CAACc,UAAU,GAAG5I,IAAI,CAACoD,QAAQ,CAACpD,IAAI,CAACrQ,OAAO,CAAC8Q,aAAa,CAAC,6BAA6B,CAAC,CAAC;MACjGT,IAAI,CAAC8H,MAAM,CAACC,EAAE,GAAG,IAAI1Y,iDAAK,CAAC2Q,IAAI,CAAC8H,MAAM,CAACc,UAAU,CAAC/X,IAAI,EAAEmP,IAAI,CAAC8H,MAAM,CAACc,UAAU,CAAC7X,GAAG,CAAC;MAEnFiP,IAAI,CAACsI,WAAW,GAAGtI,IAAI,CAAC2H,iBAAiB,CAACxH,CAAC,CAAC;MAE5CH,IAAI,CAACsI,WAAW,CAACnP,KAAK,GAAG6G,IAAI,CAACqI,UAAU,CAAClP,KAAK;MAC9C6G,IAAI,CAACkI,aAAa,GAAG,IAAI;MACzBlI,IAAI,CAACmI,cAAc,GAAG,KAAK;MAE3BnI,IAAI,CAACkC,aAAa,CAAC,KAAK,CAAC;MAEzB/B,CAAC,CAACvD,eAAe,CAAC,CAAC;MAEnB,IAAIjJ,IAAI,GAAGvD,QAAQ,CAACqQ,aAAa,CAAC,MAAM,CAAC;MACzC,IAAIN,CAAC,CAAC9D,IAAI,IAAI,WAAW,EAAE;QACvB2D,IAAI,CAACY,EAAE,CAACjN,IAAI,EAAE,yBAAyB,EAAEsU,OAAO,CAAC;QACjDjI,IAAI,CAACY,EAAE,CAACjN,IAAI,EAAE,6CAA6C,EAAE4U,QAAO,CAAC;MACzE;IACJ,CAAC;EAEL,IAAI,CAAC3H,EAAE,CAACoH,GAAG,EAAE,kDAAkD,EAAEQ,QAAQ,CAAC;EAC1E,IAAI,CAAC5H,EAAE,CAACoH,GAAG,EAAE,yBAAyB,EAAEC,OAAO,CAAC;EAChD,IAAI,CAACrH,EAAE,CAACoH,GAAG,EAAE,wBAAwB,EAAEO,QAAO,CAAC;AACnD,CAAC;;AAED;AACA;AACA;AACA;AACA;AACArU,cAAa,CAACmD,SAAS,CAAC0K,gBAAgB,GAAG,UAAUL,GAAG,EAAEC,GAAG,EAAE;EAC3D,IAAI3B,IAAI,GAAG,IAAI;IAAEtP,EAAE,GAAG,IAAI,CAACf,OAAO;IAAEqN,IAAI,GAAGgD,IAAI,CAAC/C,OAAO;EACvD,IACAgL,OAAO,GAAG,SAAVA,OAAOA,CAAa9H,CAAC,EAAE;MACnB;MACA;MACA;;MAEA,IAAI,CAACH,IAAI,CAACrQ,OAAO,CAACoE,SAAS,CAACC,QAAQ,CAAC,sBAAsB,CAAC,EACxD,OAAO,KAAK;MAGhB,IAAI,CAACgM,IAAI,CAAC0I,aAAa,EAAE,OAAO,KAAK;MACrC1I,IAAI,CAAC6I,cAAc,GAAG,IAAI;MAC1B1I,CAAC,CAACzD,cAAc,CAAC,CAAC;MAClByD,CAAC,CAACvD,eAAe,CAAC,CAAC;MACnB,IAAIkI,OAAO,GAAG3E,CAAC,CAAC2E,OAAO;QAAEsD,QAAQ,GAAG,KAAK;MAEzC,IAAGtD,OAAO,EACN,IAAIA,OAAO,CAAC9P,MAAM,IAAI,CAAC,EACnB,OAAO,KAAK;MAEpB,IAAIqQ,KAAK,GAAGrF,IAAI,CAACuF,UAAU,CAACpF,CAAC,EAAE2E,OAAO,CAAC;QACnC7G,IAAI,GAAG+B,IAAI,CAAC8I,UAAU;QACtB9K,KAAK,GAAGgC,IAAI,CAAC+I,WAAW;QACxBpY,EAAE,GAAGC,gBAAgB,CAACF,EAAE,CAAC;MAE7B,IAAI6S,KAAK,GAAG;QACRxO,KAAK,EAAEsQ,KAAK,CAACjU,MAAM,CAAC+D,GAAG,CAAC6I,KAAK,CAAC5M,MAAM,CAAC;QACrCkU,KAAK,EAAE/L,IAAI,CAACc,KAAK,CAAC,CAACgL,KAAK,CAACC,KAAK,GAAGtH,KAAK,CAACsH,KAAK,IAAI,GAAG,CAAC,GAAG,GAAG;QAC1DM,QAAQ,EAAE5H,KAAK,CAAC4H,QAAQ,IAAI,CAAC,GAAGrM,IAAI,CAACc,KAAK,CAACgL,KAAK,CAACO,QAAQ,IAAI,CAAC5H,KAAK,CAAC4H,QAAQ,GAAGP,KAAK,CAACO,QAAQ,IAAE,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,IAAI,GAAG;MACvH,CAAC;MAED,IAAIrC,KAAK,CAACxO,KAAK,CAAC2F,OAAO,CAAC,CAAC,EAAE;QACvB,IACIxJ,CAAC,GAAGJ,UAAU,CAACH,EAAE,CAACQ,MAAM,CAAC;UACzBH,CAAC,GAAGF,UAAU,CAACH,EAAE,CAACM,KAAK,CAAC;QAG5B,IAAI+X,EAAE,GAAGhJ,IAAI,CAAChP,CAAC,GAAGA,CAAC;UACfiY,EAAE,GAAGjJ,IAAI,CAAC9O,CAAC,GAAGA,CAAC;UACfgY,IAAI,GAAIlY,CAAC,GAAGuS,KAAK,CAACxO,KAAK,CAACuC,CAAC,GAAG0R,EAAG;UAC/BG,IAAI,GAAIjY,CAAC,GAAGqS,KAAK,CAACxO,KAAK,CAACwC,CAAC,GAAG0R,EAAG;QAEnCvY,EAAE,CAAC+D,KAAK,CAACxD,KAAK,GAAGiY,IAAI,GAAG,IAAI;QAC5BxY,EAAE,CAAC+D,KAAK,CAACtD,MAAM,GAAGgY,IAAI,GAAG,IAAI;QAE7BnJ,IAAI,CAAC1K,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAAChE,WAAW,GAAG,IAAIlC,iDAAK,CAAC6Z,IAAI,EAAEC,IAAI,CAAC;QAC9DnJ,IAAI,CAAC1K,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACjE,QAAQ,CAACgG,CAAC,GAAG4R,IAAI;QAC5ClJ,IAAI,CAAC1K,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAAC/D,UAAU,CAAC+F,CAAC,GAAG4R,IAAI;QAC9CnJ,IAAI,CAAC1K,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACtE,KAAK,GAAGiY,IAAI;QACvClJ,IAAI,CAAC1K,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACpE,MAAM,GAAGgY,IAAI;MAE5C;MACAnJ,IAAI,CAAC+I,WAAW,CAACzD,KAAK,GAAGD,KAAK,CAACC,KAAK;MAEpC,OAAO,KAAK,CAAC,CAAC;IAClB,CAAC;IACDkD,QAAQ,GAAG,SAAXA,QAAQA,CAAarI,CAAC,EAAE;MACpB,IAAI/P,QAAQ,CAACuY,gBAAgB,CAAC,uBAAuB,CAAC,CAAC3T,MAAM,IAAI,CAAC,EAC9DgL,IAAI,CAACrQ,OAAO,CAACoE,SAAS,CAACwG,GAAG,CAAC,sBAAsB,CAAC;MAEtD1I,OAAO,CAACC,GAAG,CAAC,eAAe,CAAC;MAC5BqO,CAAC,CAACzD,cAAc,CAAC,CAAC;MAClByD,CAAC,CAACvD,eAAe,CAAC,CAAC;MAEnB,IAAIlH,CAAC,GAAGsK,IAAI,CAACjO,MAAM;MAEnBiO,IAAI,CAAC8I,UAAU,GAAG;QACd/T,KAAK,EAAE,IAAI1F,iDAAK,CAACqG,CAAC,CAAC1D,QAAQ,CAAC,CAAC,CAAC,EAAE0D,CAAC,CAAC1D,QAAQ,CAAC,CAAC,CAAC,CAAC;QAC9CsT,KAAK,EAAE5P,CAAC,CAACmE,QAAQ,CAAC,CAAC;QACnBV,KAAK,EAAEzD,CAAC,CAACsE,OAAO,CAAC,CAAC;MACtB,CAAC;MACD,IAAI8K,OAAO,GAAG3E,CAAC,CAAC2E,OAAO;MAEvB9E,IAAI,CAAC+I,WAAW,GAAG/I,IAAI,CAACuF,UAAU,CAACpF,CAAC,EAAE2E,OAAO,CAAC;MAC9C9E,IAAI,CAAC+I,WAAW,CAAC5P,KAAK,GAAG6G,IAAI,CAAC8I,UAAU,CAAC3P,KAAK;MAC9C6G,IAAI,CAAC0I,aAAa,GAAG,IAAI;MAEzB1I,IAAI,CAAC6I,cAAc,GAAG,KAAK;MAE3B,IAAIlY,EAAE,GAAGC,gBAAgB,CAACF,EAAE,CAAC;MAE7BsP,IAAI,CAAC9O,CAAC,GAAGJ,UAAU,CAACH,EAAE,CAACQ,MAAM,CAAC,EAC9B6O,IAAI,CAAChP,CAAC,GAAGF,UAAU,CAACH,EAAE,CAACM,KAAK,CAAC;MAG7B,IAAI,OAAQ+O,IAAI,CAACoJ,SAAU,IAAI,WAAW,EACtCpJ,IAAI,CAACoJ,SAAS,GAAG,IAAI;MAEzB,IAAGpJ,IAAI,CAAC7B,MAAM,CAAC4K,WAAW,EACtB/I,IAAI,CAACyH,OAAO,CAAC,aAAa,EAAEtH,CAAC,CAAC;MAElCH,IAAI,CAACkC,aAAa,CAAC,KAAK,CAAC;MAEzB,IAAI/B,CAAC,CAAC9D,IAAI,IAAI,WAAW,EAAE;QACvB,IAAIgN,KAAK,GAAGjZ,QAAQ,CAACqQ,aAAa,CAAC,MAAM,CAAC;QAC1CT,IAAI,CAACY,EAAE,CAACyI,KAAK,EAAE,yBAAyB,EAAEpB,OAAO,CAAC;QAClDjI,IAAI,CAACY,EAAE,CAACyI,KAAK,EAAE,6CAA6C,EAAEd,QAAO,CAAC;MAC1E;MACA,OAAO,KAAK,CAAC,CAAC;IAClB,CAAC;IACDA,QAAO,GAAG,SAAVA,OAAOA,CAAA,EAAe;MAClB,IAAIc,KAAK,GAAGjZ,QAAQ,CAACqQ,aAAa,CAAC,MAAM,CAAC;MAC1CT,IAAI,CAACU,GAAG,CAAC2I,KAAK,EAAE,yBAAyB,EAAEpB,OAAO,CAAC;MACnDjI,IAAI,CAACU,GAAG,CAAC2I,KAAK,EAAE,6CAA6C,EAAEd,QAAO,CAAC;MAEvE,IAAIvI,IAAI,CAAC/C,OAAO,CAACwL,QAAQ,KAAK,IAAI,EAC9B,OAAO,KAAK;MAEhBzI,IAAI,CAACrQ,OAAO,CAACoE,SAAS,CAACyM,MAAM,CAAC,sBAAsB,CAAC;MAErDR,IAAI,CAAC0I,aAAa,GAAG,KAAK;MAC1B1I,IAAI,CAAC6I,cAAc,GAAG,KAAK;IAC/B,CAAC;EAED7I,IAAI,CAACY,EAAE,CAACe,GAAG,EAAE,yBAAyB,EAAE6G,QAAQ,CAAC;EACjDxI,IAAI,CAACY,EAAE,CAACe,GAAG,EAAE,0BAA0B,EAAE6G,QAAQ,CAAC;EAClDxI,IAAI,CAACY,EAAE,CAACe,GAAG,EAAE,yBAAyB,EAAEsG,OAAO,CAAC;EAChDjI,IAAI,CAACY,EAAE,CAACe,GAAG,EAAE,wBAAwB,EAAE4G,QAAO,CAAC;AACnD,CAAC;;AAED;AACA;AACA;AACA;AACArU,cAAa,CAACmD,SAAS,CAACiS,mBAAmB,GAAG,UAAU7T,CAAC,EAAE;EACvD,IAAIoK,GAAG,GAAG,CAAC,OAAOpK,CAAC,IAAI,WAAW,GAAGA,CAAC,GAAG,IAAI,CAAC1D,MAAM,CAAC8H,QAAQ,CAAC,CAAC,IAAI,GAAG;EACtE,IAAGgG,GAAG,GAAG,CAAC,EAAEA,GAAG,IAAE,GAAG;EAEpB,OAAO;IAAE0J,KAAK,EAAE1J,GAAG;IAAE2J,IAAI,EAAEjQ,IAAI,CAACkQ,KAAK,CAAC5J,GAAG,GAAG,EAAE,CAAC;IAAE6J,KAAK,EAAE7J,GAAG,IAAI,CAAC,IAAIA,GAAG,IAAI,GAAG;IAAE8J,IAAI,EAAE9J,GAAG,IAAI,EAAE,IAAIA,GAAG,IAAI;EAAI,CAAC;AACnH,CAAC;;AAED;AACA;AACA;AACA;AACA3L,cAAa,CAACmD,SAAS,CAACwH,UAAU,GAAG,YAAY;EAC7C,IAAImB,IAAI,GAAG,IAAI;IACXtP,EAAE,GAAG,IAAI,CAACf,OAAO;IACjBia,SAAS,GAAG,IAAI,CAAC3M,OAAO,IAAI,IAAI,CAACA,OAAO,CAAC4M,OAAO;EAEpD,IAAI,OAAO,IAAI,CAAC1L,MAAM,CAACI,UAAU,IAAI,UAAU,EAAE;IAC7C7N,EAAE,CAAC8K,gBAAgB,CAAC,eAAe,EAAE,IAAI,CAAC2C,MAAM,CAACI,UAAU,CAAC;EAChE;EAEA,IACA0J,OAAO,GAAG,SAAVA,OAAOA,CAAa9H,CAAC,EAAE;MACnB,IAAIH,IAAI,CAAC/C,OAAO,CAACwL,QAAQ,KAAK,IAAI,EAC9B,OAAO,KAAK;MAEhB,IAAI,CAACzI,IAAI,CAACrQ,OAAO,CAACoE,SAAS,CAACC,QAAQ,CAAC,sBAAsB,CAAC,EAAE;QAC1D,OAAO,KAAK;MAChB;MACA,IAAI,CAACgM,IAAI,CAAC8J,OAAO,IAAI9J,IAAI,CAAC0I,aAAa,IAAI1I,IAAI,CAACkI,aAAa,EAAE;QAC3D,OAAO,KAAK;MAChB;MACAlI,IAAI,CAACjC,QAAQ,GAAG,IAAI;MACpBoC,CAAC,CAACzD,cAAc,CAAC,CAAC;MAClByD,CAAC,CAACvD,eAAe,CAAC,CAAC;MAEnB,IAAIkI,OAAO,GAAG3E,CAAC,CAAC2E,OAAO;QAAEsD,QAAQ,GAAG,KAAK;MACzC,IAAItD,OAAO,IAAIA,OAAO,CAAC9P,MAAM,IAAI,CAAC,EAC9B,IAAI8P,OAAO,CAAC,CAAC,CAAC,CAAC3I,MAAM,IAAI2I,OAAO,CAAC,CAAC,CAAC,CAAC3I,MAAM,EACtC,IAAI2I,OAAO,CAAC,CAAC,CAAC,CAAC3I,MAAM,KAAK2I,OAAO,CAAC,CAAC,CAAC,CAAC3I,MAAM,EAAE;QACzCtK,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;QAChD,OAAO,KAAK;MAChB;MAER,IAAI4D,CAAC,GAAGsK,IAAI,CAACjO,MAAM;MACnB,IAAI2R,EAAE,GAAGhO,CAAC,CAACmE,QAAQ,CAAC,CAAC;MAErB,IAAImF,OAAO,GAAGgB,IAAI,CAAC/C,OAAO,CAAC+B,OAAO;QAC9B+K,WAAW,GAAG,KAAK;QACnBC,gBAAgB,GAAG,KAAK;QACxBC,aAAa,GAAG,KAAK;MAEzB,IAAIjL,OAAO,EAAE;QACT+K,WAAW,GAAG/K,OAAO,CAACsB,IAAI,IAAItB,OAAO,CAAC7F,KAAK;QAC3C8Q,aAAa,GAAGjL,OAAO,CAACrF,MAAM;QAC9BqQ,gBAAgB,GAAGhL,OAAO,CAAC1K,SAAS;MACxC;MAEA,IAAI+Q,KAAK,GAAGrF,IAAI,CAACuF,UAAU,CAACpF,CAAC,EAAE2E,OAAO,CAAC;QACnC7G,IAAI,GAAG+B,IAAI,CAAC/B,IAAI;QAChBD,KAAK,GAAGgC,IAAI,CAAChC,KAAK;MAEtB,IAAIuF,KAAK,GAAG;QACRxO,KAAK,EAAEsQ,KAAK,CAACjU,MAAM,CAAC+D,GAAG,CAAC6I,KAAK,CAAC5M,MAAM,CAAC;QACrCkU,KAAK,EAAE/L,IAAI,CAACc,KAAK,CAAC,CAACgL,KAAK,CAACC,KAAK,GAAGtH,KAAK,CAACsH,KAAK,IAAI,GAAG,CAAC,GAAG,GAAG;QAC1DM,QAAQ,EAAE5H,KAAK,CAAC4H,QAAQ,IAAI,CAAC,GAAGrM,IAAI,CAACc,KAAK,CAACgL,KAAK,CAACO,QAAQ,IAAI,CAAC5H,KAAK,CAAC4H,QAAQ,GAAGP,KAAK,CAACO,QAAQ,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,IAAI,GAAG;MACzH,CAAC;MAED,IAAIgE,SAAS,IAAIrG,KAAK,CAAC+B,KAAK,IAAI,CAAC,KAAK,CAACR,OAAO,IAAKA,OAAO,IAAIA,OAAO,CAAC9P,MAAM,IAAI,CAAE,CAAC,EAAE;QACjF,IACIwM,EAAE,EAAEmB,EAAE,EAAElB,EAAE,EAAEmB,EAAE;QAElB,IACI9C,GAAG,GAAGE,IAAI,CAAC1Q,QAAQ;UACnBmT,OAAO,GAAG3C,GAAG,CAACzJ,WAAW,CAAC,CAAC;UAC3B7B,KAAK,GAAGiO,OAAO,CAACpN,IAAI;UACpB6U,GAAG,GAAGxU,CAAC,CAACI,OAAO,CAAC,CAAC;UACjBqU,GAAG,GAAG3V,KAAK,CAACnD,OAAO;UACnB+Y,GAAG,GAAG5V,KAAK,CAAClD,QAAQ;UACpB+Y,GAAG,GAAG7V,KAAK,CAACjD,WAAW;UACvB+Y,GAAG,GAAG9V,KAAK,CAAChD,UAAU;QAE1BgQ,EAAE,GAAG0I,GAAG,CAAC9T,cAAc,CAAC+T,GAAG,CAAC,CAAChV,GAAG,CAACoO,KAAK,CAACxO,KAAK,CAAC;QAC7C4N,EAAE,GAAGuH,GAAG,CAAC9T,cAAc,CAACgU,GAAG,CAAC,CAACjV,GAAG,CAACoO,KAAK,CAACxO,KAAK,CAAC;QAC7C0M,EAAE,GAAGyI,GAAG,CAAC9T,cAAc,CAACiU,GAAG,CAAC,CAAClV,GAAG,CAACoO,KAAK,CAACxO,KAAK,CAAC;QAC7C6N,EAAE,GAAGsH,GAAG,CAAC9T,cAAc,CAACkU,GAAG,CAAC,CAACnV,GAAG,CAACoO,KAAK,CAACxO,KAAK,CAAC;QAE7C,IAAI,CAACiJ,KAAK,CAACuM,IAAI,EACXvM,KAAK,CAACuM,IAAI,GAAG,IAAIlb,iDAAK,CAAC2Q,IAAI,CAAC8C,sBAAsB,CAACtB,EAAE,EAAEmB,EAAE,CAAC,EAAE3C,IAAI,CAAC8C,sBAAsB,CAACtB,EAAE,EAAEoB,EAAE,CAAC,CAAC,CAAC,KAEjG5E,KAAK,CAACuM,IAAI,GAAGhH,KAAK,CAACqC,QAAQ,IAAI,CAAC,GAC5B,IAAIvW,iDAAK,CAAC2Q,IAAI,CAAC8C,sBAAsB,CAACtB,EAAE,EAAEmB,EAAE,CAAC,EAAE3C,IAAI,CAAC8C,sBAAsB,CAACtB,EAAE,EAAEoB,EAAE,CAAC,CAAC,GAEnF5E,KAAK,CAACuM,IAAI;QAElB,IAAIC,IAAI,GAAGxK,IAAI,CAAC1K,KAAK,CAAC3F,OAAO,CAAC4F,OAAO;QAErC,IAAIkV,WAAW;UAAEzN,IAAI,GAAGgD,IAAI,CAAC/C,OAAO;QAEpC,IAAI2M,SAAS,IAAI,SAAS,EAAE;UACxB,IAAIc,QAAQ,GAAG;YACXlJ,EAAE,EAAExB,IAAI,CAAC8G,gBAAgB,CAAC0D,IAAI,CAACnZ,OAAO,EAAEmQ,EAAE,EAAEmB,EAAE,EAAElB,EAAE,EAAEmB,EAAE,CAAC;YACvDD,EAAE,EAAE3C,IAAI,CAAC8G,gBAAgB,CAAC0D,IAAI,CAAClZ,QAAQ,EAAEkQ,EAAE,EAAEmB,EAAE,EAAElB,EAAE,EAAEmB,EAAE,CAAC;YACxDnB,EAAE,EAAEzB,IAAI,CAAC8G,gBAAgB,CAAC0D,IAAI,CAACjZ,WAAW,EAAEiQ,EAAE,EAAEmB,EAAE,EAAElB,EAAE,EAAEmB,EAAE,CAAC;YAC3DA,EAAE,EAAE5C,IAAI,CAAC8G,gBAAgB,CAAC0D,IAAI,CAAChZ,UAAU,EAAEgQ,EAAE,EAAEmB,EAAE,EAAElB,EAAE,EAAEmB,EAAE;UAC7D,CAAC;UAED,IAAI+H,YAAY,GAAG,CAAC;UACpB,IAAGD,QAAQ,CAAClJ,EAAE,CAACgG,EAAE,EACbmD,YAAY,EAAE;UAClB,IAAGD,QAAQ,CAAC/H,EAAE,CAAC6E,EAAE,EACbmD,YAAY,EAAE;UAClB,IAAGD,QAAQ,CAACjJ,EAAE,CAAC+F,EAAE,EACbmD,YAAY,EAAE;UAClB,IAAGD,QAAQ,CAAC9H,EAAE,CAAC4E,EAAE,EACbmD,YAAY,EAAE;UAElB,IAAIvB,SAAS,GAAGuB,YAAY,IAAI,CAAC;UAEjC,IAAI,CAACvB,SAAS,EAAE;YACZ,IAAIwB,IAAI,GAAG5K,IAAI,CAACsJ,mBAAmB,CAACtL,KAAK,CAACsH,KAAK,CAAC;YAChD,QAAQsF,IAAI,CAACpB,IAAI;cACb,KAAK,CAAC;gBACF,IAAIoB,IAAI,CAACrB,KAAK,IAAI,CAAC,EAAE;kBACjB,IAAI,CAACmB,QAAQ,CAACjJ,EAAE,CAAC+F,EAAE,EAAE;oBACjB,IAAIqD,GAAG,GAAGL,IAAI,CAACjZ,WAAW,CAACwJ,UAAU,CAAC4H,EAAE,EAAElB,EAAE,CAAC,CAACtM,GAAG,CAACqV,IAAI,CAACjZ,WAAW,CAAC;sBAAEuZ,GAAG,GAAGN,IAAI,CAACjZ,WAAW,CAACwJ,UAAU,CAAC6H,EAAE,EAAEnB,EAAE,CAAC,CAACtM,GAAG,CAACqV,IAAI,CAACjZ,WAAW,CAAC;oBACpI,IAAIsZ,GAAG,CAACvT,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACsQ,GAAG,CAAC;oBACjD,IAAIC,GAAG,CAACvT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACuQ,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACJ,QAAQ,CAAClJ,EAAE,CAACgG,EAAE,EAAE;oBACjB,IAAIuD,GAAG,GAAGP,IAAI,CAACnZ,OAAO,CAAC0J,UAAU,CAACyG,EAAE,EAAEoB,EAAE,CAAC;sBAAEoI,GAAG,GAAGR,IAAI,CAACnZ,OAAO,CAAC0J,UAAU,CAACyG,EAAE,EAAEmB,EAAE,CAAC;oBAChF,IAAIoI,GAAG,CAACzT,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACwQ,GAAG,CAAC;oBACjD,IAAIC,GAAG,CAACzT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACyQ,GAAG,CAAC;kBACrD;gBACJ,CAAC,MAAM;kBACH,IAAI,CAACN,QAAQ,CAAC9H,EAAE,CAAC4E,EAAE,EAAE;oBACjB,IAAIyD,GAAG,GAAGT,IAAI,CAAChZ,UAAU,CAACuJ,UAAU,CAACyG,EAAE,EAAEoB,EAAE,CAAC,CAACzN,GAAG,CAACqV,IAAI,CAAChZ,UAAU,CAAC,CAAC,CAAC;;oBAEnE,IAAIyZ,GAAG,CAAC3T,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAAC0Q,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACP,QAAQ,CAACjJ,EAAE,CAAC+F,EAAE,EAAE;oBACjB,IACIsD,GAAG,GAAGN,IAAI,CAACjZ,WAAW,CAACwJ,UAAU,CAAC6H,EAAE,EAAEnB,EAAE,CAAC,CAACtM,GAAG,CAACqV,IAAI,CAACjZ,WAAW,CAAC;oBACnE,IAAIuZ,GAAG,CAACvT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACuQ,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACJ,QAAQ,CAAC/H,EAAE,CAAC6E,EAAE,EAAE;oBACjB,IAAI0D,GAAG,GAAGV,IAAI,CAAClZ,QAAQ,CAACyJ,UAAU,CAAC4H,EAAE,EAAElB,EAAE,CAAC,CAACtM,GAAG,CAACqV,IAAI,CAAClZ,QAAQ,CAAC,CAAC,CAAC;oBAC/D,IAAI4Z,GAAG,CAAC5T,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAAC2Q,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACR,QAAQ,CAAClJ,EAAE,CAACgG,EAAE,EAAE;oBACjB,IAAIwD,GAAG,GAAGR,IAAI,CAACnZ,OAAO,CAAC0J,UAAU,CAACyG,EAAE,EAAEmB,EAAE,CAAC;oBACzC,IAAIqI,GAAG,CAACzT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACyQ,GAAG,CAAC;kBACrD;gBACJ;gBACA;cACJ,KAAK,CAAC;gBACF,IAAIJ,IAAI,CAACrB,KAAK,IAAI,GAAG,EAAE;kBACnB,IAAI,CAACmB,QAAQ,CAAClJ,EAAE,CAACgG,EAAE,EAAE;oBACjB,IAAIwD,GAAG,GAAGR,IAAI,CAACnZ,OAAO,CAAC0J,UAAU,CAACyG,EAAE,EAAEoB,EAAE,CAAC;sBACrCmI,GAAG,GAAGP,IAAI,CAACnZ,OAAO,CAAC0J,UAAU,CAAC6H,EAAE,EAAEnB,EAAE,CAAC;oBACzC,IAAIsJ,GAAG,CAACzT,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACwQ,GAAG,CAAC;oBACjD,IAAIC,GAAG,CAACzT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACyQ,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACN,QAAQ,CAACjJ,EAAE,CAAC+F,EAAE,EAAE;oBACjB,IACIqD,GAAG,GAAGL,IAAI,CAACjZ,WAAW,CAACwJ,UAAU,CAACyG,EAAE,EAAEmB,EAAE,CAAC,CAACxN,GAAG,CAACqV,IAAI,CAACjZ,WAAW,CAAC;sBAC/DuZ,GAAG,GAAGN,IAAI,CAACjZ,WAAW,CAACwJ,UAAU,CAAC0G,EAAE,EAAEkB,EAAE,CAAC,CAACxN,GAAG,CAACqV,IAAI,CAACjZ,WAAW,CAAC;oBACnE,IAAIsZ,GAAG,CAACvT,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACsQ,GAAG,CAAC;oBACjD,IAAIC,GAAG,CAACvT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACuQ,GAAG,CAAC;kBACrD;gBACJ,CAAC,MAAM;kBACH,IAAI,CAACJ,QAAQ,CAAClJ,EAAE,CAACgG,EAAE,EAAE;oBACjB,IAAIuD,GAAG,GAAGP,IAAI,CAACnZ,OAAO,CAAC0J,UAAU,CAACyG,EAAE,EAAEoB,EAAE,CAAC;oBACzC,IAAImI,GAAG,CAACzT,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACwQ,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACL,QAAQ,CAACjJ,EAAE,CAAC+F,EAAE,EAAE;oBACjB,IAAIqD,GAAG,GAAGL,IAAI,CAACjZ,WAAW,CAACwJ,UAAU,CAAC4H,EAAE,EAAElB,EAAE,CAAC,CAACtM,GAAG,CAACqV,IAAI,CAACjZ,WAAW,CAAC;oBACnE,IAAIsZ,GAAG,CAACvT,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACsQ,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACH,QAAQ,CAAC/H,EAAE,CAAC6E,EAAE,EAAE;oBACjB,IAAI2D,GAAG,GAAGX,IAAI,CAAClZ,QAAQ,CAACyJ,UAAU,CAACyG,EAAE,EAAEmB,EAAE,CAAC,CAACxN,GAAG,CAACqV,IAAI,CAAClZ,QAAQ,CAAC;oBAC7D,IAAI6Z,GAAG,CAAC5T,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAAC4Q,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACT,QAAQ,CAAC9H,EAAE,CAAC4E,EAAE,EAAE;oBACjB,IAAI4D,GAAG,GAAGZ,IAAI,CAAChZ,UAAU,CAACuJ,UAAU,CAAC6H,EAAE,EAAEnB,EAAE,CAAC,CAACtM,GAAG,CAACqV,IAAI,CAAChZ,UAAU,CAAC;oBACjE,IAAI4Z,GAAG,CAAC7T,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAAC6Q,GAAG,CAAC;kBACrD;gBACJ;gBACA;cACJ,KAAK,CAAC;gBACF,IAAIR,IAAI,CAACrB,KAAK,IAAI,EAAE,EAAE;kBAAE;kBACpB,IAAI,CAACmB,QAAQ,CAAClJ,EAAE,CAACgG,EAAE,EAAE;oBACjB,IAAIuD,GAAG,GAAGP,IAAI,CAACnZ,OAAO,CAAC0J,UAAU,CAAC4H,EAAE,EAAEnB,EAAE,CAAC;sBACrCwJ,GAAG,GAAGR,IAAI,CAACnZ,OAAO,CAAC0J,UAAU,CAAC4H,EAAE,EAAElB,EAAE,CAAC;oBAEzC,IAAIsJ,GAAG,CAACzT,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACwQ,GAAG,CAAC;oBACjD,IAAIC,GAAG,CAACzT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACyQ,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACN,QAAQ,CAACjJ,EAAE,CAAC+F,EAAE,EAAE;oBACjB,IAAIqD,GAAG,GAAGL,IAAI,CAACjZ,WAAW,CAACwJ,UAAU,CAAC0G,EAAE,EAAEmB,EAAE,CAAC,CAACzN,GAAG,CAACqV,IAAI,CAACjZ,WAAW,CAAC;sBAC/DuZ,GAAG,GAAGN,IAAI,CAACjZ,WAAW,CAACwJ,UAAU,CAACyG,EAAE,EAAEoB,EAAE,CAAC,CAACzN,GAAG,CAACqV,IAAI,CAACjZ,WAAW,CAAC;oBAEnE,IAAIsZ,GAAG,CAACvT,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACsQ,GAAG,CAAC;oBACjD,IAAIC,GAAG,CAACvT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACuQ,GAAG,CAAC;kBACrD;gBACJ,CAAC,MAAM;kBACH,IAAI,CAACJ,QAAQ,CAAClJ,EAAE,CAACgG,EAAE,EAAE;oBACjB,IAAIuD,GAAG,GAAGP,IAAI,CAACnZ,OAAO,CAAC0J,UAAU,CAAC4H,EAAE,EAAElB,EAAE,CAAC;oBACzC,IAAIsJ,GAAG,CAACzT,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACwQ,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACL,QAAQ,CAACjJ,EAAE,CAAC+F,EAAE,EAAE;oBACjB,IAAIqD,GAAG,GAAGL,IAAI,CAACjZ,WAAW,CAACwJ,UAAU,CAACyG,EAAE,EAAEoB,EAAE,CAAC,CAACzN,GAAG,CAACqV,IAAI,CAACjZ,WAAW,CAAC;oBACnE,IAAIsZ,GAAG,CAACvT,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACsQ,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACH,QAAQ,CAAC/H,EAAE,CAAC6E,EAAE,EAAE;oBACjB,IAAI2D,GAAG,GAAGX,IAAI,CAAClZ,QAAQ,CAACyJ,UAAU,CAAC6H,EAAE,EAAEnB,EAAE,CAAC,CAACtM,GAAG,CAACqV,IAAI,CAAClZ,QAAQ,CAAC;oBAC7D,IAAI6Z,GAAG,CAAC5T,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAAC4Q,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACT,QAAQ,CAAC9H,EAAE,CAAC4E,EAAE,EAAE;oBACjB,IAAI4D,GAAG,GAAGZ,IAAI,CAAChZ,UAAU,CAACuJ,UAAU,CAAC4H,EAAE,EAAEnB,EAAE,CAAC,CAACrM,GAAG,CAACqV,IAAI,CAAChZ,UAAU,CAAC;oBACjE,IAAI4Z,GAAG,CAAC7T,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAAC6Q,GAAG,CAAC;kBACrD;gBACJ;gBACA;cACJ,KAAK,CAAC;gBACF,IAAIR,IAAI,CAACrB,KAAK,IAAI,GAAG,EAAE;kBAAE;kBACrB,IAAI,CAACmB,QAAQ,CAAClJ,EAAE,CAACgG,EAAE,EAAE;oBACjB,IAAIuD,GAAG,GAAGP,IAAI,CAACnZ,OAAO,CAAC0J,UAAU,CAAC0G,EAAE,EAAEmB,EAAE,CAAC;sBACrCoI,GAAG,GAAGR,IAAI,CAACnZ,OAAO,CAAC0J,UAAU,CAACyG,EAAE,EAAEoB,EAAE,CAAC;oBACzC,IAAImI,GAAG,CAACxT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACwQ,GAAG,CAAC;oBACjD,IAAIC,GAAG,CAACzT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACyQ,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACN,QAAQ,CAACjJ,EAAE,CAAC+F,EAAE,EAAE;oBACjB,IACIqD,GAAG,GAAGL,IAAI,CAACjZ,WAAW,CAACwJ,UAAU,CAAC4H,EAAE,EAAEnB,EAAE,CAAC,CAACrM,GAAG,CAACqV,IAAI,CAACjZ,WAAW,CAAC;sBAC/DuZ,GAAG,GAAGN,IAAI,CAACjZ,WAAW,CAACwJ,UAAU,CAAC4H,EAAE,EAAElB,EAAE,CAAC,CAACtM,GAAG,CAACqV,IAAI,CAACjZ,WAAW,CAAC;oBACnE,IAAIsZ,GAAG,CAACtT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACsQ,GAAG,CAAC;oBACjD,IAAIC,GAAG,CAACvT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACuQ,GAAG,CAAC;kBACrD;gBACJ;gBACA,IAAI,CAACJ,QAAQ,CAAClJ,EAAE,CAACgG,EAAE,EAAE;kBACjB,IAAIuD,GAAG,GAAGP,IAAI,CAACnZ,OAAO,CAAC0J,UAAU,CAAC0G,EAAE,EAAEmB,EAAE,CAAC;kBACzC,IAAImI,GAAG,CAACxT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACwQ,GAAG,CAAC;gBACrD;gBACA,IAAI,CAACL,QAAQ,CAACjJ,EAAE,CAAC+F,EAAE,EAAE;kBACjB,IAAIqD,GAAG,GAAGL,IAAI,CAACjZ,WAAW,CAACwJ,UAAU,CAAC4H,EAAE,EAAEnB,EAAE,CAAC,CAACrM,GAAG,CAACqV,IAAI,CAACjZ,WAAW,CAAC,CAAC;kBACpE,IAAIsZ,GAAG,CAACtT,CAAC,GAAG,CAAC,EAAEgM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAACsQ,GAAG,CAAC;gBACrD;gBAEA,IAAI,CAACH,QAAQ,CAAC/H,EAAE,CAAC6E,EAAE,EAAE;kBACjB,IAAI2D,GAAG,GAAGX,IAAI,CAAClZ,QAAQ,CAACyJ,UAAU,CAACyG,EAAE,EAAEoB,EAAE,CAAC,CAACzN,GAAG,CAACqV,IAAI,CAAClZ,QAAQ,CAAC;kBAC7D,IAAI6Z,GAAG,CAAC7T,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAAC4Q,GAAG,CAAC;gBACrD;gBACA,IAAI,CAACT,QAAQ,CAAC9H,EAAE,CAAC4E,EAAE,EAAE;kBACjB,IAAI4D,GAAG,GAAGZ,IAAI,CAAChZ,UAAU,CAACuJ,UAAU,CAAC4H,EAAE,EAAElB,EAAE,CAAC,CAACtM,GAAG,CAACqV,IAAI,CAAChZ,UAAU,CAAC;kBACjE,IAAI4Z,GAAG,CAAC9T,CAAC,GAAG,CAAC,EAAEiM,KAAK,CAACxO,KAAK,GAAGwO,KAAK,CAACxO,KAAK,CAACwF,GAAG,CAAC6Q,GAAG,CAAC;gBACrD;gBACA;YACR;UACJ;QACJ;QACA,IAAIxB,SAAS,IAAI,OAAO,EAAE;UACtB,IAAIc,QAAQ,GAAG;YACXlJ,EAAE,EAAExB,IAAI,CAAC8G,gBAAgB,CAAC0D,IAAI,CAACnZ,OAAO,EAAEmQ,EAAE,EAAEmB,EAAE,EAAElB,EAAE,EAAEmB,EAAE,CAAC;YACvDD,EAAE,EAAE3C,IAAI,CAAC8G,gBAAgB,CAAC0D,IAAI,CAAClZ,QAAQ,EAAEkQ,EAAE,EAAEmB,EAAE,EAAElB,EAAE,EAAEmB,EAAE,CAAC;YACxDnB,EAAE,EAAEzB,IAAI,CAAC8G,gBAAgB,CAAC0D,IAAI,CAACjZ,WAAW,EAAEiQ,EAAE,EAAEmB,EAAE,EAAElB,EAAE,EAAEmB,EAAE,CAAC;YAC3DA,EAAE,EAAE5C,IAAI,CAAC8G,gBAAgB,CAAC0D,IAAI,CAAChZ,UAAU,EAAEgQ,EAAE,EAAEmB,EAAE,EAAElB,EAAE,EAAEmB,EAAE;UAC7D,CAAC;UAED,IAAIyI,SAAS,GAAG,CAAC;UACjB,IAAI,CAACX,QAAQ,CAAClJ,EAAE,CAACgG,EAAE,EAAE6D,SAAS,EAAE;UAChC,IAAI,CAACX,QAAQ,CAAC/H,EAAE,CAAC6E,EAAE,EAAE6D,SAAS,EAAE;UAChC,IAAI,CAACX,QAAQ,CAACjJ,EAAE,CAAC+F,EAAE,EAAE6D,SAAS,EAAE;UAChC,IAAI,CAACX,QAAQ,CAAC9H,EAAE,CAAC4E,EAAE,EAAE6D,SAAS,EAAE;UAEhC,IAAK,CAACX,QAAQ,CAAClJ,EAAE,CAACgG,EAAE,IAChB,CAACkD,QAAQ,CAAC/H,EAAE,CAAC6E,EAAE,IACf,CAACkD,QAAQ,CAACjJ,EAAE,CAAC+F,EAAE,IACf,CAACkD,QAAQ,CAAC9H,EAAE,CAAC4E,EAAE,IACZxH,IAAI,CAACsL,WAAW,IAAGD,SAAS,IAAI,CAAC,IAAIrN,KAAK,CAACsH,KAAK,IAAI,CAAE,EAAE;YAC3DtF,IAAI,CAACsL,WAAW,GAAG,IAAI;YACvB,IAAIV,IAAI,GAAG5K,IAAI,CAACsJ,mBAAmB,CAACtL,KAAK,CAACsH,KAAK,CAAC;YAChD,QAAQsF,IAAI,CAACpB,IAAI;cACb,KAAK,CAAC;gBACF,IAAI7G,EAAE,CAACpL,CAAC,IAAI,CAAC,EACTgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,GAAGgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,GAAGoL,EAAE,CAACpL,CAAC;gBACxC,IAAIqL,EAAE,CAACrL,CAAC,IAAIiT,IAAI,CAAChZ,UAAU,CAAC+F,CAAC,EACzBgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,GAAGgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,IAAIqL,EAAE,CAACrL,CAAC,GAAGiT,IAAI,CAAChZ,UAAU,CAAC+F,CAAC,CAAC;gBAC9D,IAAIkK,EAAE,CAACnK,CAAC,IAAIkT,IAAI,CAACjZ,WAAW,CAAC+F,CAAC,EAC1BiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,GAAGiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,IAAImK,EAAE,CAACnK,CAAC,GAAGkT,IAAI,CAACjZ,WAAW,CAAC+F,CAAC,CAAC;gBAC/D,IAAIkK,EAAE,CAAClK,CAAC,IAAI,CAAC,EACTiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,GAAGiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,GAAGkK,EAAE,CAAClK,CAAC;gBACxC;cACJ,KAAK,CAAC;gBACF,IAAIkK,EAAE,CAACjK,CAAC,IAAIiT,IAAI,CAAChZ,UAAU,CAAC+F,CAAC,EACzBgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,GAAGgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,IAAIiK,EAAE,CAACjK,CAAC,GAAGiT,IAAI,CAAChZ,UAAU,CAAC+F,CAAC,CAAC;gBAC9D,IAAIqL,EAAE,CAACtL,CAAC,IAAIkT,IAAI,CAAClZ,QAAQ,CAACgG,CAAC,EACvBiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,GAAGiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,IAAIkT,IAAI,CAAClZ,QAAQ,CAACgG,CAAC,GAAGsL,EAAE,CAACtL,CAAC,CAAC;gBAC5D,IAAImK,EAAE,CAAClK,CAAC,IAAI,CAAC;kBAAE;kBACXgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,GAAGgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,GAAGkK,EAAE,CAAClK,CAAC;gBACxC,IAAIoL,EAAE,CAACrL,CAAC,IAAI,CAAC,EACTiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,GAAGiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,GAAGqL,EAAE,CAACrL,CAAC;gBACxC;cACJ,KAAK,CAAC;gBACF,IAAIsL,EAAE,CAACrL,CAAC,IAAI,CAAC;kBAAE;kBACXgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,GAAGgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,GAAGqL,EAAE,CAACrL,CAAC;gBACxC,IAAIiK,EAAE,CAAClK,CAAC,IAAIkT,IAAI,CAACjZ,WAAW,CAAC+F,CAAC,EAC1BiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,GAAGiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,IAAIkT,IAAI,CAACjZ,WAAW,CAAC+F,CAAC,GAAGkK,EAAE,CAAClK,CAAC,CAAC;gBAC/D,IAAIqL,EAAE,CAACpL,CAAC,IAAIiT,IAAI,CAAChZ,UAAU,CAAC+F,CAAC,EACzBgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,GAAGgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,IAAIoL,EAAE,CAACpL,CAAC,GAAGiT,IAAI,CAAChZ,UAAU,CAAC+F,CAAC,CAAC;gBAC9D,IAAIkK,EAAE,CAACnK,CAAC,IAAI,CAAC,EACTiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,GAAGiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,GAAGmK,EAAE,CAACnK,CAAC;gBACxC;gBACA;gBACA;gBACA;gBACA;gBACA;cACJ,KAAK,CAAC;gBACF,IAAIkK,EAAE,CAACjK,CAAC,IAAI,CAAC;kBAAE;kBACXgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,GAAGgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,GAAGiK,EAAE,CAACjK,CAAC;gBACxC,IAAIqL,EAAE,CAACtL,CAAC,IAAI,CAAC,EACTiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,GAAGiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,GAAGsL,EAAE,CAACtL,CAAC;gBACxC,IAAImK,EAAE,CAAClK,CAAC,IAAIiT,IAAI,CAACjZ,WAAW,CAACgG,CAAC;kBAAE;kBAC5BgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,GAAGgM,KAAK,CAACxO,KAAK,CAACwC,CAAC,IAAIkK,EAAE,CAAClK,CAAC,GAAGiT,IAAI,CAACjZ,WAAW,CAACgG,CAAC,CAAC;gBAC/D,IAAIoL,EAAE,CAACrL,CAAC,IAAIkT,IAAI,CAAClZ,QAAQ,CAACgG,CAAC,EACvBiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,GAAGiM,KAAK,CAACxO,KAAK,CAACuC,CAAC,IAAIkT,IAAI,CAAClZ,QAAQ,CAACgG,CAAC,GAAGqL,EAAE,CAACrL,CAAC,CAAC;gBAE5D;YACR;UACJ;QACJ;MACJ;MAEA,IAAIiM,KAAK,CAACxO,KAAK,CAAC2F,OAAO,CAAC,CAAC,IAAI,CAACsP,gBAAgB,EAAE;QAC5CtU,CAAC,CAACpB,SAAS,CAACiP,KAAK,CAACxO,KAAK,CAAC;QACxBqT,QAAQ,GAAG,IAAI;QACfpI,IAAI,CAACuD,KAAK,CAACjM,CAAC,IAAIiM,KAAK,CAACxO,KAAK,CAACuC,CAAC;QAC7B0I,IAAI,CAACuD,KAAK,CAAChM,CAAC,IAAIgM,KAAK,CAACxO,KAAK,CAACwC,CAAC;MACjC;MAEA,IAAIgM,KAAK,CAACqC,QAAQ,IAAI,CAAC,IAAIrC,KAAK,CAACqC,QAAQ,IAAI,CAAC,IAAId,OAAO,EACrD,IAAIA,OAAO,CAAC9P,MAAM,IAAI,CAAC,IAAI,CAAC+U,WAAW,EAAE;QACrCrU,CAAC,CAACyD,KAAK,CAACkM,KAAK,CAACjU,MAAM,EAAEmS,KAAK,CAACqC,QAAQ,CAAC;QAErCwC,QAAQ,GAAG,IAAI;MAEnB;MAEJ,IAAI7E,KAAK,CAAC+B,KAAK,IAAI,CAAC,IAAI,CAAC2E,aAAa,EAAE;QACpCvU,CAAC,CAAC4D,gBAAgB,CAAC+L,KAAK,CAACjU,MAAM,EAAEmS,KAAK,CAAC+B,KAAK,CAAC;QAC7C8C,QAAQ,GAAG,IAAI;MACnB;MAEA,IAAIA,QAAQ,EACRpI,IAAI,CAACmC,cAAc,CAACzM,CAAC,CAAC;MAE1BsK,IAAI,CAAChC,KAAK,CAACsH,KAAK,GAAGD,KAAK,CAACC,KAAK;MAE9B,IAAItF,IAAI,CAAC7B,MAAM,CAACC,IAAI,EAChB4B,IAAI,CAACyH,OAAO,CAAC,MAAM,EAAEtH,CAAC,CAAC;MAE3B,OAAO,KAAK;IAChB,CAAC;IACDqI,QAAQ,GAAG,SAAXA,QAAQA,CAAarI,CAAC,EAAE;MACpB,IAAIH,IAAI,CAAC/C,OAAO,CAACwL,QAAQ,KAAK,IAAI,EAC9B,OAAO,KAAK;MAChB,IAAIzI,IAAI,CAAC0I,aAAa,IAAI1I,IAAI,CAACkI,aAAa,EACxC,OAAO,KAAK;MAEhB,IAAI9X,QAAQ,CAACuY,gBAAgB,CAAC,uBAAuB,CAAC,CAAC3T,MAAM,IAAI,CAAC,EAC9DgL,IAAI,CAACrQ,OAAO,CAACoE,SAAS,CAACwG,GAAG,CAAC,sBAAsB,CAAC;MAEtD,IAAIyF,IAAI,CAAC/C,OAAO,CAACZ,IAAI,IAAI,aAAa,EAAE;QACpC,IAAI+E,EAAE,GAAGjB,CAAC,CAAChE,MAAM,CAACoP,OAAO,CAAC,KAAK,CAAC;QAEhC,IAAInK,EAAE,IAAI,CAACA,EAAE,CAACrN,SAAS,CAACC,QAAQ,CAAC,0BAA0B,CAAC,EAAE;UAC1D,OAAO,KAAK;QAChB,CAAC,MACGmM,CAAC,CAACvD,eAAe,CAAC,CAAC;MAC3B;MAEA,IAAIkI,OAAO,GAAG3E,CAAC,CAAC2E,OAAO;MACvB9E,IAAI,CAAChC,KAAK,GAAGgC,IAAI,CAACuF,UAAU,CAACpF,CAAC,EAAE2E,OAAO,CAAC;MAExC,IAAI0G,EAAE,GAAGxL,IAAI,CAAC1K,KAAK,CAACpF,MAAM;MAC1B,IAAI8P,IAAI,CAAChC,KAAK,CAACmH,KAAK,GAAG,EAAE,IAAInF,IAAI,CAAChC,KAAK,CAACmH,KAAK,GAAGqG,EAAE,CAACva,KAAK,GAAG,EAAE;QAAE;QAC/D;UAAEY,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;UAAE,OAAO,KAAK;QAAE;MAE7CkO,IAAI,CAACuD,KAAK,GAAG;QAAEjM,CAAC,EAAE,CAAC;QAAEC,CAAC,EAAE;MAAE,CAAC;MAE3B,IAAIuN,OAAO,IAAIA,OAAO,CAAC9P,MAAM,IAAI,CAAC,EAC9B,IAAI8P,OAAO,CAAC,CAAC,CAAC,CAAC3I,MAAM,IAAI2I,OAAO,CAAC,CAAC,CAAC,CAAC3I,MAAM,EACtC,IAAI2I,OAAO,CAAC,CAAC,CAAC,CAAC3I,MAAM,KAAK2I,OAAO,CAAC,CAAC,CAAC,CAAC3I,MAAM,EAAE;QACzCtK,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;QAChD,OAAO,KAAK;MAChB;MAER,IAAI4D,CAAC,GAAGsK,IAAI,CAACjO,MAAM;MAEnBiO,IAAI,CAAC/B,IAAI,GAAG;QACRlJ,KAAK,EAAE,IAAI1F,iDAAK,CAACqG,CAAC,CAAC1D,QAAQ,CAAC,CAAC,CAAC,EAAE0D,CAAC,CAAC1D,QAAQ,CAAC,CAAC,CAAC,CAAC;QAC9CsT,KAAK,EAAE5P,CAAC,CAACmE,QAAQ,CAAC,CAAC;QACnBV,KAAK,EAAEzD,CAAC,CAACsE,OAAO,CAAC;MACrB,CAAC;MAEDgG,IAAI,CAAChC,KAAK,CAAC7E,KAAK,GAAG6G,IAAI,CAAC/B,IAAI,CAAC9E,KAAK;MAClC6G,IAAI,CAAC8J,OAAO,GAAG,IAAI;MACnB9J,IAAI,CAACjC,QAAQ,GAAG,KAAK;MAErB,IAAIiC,IAAI,CAAC7B,MAAM,CAACH,KAAK,EACjBgC,IAAI,CAACyH,OAAO,CAAC,OAAO,EAAEtH,CAAC,CAAC;MAE5BH,IAAI,CAACkC,aAAa,CAAC,KAAK,CAAC;MAEzB,IAAI/B,CAAC,CAAC9D,IAAI,IAAI,WAAW,EAAE;QACvB,IAAIgN,KAAK,GAAGjZ,QAAQ,CAACqQ,aAAa,CAAC,MAAM,CAAC;QAC1CT,IAAI,CAACY,EAAE,CAACyI,KAAK,EAAE,yBAAyB,EAAEpB,OAAO,CAAC;QAClDjI,IAAI,CAACY,EAAE,CAACyI,KAAK,EAAE,6CAA6C,EAAEd,QAAO,CAAC;MAC1E;IACJ,CAAC;IACDA,QAAO,GAAG,SAAVA,OAAOA,CAAapI,CAAC,EAAE;MACnB,IAAIkJ,KAAK,GAAGjZ,QAAQ,CAACqQ,aAAa,CAAC,MAAM,CAAC;MAC1CT,IAAI,CAACU,GAAG,CAAC2I,KAAK,EAAE,yBAAyB,EAAEpB,OAAO,CAAC;MACnDjI,IAAI,CAACU,GAAG,CAAC2I,KAAK,EAAE,6CAA6C,EAAEd,QAAO,CAAC;MAEvEvI,IAAI,CAACrQ,OAAO,CAACoE,SAAS,CAACyM,MAAM,CAAC,sBAAsB,CAAC;MACrDR,IAAI,CAACrQ,OAAO,CAACoE,SAAS,CAACyM,MAAM,CAAC,qBAAqB,CAAC;MAEpD,IAAIR,IAAI,CAAC/C,OAAO,CAACwL,QAAQ,KAAK,IAAI,EAC9B,OAAO,KAAK;MAEhBzI,IAAI,CAACsL,WAAW,GAAG,KAAK;MAExB,IAAItL,IAAI,CAAC8J,OAAO,KAAK,IAAI,IAAI9J,IAAI,CAACjC,QAAQ,KAAK,IAAI,EAAE;QACjDiC,IAAI,CAAC4E,YAAY,CAAC,CAAC;QACnB5E,IAAI,CAACsG,YAAY,CAAC,CAAC;MACvB;MAEA,IAAItG,IAAI,CAAC8J,OAAO,KAAK,IAAI,IAAI9J,IAAI,CAACjC,QAAQ,KAAK,KAAK,EAChD,IAAIiC,IAAI,CAAC7B,MAAM,CAACG,GAAG,EACf0B,IAAI,CAACyH,OAAO,CAAC,KAAK,EAAEtH,CAAC,CAAC;MAE9BH,IAAI,CAACjC,QAAQ,GAAG,KAAK;MACrBiC,IAAI,CAAC8J,OAAO,GAAG,KAAK;MACpB,IAAI9J,IAAI,CAAC7B,MAAM,CAACE,IAAI,EAChB2B,IAAI,CAACyH,OAAO,CAAC,MAAM,EAAEtH,CAAC,CAAC;MAE3BH,IAAI,CAACkC,aAAa,CAAC,IAAI,CAAC;MAExB,IACId,EAAE,GAAGpB,IAAI,CAACI,UAAU;QACpBsB,GAAG,GAAG1B,IAAI,CAAC6B,SAAS;QACpBF,GAAG,GAAG3B,IAAI,CAAC8B,SAAS;MAExB,IAAIV,EAAE,EAAE;QACJ,IAAIqK,GAAG,GAAGzL,IAAI,CAACjO,MAAM,CAACiI,OAAO,CAAC,CAAC;QAC/BoH,EAAE,CAACjI,KAAK,CAAC,IAAI9J,iDAAK,CAAC,CAAC,CAAC,EAAG,CAAC,GAAG+R,EAAE,CAACrP,MAAM,CAACiI,OAAO,CAAC,CAAC,IAAK,CAAC,GAAGyR,GAAG,CAAC,CAAC;MACjE;MACA,IAAI/J,GAAG,IAAIC,GAAG,EAAE;QACZ,IAAI+J,IAAI,GAAGD,GAAG,IAAIzL,IAAI,CAACjO,MAAM,CAACiI,OAAO,CAAC,CAAC,CAAC,CAAC;;QAEzC0H,GAAG,CAACjN,KAAK,CAACnB,SAAS,GAAG,QAAQ,GAAI,CAAC,GAAGoY,IAAK,GAAG,GAAG;QACjD/J,GAAG,CAAClN,KAAK,CAACnB,SAAS,GAAG,QAAQ,GAAI,CAAC,GAAGoY,IAAK,GAAG,GAAG;MACrD;IACJ,CAAC;IACDC,YAAY,GAAG,SAAfA,YAAYA,CAAaxL,CAAC,EAAE;MACxB,IAAIH,IAAI,CAAC/C,OAAO,CAACwL,QAAQ,KAAK,IAAI,EAC9B,OAAO,KAAK;MAChB,IAAIzI,IAAI,CAAC0I,aAAa,IAAI1I,IAAI,CAACkI,aAAa,EACxC,OAAO,KAAK;MAChB,IAAIlI,IAAI,CAAC/C,OAAO,CAACZ,IAAI,IAAI,aAAa,EAClC,OAAO,KAAK;MAEhB8D,CAAC,CAACzD,cAAc,CAAC,CAAC;MAClByD,CAAC,CAACvD,eAAe,CAAC,CAAC;MAEnB,IAAIgP,GAAG,GAAGC,IAAI,CAACD,GAAG,CAAC,CAAC;QAChBE,GAAG,GAAG9L,IAAI,CAAC+L,aAAa,GAAGH,GAAG,GAAG5L,IAAI,CAAC+L,aAAa,GAAG,GAAG;MAE7D,IAAID,GAAG,GAAG,GAAG,IAAIrN,SAAS,CAACC,SAAS,CAACvM,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EACpD,OAAO,KAAK;MAEhB,IAAI/B,QAAQ,CAACuY,gBAAgB,CAAC,uBAAuB,CAAC,CAAC3T,MAAM,IAAI,CAAC,EAC9DgL,IAAI,CAACrQ,OAAO,CAACoE,SAAS,CAACwG,GAAG,CAAC,sBAAsB,CAAC;MAEtD,IAAIyF,IAAI,CAACI,UAAU,EACfJ,IAAI,CAACI,UAAU,CAAClD,MAAM,CAACnJ,SAAS,CAACwG,GAAG,CAAC,4BAA4B,CAAC;MAEtE,IAAIyF,IAAI,CAACgM,WAAW,EAChBjL,YAAY,CAACf,IAAI,CAACgM,WAAW,CAAC;MAElC,IAAI3G,KAAK,GAAGrF,IAAI,CAACuF,UAAU,CAACpF,CAAC,CAAC;QAC1BzK,CAAC,GAAGsK,IAAI,CAACjO,MAAM;QACfqH,CAAC,GAAG1D,CAAC,CAACsE,OAAO,CAAC,CAAC;QACfqH,EAAE;QACF4K,EAAE,GAAG,IAAI;QACTC,GAAG,GAAG7G,KAAK,CAACI,OAAO,CAAClO,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;MAEtCyI,IAAI,CAACkC,aAAa,CAAC,IAAI,CAAC;MAGxB,IAAImD,KAAK,CAACI,OAAO,CAAClO,CAAC,IAAI,CAAC,EAAE;QACtB8J,EAAE,GAAG,CAAC,GAAI4K,EAAE,GAAGC,GAAI;QACnBxW,CAAC,CAACyD,KAAK,CAACkM,KAAK,CAACjU,MAAM,EAAEiQ,EAAE,CAAC;QACzBrB,IAAI,CAACmC,cAAc,CAAC,CAAC;QACrB;MACJ;MAAC;MACDnC,IAAI,CAACrQ,OAAO,CAACoE,SAAS,CAACyM,MAAM,CAAC,sBAAsB,CAAC;MAErDR,IAAI,CAACgM,WAAW,GAAG/K,UAAU,CAAC,YAAY;QACtCjB,IAAI,CAAC4E,YAAY,CAAC,CAAC;QACnB,IAAI5E,IAAI,CAACI,UAAU,EACfJ,IAAI,CAACI,UAAU,CAAClD,MAAM,CAACnJ,SAAS,CAACyM,MAAM,CAAC,4BAA4B,CAAC;MAG7E,CAAC,EAAE,GAAG,CAAC;MACPR,IAAI,CAAC+L,aAAa,GAAGH,GAAG;IAC5B,CAAC;EAED5L,IAAI,CAACY,EAAE,CAAClQ,EAAE,EAAE,yBAAyB,EAAE8X,QAAQ,CAAC;EAChDxI,IAAI,CAACY,EAAE,CAAClQ,EAAE,EAAE,0BAA0B,EAAE8X,QAAQ,CAAC;EACjDxI,IAAI,CAACY,EAAE,CAAClQ,EAAE,EAAE,yBAAyB,EAAEuX,OAAO,CAAC;EAC/CjI,IAAI,CAACY,EAAE,CAAClQ,EAAE,EAAE,wBAAwB,EAAE6X,QAAO,CAAC;EAE9CvI,IAAI,CAACY,EAAE,CAAClQ,EAAE,EAAE,sBAAsB,EAAE,UAAUyP,CAAC,EAAE;IAC7CtO,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;IAC3BqO,CAAC,CAACzD,cAAc,CAAC,CAAC;IAAEyD,CAAC,CAACvD,eAAe,CAAC,CAAC;IAAE,OAAO,KAAK;EACzD,CAAC,CAAC;EAEF,IAAI,CAAC,IAAI,CAACK,OAAO,CAAC+B,OAAO,IAAK,IAAI,CAAC/B,OAAO,CAAC+B,OAAO,IAAI,CAAC,IAAI,CAAC/B,OAAO,CAAC+B,OAAO,CAACmN,KAAM,EAC9E,IAAI1N,SAAS,CAACC,SAAS,CAACvM,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IAAE;IAC7CwJ,gBAAgB,CAACjL,EAAE,EAAEib,YAAY,CAAC;AAC9C,CAAC;;AAED;AACA;AACA;AACAzX,cAAa,CAACkY,QAAQ,GAAG;EAAEC,UAAU,EAAE,CAAC;AAAE,CAAC;;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA;AACAnY,cAAa,CAACmD,SAAS,CAACuJ,EAAE,GAAG,UAAUlQ,EAAE,EAAEwL,KAAK,EAAEoQ,IAAI,EAAEtP,IAAI,EAAE;EAC1D,IAAImB,MAAM,GAAGjC,KAAK,CAACmD,KAAK,CAAC,GAAG,CAAC;IAAEzN,CAAC;IAAE2a,EAAE;IAAEC,EAAE;IAAEC,EAAE;IAAEC,EAAE;EAChD,KAAK9a,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGuM,MAAM,CAACnJ,MAAM,EAAEpD,CAAC,EAAE,EAAE;IAChC2a,EAAE,GAAGpO,MAAM,CAACvM,CAAC,CAAC,CAACyN,KAAK,CAAC,GAAG,CAAC,EAAEmN,EAAE,GAAGD,EAAE,CAAC,CAAC,CAAC,EAAEE,EAAE,GAAGF,EAAE,CAACvX,MAAM,GAAG,CAAC,GAAGuX,EAAE,CAAC,CAAC,CAAC,GAAG,KAAK;IACzE7b,EAAE,CAAC8K,gBAAgB,CAACgR,EAAE,EAAEF,IAAI,EAAEtP,IAAI,IAAI,KAAK,CAAC;IAE5C,IAAI,CAAC9I,cAAa,CAACkY,QAAQ,CAACC,UAAU,CAACnQ,KAAK,CAAC,EACzChI,cAAa,CAACkY,QAAQ,CAACC,UAAU,CAACnQ,KAAK,CAAC,GAAG,EAAE;IAEjD,IAAIuQ,EAAE,EACF,IAAI,CAACvY,cAAa,CAACkY,QAAQ,CAACC,UAAU,CAACI,EAAE,CAAC,EACtCvY,cAAa,CAACkY,QAAQ,CAACC,UAAU,CAACI,EAAE,CAAC,GAAG,EAAE;IAElDC,EAAE,GAAGxY,cAAa,CAACkY,QAAQ,CAACC,UAAU,CAACnQ,KAAK,CAAC,CAACtG,IAAI,CAAC;MAAEsG,KAAK,EAAEsQ,EAAE;MAAEF,IAAI,EAAEA,IAAI;MAAEtP,IAAI,EAAEA,IAAI,IAAI;IAAM,CAAC,CAAC;IAClG,IAAIyP,EAAE,EACFvY,cAAa,CAACkY,QAAQ,CAACC,UAAU,CAACI,EAAE,CAAC,CAAC7W,IAAI,CAAC1B,cAAa,CAACkY,QAAQ,CAACC,UAAU,CAACnQ,KAAK,CAAC,CAACwQ,EAAE,GAAG,CAAC,CAAC,CAAC;EACpG;AACJ,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACAxY,cAAa,CAACmD,SAAS,CAACqJ,GAAG,GAAG,UAAUhQ,EAAE,EAAEwL,KAAK,EAAEc,IAAI,EAAE;EACrD,IAAI1F,CAAC,GAAGpD,cAAa,CAACkY,QAAQ,CAACC,UAAU,CAACnQ,KAAK,CAAC;IAAEyQ,EAAE;EACpD,IAAIrV,CAAC,EACD,KAAK,IAAI1F,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG0F,CAAC,CAACtC,MAAM,EAAEpD,CAAC,EAAE,EAAE;IAC/B+a,EAAE,GAAGrV,CAAC,CAAC1F,CAAC,CAAC;IACTlB,EAAE,CAACkc,mBAAmB,CAACD,EAAE,CAACzQ,KAAK,EAAEyQ,EAAE,CAACL,IAAI,EAAEK,EAAE,CAAC3P,IAAI,CAAC;EACtD;AAER,CAAC;;AAED;AACA;AACA;AACA9I,cAAa,CAACmD,SAAS,CAACpF,OAAO,GAAG,YAAY;EAC1C,IAAI,CAACqD,KAAK,GAAG6E,SAAS;EACtB,IAAI,CAACgD,eAAe,CAAC,CAAC;EACtB,IAAI,CAAC7N,QAAQ,CAAC2C,OAAO,CAAC,CAAC;AAC3B,CAAC,CAAC,CAAC;AACH,CAAC,YAAW;EACR,IAAI4a,KAAK,EAAEC,MAAM;EACjB5c,MAAM,CAACsL,gBAAgB,CAAC,QAAQ,EAAE,YAAY;IAC1CuF,YAAY,CAAC8L,KAAK,CAAC;IACnBA,KAAK,GAAG5L,UAAU,CAAC8L,qBAAqB,EAAE,GAAG,CAAC;EAClD,CAAC,CAAC;EACF;EACA;EACA;EACA;;EAEA,IAAIA,qBAAqB,GAAG,SAAxBA,qBAAqBA,CAAA,EAAe;IACpC;IACA,IAAIC,EAAE,GAAG5c,QAAQ,CAACuY,gBAAgB,CAAC,gBAAgB,CAAC,CAACjX,OAAO,CAAC,UAAUC,CAAC,EAAEC,CAAC,EAAE;MACzE,IAAIA,CAAC,GAAGD,CAAC,CAACsC,YAAY,CAAC,uBAAuB,CAAC;QAC3Cd,CAAC,GAAGvB,CAAC,GAAGsC,cAAa,CAACC,QAAQ,CAACvC,CAAC,CAAC,GAAG,KAAK;MAE7C,IAAIuB,CAAC,YAAYe,cAAa,EAC1Bf,CAAC,CAAClB,OAAO,CAAC,CAAC;IACnB,CAAC,CAAC;EACN,CAAC;AACL,CAAC,EAAE,CAAC,CAAC,CAAC;;AAEN;AACA,IAAI,OAAO/B,MAAM,KAAK,WAAW,EAAE;EACjCA,MAAM,CAACgE,aAAa,GAAGA,cAAa;AACtC;AACA,+DAAeA,cAAa,E","sources":["webpack://Transformable/webpack/universalModuleDefinition","webpack://Transformable/./src/css/transformable.css?3b64","webpack://Transformable/./src/js/Ancestry.js","webpack://Transformable/./src/js/Matrix.js","webpack://Transformable/./src/js/Point.js","webpack://Transformable/webpack/bootstrap","webpack://Transformable/webpack/runtime/make namespace object","webpack://Transformable/./src/js/transformable.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Transformable\"] = factory();\n\telse\n\t\troot[\"Transformable\"] = factory();\n})(this, function() {\nreturn ","// extracted by mini-css-extract-plugin\nexport {};","import Matrix from './Matrix.js';\r\nimport Point from './Point.js';\r\n\r\nclass Ancestry {\r\n    constructor(self) {\r\n        this.Items = [];\r\n        this._add(self, self.element);\r\n        this.Self = self;\r\n        this._init();\r\n    }\r\n\r\n    _getScroll() {\r\n        return new Point(window.pageXOffset || document.documentElement.scrollLeft, window.pageYOffset || document.documentElement.scrollTop);\r\n    }\r\n\r\n    /**\r\n     * Gets size/positions from computed style\r\n     * @param {HtmlElement} el\r\n     * @param {CSSStyleDeclaration} cs If you just got the computed styles, pass them in.\r\n     */\r\n    GetElementSize(el, cs) {\r\n        cs = cs || getComputedStyle(el);\r\n\r\n        const left = parseFloat(cs.left);\r\n        const top = parseFloat(cs.top);\r\n        const w = parseFloat(cs.width);\r\n        const h = parseFloat(cs.height);\r\n\r\n        return {\r\n            offset: new Point(left || 0, top || 0),\r\n            width: w,\r\n            height: h,\r\n            topleft: new Point(0, 0),\r\n            topright: new Point(w, 0),\r\n            bottomright: new Point(w, h),\r\n            bottomleft: new Point(0, h)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Prints out the Ancestry to console\r\n     */\r\n    _debug() {\r\n        this.Items.forEach(function (v, i) {\r\n            console.log(v.matrix.elements);\r\n        });\r\n        this.Items.forEach(function (v, i) {\r\n            console.log([v.element]);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Automatically called after resizing the window.\r\n     * Or can be called manually if the resizable element has its position on \r\n     * the page changed by elements outside its Ancestry. E.g. content above, changes height\r\n     */\r\n    Refresh() {\r\n        this.Items = [];\r\n        this._add(this.Self, this.Self.element);\r\n        //this.scroll = Point.Point0;\r\n        this._init();\r\n    }\r\n\r\n    /**\r\n     * Checks a computed style value to see if it is in percent instead of px \r\n     * @param {String|Number} v\r\n     */\r\n    _ispercent(v) { return v.indexOf('%') > -1; }\r\n\r\n    /**\r\n     * Checks a computed style value to see if it is auto\r\n     * @param {String|Number} v\r\n     */\r\n    _isauto(v) { return v == 'auto'; }\r\n\r\n    /**\r\n     * Converts percentage values obtained from buggy browsers to pixels\r\n     * @param {String} k CSS style to calculate\r\n     * @param {String|Number} val The percentage value to convert to pixels\r\n     * @param {CSSStyleDeclaration} cs The computed styles of the parent element. E.g. getComputedStyle(parentElement);\r\n     */\r\n    _pixelFromParent(k, val, cs) {\r\n        if (val === '0%') return 0;\r\n        let v = parseFloat(val);\r\n        switch (k) {\r\n            case 'left':\r\n                v = parseFloat(cs.width) * v / 100;\r\n                break;\r\n            case 'top':\r\n                v = parseFloat(cs.height) * v / 100;\r\n                break;\r\n        }\r\n        return v;\r\n    }\r\n\r\n    /**\r\n     * Gets dimensions from computed styles and makes them all pixel based\r\n     * @param {HtmlElement} el\r\n     */\r\n    GetComputedDims(el) {\r\n        const cs = getComputedStyle(el);\r\n        const cmt = cs.marginTop;\r\n        const cml = cs.marginLeft;\r\n        let cl = cs.left;\r\n        let ct = cs.top;\r\n        const leftp = this._ispercent(cl);\r\n        const topp = this._ispercent(ct);\r\n        const pf = function (v) { return parseFloat(v); }\r\n        let l, t, pcs;\r\n\r\n        if (this._isauto(cl)) cl = 0;\r\n        if (this._isauto(ct)) ct = 0;\r\n\r\n        if (leftp || topp)\r\n            pcs = getComputedStyle(el.parentNode);\r\n\r\n        if (leftp) l = this._pixelFromParent('left', cl, pcs);\r\n        if (topp) t = this._pixelFromParent('top', ct, pcs);;\r\n\r\n        return {\r\n            left: typeof l != 'undefined' ? l : pf(cl),\r\n            top: typeof t != 'undefined' ? t : pf(ct),\r\n            marginLeft: pf(cml),\r\n            marginTop: pf(cmt),\r\n            transform: cs.transform\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Walks upwards through node hierarchy replacing any position/offset changing CSS with an equivalent matrix.\r\n     * This simplifies matrix calculations and means no CSS restrictions are required on elements you want to make transformable.\r\n     */\r\n    _init() {\r\n        let t, has, pt, tid, nm, el = this.Self.element;\r\n        while (el.parentNode && !el.parentNode.body) {\r\n\r\n            const cs = this.GetComputedDims(el.parentNode);\r\n            t = cs.transform;\r\n            has = /matrix\\(\\-?[0-9]+[^\\)]+\\)/.test(t);\r\n            \r\n            const top = cs.top;\r\n            let left = cs.left,\r\n            margintop = cs.marginTop,\r\n            marginleft = cs.marginLeft;\r\n\r\n            if (has || el.parentNode.classList.contains('transformable') || el.classList.contains('transformable')\r\n                || top != 0 || left != 0\r\n                || margintop != 0\r\n                || marginleft != 0\r\n                ) {\r\n                if (tid = el.parentNode.getAttribute('data-transformable-id')) {\r\n                    pt = Transformable.Instance[tid];\r\n                    if (pt)\r\n                        this._add(pt);\r\n                } else {\r\n                    let om = has ? new Matrix(this.Self._cssStringToArray(t)) : false;                \r\n\r\n                    if (has || top != 0 || left != 0 || margintop != 0 || marginleft != 0 || el.classList.contains('transformable')) {\r\n                        nm = new Matrix();\r\n                        nm.translate(left||0, top||0).translate(marginleft||0, margintop||0);\r\n\r\n                        if (om)\r\n                            nm.multiply(om.elements);\r\n\r\n                        let prect = this.GetElementSize(el.parentNode);\r\n\r\n                        el.parentNode.style.top = 0;\r\n                        el.parentNode.style.left = 0; \r\n                        el.parentNode.style.marginLeft = 0;\r\n                        el.parentNode.style.marginTop = 0;\r\n                        el.parentNode.style.transformOrigin = '0 0';\r\n                        el.parentNode.style.transform = this.Self._arrayToCssString(nm.elements);\r\n\r\n                        this._add(nm, el.parentNode, prect);\r\n                    }\r\n                }\r\n            }\r\n            el = el.parentNode;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets offset initially then updates scroll position data\r\n     */\r\n    _setoffset () {\r\n        this.scroll = this._getScroll();\r\n        if(this.offset) return;\r\n        let cur, i;\r\n        const trans = new Matrix();\r\n        for (i = 0; i < this.Items.length; i++)\r\n            trans.translate(this.Items[i].matrix.translation());\r\n\r\n        for (i = 0; i < this.Items.length; i++) {\r\n            cur = this.Items[i];\r\n            if (cur.element.classList.contains('transformable')) {\r\n                this.offset = cur.transformable.offset.sub(trans.translation());\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds an element/transformable element to the Ancestry of parent elements\r\n     * @param {Transformable|Matrix} t\r\n     * @param {HtmlElement} el\r\n     */\r\n    _add(t, el) {\r\n        if (t instanceof Transformable) {\r\n            this.Items.unshift({ matrix: t.matrix, element: el || t.element, rect: t.sizes.element.initial, transformable: t });\r\n        }\r\n        if (t instanceof Matrix) {\r\n            this.Items.unshift({ matrix: t, element: el, rect: this.GetElementSize(el) });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns Array of objects for each parent element.\r\n     * Gets the matrix, inverse matrix and the element for each parent.\r\n     */\r\n    GetParents() {\r\n        let r = [];\r\n        //this._setoffset();\r\n        this.Items.forEach(function (v, i) {\r\n            let t = v.transformable, m, ti;\r\n            if (!t)\r\n                if (ti = v.element.getAttribute('data-transformable-id')) {\r\n                    t = Transformable.Instance[ti];\r\n                    v.transformable = t;\r\n                }\r\n\r\n            m = t ? t.matrix : v.matrix\r\n            r.push({\r\n                Matrix: m,\r\n                Inverse: m.inverse(),\r\n                Element: v.element\r\n            });\r\n        });\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * Uses this instance's matrix to transform corner points\r\n     * @param {Object} c Named points of a rectangle\r\n     */\r\n    TransformCorners(c) {\r\n        const mat = this.GetMatrix();\r\n        return {\r\n            bottomright: mat.transformpoint(c.bottomright),\r\n            bottomleft: mat.transformpoint(c.bottomleft),\r\n            topright: mat.transformpoint(c.topright),\r\n            topleft: mat.transformpoint(c.topleft)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets data from Items for the outermost containing element.\r\n     */\r\n    FirstParent() {\r\n        const t = this, i = t.Items, l = i.length;\r\n        const par = l > 1 ? i[l - 2] : false;\r\n\r\n        return par;\r\n    }\r\n\r\n    /**\r\n     Gets the combined effective matrix based on all matrices that have an effect on the element\r\n     */\r\n    GetMatrix() {\r\n        let mat = Matrix.Identity();\r\n        this.Items.forEach(function (v, i) {\r\n            mat.multiply(v.matrix.elements);\r\n        });\r\n        return mat;\r\n    }\r\n\r\n    /**\r\n     * Gets the x,y coordinate on the transformable element for a given point\r\n     * @param {Point} p Coordinates in the window or from a mouse/touch event\r\n     * @param {Array of Object} pars Objects with matrix, inverse matrix and element\r\n     */\r\n    OffsetFromPoint(p, pars) {\r\n        pars = pars || this.GetParents();\r\n        this._setoffset();\r\n        let op = p, cur, mat = Matrix.Identity().translate(this.offset);\r\n\r\n        for (var i = 0; i < pars.length; i++) {\r\n            cur = pars[i];\r\n            mat.multiply(cur.Matrix.elements);\r\n        }\r\n\r\n        const matinv = mat.inverse();\r\n        op = matinv.transformpoint(op); \r\n\r\n        return op;\r\n    }\r\n\r\n}\r\n\r\nexport default Ancestry;\r\n","import Point from './Point.js';\r\n\r\nvar Matrix = function (a) {\r\n    if (a == null || typeof a == 'undefined')\r\n        return Matrix.Identity();\r\n\r\n    if (a instanceof Array) {\r\n        this.elements = a.slice(0);\r\n    } else {\r\n        if(a instanceof Matrix) {\r\n            this.elements = a.elements.slice(0);\r\n        } else {\r\n            if (arguments.length == 6) {\r\n                this.elements = [];\r\n                var i = 0;\r\n                while (i < arguments.length)\r\n                    this.elements.push(arguments[i++]);\r\n            } else\r\n                throw new Error(\"Can't create Matrix from supplied arguments. Array of 6 elements, Matrix or nothing only.\");\r\n        }\r\n    }\r\n    this.history = { undo: [], redo: [] };\r\n\r\n    return this;\r\n}\r\nMatrix.Identity = function () {\r\n    return new Matrix([1, 0, 0, 1, 0, 0]);\r\n}\r\nMatrix.prototype = {\r\n    transformpoint: function (pt) {\r\n        var m = this.elements;\r\n\t\treturn new Point(\r\n\t\t\tpt.x * m[0] + pt.y * m[2] + m[4],\r\n\t\t\tpt.x * m[1] + pt.y * m[3] + m[5]\r\n\t\t)\r\n    },\r\n    multiply: function(els) {\r\n        var me = this.elements;\r\n        var a1 = me[0],\r\n\t\t\tb1 = me[1],\r\n\t\t\tc1 = me[2],\r\n\t\t\td1 = me[3],\r\n\t\t\te1 = me[4],\r\n\t\t\tf1 = me[5],\r\n            a2 = els[0],\r\n            b2 = els[1],\r\n            c2 = els[2],\r\n            d2 = els[3],\r\n            e2 = els[4],\r\n            f2 = els[5];\r\n\r\n\r\n\t\t/* matrix order (canvas compatible):\r\n\t\t* ace\r\n\t\t* bdf\r\n\t\t* 001\r\n\t\t*/\r\n\t\tthis.elements = [\r\n            a1 * a2 + c1 * b2,\r\n            b1 * a2 + d1 * b2,\r\n            a1 * c2 + c1 * d2,\r\n            b1 * c2 + d1 * d2,\r\n            a1 * e2 + c1 * f2 + e1,\r\n            b1 * e2 + d1 * f2 + f1\r\n\t\t];\r\n\r\n\t\treturn this;\r\n    },\r\n    elementsequal: function (a, b) {\r\n        if (!a || !b) return false;\r\n        return (\r\n        a[0] == b[0] &&\r\n        a[1] == b[1] &&\r\n        a[2] == b[2] &&\r\n        a[3] == b[3] &&\r\n        a[4] == b[4] &&\r\n        a[5] == b[5]);\r\n    },\r\n    save: function (els) {\r\n        var h = this.history, last,\r\n            k = typeof els === 'string' ? els : false;\r\n\r\n        if (!els || k)\r\n            els = this.elements;\r\n\r\n        last = h.undo[h.undo.length - 1];\r\n\r\n        if (!this.elementsequal(els, last)) {\r\n            var l = h.undo.push(els.slice(0));\r\n            h.redo = [];\r\n            if (k)\r\n                h.undo[k] = h.undo[l - 1];\r\n        } else \r\n            if (k) {\r\n                h.undo[k] = last;\r\n            }\r\n    },\r\n    undo: function (k) {\r\n        var h = this.history.undo,\r\n            len = h.length,\r\n            cur = h.pop(),\r\n            prev = typeof k == 'string' ? h[k] : h[h.length - 1];\r\n        \r\n        if (cur)\r\n            this.history.redo.unshift(cur);\r\n\r\n        this.elements = prev ? prev.slice(0) : this.identity();\r\n    },\r\n    redo: function () {\r\n        var h = this.history.redo, \r\n            len = h.length, \r\n            cur = h.pop(),\r\n            prev = h[h.length - 1]\r\n        \r\n        if (cur)\r\n            this.history.undo.unshift(cur);\r\n\r\n        this.elements = prev ? prev.slice(0) : this.identity();\r\n    },\r\n    reset: function () {\r\n        this.elements = this.identity();\r\n        return this;\r\n    },\r\n    determinant: function () {\r\n        var m = this.elements;\r\n        return m[0] * m[3] - m[1] * m[2];\r\n    },\r\n\tinverse: function() {\r\n\r\n\t\tvar me = this.elements,\r\n\t\t\tm  = this.identity(),\r\n\t\t\tdt = this.determinant();\r\n\r\n\t\tif (dt < 1e-14)\r\n\t\t\tthrow \"Matrix not invertible.\";\r\n\r\n\t\tm[0] = me[3] / dt;\r\n\t\tm[1] = -me[1] / dt;\r\n\t\tm[2] = -me[2] / dt;\r\n\t\tm[3] = me[0] / dt;\r\n\t\tm[4] = (me[2] * me[5] - me[3] * me[4]) / dt;\r\n\t\tm[5] = -(me[0] * me[5] - me[1] * me[4]) / dt;\r\n\r\n\t\treturn new Matrix(m);\r\n\t},\r\n\tinvert: function () {\r\n        return this.multiply(this.inverse().elements);\r\n\t},\r\n    identity: function () {\r\n        return [1, 0, 0, 1, 0, 0];\r\n    },\r\n    isIdentity: function () {\r\n        var m = this.elements;\r\n        return m[0] === 1 && m[1] === 0 && m[2] === 0 && m[3] === 1 && m[4] === 0 && m[5] === 0;\r\n    },\r\n    translate: function (x, y) {\r\n        if (x instanceof Point && !y)\r\n            return this.multiply([1, 0, 0, 1, x.x, x.y]);\r\n\r\n        return this.multiply([1, 0, 0, 1, x, y]);\r\n    },\r\n    scale: function (pt, s) {\r\n        this.multiply([s, 0, 0, s, 0, 0]);\r\n        var dp = pt.sub(pt.scale(s)).scale(1/s); // keep pt in same place after scale from origin\r\n        return this.translate(dp);\r\n    },\r\n    rotateAboutPoint: function (pt, a) {\r\n        var r = a * Math.PI / 180;\r\n        return this.multiply([\r\n            Math.cos(r),\r\n            Math.sin(r),\r\n            -Math.sin(r),\r\n            Math.cos(r),\r\n            pt.x - Math.cos(r) * pt.x - -Math.sin(r) * pt.y,\r\n            pt.y - Math.sin(r) * pt.x - Math.cos(r) * pt.y\r\n        ]);\r\n    },\r\n    rotate: function (a,b) {\r\n        if (a instanceof Point)\r\n            return this.rotateAboutPoint(a, b);\r\n\r\n        var r = a * Math.PI / 180;\r\n        return this.multiply([Math.cos(r), Math.sin(r), -Math.sin(r), Math.cos(r), 0, 0]);\r\n    },\r\n    normaldegree: function (r) {\r\n        return r < 0 ? r + 360 : r;\r\n    },\r\n    rotation: function (norm) {\r\n        var l = this.elements, r = Math.atan2(l[1], l[0]) * 180 / Math.PI;\r\n\r\n        return norm ? this.normaldegree(r) : r;\r\n    },\r\n    scaling: function () {\r\n        return Math.sqrt(Math.pow(this.elements[0], 2) + Math.pow(this.elements[1], 2))\r\n    },\r\n    translation: function () {\r\n        return new Point(this.elements[4], this.elements[5]);\r\n    }\r\n}\r\n\r\nexport default Matrix;\r\n","class Point {\r\n  constructor(x, y = x) {\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n\r\n  scale(factor) {\r\n    return new Point(this.x * factor, this.y * factor);\r\n  }\r\n\r\n  round(precision = 0) {\r\n    const factor = precision ? Math.pow(10, precision) : 1;\r\n    return new Point(\r\n      Math.round(this.x * factor) / factor,\r\n      Math.round(this.y * factor) / factor\r\n    );\r\n  }\r\n\r\n  sub(p) {\r\n    return new Point(this.x - p.x, this.y - p.y);\r\n  }\r\n\r\n  add(p) {\r\n    return new Point(this.x + p.x, this.y + p.y);\r\n  }\r\n\r\n  mult(p) {\r\n    return new Point(this.x * p.x, this.y * p.y);\r\n  }\r\n\r\n  divide(p) {\r\n    return new Point(this.x / p.x, this.y / p.y);\r\n  }\r\n\r\n  nonzero() {\r\n    return this.x !== 0 || this.y !== 0;\r\n  }\r\n\r\n  equals(p) {\r\n    return this.x === p.x && this.y === p.y;\r\n  }\r\n\r\n  moreoreq(p) {\r\n    return { x: this.x >= p.x, y: this.y >= p.y };\r\n  }\r\n\r\n  lessoreq(p) {\r\n    return { x: this.x <= p.x, y: this.y <= p.y };\r\n  }\r\n\r\n  dot(p) {\r\n    return this.x * p.x + this.y * p.y;\r\n  }\r\n\r\n  perpOnLine(p1, p2) {\r\n    const k = ((p2.y - p1.y) * (this.x - p1.x) - (p2.x - p1.x) * (this.y - p1.y)) /\r\n      (Math.pow(p2.y - p1.y, 2) + Math.pow(p2.x - p1.x, 2));\r\n    const x4 = this.x - k * (p2.y - p1.y);\r\n    const y4 = this.y + k * (p2.x - p1.x);\r\n    return new Point(x4, y4);\r\n  }\r\n\r\n  mag() {\r\n    return Math.sqrt(this.x * this.x + this.y * this.y);\r\n  }\r\n\r\n  // toPos() {\r\n  //   return new Pos(this.x, this.y);\r\n  // }\r\n}\r\n\r\nexport default Point;\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import '../css/transformable.css';\r\nimport Matrix from './Matrix.js';\r\nimport Ancestry from './Ancestry.js';\r\nimport Point from './Point.js';\r\n\r\n// Wheel event polyfill\r\n(function (window, document) {\r\n \r\n    var prefix = \"\", _addEventListener, support;\r\n\r\n    // detect event model\r\n    if ( window.addEventListener ) {\r\n        _addEventListener = \"addEventListener\";\r\n    } else {\r\n        _addEventListener = \"attachEvent\";\r\n        prefix = \"on\";\r\n    }\r\n\r\n    // detect available wheel event\r\n    support = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : // Modern browsers support \"wheel\"\r\n                document.onmousewheel !== undefined ? \"mousewheel\" : // Webkit and IE support at least \"mousewheel\"\r\n                \"DOMMouseScroll\"; // let's assume that remaining browsers are older Firefox\r\n\r\n    window.addWheelListener = function( elem, callback, useCapture ) {\r\n        _addWheelListener( elem, support, callback, useCapture );\r\n\r\n        // handle MozMousePixelScroll in older Firefox\r\n        if( support == \"DOMMouseScroll\" ) {\r\n            _addWheelListener( elem, \"MozMousePixelScroll\", callback, useCapture );\r\n        }\r\n    };\r\n\r\n    function _addWheelListener( elem, eventName, callback, useCapture ) {\r\n        elem[ _addEventListener ]( prefix + eventName, support == \"wheel\" ? callback : function( originalEvent ) {\r\n            !originalEvent && ( originalEvent = window.event );\r\n\r\n            // create a normalized event object\r\n            var event = {\r\n                // keep a ref to the original event object\r\n                originalEvent: originalEvent,\r\n                target: originalEvent.target || originalEvent.srcElement,\r\n                type: \"wheel\",\r\n                deltaMode: originalEvent.type == \"MozMousePixelScroll\" ? 0 : 1,\r\n                deltaX: 0,\r\n                deltaY: 0,\r\n                deltaZ: 0,\r\n                preventDefault: function() {\r\n                    originalEvent.preventDefault ?\r\n                        originalEvent.preventDefault() :\r\n                        originalEvent.returnValue = false;\r\n                },\r\n                stopPropagation: function () {\r\n                    originalEvent.stopPropagation ?\r\n                        originalEvent.stopPropagation() :\r\n                        originalEvent.returnValue = false;\r\n                }\r\n            };\r\n            \r\n            // calculate deltaY (and deltaX) according to the event\r\n            if ( support == \"mousewheel\" ) {\r\n                event.deltaY = - 1/40 * originalEvent.wheelDelta;\r\n                // Webkit also support wheelDeltaX\r\n                originalEvent.wheelDeltaX && ( event.deltaX = - 1/40 * originalEvent.wheelDeltaX );\r\n            } else {\r\n                event.deltaY = originalEvent.detail;\r\n            }\r\n\r\n            // it's time to fire the callback\r\n            return callback( event );\r\n\r\n        }, useCapture || false );\r\n    }\r\n\r\n})(window, document);\r\n\r\n/**\r\n * Constructor\r\n * @param {HtmlElement} el\r\n * @param {Object} opts\r\n */\r\nvar Transformable = function (el, opts) {\r\n    opts = opts || {}\r\n    if (el.length)\r\n        el = el[0];\r\n    this.options = opts;\r\n    this.element = el;\r\n    this.element.classList.add('transformable');\r\n    this.parent = el.parentNode;\r\n\r\n    this.setInitialSizes();\r\n\r\n    if (opts && opts.matrix) {\r\n        var cscale = { x:1, y:1 }\r\n        if (opts.computedsize && (opts.computedsize.width || opts.computedsize.Width)) {\r\n            // TO DO: Explain and document this...\r\n            // we have a size to compare current computed size with\r\n            // translation is in local pixels, and depends on current size of element in local pixels\r\n            // if the current computed size is different, the translation will need \r\n            // to be scaled so relative size of elements look the same when drawn at some other size\r\n            var precs = {\r\n                width: opts.computedsize.width || opts.computedsize.Width,\r\n                height: opts.computedsize.height || opts.computedsize.Height\r\n            }\r\n            var curcs = this.sizes.element.initial;\r\n            cscale.x = curcs.width / precs.width;\r\n            cscale.y = curcs.height / precs.height;\r\n        }\r\n        if (opts.matrix instanceof Array && opts.matrix.length == 6) {\r\n            opts.matrix[4] *= cscale.x;\r\n            opts.matrix[5] *= cscale.y;\r\n            this._setMatrix(new Matrix(opts.matrix));\r\n        } else if (opts.matrix instanceof Matrix) {\r\n            opts.matrix.elements[4] *= cscale.x;\r\n            opts.matrix.elements[5] *= cscale.y;\r\n            this._setMatrix(opts.matrix);\r\n        }\r\n    }\r\n    this.matrix = this._getMatrix();\r\n    this.originalTransition = this._getOriginalTransition();\r\n    this.Ancestry = new Ancestry(this);\r\n\r\n    this._setOffset();\r\n\r\n    this.Ancestry._setoffset();\r\n\r\n    this.dragging = false; //\r\n    this.start = null;\r\n    this.orig = null;\r\n    this.zooma = 0.001; \r\n\r\n    this.events = { \r\n        start: opts.start,\r\n        move: opts.move,\r\n        stop: opts.stop,\r\n        tap: opts.tap,\r\n        transition: opts.transition\r\n    }\r\n\r\n    this.element.setAttribute('data-transformable-id', Transformable.Instance.push(this) - 1);\r\n    if(navigator.userAgent.indexOf('Edge') == -1)\r\n        this.element.setAttribute('draggable', false);\r\n\r\n    if ((typeof opts.attachevents == 'undefined' || opts.attachevents === true) && opts.editable !== false) {\r\n        this._addEvents();\r\n\r\n        if (opts.resize) \r\n            this.createResizeHandles(opts.resize);\r\n\r\n        if (!opts.disable || opts.disable && !opts.disable.rotate) \r\n            this.createRotateHandles();\r\n\r\n        if (opts.handle && opts.type == 'rotator-box') \r\n            this._addRotateEvents(opts.handle);\r\n    }\r\n}\r\n/**\r\n * A store/lookup of all transformable instances.\r\n * Each transformable element is given a data attribute for its id in this lookup.\r\n * E.g. data-transformable-id=\"0\"\r\n */\r\nTransformable.Instance = [];\r\n/**\r\n * Gets any existing CSS transition that exists on the element.\r\n * It will be merged with transition changes to preserve existing effects\r\n */\r\nTransformable.prototype._getOriginalTransition = function () {\r\n    var t = getComputedStyle(this.element)['transition'], sa = t.split(','), r = [];\r\n    for (var i in sa) {\r\n        if (sa[i].indexOf('transform ') == -1)\r\n            r.push(sa[i]);\r\n    }\r\n    return r.join(',');\r\n}\r\n/**\r\n * Creates an HTML Element from str \r\n * @param {String} str E.g. span, div etc\r\n */\r\nTransformable.prototype.tag = function (str) {\r\n    var r = document.createElement('div');\r\n    r.innerHTML = str;\r\n    return r.firstChild;\r\n}\r\n/**\r\n * Adds rotation handles on to the transformable element and wires up their events\r\n * @param {String} typ \r\n */\r\nTransformable.prototype.createRotateHandles = function (typ) {\r\n    if ((!typ || typ == 'rotate')) {\r\n        var box = this.tag('<div class=\"transformable-rotation-box\"></div>'),\r\n            rot = this.tag('<svg class=\"transformable-svg-rotator\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 96 96\" style=\"enable-background:new 0 0 96 96;\" xml:space=\"preserve\"><g><circle style=\"fill:#00A8DF;\" cx=\"48.3\" cy=\"48\" r=\"35.3\"/><g><path style=\"fill:#FFFFFF;\" d=\"M35.2,3.8l4.1,28.5c0.2,1.5,2,2.1,3,1l8.2-8.2c0.7-0.7,1.8-0.7,2.5,0l8.8,8.8c7.8,7.8,9.1,20.2,1.2,28.2l-10,10c-0.7,0.7-1.8,0.7-2.5,0L41,62.6c-1-1-2.8-0.4-3,1l-4.1,28.5c-0.2,1.2,0.8,2.2,2,2l28.5-4.1c1.5-0.2,2.1-2,1-3l-8.9-8.9c-0.7-0.7-0.7-1.8,0-2.5l10-10c9.8-9.8,8.5-25.6-1.2-35.2l-8.8-8.8c-0.7-0.7-0.7-1.8,0-2.5L66.7,8.9c1-1,0.4-2.8-1-3L37.2,1.8C36,1.6,35,2.6,35.2,3.8z\"/><g style=\"opacity:0.5;\"><path d=\"M36.9,1.8c0.1,0,0.2,0,0.3,0l28.5,4.1c1.5,0.2,2.1,2,1,3L56.6,19.1c-0.7,0.7-0.7,1.8,0,2.5l8.8,8.8c9.7,9.7,11,25.5,1.2,35.2l-10,10c-0.7,0.7-0.7,1.8,0,2.5l8.9,8.9c1,1,0.4,2.8-1,3l-28.5,4.1c-0.1,0-0.2,0-0.3,0c-1.1,0-1.9-1-1.8-2.1l4.1-28.5c0.1-1,0.9-1.5,1.8-1.5c0.4,0,0.9,0.2,1.3,0.5l9.5,9.5c0.4,0.4,0.8,0.5,1.3,0.5s0.9-0.2,1.3-0.5l10-10c8-8,6.7-20.3-1.2-28.2L53,25.2c-0.4-0.4-0.8-0.5-1.3-0.5s-0.9,0.2-1.3,0.5l-8.2,8.2c-0.4,0.4-0.8,0.5-1.3,0.5c-0.8,0-1.7-0.6-1.8-1.5L35.2,3.8C35,2.7,35.9,1.8,36.9,1.8 M36.9-0.2c-1.1,0-2.1,0.5-2.9,1.3c-0.7,0.8-1,1.9-0.9,3l4.1,28.5c0.3,1.9,1.9,3.3,3.8,3.3c1,0,2-0.4,2.7-1.1l8.1-8.1l8.7,8.7c7.4,7.4,8,18.6,1.2,25.3l-9.8,9.8l-9.3-9.3c-0.7-0.7-1.7-1.1-2.7-1.1c-1.9,0-3.5,1.4-3.8,3.3l-4.1,28.5c-0.2,1.1,0.2,2.2,0.9,3c0.7,0.8,1.8,1.3,2.9,1.3c0.2,0,0.4,0,0.5,0l28.5-4.1c1.4-0.2,2.6-1.2,3.1-2.6c0.5-1.4,0.1-2.9-0.9-3.9l-8.7-8.7l9.8-9.8c10.2-10.2,9.6-27.2-1.2-38.1l-8.7-8.7l10-10c1-1,1.4-2.5,0.9-3.9c-0.5-1.4-1.6-2.4-3.1-2.6L37.5-0.2C37.3-0.2,37.1-0.2,36.9-0.2L36.9-0.2z\"/></g></g></g></svg>'),\r\n            anc = this.tag('<svg class=\"transformable-svg-anchor\" version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 96 96\" style=\"enable-background:new 0 0 96 96;\" xml:space=\"preserve\"><g><circle style=\"fill:#00A8DF;\" cx=\"47.6\" cy=\"48.4\" r=\"17.6\"/><g><path style=\"fill:#FFFFFF;\" d=\"M69,46H50V27.2c0-1.4-1.1-2.4-2.5-2.4S45,25.9,45,27.2V46H26.6c-1.4,0-2.4,1.1-2.4,2.5s1.1,2.5,2.4,2.5H45v18.6c0,1.4,1.1,2.4,2.5,2.4s2.5-1.1,2.5-2.4V51h19c1.4,0,2.4-1.1,2.4-2.5S70.3,46,69,46z\"/><g style=\"opacity:0.5;\"><path d=\"M47.5,24.8c1.4,0,2.5,1.1,2.5,2.4V46h19c1.4,0,2.4,1.1,2.4,2.5c0,1.4-1.1,2.5-2.4,2.5H50v18.6c0,1.4-1.1,2.4-2.5,2.4S45,70.9,45,69.6V51H26.6c-1.4,0-2.4-1.1-2.4-2.5c0-1.4,1.1-2.5,2.4-2.5H45V27.2C45,25.9,46.1,24.8,47.5,24.8 M47.5,22.8c-2.5,0-4.5,2-4.5,4.4V44H26.6c-2.5,0-4.4,2-4.4,4.5c0,2.5,2,4.5,4.4,4.5H43v16.6c0,2.5,2,4.4,4.5,4.4s4.5-2,4.5-4.4V53h17c2.5,0,4.4-2,4.4-4.5c0-2.5-2-4.5-4.4-4.5H52V27.2C52,24.8,50,22.8,47.5,22.8L47.5,22.8z\"/></g></g></g></svg>'),\r\n            lin = this.tag('<div class=\"transformable-rotation-line\"></div>'),\r\n            that = this;\r\n\r\n\r\n        box.appendChild(lin);\r\n        box.appendChild(anc);\r\n        box.appendChild(rot);\r\n        box.appendChild(this.tag('<div class=\"transformable-anchor-point\"></div>'));\r\n\r\n        if(this.element.nodeName=='IMG')\r\n            this.parent.appendChild(box);\r\n        else\r\n            this.element.appendChild(box);\r\n\r\n        // stops clicks from parent elements, can't cancel clicks in a mouseup\r\n        box.addEventListener('click', function (e) { e.stopPropagation(); return false; });\r\n\r\n        this.rotatorBox = new Transformable(box, { type: 'rotator-box', rotatetarget: this, handle: rot, disable: { zoom: true, rotate: true, resize: true } });\r\n\r\n        var\r\n        _domouseup = function () {\r\n            if (that.rotatorBox)\r\n                if(that.rotatorBox.parent)\r\n                    that.rotatorBox.parent.classList.remove('transformable-mousedown');\r\n\r\n            var body = document.querySelector('body');\r\n            that.off(body, 'mouseup.rotatormouse')\r\n        },\r\n        _domousedown = function () {\r\n            this.classList.add('transformable-mousedown');\r\n            var body = document.querySelector('body');\r\n            that.on(body, 'mouseup.rotatormouse', _domouseup)\r\n        },\r\n        _domouseleave = function () {\r\n            if (that._overTimer)\r\n                clearTimeout(that._overTimer);\r\n\r\n            //var rb;\r\n            //if (rb = that.rotatorBox) {\r\n            //    rb.translate(8000, 0, false);\r\n            //}\r\n            that._resizeTimer = setTimeout(function () {\r\n                that.element.classList.remove('transformable-resize-over');\r\n            }, 500);\r\n\r\n            this.classList.remove('transformable-over-active');\r\n            this.classList.remove('transformable-over');\r\n        },\r\n        _domouseenter = function (tim) {\r\n            if (tim.stopPropagation)\r\n                tim.stopPropagation();\r\n\r\n            if (that._resizeTimer)\r\n                clearTimeout(that._resizeTimer);\r\n\r\n            this.classList.add('transformable-over');\r\n            this.classList.add('transformable-resize-over');\r\n\r\n            that.Ancestry.Items.forEach(function (v, i) {\r\n                if (v._overTimer)\r\n                    clearTimeout(v._overTimer);\r\n            });\r\n\r\n            that._overTimer = setTimeout(function () {\r\n                var\r\n                    rb = that.rotatorBox,\r\n                    anc = rb.Ancestry, \r\n                    pt = anc.FirstParent(), \r\n                    ds = 1;\r\n                /*\r\n                 * trying to scale the handles displayed inside the transformable element\r\n                 * so they dont look huge when a parent element is scaled \r\n                 * abandoned - not really working as I wanted\r\n                 * \r\n                if (pt)\r\n                    ds = 1 / pt.matrix.scaling();\r\n\r\n                if (rb) {\r\n                    var tsc = rb.matrix.scaling(); \r\n                    if (rb.dragging || rb.draggingrotate)\r\n                        return;\r\n\r\n                    rb.scale(new Point(0), ds * (1/tsc), false);\r\n                }\r\n                if (tlb && brb)\r\n                {\r\n                    tlb.style.transform = 'scale(' + ds + ')';\r\n                    brb.style.transform = 'scale(' + ds + ')';\r\n                }\r\n                */\r\n                if(parseFloat(getComputedStyle(rb.element).width) >= 32)\r\n                    rb.parent.classList.add('transformable-over-active');\r\n\r\n                var l = anc.Items.length;\r\n                anc.Items.forEach(function (v, i) {\r\n                    if (i < l-2) {\r\n                        v.element.classList.remove('transformable-over-active');\r\n                    }\r\n                })\r\n\r\n            }, typeof(tim) == 'number' ? tim : 1500);\r\n\r\n        };\r\n\r\n        var rotparent = this.rotatorBox.parent;\r\n\r\n        this.on(rotparent, 'mouseenter.rotatormouse', _domouseenter);\r\n        this.on(rotparent, 'mouseleave.rotatormouse', _domouseleave);\r\n        this.on(rotparent, 'mousedown.rotatormouse', _domousedown);\r\n        this.on(rotparent, 'click.rotatormouse', function () { _domouseenter.apply(this, [0]); });\r\n    }\r\n}\r\n/**\r\n * Creates resize handles on the transformable element and wires up their events\r\n * @param {String} typ\r\n */\r\nTransformable.prototype.createResizeHandles = function (typ) {\r\n    // hard coded svg elements. Sorry\r\n    if (typ == 'tl-br') {\r\n        var\r\n            tl = this.tag('<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"-271 394.9 52 52\" style=\"enable-background:new -271 394.9 52 52;\" xml:space=\"preserve\"><g><path style=\"fill:#00A8DF;\" d=\"M-244.9,421L-244.9,421L-244.9,421L-244.9,421L-244.9,421l26,0.1c0-10.8-6.1-20-16-24.1 c-10-4.1-20.8-2-28.4,5.7c-7.6,7.6-9.7,18.5-5.6,28.4c4.2,10,13.4,16,24.2,15.9L-244.9,421z\"/><path style=\"fill:none;stroke:#FFFFFF;stroke-width:3;\" d=\"M-251.6,414.3\"/><path style=\"fill:none;stroke:#FFFFFF;stroke-width:3;\" d=\"M-236.6,414.3\"/></g><g><path style=\"fill:#FFFFFF;\" d=\"M-227,419.5l-7.6-4.4c-1.1-0.6-2.4,0.2-2.4,1.4v1.9h-5.6v-5.5h2c1.2,0,2-1.3,1.4-2.4l-4.4-7.6 c-0.6-1.1-2.1-1.1-2.7,0l-4.4,7.6c-0.6,1.1,0.2,2.4,1.4,2.4h2v5.5h-5.6v-1.9c0-1.2-1.3-2-2.4-1.4l-7.6,4.4c-1.1,0.6-1.1,2.1,0,2.7 l7.6,4.4c1.1,0.6,2.4-0.2,2.4-1.4v-2h5.6v5.6h-2c-1.2,0-2,1.3-1.4,2.4l4.4,7.6c0.6,1.1,2.1,1.1,2.7,0l4.4-7.6 c0.6-1.1-0.2-2.4-1.4-2.4h-2v-5.6h5.6v2c0,1.2,1.3,2,2.4,1.4l7.6-4.4C-225.9,421.7-225.9,420.1-227,419.5z\"/><path style=\"opacity:0.5;fill:#231F20;\" d=\"M-245,402.1c0.5,0,1.1,0.3,1.4,0.8l4.4,7.6c0.6,1.1-0.2,2.4-1.4,2.4h-2v5.5h5.6v-1.9 c0-0.9,0.8-1.6,1.6-1.6c0.3,0,0.5,0.1,0.8,0.2l7.6,4.4c1.1,0.6,1.1,2.1,0,2.7l-7.6,4.4c-0.3,0.1-0.5,0.2-0.8,0.2 c-0.8,0-1.6-0.7-1.6-1.6v-2h-5.6v5.6h2c1.2,0,2,1.3,1.4,2.4l-4.4,7.6c-0.3,0.5-0.8,0.8-1.4,0.8c-0.5,0-1.1-0.3-1.4-0.8l-4.4-7.6 c-0.6-1.1,0.2-2.4,1.4-2.4h2v-5.6h-5.6v2c0,0.9-0.8,1.6-1.6,1.6c-0.3,0-0.5-0.1-0.8-0.2l-7.6-4.4c-1.1-0.6-1.1-2.1,0-2.7l7.6-4.4 c0.3-0.1,0.5-0.2,0.8-0.2c0.8,0,1.6,0.7,1.6,1.6v1.9h5.6v-5.5h-2c-1.2,0-2-1.3-1.4-2.4l4.4-7.6C-246.1,402.3-245.5,402.1-245,402.1 M-245,400.6c-1.1,0-2.1,0.6-2.6,1.5l-4.4,7.6c-0.5,0.9-0.5,2.1,0,3c0.5,0.9,1.5,1.5,2.6,1.5h0.5v2.7h-2.7v-0.5c0-1.7-1.4-3-3-3 c-0.5,0-1,0.1-1.5,0.4l-7.6,4.4c-0.9,0.5-1.5,1.5-1.5,2.6c0,1.1,0.6,2.1,1.5,2.6l7.6,4.4c0.5,0.3,1,0.4,1.5,0.4c1.7,0,3-1.4,3-3\tv-0.6h2.7v2.8h-0.5c-1.1,0-2.1,0.6-2.6,1.5c-0.5,0.9-0.5,2.1,0,3l4.4,7.6c0.5,0.9,1.5,1.5,2.6,1.5c1.1,0,2.1-0.6,2.6-1.5l4.4-7.6 c0.5-0.9,0.5-2.1,0-3c-0.5-0.9-1.5-1.5-2.6-1.5h-0.5v-2.8h2.7v0.6c0,1.7,1.4,3,3,3c0.5,0,1-0.1,1.5-0.4l7.6-4.4\tc0.9-0.5,1.5-1.5,1.5-2.6c0-1.1-0.6-2.1-1.5-2.6l-7.6-4.4c-0.5-0.3-1-0.4-1.5-0.4c-1.7,0-3,1.4-3,3v0.5h-2.7v-2.7h0.5\tc1.1,0,2.1-0.6,2.6-1.5c0.5-0.9,0.5-2.1,0-3l-4.4-7.6C-242.9,401.2-243.9,400.6-245,400.6L-245,400.6z\"/></g></svg>'),\r\n            br = this.tag('<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"-271 394.9 52 52\" style=\"enable-background:new -271 394.9 52 52;\" xml:space=\"preserve\"><g><path style=\"fill:#00A8DF;\" d=\"M-245,420.9L-245,420.9L-245,420.9L-245,420.9L-245,420.9l-26-0.1c0,10.8,6.1,20,16,24.1 c10,4.1,20.8,2,28.4-5.7c7.6-7.6,9.7-18.5,5.6-28.4c-4.2-10-13.4-16-24.2-15.9L-245,420.9z\"/></g><g><path style=\"fill:#FFFFFF;\" d=\"M-245.8,423l-2.5-2.5l-2.1,2.1c-0.9,0.9-2.3,0.5-2.6-0.7l-1.6-9.2c-0.3-1.2,0.8-2.3,1.9-1.9l9.2,1.6 c1.2,0.3,1.6,1.8,0.7,2.6l-2.1,2.1l2.5,2.5l2.7,2.7l-1-1l2.1-2.1c0.9-0.9,2.3-0.5,2.6,0.7l1.6,9.2c0.3,1.2-0.8,2.3-1.9,1.9 l-9.2-1.6c-1.2-0.3-1.6-1.8-0.7-2.6l2.1-2.1l-3.2-3.2L-245.8,423z\"/><path style=\"opacity:0.5;fill:#231F20;\" d=\"M-239.6,422.3l-1-1l2.1-2.1c0.7-0.7,1.7-0.6,2.2,0c0.2,0.2,0.3,0.4,0.4,0.7l1.6,9.2 c0.3,1.2-0.8,2.3-1.9,1.9l-9.2-1.6c-0.3-0.1-0.5-0.2-0.7-0.4c-0.6-0.6-0.7-1.6,0-2.2l2.1-2.1l-3.2-3.2l1.5,1.5l-2.5-2.5l-2.1,2.1 c-0.7,0.7-1.7,0.6-2.2,0c-0.2-0.2-0.3-0.4-0.4-0.7l-1.6-9.2c-0.3-1.2,0.8-2.3,1.9-1.9l9.2,1.6c0.3,0.1,0.5,0.2,0.7,0.4 c0.6,0.6,0.7,1.6,0,2.2l-2.1,2.1l2.5,2.5L-239.6,422.3z M-242.3,417.5l-0.5-0.5l1-1c1.2-1.2,1.2-3.1,0-4.3 c-0.4-0.4-0.8-0.6-1.4-0.8l-9.2-1.6c-1.1-0.3-2.1,0-2.9,0.8c-0.8,0.8-1.1,1.9-0.8,2.9l1.6,9.2c0.1,0.5,0.4,1,0.8,1.4 c1.2,1.2,3.1,1.2,4.3,0l1.1-1.1l0.5,0.5l0.5,0.5l1.2,1.2l-1.1,1.1c-1.2,1.2-1.2,3.1,0,4.3c0.4,0.4,0.8,0.6,1.4,0.8l9.2,1.6 c1.1,0.3,2.1,0,2.9-0.8c0.8-0.8,1.1-1.9,0.8-2.9l-1.6-9.2c-0.1-0.5-0.4-1-0.8-1.4c-1.2-1.2-3.1-1.2-4.3,0l-1,1l-1.2-1.2\"/></g></svg>');\r\n        var\r\n            tlb = this.tag('<div class=\"transformable-resize-button\"></div>'),\r\n            brb = tlb.cloneNode();\r\n\r\n        tlb.classList.add('tl');\r\n        tlb.appendChild(tl);\r\n        brb.classList.add('br');\r\n        brb.appendChild(br);\r\n\r\n        this.resizertl = tlb;\r\n        this.resizerbr = brb;\r\n\r\n        this.element.appendChild(tlb);\r\n        this.element.appendChild(brb);\r\n        this._addResizeEvents(tlb, brb);\r\n    }\r\n}\r\n/**\r\n * Zooms the element centred on the middle of the parent element in increments of 5%.\r\n * @param {Number} dir positive numbers make it bigger, negative make it smaller\r\n */\r\nTransformable.prototype.zoom = function (dir) {\r\n    var offset = this.Ancestry.OffsetFromPoint(this._findCentreInWindow());\r\n    this.scale(offset, 1 + dir * 0.05);\r\n\r\n    return this;\r\n}\r\n/**\r\n * Scales the transformable element at point p by s amount\r\n * @param {Point} p Origin for the transform on the element\r\n * @param {any} s scale amount\r\n */\r\nTransformable.prototype.scale = function (p, s) {\r\n    this.matrix.scale(p, s);\r\n    this.setTransition(true);\r\n    this._updateElement();\r\n    //this.trigger('stop');\r\n    return this;\r\n}\r\n/**\r\n * Translates the element by x and y. Uses element pixels before any transform. Not window/screen pixels.\r\n * @param {Number} x Pixels horizontal\r\n * @param {Number} y Pixels vertical\r\n * @param {Boolean} transition Use a transition\r\n */\r\nTransformable.prototype.translate = function (x,y, transition) {\r\n    this.matrix.translate(x, y);\r\n    this.setTransition(transition);\r\n    this._updateElement();\r\n    return this;\r\n}\r\n/**\r\n * Rotates the element about point p. Or about the centre of the element if p is not supplied. \r\n * If inwindow==true, you can supply a Point in the window coordinate space and have the element rotate about that.\r\n * @param {Point} p The origin of the rotation in pixels on the element. When inwindow == false or undefined\r\n * @param {Number} a Angle in degrees\r\n * @param {Boolean} trans Optional: Specify if a transition should be used\r\n * @param {Boolean} inwindow Optional: If true, p should be treated like a window coordinate. \r\n */\r\nTransformable.prototype.rotate = function (p, a, trans, inwindow) {\r\n    if (!(p instanceof Point) || !p || typeof p == 'undefined') \r\n        p = this.Ancestry.OffsetFromPoint(this._findCentreInWindow());\r\n\r\n    if (p instanceof Point && inwindow)\r\n        p = this.Ancestry.OffsetFromPoint(p);\r\n\r\n    this.matrix.rotate(p, a);\r\n    this.lastrotationpoint = p;\r\n    if (typeof trans == 'undefined' || trans === false)\r\n        this.setTransition(false);\r\n\r\n    this._updateElement();\r\n    return this;\r\n}\r\n/**\r\n * Makes a rotated element horizontal.\r\n */\r\nTransformable.prototype.straighten = function () {\r\n    var r = this.matrix.rotation();\r\n    this.rotate(new Point(this.sizes.element.initial.width / 2, this.sizes.element.initial.height / 2), -r, true);\r\n    return this;\r\n}\r\n/**\r\n * Scales the element to make the element's height or width match that of the parent element. Centres it and straightens out any rotation. \r\n */\r\nTransformable.prototype.fittoparent = function () {\r\n    var sz = new Point(this.sizes.element.initial.width, this.sizes.element.initial.height),\r\n        anc = this.Ancestry,\r\n        pars = anc.GetParents(),\r\n        parentT = anc.FirstParent(),\r\n        pr = parentT.rect,\r\n        m = this.matrix.inverse(),\r\n        tl = m.transformpoint(pr.topleft),\r\n        tr = m.transformpoint(pr.topright),\r\n        bl = m.transformpoint(pr.bottomleft),\r\n        br = m.transformpoint(pr.bottomright),\r\n        psiz = new Point(this._distanceBetweenPoints(tl, tr), this._distanceBetweenPoints(tl, bl));\r\n\r\n    var sc = psiz.divide(sz), scale = Math.min(sc.x, sc.y);\r\n    this.scale(new Point(0, 0), scale);\r\n    this.centreinparent(true, pars);\r\n    this.straighten();\r\n\r\n    return this;\r\n}\r\n/**\r\n * Scales the element so its width and height is equal or greater than the parent element. \r\n * Basically so you can't see any background in the parent element. Also centres and straightens it.\r\n */\r\nTransformable.prototype.filltoparent = function () {\r\n    var sz = new Point(this.sizes.element.initial.width, this.sizes.element.initial.height),\r\n    anc = this.Ancestry,\r\n    pars = anc.GetParents(),\r\n    parentT = anc.FirstParent(),\r\n    pr = parentT.rect,\r\n    m = this.matrix.inverse(),\r\n    tl = m.transformpoint(pr.topleft),\r\n    tr = m.transformpoint(pr.topright),\r\n    bl = m.transformpoint(pr.bottomleft),\r\n    br = m.transformpoint(pr.bottomright),\r\n    psiz = new Point(this._distanceBetweenPoints(tl, tr), this._distanceBetweenPoints(tl, bl));\r\n\r\n    var sc = psiz.divide(sz),\r\n        scale = Math.max(sc.x, sc.y);\r\n    \r\n    this.scale(new Point(0, 0), scale);\r\n    this.centreinparent(true, pars);\r\n    this.straighten();\r\n\r\n    return this;\r\n}\r\n/**\r\n * Gets the boundingClientRect for supplied element.\r\n * @param {HtmlElement} el\r\n */\r\nTransformable.prototype._getRect = function (el) {\r\n    return el.getBoundingClientRect();\r\n}\r\n/**\r\n * Resets the transformation to its starting value. Undoing all changes since instantiation.\r\n * @param {Boolean} trans Specify if a transition should be used\r\n */\r\nTransformable.prototype.reset = function (trans) {\r\n    if (!this.InitialMatrix)\r\n        this.matrix.reset();\r\n    else\r\n        this.matrix.elements = this.InitialMatrix.slice(0);\r\n\r\n    // unsupported!\r\n    //this.off(this.element, 'transitionstart.reset');\r\n\r\n    this.setTransition(typeof trans == 'undefined' ? true : trans);\r\n    if (this.transition) {\r\n        var that = this;\r\n\r\n        if (this.delta && (this.delta.x || this.delta.y)) { // has moved so will transition\r\n            this.element.classList.add('transformable-reset');\r\n            this.on(this.element, 'transitionend.reset', function () {\r\n                this.classList.remove('transformable-reset');\r\n                that.off(this, 'transitionend.reset');\r\n            });\r\n        }\r\n        // unsupported !\r\n        //this.on(this.element, 'transitionstart.reset', function () {\r\n        //    this.classList.add('transformable-reset');\r\n        //    that.off(this, 'transitionstart.reset');\r\n        //});\r\n    }\r\n    this._updateElement();\r\n    return this;\r\n}\r\n/**\r\n * Returns true if the undo stack contains a saved state named k\r\n * @param {String} k\r\n */\r\nTransformable.prototype.hasHistoryKey = function (k) {\r\n    return this.matrix.history.undo[k] instanceof Array;\r\n}\r\n/**\r\n * Undo the last transformation or go back to a named state.\r\n * @param {String} k Optional: the name of a saved state to go back to\r\n */\r\nTransformable.prototype.undo = function (k) {\r\n    this.matrix.undo(k);\r\n    this.setTransition(true);\r\n    this._updateElement();\r\n    return this;\r\n}\r\n\r\n/**\r\n * Redo the last thing that was undone.\r\n */\r\nTransformable.prototype.redo = function () {\r\n    this.matrix.redo();\r\n    this.setTransition(true);\r\n    this._updateElement();\r\n    return this;\r\n}\r\n\r\n/**\r\n * Sets initial sizes and positions of the element and window\r\n */\r\nTransformable.prototype.setInitialSizes = function () {\r\n    if (this.sizes) return;\r\n    var\r\n        cs = window.getComputedStyle(this.element),\r\n        w = parseFloat(cs.width),\r\n        h = parseFloat(cs.height),\r\n        l = parseFloat(cs.left),\r\n        t = parseFloat(cs.top); //,\r\n    \r\n    this.sizes = {\r\n        element: {\r\n            initial: {\r\n                offset: new Point(l, t),\r\n                width: w,\r\n                height: h,\r\n                topleft: new Point(0, 0),\r\n                topright: new Point(w, 0),\r\n                bottomright: new Point(w, h),\r\n                bottomleft: new Point(0, h)\r\n            }\r\n        },\r\n        window: { width: parseFloat(getComputedStyle(document.body.parentNode).width) }\r\n    }\r\n}\r\n\r\n/**\r\n * Gets the offset of an element taking in to account scroll position of the window\r\n * @param {HtmlElement} el Element to check\r\n */\r\nTransformable.prototype._getOffset = function (el) {\r\n    var cr = this._getRect(el), scroll = this.Ancestry._getScroll(); \r\n    \r\n    var cs = getComputedStyle(el),\r\n        pos = new Point(parseFloat(cs.left), parseFloat(cs.top)),\r\n        os = new Point(cr.left + scroll.x, cr.top + scroll.y),\r\n        br = new Point(cr.right, cr.bottom),\r\n        tr = new Point(cr.right, cr.top),\r\n        bl = new Point(cr.left, cr.bottom);\r\n\r\n    return { offset: os, topleft: os, bottomright: br, topright: tr, bottomleft: bl, pos: pos  };\r\n}\r\n\r\n/**\r\n * Sets the initial offset.  \r\n */\r\nTransformable.prototype._setOffset = function () {\r\n    // first init \r\n    if (!this.offset) {\r\n        var too = this._getOffset(this.element, true); \r\n\r\n        this.offset = too.offset;\r\n        this.initialoffset = too.offset;\r\n        return;\r\n    }\r\n}\r\n\r\n/**\r\n * Convert a string representation of a CSS transformation matrix in to an Array\r\n * @param {String} t The CSS transformation\r\n */\r\nTransformable.prototype._cssStringToArray = function (t) {\r\n    var m = t.match(/[0-9e., -]+/)[0].split(\", \");\r\n    m.forEach(function (v,i) {\r\n        m[i] = parseFloat(v);\r\n    });\r\n    return m;\r\n}\r\n\r\n/**\r\n * Converts a 6 element Array in to a CSS transformation string.\r\n * @param {Array} a \r\n */\r\nTransformable.prototype._arrayToCssString = function (a) {\r\n    return 'matrix(' + a.join(',') + ')'\r\n}\r\n\r\n/**\r\n * Creates a Matrix for the transformable element. \r\n * Cancels out any CSS that affects the offset or position of the element and converts to an equivalent CSS transformation matrix.\r\n * @param {HtmlElement} el\r\n */\r\nTransformable.prototype._getMatrix = function (el) {\r\n    var elem = el || this.element,\r\n        cs = getComputedStyle(elem),\r\n        pcs = getComputedStyle(this.parent),\r\n        t = cs.transform,\r\n        top = cs.top.indexOf('%') > -1 ? parseFloat(pcs.height)*parseFloat(cs.top)/100 : parseFloat(cs.top), // ios safari bug\r\n        left = cs.left.indexOf('%') > -1 ? parseFloat(pcs.width)*parseFloat(cs.left)/100 : parseFloat(cs.left), // ios safari bug\r\n        margintop = parseFloat(cs.marginTop),\r\n        marginleft = parseFloat(cs.marginLeft),\r\n        bordertop = parseFloat(cs.borderTopWidth),\r\n        borderleft = parseFloat(cs.borderLeftWidth),\r\n        m, hasone = /matrix\\(\\-?[0-9]+[^\\)]+\\)/.test(t);\r\n\r\n    if (hasone) {\r\n        var m = this._cssStringToArray(t);\r\n        if (!this.InitialMatrix)\r\n            this.InitialMatrix = m.slice(0);\r\n    }\r\n    m = new Matrix(m || [1, 0, 0, 1, 0, 0]);\r\n    var isrb = this.options.type == 'rotator-box';\r\n    if (left || top || margintop || marginleft || bordertop || borderleft) {\r\n        m.translate(left || 0, top || 0);\r\n        m.translate(marginleft || 0, margintop || 0);\r\n        m.translate(borderleft || 0, bordertop || 0);\r\n        elem.style.marginTop = 0;\r\n        elem.style.marginLeft = 0;\r\n        elem.style.top = 0;\r\n        elem.style.left = 0;\r\n        elem.style.marginTop = (-(bordertop || 0)) + 'px';\r\n        elem.style.marginLeft = (-(bordertop || 0)) + 'px';\r\n\r\n        this.matrix = m;\r\n        this._updateElement();\r\n\r\n        this.InitialMatrix = m.elements.slice(0);\r\n    }\r\n    return m;\r\n}\r\n\r\n/**\r\n * Sets the transition to use for transforms. \r\n * Retains any existing transition originally set by CSS\r\n * @param {Boolean} bool If true will use a transition\r\n */\r\nTransformable.prototype.setTransition = function (bool) {\r\n    if(typeof bool == 'boolean') {\r\n        var was = this.transition,\r\n            cur = this.originalTransition,\r\n            spl = cur ? cur.split(','): [];\r\n\r\n        if(bool == true) {\r\n            if (was != bool) {\r\n                spl.push('transform 0.5s');\r\n                this.element.style.transition = spl.join(',');\r\n            }\r\n        } \r\n        if(bool == false) {\r\n            if (was != bool) {\r\n                spl.push('transform 0s');\r\n                this.element.style.transition = spl.join(',');\r\n            }\r\n        } \r\n        this.transition = bool;\r\n    }\r\n}\r\n\r\n/**\r\n * Sets the CSS transform on the element.\r\n */\r\nTransformable.prototype._updateElement = function () {\r\n    var m = this.matrix, mtx = 'matrix(' + m.elements.join(',') + ')';\r\n\r\n    this.element.style.transform = mtx;\r\n}\r\n\r\n/**\r\n * Adds the current matrix to the undo stack.\r\n */\r\nTransformable.prototype._pushhistory = function () {\r\n    this.matrix.save();\r\n}\r\n\r\n/**\r\n * Sets the matrix property on this instance and applies the CSS.\r\n * @param {Matrix} m\r\n */\r\nTransformable.prototype._setMatrix = function (m) {\r\n    this.matrix = m;\r\n    this._updateElement(m);\r\n}\r\n\r\n/**\r\n * Gets the window coordinates of a mouse or touch event.\r\n * Also gets the angle and centre point between two touches\r\n * \r\n * @param {Event} e\r\n * @param {Array} touches\r\n */\r\nTransformable.prototype._getPageXY = function (e, touches) {\r\n    var xy, ang, p1, p2;\r\n    if (touches)\r\n        if (touches.length == 2) {\r\n            xy = this._getMiddle(touches);\r\n            ang = this._getRotation(touches);\r\n            p1 = new Point(touches[0].pageX, touches[0].pageY);\r\n            p2 = new Point(touches[1].pageX, touches[1].pageY);\r\n        }\r\n        else {\r\n            xy = (new Point(touches[0].pageX, touches[0].pageY));\r\n            ang = this.matrix.rotation();\r\n        }\r\n    else {\r\n        xy = (new Point(e.pageX, e.pageY));\r\n        ang = this.matrix.rotation();\r\n    }\r\n    return {\r\n        point: xy,\r\n        angle: ang,\r\n        p1: p1,\r\n        p2: p2\r\n    };\r\n}\r\n\r\n/**\r\n * Gets offset (point in element coordinate space), \r\n * window coordinates of the event and angle, distance and centre between two touches.\r\n * @param {Event} e\r\n * @param {Array} touches\r\n */\r\nTransformable.prototype._getPoint2 = function (e, touches) {\r\n    var\r\n        dat = this._getPageXY(e, touches), deltaXY = null,\r\n        anc = this.Ancestry,\r\n        pars = anc.GetParents(),\r\n        op = anc.OffsetFromPoint(dat.point, pars),\r\n        dist = dat.p1 && dat.p2 ?\r\n            this._distanceBetweenPoints(\r\n                anc.OffsetFromPoint(dat.p1, pars),\r\n                anc.OffsetFromPoint(dat.p2, pars)\r\n            ) : 0;\r\n\r\n    if (typeof(e.deltaX) != 'undefined')\r\n        deltaXY = new Point(e.deltaX, e.deltaY);\r\n     \r\n    return {\r\n        offset: op, \r\n        pageXY: dat.point,\r\n        pageX: dat.point.x,\r\n        pageY: dat.point.y,\r\n        angle: dat.angle,\r\n        distance: dist,\r\n        deltaXY: deltaXY\r\n    };  \r\n}\r\n\r\n/**\r\n * Calculates the distance between two points\r\n * @param {Point} a First point\r\n * @param {Point} b Second point\r\n */\r\nTransformable.prototype._distanceBetweenPoints = function (a, b) {\r\n    var prop = a.pageX ? {x:'pageX', y:'pageX'} : {x:'x', y:'y'}\r\n    return Math.sqrt(Math.pow(Math.abs(b[prop.x] - a[prop.x]), 2) + Math.pow(Math.abs(b[prop.y] - a[prop.y]), 2));\r\n}\r\n\r\n/**\r\n * Gets the centre point between two touches\r\n * @param {Array} touches\r\n */\r\nTransformable.prototype._getMiddle = function (touches) {\r\n    var touch1 = touches[0];\r\n    var touch2 = touches[1];\r\n    var mx = ((touch2.pageX - touch1.pageX) / 2) + touch1.pageX;\r\n    var my = ((touch2.pageY - touch1.pageY) / 2) + touch1.pageY;\r\n\r\n    return new Point(mx, my);\r\n};\r\n\r\n/**\r\n * Gets distance between two touch points (in the window) relative to the element.\r\n * @param {Array} touches\r\n * @param {Array} pars\r\n */\r\nTransformable.prototype._getDistance2 = function (touches, pars) {\r\n    var anc = this.Ancestry;\r\n    pars = pars || anc.GetParents();\r\n    var t1 = anc.OffsetFromPoint(new Point(touches[0].pageX, touches[0].pageY), pars);\r\n    var t2 = anc.OffsetFromPoint(new Point(touches[1].pageX, touches[1].pageY), pars);\r\n\r\n    return this._distanceBetweenPoints(t1, t2);\r\n}\r\n\r\n/**\r\n * Gets the angle in degrees between two touch points\r\n * @param {Array} touches\r\n * @param {Boolean} norm Optional: Normalise to be 0-365 degrees\r\n */\r\nTransformable.prototype._getRotation = function (touches, norm) {\r\n    var r;\r\n\r\n    r = Math.atan2((touches[0].pageY||touches[0].y) - (touches[1].pageY||touches[1].y), (touches[0].pageX||touches[0].x) - (touches[1].pageX||touches[1].x)) *180 / Math.PI;\r\n\r\n    return norm ? this.matrix.normaldegree(r) : r;\r\n};\r\n\r\n/**\r\n * Snaps the rotation to a multiple of 15 degrees if within 3 degrees of a multiple of 15 degrees.\r\n */\r\nTransformable.prototype.snapRotation = function () {\r\n    if (this.options.disable && this.options.disable.rotate)\r\n        return;\r\n\r\n    var r = this.matrix.rotation(), m = r-(15*Math.round(r/15)), am = Math.abs(m), siz = this.sizes.element.initial;\r\n    this.setTransition(true);\r\n\r\n    if (am <= 3 && am > 0) {\r\n        var pt = this.lastrotationpoint || new Point(siz.width / 2, siz.height / 2);\r\n        this.rotate(pt, -m);\r\n        this.lastlastrotationpoint = undefined;\r\n        this._pushhistory();\r\n    }\r\n    var msg;\r\n    r = this.matrix.rotation();\r\n    switch (Math.abs(Math.round(r*10)/10)) {\r\n        case 0:\r\n        case 180:\r\n            msg = 'Horizontal';\r\n            break;\r\n        case 90:\r\n            msg = 'Vertical';\r\n            break;\r\n        default:\r\n            msg = 'Rotation: ' + (Math.round(r*10)/10) + '&deg;';\r\n    }\r\n    this.showMessage(msg, 'sticky', 2000);\r\n}\r\n\r\n/**\r\n * Writes info to the console\r\n * @param {String} m\r\n * @param {any} c Not implemented\r\n * @param {any} t Not implemented\r\n */\r\nTransformable.prototype.showMessage = function (m, c, t) {\r\n    console.log(m);\r\n}\r\n\r\n/**\r\n * Gets the centre point of the element in window coordinates\r\n */\r\nTransformable.prototype._findCentreInWindow = function () {\r\n    var prect = this._getRect(this.parent);\r\n    return new Point(prect.left + prect.width / 2, prect.top + prect.height / 2);\r\n}\r\n\r\n/**\r\n * Centres the element in the middle of its parent element\r\n * @param {Bool} transition Optional\r\n * @param {Array} pars Optional but should always be supplied\r\n */\r\nTransformable.prototype.centreinparent = function (transition, pars) {\r\n\r\n    var was = this.transition, anc = this.Ancestry;\r\n    this.setTransition(transition);\r\n\r\n    pars = pars || anc.GetParents();\r\n\r\n    var pcs = getComputedStyle(this.parent), parentCentre = new Point(parseFloat(pcs.width) / 2, parseFloat(pcs.height) / 2);\r\n    var centreOnThis = this.matrix.inverse().transformpoint(parentCentre);\r\n\r\n    this.translate( centreOnThis.sub(new Point(this.sizes.element.initial.width / 2, this.sizes.element.initial.height / 2)));\r\n    this.setTransition(was);\r\n}\r\n\r\n/**\r\n * Find out if point p is within the rectangle defined by points a,b,c,d\r\n * @param {Point} p\r\n * @param {Point} a\r\n * @param {Point} b\r\n * @param {Point} c\r\n * @param {Point} d\r\n */\r\nTransformable.prototype.pointInRectangle = function(p, a, b, c, d) {\r\n    var ab = b.sub(a),\r\n        ap = p.sub(a),\r\n        bc = c.sub(b),\r\n        bp = p.sub(b),\r\n        dot_abap = ab.dot(ap),\r\n        dot_abab = ab.dot(ab),\r\n        dot_bcbp = bc.dot(bp),\r\n        dot_bcbc = bc.dot(bc);\r\n\r\n    var r = {\r\n        dot_abap: dot_abap,\r\n        dot_abab: dot_abab,\r\n        dot_bcbp: dot_bcbp,\r\n        dot_bcbc: dot_bcbc,\r\n        ok: 0 <= dot_abap && (Math.round(dot_abap * 10) / 10) <= (Math.round(dot_abab * 10) / 10) && 0 <= dot_bcbp && (Math.round(dot_bcbp*10)/10) <= (Math.round(dot_bcbc*10)/10)\r\n    };\r\n\r\n    return r;\r\n}\r\n\r\n/**\r\n * Triggers an event named n. \r\n * In the handler, this will refer to the Transformable instance.\r\n * The handler will receive the transformable element as first argument and a real event object as the second argument.\r\n * @param {String} n\r\n * @param {Event} event Pass in a real event object if you have one\r\n */\r\nTransformable.prototype.trigger = function (n, event) {\r\n    if (typeof this.events[n] == \"function\")\r\n        this.events[n].apply(this, [this.element, event]);\r\n}\r\n\r\n/**\r\n * Gets the points data needed to make rotation handles work\r\n * @param {Event} e\r\n * @param {Array} pars\r\n */\r\nTransformable.prototype._getRotatorPoints = function (e, pars) {\r\n    var rpoint,\r\n        apoint = this.anchor.TL,\r\n        touches = e.touches,\r\n        anc = this.Ancestry;\r\n\r\n    pars = pars || anc.GetParents();\r\n\r\n    anc._setoffset();\r\n\r\n    if (touches)\r\n        rpoint = (new Point(touches[0].pageX, touches[0].pageY));\r\n    else\r\n        rpoint = (new Point(e.pageX, e.pageY));\r\n\r\n    var angle = Math.round(this._getRotation([apoint.add(anc.scroll), rpoint], false) * 100)/100; //,\r\n\r\n    return {\r\n        deltaXY: null,\r\n        offset: anc.OffsetFromPoint(rpoint, pars), \r\n        pageXY: rpoint,\r\n        pageX: rpoint.x ,\r\n        pageY: rpoint.y,\r\n        angle: angle,\r\n        distance: 0\r\n   }; \r\n}\r\n\r\n/**\r\n * Attaches events for rotation interactions with rotation handles\r\n * @param {HtmlElement} hdl The element to use as a rotation handle\r\n */\r\nTransformable.prototype._addRotateEvents = function (hdl) {\r\n    var that = this, handle = hdl;\r\n    var\r\n        _domove = function (e) {\r\n            if (!that.startedrotate) return false;\r\n            that.draggingrotate = true;\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            var touches = e.touches, doupdate = false;\r\n\r\n            if (touches)\r\n                if (touches.length == 2)\r\n                    return false\r\n\r\n            var point = that._getRotatorPoints(e),\r\n                orig = that.origrotate,\r\n                start = that.startrotate,\r\n                m = that.matrix;\r\n\r\n            var delta = {\r\n                angle: Math.round((point.angle - start.angle) * 100) / 100,\r\n            }\r\n\r\n            if (delta.angle != 0) {\r\n                if (that.parent != that.options.rotatetarget.element) {\r\n                    m.rotateAboutPoint(new Point(0), delta.angle);\r\n                    doupdate = true;\r\n                }\r\n                if (that.options.rotatetarget instanceof Transformable)\r\n                    that.options.rotatetarget.rotate(that.anchor.TL.add(that.Ancestry.scroll), delta.angle, false, true);\r\n\r\n            }\r\n\r\n            if (doupdate)\r\n                that._updateElement(m);\r\n\r\n            that.startrotate.angle = point.angle;\r\n        },\r\n        _dostop = function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            that.element.classList.remove('transformable-active');\r\n\r\n            that.startedrotate = false;\r\n            that.draggingrotate = false;\r\n\r\n            that.off(document.querySelector('body'), 'mouseup.transformable dragend.transformable', _dostop);\r\n\r\n            if (that.options.rotatetarget instanceof Transformable) {\r\n                if (that.options.rotatetarget.events.stop)\r\n                    that.options.rotatetarget.trigger('stop', e);\r\n\r\n                that.options.rotatetarget.snapRotation();\r\n            }\r\n            if (that.events.stop)\r\n                that.trigger('stop', e);\r\n\r\n            that.snapRotation();\r\n        },\r\n        _dostart = function (e) {\r\n            if (that.options.disabled === true)\r\n                return false;\r\n            if (that.startedresize)\r\n                return false;\r\n            if (document.querySelectorAll('.transformable-active').length == 0)\r\n                that.element.classList.add('transformable-active');\r\n\r\n            //if (that.options.rotatetarget instanceof Transformable) \r\n            //    that.options.rotatetarget.updatedims();\r\n\r\n            //that.updatedims();\r\n\r\n            var m = that.matrix;\r\n\r\n            that.origrotate = {\r\n                trans: new Point(m.elements[4], m.elements[5]),\r\n                angle: m.rotation(true),\r\n                scale: m.scaling(),\r\n            };\r\n\r\n            var touches = e.touches;\r\n            if (touches && touches.length == 2)\r\n                if (touches[0].target && touches[1].target)\r\n                    if (touches[0].target !== touches[1].target) {\r\n                        console.log('Two active elements not supported');\r\n                        return false;\r\n                    }\r\n\r\n            that.anchor = that.anchor || {};\r\n            that.anchor.clientRect = that._getRect(that.element.querySelector('.transformable-anchor-point'));\r\n            that.anchor.TL = new Point(that.anchor.clientRect.left, that.anchor.clientRect.top);\r\n\r\n            that.startrotate = that._getRotatorPoints(e);\r\n\r\n            that.startrotate.scale = that.origrotate.scale;\r\n            that.startedrotate = true;\r\n            that.draggingrotate = false;\r\n\r\n            that.setTransition(false);\r\n\r\n            e.stopPropagation();\r\n\r\n            var body = document.querySelector('body');\r\n            if (e.type == 'mousedown') {\r\n                that.on(body, 'mousemove.transformable', _domove);\r\n                that.on(body, 'mouseup.transformable dragend.transformable', _dostop);\r\n            }\r\n        };\r\n\r\n    this.on(hdl, 'mousedown.transformable touchstart.transformable', _dostart)\r\n    this.on(hdl, 'touchmove.transformable', _domove);\r\n    this.on(hdl, 'touchend.transformable', _dostop);\r\n}\r\n\r\n/**\r\n * Attaches events for resize interactions with resize handles\r\n * @param {HtmlElement} tlb Top left button/handle used for moving the element\r\n * @param {HtmlElement} brb Bottom right button/handle for resizing the element's width/height\r\n */\r\nTransformable.prototype._addResizeEvents = function (tlb, brb) {\r\n    var that = this, el = this.element, opts = that.options;\r\n    var\r\n    _domove = function (e) {\r\n        // not really implemented yet\r\n        //if (that.options.disabled === true)\r\n        //    return;\r\n\r\n        if (!that.element.classList.contains('transformable-active')) \r\n            return false;\r\n        \r\n\r\n        if (!that.startedresize) return false;\r\n        that.draggingresize = true;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        var touches = e.touches, doupdate = false;\r\n\r\n        if(touches)\r\n            if (touches.length == 2)\r\n                return false\r\n\r\n        var point = that._getPoint2(e, touches),\r\n            orig = that.origresize,\r\n            start = that.startresize,\r\n            cs = getComputedStyle(el);\r\n\r\n        var delta = {\r\n            trans: point.offset.sub(start.offset),\r\n            angle: Math.round((point.angle - start.angle) * 100) / 100,\r\n            distance: start.distance != 0 ? Math.round(point.distance / ((start.distance + point.distance)/2) * 1000) / 1000 : 0\r\n        }\r\n\r\n        if (delta.trans.nonzero()) {\r\n            var \r\n                h = parseFloat(cs.height),\r\n                w = parseFloat(cs.width);\r\n\r\n\r\n            var dw = that.w - w,\r\n                dh = that.h - h,\r\n                neww = (w + delta.trans.x + dw),\r\n                newh = (h + delta.trans.y + dh);\r\n\r\n            el.style.width = neww + 'px';\r\n            el.style.height = newh + 'px';\r\n\r\n            that.sizes.element.initial.bottomright = new Point(neww, newh);\r\n            that.sizes.element.initial.topright.x = neww;\r\n            that.sizes.element.initial.bottomleft.y = newh;\r\n            that.sizes.element.initial.width = neww;\r\n            that.sizes.element.initial.height = newh;\r\n            \r\n        }                \r\n        that.startresize.angle = point.angle;\r\n\r\n        return false; // kill off bubble\r\n    },\r\n    _dostart = function (e) {\r\n        if (document.querySelectorAll('.transformable-active').length == 0)\r\n            that.element.classList.add('transformable-active');\r\n\r\n        console.log('_resize.start');\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        var m = that.matrix;\r\n\r\n        that.origresize = {\r\n            trans: new Point(m.elements[4], m.elements[5]),\r\n            angle: m.rotation(),\r\n            scale: m.scaling()//,\r\n        };\r\n        var touches = e.touches;\r\n\r\n        that.startresize = that._getPoint2(e, touches);\r\n        that.startresize.scale = that.origresize.scale;\r\n        that.startedresize = true;\r\n\r\n        that.draggingresize = false;\r\n\r\n        var cs = getComputedStyle(el);\r\n\r\n        that.h = parseFloat(cs.height), \r\n        that.w = parseFloat(cs.width);\r\n\r\n\r\n        if (typeof (that.contained) == 'undefined')\r\n            that.contained = true;\r\n\r\n        if(that.events.startresize)\r\n            that.trigger('startresize', e);\r\n\r\n        that.setTransition(false);\r\n\r\n        if (e.type == 'mousedown') {\r\n            var bodee = document.querySelector('body');\r\n            that.on(bodee, 'mousemove.transformable', _domove);\r\n            that.on(bodee, 'mouseup.transformable dragend.transformable', _dostop);\r\n        }\r\n        return false; // kill off bubble\r\n    },\r\n    _dostop = function () {\r\n        var bodee = document.querySelector('body');\r\n        that.off(bodee, 'mousemove.transformable', _domove);\r\n        that.off(bodee, 'mouseup.transformable dragend.transformable', _dostop);\r\n\r\n        if (that.options.disabled === true)\r\n            return false;\r\n\r\n        that.element.classList.remove('transformable-active');\r\n\r\n        that.startedresize = false;\r\n        that.draggingresize = false;\r\n    }\r\n\r\n    that.on(brb, 'mousedown.transformable', _dostart);\r\n    that.on(brb, 'touchstart.transformable', _dostart);\r\n    that.on(brb, 'touchmove.transformable', _domove);\r\n    that.on(brb, 'touchend.transformable', _dostop);\r\n}\r\n\r\n/**\r\n * Gets the quadrant based on angle r and wether the angle is horizontal or vertical\r\n * @param {Number} r\r\n */\r\nTransformable.prototype.getRotationQuadrant = function (r) {\r\n    var rot = (typeof r != 'undefined' ? r : this.matrix.rotation()) % 360;\r\n    if(rot < 0) rot+=360;\r\n\r\n    return { Angle: rot, Quad: Math.floor(rot / 90), Horiz: rot == 0 || rot == 180, Vert: rot == 90 || rot == 270 }\r\n}\r\n\r\n/**\r\n * Attaches events for scaling, rotating and moving elements. \r\n * Calculates and applies containment too.\r\n */\r\nTransformable.prototype._addEvents = function () {\r\n    var that = this,\r\n        el = this.element,\r\n        docontain = this.options && this.options.contain;\r\n\r\n    if (typeof this.events.transition == 'function') {\r\n        el.addEventListener('transitionend', this.events.transition);\r\n    }\r\n\r\n    var\r\n    _domove = function (e) {\r\n        if (that.options.disabled === true)\r\n            return false;\r\n\r\n        if (!that.element.classList.contains('transformable-active')) {\r\n            return false;\r\n        }\r\n        if (!that.started || that.startedresize || that.startedrotate) {\r\n            return false;\r\n        }\r\n        that.dragging = true;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        var touches = e.touches, doupdate = false;\r\n        if (touches && touches.length == 2)\r\n            if (touches[0].target && touches[1].target)\r\n                if (touches[0].target !== touches[1].target) {\r\n                    console.log('Two active elements not supported');\r\n                    return false;\r\n                }\r\n\r\n        var m = that.matrix;\r\n        var cr = m.rotation();\r\n\r\n        var disable = that.options.disable,\r\n            disableZoom = false,\r\n            disableTranslate = false,\r\n            disableRotate = false;\r\n\r\n        if (disable) {\r\n            disableZoom = disable.zoom || disable.scale;\r\n            disableRotate = disable.rotate;\r\n            disableTranslate = disable.translate;\r\n        }\r\n\r\n        var point = that._getPoint2(e, touches),\r\n            orig = that.orig,\r\n            start = that.start;\r\n\r\n        var delta = {\r\n            trans: point.offset.sub(start.offset),\r\n            angle: Math.round((point.angle - start.angle) * 100) / 100,\r\n            distance: start.distance != 0 ? Math.round(point.distance / ((start.distance + point.distance) / 2) * 1000) / 1000 : 0\r\n        }\r\n\r\n        if (docontain && delta.angle == 0 && (!touches || (touches && touches.length == 1))) {\r\n            var\r\n                tl, tr, br, bl;\r\n\r\n            var\r\n                anc = that.Ancestry,\r\n                parentT = anc.FirstParent(),\r\n                prect = parentT.rect,\r\n                inv = m.inverse(),\r\n                ptl = prect.topleft,\r\n                ptr = prect.topright,\r\n                pbr = prect.bottomright,\r\n                pbl = prect.bottomleft;\r\n\r\n            tl = inv.transformpoint(ptl).sub(delta.trans);\r\n            tr = inv.transformpoint(ptr).sub(delta.trans);\r\n            br = inv.transformpoint(pbr).sub(delta.trans);\r\n            bl = inv.transformpoint(pbl).sub(delta.trans);\r\n\r\n            if (!start.size)\r\n                start.size = new Point(that._distanceBetweenPoints(tl, tr), that._distanceBetweenPoints(tl, bl));\r\n            else\r\n                start.size = delta.distance != 0 ?\r\n                    new Point(that._distanceBetweenPoints(tl, tr), that._distanceBetweenPoints(tl, bl))\r\n                    :\r\n                    start.size;\r\n\r\n            var csiz = that.sizes.element.initial;\r\n                \r\n            var containment, opts = that.options;\r\n\r\n            if (docontain == 'enclose') {\r\n                var enclosed = {\r\n                    tl: that.pointInRectangle(csiz.topleft, tl, tr, br, bl),\r\n                    tr: that.pointInRectangle(csiz.topright, tl, tr, br, bl),\r\n                    br: that.pointInRectangle(csiz.bottomright, tl, tr, br, bl),\r\n                    bl: that.pointInRectangle(csiz.bottomleft, tl, tr, br, bl)\r\n                };\r\n\r\n                var containcount = 0;\r\n                if(enclosed.tl.ok)\r\n                    containcount++;\r\n                if(enclosed.tr.ok)\r\n                    containcount++;\r\n                if(enclosed.br.ok)\r\n                    containcount++;\r\n                if(enclosed.bl.ok)\r\n                    containcount++;\r\n\r\n                var contained = containcount == 4;\r\n\r\n                if (!contained) {\r\n                    var quad = that.getRotationQuadrant(start.angle);\r\n                    switch (quad.Quad) {\r\n                        case 0:\r\n                            if (quad.Angle == 0) {\r\n                                if (!enclosed.br.ok) {\r\n                                    var brv = csiz.bottomright.perpOnLine(tr, br).sub(csiz.bottomright), brh = csiz.bottomright.perpOnLine(bl, br).sub(csiz.bottomright);\r\n                                    if (brv.x < 0) delta.trans = delta.trans.add(brv);\r\n                                    if (brh.y < 0) delta.trans = delta.trans.add(brh);\r\n                                }\r\n                                if (!enclosed.tl.ok) {\r\n                                    var tlv = csiz.topleft.perpOnLine(tl, bl), tlh = csiz.topleft.perpOnLine(tl, tr);\r\n                                    if (tlv.x > 0) delta.trans = delta.trans.add(tlv);\r\n                                    if (tlh.y > 0) delta.trans = delta.trans.add(tlh);\r\n                                }\r\n                            } else {\r\n                                if (!enclosed.bl.ok) {\r\n                                    var blv = csiz.bottomleft.perpOnLine(tl, bl).sub(csiz.bottomleft); //,\r\n\r\n                                    if (blv.x > 0) delta.trans = delta.trans.add(blv);\r\n                                }\r\n                                if (!enclosed.br.ok) {\r\n                                    var\r\n                                        brh = csiz.bottomright.perpOnLine(bl, br).sub(csiz.bottomright);\r\n                                    if (brh.y < 0) delta.trans = delta.trans.add(brh);\r\n                                }\r\n                                if (!enclosed.tr.ok) {\r\n                                    var trv = csiz.topright.perpOnLine(tr, br).sub(csiz.topright); //,\r\n                                    if (trv.x < 0) delta.trans = delta.trans.add(trv);\r\n                                }\r\n                                if (!enclosed.tl.ok) {\r\n                                    var tlh = csiz.topleft.perpOnLine(tl, tr);\r\n                                    if (tlh.y > 0) delta.trans = delta.trans.add(tlh);\r\n                                }\r\n                            }\r\n                            break;\r\n                        case 3:\r\n                            if (quad.Angle == 270) {\r\n                                if (!enclosed.tl.ok) {\r\n                                    var tlh = csiz.topleft.perpOnLine(tl, bl),\r\n                                        tlv = csiz.topleft.perpOnLine(bl, br);\r\n                                    if (tlv.x > 0) delta.trans = delta.trans.add(tlv);\r\n                                    if (tlh.y > 0) delta.trans = delta.trans.add(tlh);\r\n                                }\r\n                                if (!enclosed.br.ok) {\r\n                                    var\r\n                                        brv = csiz.bottomright.perpOnLine(tl, tr).sub(csiz.bottomright),\r\n                                        brh = csiz.bottomright.perpOnLine(br, tr).sub(csiz.bottomright);\r\n                                    if (brv.x < 0) delta.trans = delta.trans.add(brv);\r\n                                    if (brh.y < 0) delta.trans = delta.trans.add(brh);\r\n                                }\r\n                            } else {\r\n                                if (!enclosed.tl.ok) {\r\n                                    var tlv = csiz.topleft.perpOnLine(tl, bl);\r\n                                    if (tlv.x > 0) delta.trans = delta.trans.add(tlv);\r\n                                }\r\n                                if (!enclosed.br.ok) {\r\n                                    var brv = csiz.bottomright.perpOnLine(tr, br).sub(csiz.bottomright);\r\n                                    if (brv.x < 0) delta.trans = delta.trans.add(brv);\r\n                                }\r\n                                if (!enclosed.tr.ok) {\r\n                                    var trh = csiz.topright.perpOnLine(tl, tr).sub(csiz.topright);\r\n                                    if (trh.y > 0) delta.trans = delta.trans.add(trh);\r\n                                }\r\n                                if (!enclosed.bl.ok) {\r\n                                    var blh = csiz.bottomleft.perpOnLine(bl, br).sub(csiz.bottomleft);\r\n                                    if (blh.y < 0) delta.trans = delta.trans.add(blh);\r\n                                }\r\n                            }\r\n                            break;\r\n                        case 1:\r\n                            if (quad.Angle == 90) { // can get away with 2 perp calcs instead of 4;\r\n                                if (!enclosed.tl.ok) {\r\n                                    var tlv = csiz.topleft.perpOnLine(tr, tl),\r\n                                        tlh = csiz.topleft.perpOnLine(tr, br);\r\n\r\n                                    if (tlv.x > 0) delta.trans = delta.trans.add(tlv);\r\n                                    if (tlh.y > 0) delta.trans = delta.trans.add(tlh);\r\n                                }\r\n                                if (!enclosed.br.ok) {\r\n                                    var brv = csiz.bottomright.perpOnLine(br, bl).sub(csiz.bottomright),\r\n                                        brh = csiz.bottomright.perpOnLine(tl, bl).sub(csiz.bottomright);\r\n\r\n                                    if (brv.x < 0) delta.trans = delta.trans.add(brv);\r\n                                    if (brh.y < 0) delta.trans = delta.trans.add(brh);\r\n                                }\r\n                            } else {\r\n                                if (!enclosed.tl.ok) {\r\n                                    var tlv = csiz.topleft.perpOnLine(tr, br);\r\n                                    if (tlv.x > 0) delta.trans = delta.trans.add(tlv);\r\n                                }\r\n                                if (!enclosed.br.ok) {\r\n                                    var brv = csiz.bottomright.perpOnLine(tl, bl).sub(csiz.bottomright);\r\n                                    if (brv.x < 0) delta.trans = delta.trans.add(brv);\r\n                                }\r\n                                if (!enclosed.tr.ok) {\r\n                                    var trh = csiz.topright.perpOnLine(bl, br).sub(csiz.topright);\r\n                                    if (trh.y > 0) delta.trans = delta.trans.add(trh);\r\n                                }\r\n                                if (!enclosed.bl.ok) {\r\n                                    var blh = csiz.bottomleft.perpOnLine(tr, tl).sub(csiz.bottomleft);\r\n                                    if (blh.y < 0) delta.trans = delta.trans.add(blh);\r\n                                }\r\n                            }\r\n                            break;\r\n                        case 2:\r\n                            if (quad.Angle == 180) { // can get away with 2 calcs instead of 4;\r\n                                if (!enclosed.tl.ok) {\r\n                                    var tlv = csiz.topleft.perpOnLine(br, bl),\r\n                                        tlh = csiz.topleft.perpOnLine(tl, bl);\r\n                                    if (tlv.y > 0) delta.trans = delta.trans.add(tlv);\r\n                                    if (tlh.y > 0) delta.trans = delta.trans.add(tlh);\r\n                                }\r\n                                if (!enclosed.br.ok) {\r\n                                    var\r\n                                        brv = csiz.bottomright.perpOnLine(tr, tl).sub(csiz.bottomright),\r\n                                        brh = csiz.bottomright.perpOnLine(tr, br).sub(csiz.bottomright);\r\n                                    if (brv.y < 0) delta.trans = delta.trans.add(brv);\r\n                                    if (brh.y < 0) delta.trans = delta.trans.add(brh);\r\n                                }\r\n                            }\r\n                            if (!enclosed.tl.ok) {\r\n                                var tlv = csiz.topleft.perpOnLine(br, bl);\r\n                                if (tlv.y > 0) delta.trans = delta.trans.add(tlv);\r\n                            }\r\n                            if (!enclosed.br.ok) {\r\n                                var brv = csiz.bottomright.perpOnLine(tr, tl).sub(csiz.bottomright);//,\r\n                                if (brv.y < 0) delta.trans = delta.trans.add(brv);\r\n                            }\r\n\r\n                            if (!enclosed.tr.ok) {\r\n                                var trh = csiz.topright.perpOnLine(tl, bl).sub(csiz.topright);\r\n                                if (trh.x < 0) delta.trans = delta.trans.add(trh);\r\n                            }\r\n                            if (!enclosed.bl.ok) {\r\n                                var blh = csiz.bottomleft.perpOnLine(tr, br).sub(csiz.bottomleft);\r\n                                if (blh.x > 0) delta.trans = delta.trans.add(blh);\r\n                            }\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n            if (docontain == 'cover') {\r\n                var enclosed = {\r\n                    tl: that.pointInRectangle(csiz.topleft, tl, tr, br, bl),\r\n                    tr: that.pointInRectangle(csiz.topright, tl, tr, br, bl),\r\n                    br: that.pointInRectangle(csiz.bottomright, tl, tr, br, bl),\r\n                    bl: that.pointInRectangle(csiz.bottomleft, tl, tr, br, bl)\r\n                };\r\n\r\n                var okcorners = 0;\r\n                if (!enclosed.tl.ok) okcorners++;\r\n                if (!enclosed.tr.ok) okcorners++;\r\n                if (!enclosed.br.ok) okcorners++;\r\n                if (!enclosed.bl.ok) okcorners++;\r\n\r\n                if ((!enclosed.tl.ok &&\r\n                    !enclosed.tr.ok &&\r\n                    !enclosed.br.ok &&\r\n                    !enclosed.bl.ok\r\n                    )||that.lockcontain||(okcorners == 3 && start.angle == 0)) {\r\n                    that.lockcontain = true;\r\n                    var quad = that.getRotationQuadrant(start.angle);\r\n                    switch (quad.Quad) {\r\n                        case 0:\r\n                            if (tr.y <= 0)\r\n                                delta.trans.y = delta.trans.y + tr.y;\r\n                            if (bl.y >= csiz.bottomleft.y)\r\n                                delta.trans.y = delta.trans.y + (bl.y - csiz.bottomleft.y);\r\n                            if (br.x >= csiz.bottomright.x)\r\n                                delta.trans.x = delta.trans.x + (br.x - csiz.bottomright.x);\r\n                            if (tl.x <= 0)\r\n                                delta.trans.x = delta.trans.x + tl.x;\r\n                            break;\r\n                        case 1:\r\n                            if (tl.y >= csiz.bottomleft.y)\r\n                                delta.trans.y = delta.trans.y + (tl.y - csiz.bottomleft.y);\r\n                            if (bl.x >= csiz.topright.x)\r\n                                delta.trans.x = delta.trans.x - (csiz.topright.x - bl.x);\r\n                            if (br.y <= 0) // works\r\n                                delta.trans.y = delta.trans.y + br.y;\r\n                            if (tr.x <= 0)\r\n                                delta.trans.x = delta.trans.x + tr.x;\r\n                            break;\r\n                        case 2:\r\n                            if (bl.y <= 0) // works\r\n                                delta.trans.y = delta.trans.y + bl.y;\r\n                            if (tl.x >= csiz.bottomright.x)\r\n                                delta.trans.x = delta.trans.x - (csiz.bottomright.x - tl.x);\r\n                            if (tr.y >= csiz.bottomleft.y)\r\n                                delta.trans.y = delta.trans.y + (tr.y - csiz.bottomleft.y);\r\n                            if (br.x <= 0)\r\n                                delta.trans.x = delta.trans.x + br.x;\r\n                            //console.log('points')\r\n                            //console.log(tl)\r\n                            //console.log(tr)\r\n                            //console.log(br)\r\n                            //console.log(bl)\r\n                            break;\r\n                        case 3:\r\n                            if (tl.y <= 0) // works\r\n                                delta.trans.y = delta.trans.y + tl.y;\r\n                            if (bl.x <= 0)\r\n                                delta.trans.x = delta.trans.x + bl.x;\r\n                            if (br.y >= csiz.bottomright.y) // works\r\n                                delta.trans.y = delta.trans.y + (br.y - csiz.bottomright.y);\r\n                            if (tr.x >= csiz.topright.x)\r\n                                delta.trans.x = delta.trans.x - (csiz.topright.x - tr.x);\r\n\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (delta.trans.nonzero() && !disableTranslate) {\r\n            m.translate(delta.trans);\r\n            doupdate = true;\r\n            that.delta.x += delta.trans.x;\r\n            that.delta.y += delta.trans.y;\r\n        }\r\n\r\n        if (delta.distance != 0 && delta.distance != 1 && touches)\r\n            if (touches.length == 2 && !disableZoom) {\r\n                m.scale(point.offset, delta.distance);\r\n\r\n                doupdate = true;\r\n\r\n            }\r\n\r\n        if (delta.angle != 0 && !disableRotate) {\r\n            m.rotateAboutPoint(point.offset, delta.angle);\r\n            doupdate = true;\r\n        }\r\n\r\n        if (doupdate)\r\n            that._updateElement(m);\r\n\r\n        that.start.angle = point.angle;\r\n\r\n        if (that.events.move)\r\n            that.trigger('move', e);\r\n\r\n        return false;\r\n    },\r\n    _dostart = function (e) {\r\n        if (that.options.disabled === true)\r\n            return false;\r\n        if (that.startedresize || that.startedrotate)\r\n            return false;\r\n\r\n        if (document.querySelectorAll('.transformable-active').length == 0)\r\n            that.element.classList.add('transformable-active');\r\n\r\n        if (that.options.type == 'rotator-box') {\r\n            var rb = e.target.closest('svg')\r\n\r\n            if (rb && !rb.classList.contains('transformable-svg-anchor')) {\r\n                return false;\r\n            } else\r\n                e.stopPropagation();\r\n        }\r\n\r\n        var touches = e.touches;\r\n        that.start = that._getPoint2(e, touches);\r\n\r\n        var ww = that.sizes.window;\r\n        if (that.start.pageX < 40 || that.start.pageX > ww.width - 40) // don't translate if history navigation can happen from swiping at the edges of webpage.  e.g. on a touch device\r\n        { console.log('edge cancel.'); return false; }\r\n\r\n        that.delta = { x: 0, y: 0 };\r\n\r\n        if (touches && touches.length == 2)\r\n            if (touches[0].target && touches[1].target)\r\n                if (touches[0].target !== touches[1].target) {\r\n                    console.log('Two active elements not supported');\r\n                    return false;\r\n                }\r\n\r\n        var m = that.matrix;\r\n\r\n        that.orig = {\r\n            trans: new Point(m.elements[4], m.elements[5]),\r\n            angle: m.rotation(),\r\n            scale: m.scaling(),\r\n        };\r\n\r\n        that.start.scale = that.orig.scale;\r\n        that.started = true;\r\n        that.dragging = false;\r\n\r\n        if (that.events.start)\r\n            that.trigger('start', e);\r\n\r\n        that.setTransition(false);\r\n\r\n        if (e.type == 'mousedown') {\r\n            var bodee = document.querySelector('body');\r\n            that.on(bodee, 'mousemove.transformable', _domove);\r\n            that.on(bodee, 'mouseup.transformable dragend.transformable', _dostop);\r\n        }\r\n    },\r\n    _dostop = function (e) {\r\n        var bodee = document.querySelector('body');\r\n        that.off(bodee, 'mousemove.transformable', _domove);\r\n        that.off(bodee, 'mouseup.transformable dragend.transformable', _dostop);\r\n\r\n        that.element.classList.remove('transformable-active');\r\n        that.element.classList.remove('transformable-reset');\r\n\r\n        if (that.options.disabled === true)\r\n            return false;\r\n\r\n        that.lockcontain = false;\r\n\r\n        if (that.started === true && that.dragging === true) {\r\n            that._pushhistory();\r\n            that.snapRotation();\r\n        }\r\n\r\n        if (that.started === true && that.dragging === false)\r\n            if (that.events.tap)\r\n                that.trigger('tap', e);\r\n\r\n        that.dragging = false;\r\n        that.started = false;\r\n        if (that.events.stop)\r\n            that.trigger('stop', e);\r\n\r\n        that.setTransition(true);\r\n\r\n        var\r\n            rb = that.rotatorBox,\r\n            tlb = that.resizertl,\r\n            brb = that.resizerbr;\r\n\r\n        if (rb) {\r\n            var nsc = that.matrix.scaling();\r\n            rb.scale(new Point(0), (1 / rb.matrix.scaling()) * (1 / nsc));\r\n        }\r\n        if (tlb && brb) {\r\n            var nscc = nsc || that.matrix.scaling(); //,\r\n\r\n            tlb.style.transform = 'scale(' + (1 / nscc) + ')';\r\n            brb.style.transform = 'scale(' + (1 / nscc) + ')';\r\n        }\r\n    },\r\n    _dowheelzoom = function (e) {\r\n        if (that.options.disabled === true)\r\n            return false;\r\n        if (that.startedresize || that.startedrotate)\r\n            return false;\r\n        if (that.options.type == 'rotator-box')\r\n            return false;\r\n\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        var now = Date.now(),\r\n            dmw = that.lastwheelmove ? now - that.lastwheelmove : 150;\r\n\r\n        if (dmw < 150 && navigator.userAgent.indexOf('Mac') > -1)\r\n            return false;\r\n\r\n        if (document.querySelectorAll('.transformable-active').length == 0)\r\n            that.element.classList.add('transformable-active');\r\n\r\n        if (that.rotatorBox)\r\n            that.rotatorBox.parent.classList.add('transformable-wheel-active');\r\n\r\n        if (that._wheelTimer) \r\n            clearTimeout(that._wheelTimer);\r\n\r\n        var point = that._getPoint2(e),\r\n            m = that.matrix,\r\n            s = m.scaling(),\r\n            ds,\r\n            sy = 0.05, \r\n            acc = point.deltaXY.y < 0 ? 1 : -1;\r\n\r\n        that.setTransition(true);\r\n\r\n\r\n        if (point.deltaXY.y != 0) {\r\n            ds = 1 + (sy * acc);\r\n            m.scale(point.offset, ds);\r\n            that._updateElement();\r\n            //console.log(ds);\r\n        };\r\n        that.element.classList.remove('transformable-active');\r\n\r\n        that._wheelTimer = setTimeout(function () {\r\n            that._pushhistory();\r\n            if (that.rotatorBox)\r\n                that.rotatorBox.parent.classList.remove('transformable-wheel-active');\r\n\r\n\r\n        }, 750);\r\n        that.lastwheelmove = now;\r\n    };\r\n\r\n    that.on(el, 'mousedown.transformable', _dostart);\r\n    that.on(el, 'touchstart.transformable', _dostart);\r\n    that.on(el, 'touchmove.transformable', _domove);\r\n    that.on(el, 'touchend.transformable', _dostop);\r\n\r\n    that.on(el, 'scroll.transformable', function (e) {\r\n        console.log('tried scroll');\r\n        e.preventDefault(); e.stopPropagation(); return false;\r\n    });\r\n\r\n    if (!this.options.disable || (this.options.disable && !this.options.disable.wheel))\r\n        if (navigator.userAgent.indexOf('Mac OS') == -1) // some issues with wild zoom on magic mouse, so turn it off\r\n            addWheelListener(el, _dowheelzoom);\r\n}\r\n\r\n/**\r\n * Datastore for any namespaced events attached to elements by .on(....)\r\n */\r\nTransformable.Handlers = { Namespaces: {} };\r\n\r\n/**\r\n * attaches events to an element\r\n * @param {HtmlElement} el The element to attach the event to\r\n * @param {String} event Type of event with optional namespace. E.g. touchstart.mynamespace\r\n * @param {Function} func Handler function\r\n * @param {Object} opts Options to use when attaching the event\r\n */\r\nTransformable.prototype.on = function (el, event, func, opts) {\r\n    var events = event.split(' '), i, sp, ev, ns, pl;\r\n    for (i = 0; i < events.length; i++) {\r\n        sp = events[i].split('.'), ev = sp[0], ns = sp.length > 1 ? sp[1] : false;\r\n        el.addEventListener(ev, func, opts || false);\r\n\r\n        if (!Transformable.Handlers.Namespaces[event])\r\n            Transformable.Handlers.Namespaces[event] = [];\r\n\r\n        if (ns)\r\n            if (!Transformable.Handlers.Namespaces[ns])\r\n                Transformable.Handlers.Namespaces[ns] = [];\r\n\r\n        pl = Transformable.Handlers.Namespaces[event].push({ event: ev, func: func, opts: opts || false });\r\n        if (ns)\r\n            Transformable.Handlers.Namespaces[ns].push(Transformable.Handlers.Namespaces[event][pl - 1]);\r\n    }\r\n};\r\n\r\n/**\r\n * REmoves an event previously added with .on(...)\r\n * @param {HtmlElement} el The element to remove the event from\r\n * @param {any} event Handler function to remove\r\n * @param {any} opts Options to use when removing the event\r\n */\r\nTransformable.prototype.off = function (el, event, opts) {\r\n    var x = Transformable.Handlers.Namespaces[event], tv;\r\n    if (x)\r\n        for (var i = 0; i < x.length; i++) {\r\n            tv = x[i];\r\n            el.removeEventListener(tv.event, tv.func, tv.opts);\r\n        }\r\n\r\n};\r\n\r\n/**\r\n * Resets/updates the instance.\r\n */\r\nTransformable.prototype.Refresh = function () {\r\n    this.sizes = undefined;\r\n    this.setInitialSizes();\r\n    this.Ancestry.Refresh();\r\n}; // <--- dont forget this semicolon, it will break the next closure if missing\r\n(function() {        \r\n    var timer, rtimer\r\n    window.addEventListener('resize', function () {\r\n        clearTimeout(timer);\r\n        timer = setTimeout(refreshtransformables, 150);\r\n    });\r\n    //window.addEventListener('scroll', function () {\r\n    //    clearTimeout(rtimer);\r\n    //    rtimer = setTimeout(refreshtransformables, 150);\r\n    //});\r\n\r\n    var refreshtransformables = function () { \r\n        // do stuff\r\n        var ts = document.querySelectorAll('.transformable').forEach(function (v, i) {\r\n            var i = v.getAttribute('data-transformable-id'),\r\n                t = i ? Transformable.Instance[i] : false;\r\n\r\n            if (t instanceof Transformable) \r\n                t.Refresh()\r\n        });\r\n    };\r\n})(); // end\r\n\r\n// Ensure Transformable is available as a global for UMD/browser builds\r\nif (typeof window !== 'undefined') {\r\n  window.Transformable = Transformable;\r\n}\r\nexport default Transformable;"],"names":["Matrix","Point","Ancestry","self","_classCallCheck","Items","_add","element","Self","_init","_createClass","key","value","_getScroll","window","pageXOffset","document","documentElement","scrollLeft","pageYOffset","scrollTop","GetElementSize","el","cs","getComputedStyle","left","parseFloat","top","w","width","h","height","offset","topleft","topright","bottomright","bottomleft","_debug","forEach","v","i","console","log","matrix","elements","Refresh","_ispercent","indexOf","_isauto","_pixelFromParent","k","val","GetComputedDims","cmt","marginTop","cml","marginLeft","cl","ct","leftp","topp","pf","l","t","pcs","parentNode","transform","has","pt","tid","nm","body","test","margintop","marginleft","classList","contains","getAttribute","Transformable","Instance","om","_cssStringToArray","translate","multiply","prect","style","transformOrigin","_arrayToCssString","_setoffset","scroll","cur","trans","length","translation","transformable","sub","unshift","rect","sizes","initial","GetParents","r","m","ti","push","Inverse","inverse","Element","TransformCorners","c","mat","GetMatrix","transformpoint","FirstParent","par","Identity","OffsetFromPoint","p","pars","op","matinv","a","Array","slice","arguments","Error","history","undo","redo","prototype","x","y","els","me","a1","b1","c1","d1","e1","f1","a2","b2","c2","d2","e2","f2","elementsequal","b","save","last","len","pop","prev","identity","reset","determinant","dt","invert","isIdentity","scale","s","dp","rotateAboutPoint","Math","PI","cos","sin","rotate","normaldegree","rotation","norm","atan2","scaling","sqrt","pow","undefined","factor","round","precision","add","mult","divide","nonzero","equals","moreoreq","lessoreq","dot","perpOnLine","p1","p2","x4","y4","mag","prefix","_addEventListener","support","addEventListener","createElement","onmousewheel","addWheelListener","elem","callback","useCapture","_addWheelListener","eventName","originalEvent","event","target","srcElement","type","deltaMode","deltaX","deltaY","deltaZ","preventDefault","returnValue","stopPropagation","wheelDelta","wheelDeltaX","detail","opts","options","parent","setInitialSizes","cscale","computedsize","Width","precs","Height","curcs","_setMatrix","_getMatrix","originalTransition","_getOriginalTransition","_setOffset","dragging","start","orig","zooma","events","move","stop","tap","transition","setAttribute","navigator","userAgent","attachevents","editable","_addEvents","resize","createResizeHandles","disable","createRotateHandles","handle","_addRotateEvents","sa","split","join","tag","str","innerHTML","firstChild","typ","box","rot","anc","lin","that","appendChild","nodeName","e","rotatorBox","rotatetarget","zoom","_domouseup","remove","querySelector","off","_domousedown","on","_domouseleave","_overTimer","clearTimeout","_resizeTimer","setTimeout","_domouseenter","tim","rb","ds","rotparent","apply","tl","br","tlb","brb","cloneNode","resizertl","resizerbr","_addResizeEvents","dir","_findCentreInWindow","setTransition","_updateElement","inwindow","lastrotationpoint","straighten","fittoparent","sz","parentT","pr","tr","bl","psiz","_distanceBetweenPoints","sc","min","centreinparent","filltoparent","max","_getRect","getBoundingClientRect","InitialMatrix","delta","hasHistoryKey","_getOffset","cr","pos","os","right","bottom","too","initialoffset","match","bordertop","borderTopWidth","borderleft","borderLeftWidth","hasone","isrb","bool","was","spl","mtx","_pushhistory","_getPageXY","touches","xy","ang","_getMiddle","_getRotation","pageX","pageY","point","angle","_getPoint2","dat","deltaXY","dist","pageXY","distance","prop","abs","touch1","touch2","mx","my","_getDistance2","t1","t2","snapRotation","am","siz","lastlastrotationpoint","msg","showMessage","parentCentre","centreOnThis","pointInRectangle","d","ab","ap","bc","bp","dot_abap","dot_abab","dot_bcbp","dot_bcbc","ok","trigger","n","_getRotatorPoints","rpoint","apoint","anchor","TL","hdl","_domove","startedrotate","draggingrotate","doupdate","origrotate","startrotate","_dostop","_dostart","disabled","startedresize","querySelectorAll","clientRect","draggingresize","origresize","startresize","dw","dh","neww","newh","contained","bodee","getRotationQuadrant","Angle","Quad","floor","Horiz","Vert","docontain","contain","started","disableZoom","disableTranslate","disableRotate","inv","ptl","ptr","pbr","pbl","size","csiz","containment","enclosed","containcount","quad","brv","brh","tlv","tlh","blv","trv","trh","blh","okcorners","lockcontain","closest","ww","nsc","nscc","_dowheelzoom","now","Date","dmw","lastwheelmove","_wheelTimer","sy","acc","wheel","Handlers","Namespaces","func","sp","ev","ns","pl","tv","removeEventListener","timer","rtimer","refreshtransformables","ts"],"sourceRoot":""}