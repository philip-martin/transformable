{"version":3,"file":"transformable.dev.esm.js","mappings":";;;;;;;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;ACAiC;AACF;AAAA,IAEzBE,QAAQ;EACV,SAAAA,SAAYC,IAAI,EAAE;IAAAC,eAAA,OAAAF,QAAA;IACd,IAAI,CAACG,KAAK,GAAG,EAAE;IACf,IAAI,CAACC,IAAI,CAACH,IAAI,EAAEA,IAAI,CAACI,OAAO,CAAC;IAC7B,IAAI,CAACC,IAAI,GAAGL,IAAI;IAChB,IAAI,CAACM,KAAK,CAAC,CAAC;EAChB;EAAC,OAAAC,YAAA,CAAAR,QAAA;IAAAS,GAAA;IAAAC,KAAA,EAED,SAAAC,UAAUA,CAAA,EAAG;MACT,OAAO,IAAIZ,iDAAK,CAACa,MAAM,CAACC,WAAW,IAAIC,QAAQ,CAACC,eAAe,CAACC,UAAU,EAAEJ,MAAM,CAACK,WAAW,IAAIH,QAAQ,CAACC,eAAe,CAACG,SAAS,CAAC;IACzI;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAAT,GAAA;IAAAC,KAAA,EAKA,SAAAS,cAAcA,CAACC,EAAE,EAAEC,EAAE,EAAE;MACnBA,EAAE,GAAGA,EAAE,IAAIC,gBAAgB,CAACF,EAAE,CAAC;MAE/B,IAAMG,IAAI,GAAGC,UAAU,CAACH,EAAE,CAACE,IAAI,CAAC;MAChC,IAAME,GAAG,GAAGD,UAAU,CAACH,EAAE,CAACI,GAAG,CAAC;MAC9B,IAAMC,CAAC,GAAGF,UAAU,CAACH,EAAE,CAACM,KAAK,CAAC;MAC9B,IAAMC,CAAC,GAAGJ,UAAU,CAACH,EAAE,CAACQ,MAAM,CAAC;MAE/B,OAAO;QACHC,MAAM,EAAE,IAAI/B,iDAAK,CAACwB,IAAI,IAAI,CAAC,EAAEE,GAAG,IAAI,CAAC,CAAC;QACtCE,KAAK,EAAED,CAAC;QACRG,MAAM,EAAED,CAAC;QACTG,OAAO,EAAE,IAAIhC,iDAAK,CAAC,CAAC,EAAE,CAAC,CAAC;QACxBiC,QAAQ,EAAE,IAAIjC,iDAAK,CAAC2B,CAAC,EAAE,CAAC,CAAC;QACzBO,WAAW,EAAE,IAAIlC,iDAAK,CAAC2B,CAAC,EAAEE,CAAC,CAAC;QAC5BM,UAAU,EAAE,IAAInC,iDAAK,CAAC,CAAC,EAAE6B,CAAC;MAC9B,CAAC;IACL;;IAEA;AACJ;AACA;EAFI;IAAAnB,GAAA;IAAAC,KAAA,EAGA,SAAAyB,MAAMA,CAAA,EAAG;MACL,IAAI,CAAChC,KAAK,CAACiC,OAAO,CAAC,UAAUC,CAAC,EAAEC,CAAC,EAAE;QAC/BC,OAAO,CAACC,GAAG,CAACH,CAAC,CAACI,MAAM,CAACC,QAAQ,CAAC;MAClC,CAAC,CAAC;MACF,IAAI,CAACvC,KAAK,CAACiC,OAAO,CAAC,UAAUC,CAAC,EAAEC,CAAC,EAAE;QAC/BC,OAAO,CAACC,GAAG,CAAC,CAACH,CAAC,CAAChC,OAAO,CAAC,CAAC;MAC5B,CAAC,CAAC;IACN;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAAI,GAAA;IAAAC,KAAA,EAKA,SAAAiC,OAAOA,CAAA,EAAG;MACN,IAAI,CAACxC,KAAK,GAAG,EAAE;MACf,IAAI,CAACC,IAAI,CAAC,IAAI,CAACE,IAAI,EAAE,IAAI,CAACA,IAAI,CAACD,OAAO,CAAC;MACvC;MACA,IAAI,CAACE,KAAK,CAAC,CAAC;IAChB;;IAEA;AACJ;AACA;AACA;EAHI;IAAAE,GAAA;IAAAC,KAAA,EAIA,SAAAkC,UAAUA,CAACP,CAAC,EAAE;MAAE,OAAOA,CAAC,CAACQ,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;IAAE;;IAE5C;AACJ;AACA;AACA;EAHI;IAAApC,GAAA;IAAAC,KAAA,EAIA,SAAAoC,OAAOA,CAACT,CAAC,EAAE;MAAE,OAAOA,CAAC,IAAI,MAAM;IAAE;;IAEjC;AACJ;AACA;AACA;AACA;AACA;EALI;IAAA5B,GAAA;IAAAC,KAAA,EAMA,SAAAqC,gBAAgBA,CAACC,CAAC,EAAEC,GAAG,EAAE5B,EAAE,EAAE;MACzB,IAAI4B,GAAG,KAAK,IAAI,EAAE,OAAO,CAAC;MAC1B,IAAIZ,CAAC,GAAGb,UAAU,CAACyB,GAAG,CAAC;MACvB,QAAQD,CAAC;QACL,KAAK,MAAM;UACPX,CAAC,GAAGb,UAAU,CAACH,EAAE,CAACM,KAAK,CAAC,GAAGU,CAAC,GAAG,GAAG;UAClC;QACJ,KAAK,KAAK;UACNA,CAAC,GAAGb,UAAU,CAACH,EAAE,CAACQ,MAAM,CAAC,GAAGQ,CAAC,GAAG,GAAG;UACnC;MACR;MACA,OAAOA,CAAC;IACZ;;IAEA;AACJ;AACA;AACA;EAHI;IAAA5B,GAAA;IAAAC,KAAA,EAIA,SAAAwC,eAAeA,CAAC9B,EAAE,EAAE;MAChB,IAAMC,EAAE,GAAGC,gBAAgB,CAACF,EAAE,CAAC;MAC/B,IAAM+B,GAAG,GAAG9B,EAAE,CAAC+B,SAAS;MACxB,IAAMC,GAAG,GAAGhC,EAAE,CAACiC,UAAU;MACzB,IAAIC,EAAE,GAAGlC,EAAE,CAACE,IAAI;MAChB,IAAIiC,EAAE,GAAGnC,EAAE,CAACI,GAAG;MACf,IAAMgC,KAAK,GAAG,IAAI,CAACb,UAAU,CAACW,EAAE,CAAC;MACjC,IAAMG,IAAI,GAAG,IAAI,CAACd,UAAU,CAACY,EAAE,CAAC;MAChC,IAAMG,EAAE,GAAG,SAALA,EAAEA,CAAatB,CAAC,EAAE;QAAE,OAAOb,UAAU,CAACa,CAAC,CAAC;MAAE,CAAC;MACjD,IAAIuB,CAAC,EAAEC,CAAC,EAAEC,GAAG;MAEb,IAAI,IAAI,CAAChB,OAAO,CAACS,EAAE,CAAC,EAAEA,EAAE,GAAG,CAAC;MAC5B,IAAI,IAAI,CAACT,OAAO,CAACU,EAAE,CAAC,EAAEA,EAAE,GAAG,CAAC;MAE5B,IAAIC,KAAK,IAAIC,IAAI,EACbI,GAAG,GAAGxC,gBAAgB,CAACF,EAAE,CAAC2C,UAAU,CAAC;MAEzC,IAAIN,KAAK,EAAEG,CAAC,GAAG,IAAI,CAACb,gBAAgB,CAAC,MAAM,EAAEQ,EAAE,EAAEO,GAAG,CAAC;MACrD,IAAIJ,IAAI,EAAEG,CAAC,GAAG,IAAI,CAACd,gBAAgB,CAAC,KAAK,EAAES,EAAE,EAAEM,GAAG,CAAC;MAAC;MAEpD,OAAO;QACHvC,IAAI,EAAE,OAAOqC,CAAC,IAAI,WAAW,GAAGA,CAAC,GAAGD,EAAE,CAACJ,EAAE,CAAC;QAC1C9B,GAAG,EAAE,OAAOoC,CAAC,IAAI,WAAW,GAAGA,CAAC,GAAGF,EAAE,CAACH,EAAE,CAAC;QACzCF,UAAU,EAAEK,EAAE,CAACN,GAAG,CAAC;QACnBD,SAAS,EAAEO,EAAE,CAACR,GAAG,CAAC;QAClBa,SAAS,EAAE3C,EAAE,CAAC2C;MAClB,CAAC;IACL;;IAEA;AACJ;AACA;AACA;EAHI;IAAAvD,GAAA;IAAAC,KAAA,EAIA,SAAAH,KAAKA,CAAA,EAAG;MACJ,IAAIsD,CAAC;QAAEI,GAAG;QAAEC,EAAE;QAAEC,GAAG;QAAEC,EAAE;QAAEhD,EAAE,GAAG,IAAI,CAACd,IAAI,CAACD,OAAO;MAC/C,OAAOe,EAAE,CAAC2C,UAAU,IAAI,CAAC3C,EAAE,CAAC2C,UAAU,CAACM,IAAI,EAAE;QAEzC,IAAMhD,EAAE,GAAG,IAAI,CAAC6B,eAAe,CAAC9B,EAAE,CAAC2C,UAAU,CAAC;QAC9CF,CAAC,GAAGxC,EAAE,CAAC2C,SAAS;QAChBC,GAAG,GAAG,2BAA2B,CAACK,IAAI,CAACT,CAAC,CAAC;QAEzC,IAAMpC,GAAG,GAAGJ,EAAE,CAACI,GAAG;QAClB,IAAIF,IAAI,GAAGF,EAAE,CAACE,IAAI;UAClBgD,SAAS,GAAGlD,EAAE,CAAC+B,SAAS;UACxBoB,UAAU,GAAGnD,EAAE,CAACiC,UAAU;QAE1B,IAAIW,GAAG,IAAI7C,EAAE,CAAC2C,UAAU,CAACU,SAAS,CAACC,QAAQ,CAAC,eAAe,CAAC,IAAItD,EAAE,CAACqD,SAAS,CAACC,QAAQ,CAAC,eAAe,CAAC,IAC/FjD,GAAG,IAAI,CAAC,IAAIF,IAAI,IAAI,CAAC,IACrBgD,SAAS,IAAI,CAAC,IACdC,UAAU,IAAI,CAAC,EAChB;UACF,IAAIL,GAAG,GAAG/C,EAAE,CAAC2C,UAAU,CAACY,YAAY,CAAC,uBAAuB,CAAC,EAAE;YAC3DT,EAAE,GAAGU,aAAa,CAACC,QAAQ,CAACV,GAAG,CAAC;YAChC,IAAID,EAAE,EACF,IAAI,CAAC9D,IAAI,CAAC8D,EAAE,CAAC;UACrB,CAAC,MAAM;YACH,IAAIY,EAAE,GAAGb,GAAG,GAAG,IAAInE,kDAAM,CAAC,IAAI,CAACQ,IAAI,CAACyE,iBAAiB,CAAClB,CAAC,CAAC,CAAC,GAAG,KAAK;YAEjE,IAAII,GAAG,IAAIxC,GAAG,IAAI,CAAC,IAAIF,IAAI,IAAI,CAAC,IAAIgD,SAAS,IAAI,CAAC,IAAIC,UAAU,IAAI,CAAC,IAAIpD,EAAE,CAACqD,SAAS,CAACC,QAAQ,CAAC,eAAe,CAAC,EAAE;cAC7GN,EAAE,GAAG,IAAItE,kDAAM,CAAC,CAAC;cACjBsE,EAAE,CAACY,SAAS,CAACzD,IAAI,IAAE,CAAC,EAAEE,GAAG,IAAE,CAAC,CAAC,CAACuD,SAAS,CAACR,UAAU,IAAE,CAAC,EAAED,SAAS,IAAE,CAAC,CAAC;cAEpE,IAAIO,EAAE,EACFV,EAAE,CAACa,QAAQ,CAACH,EAAE,CAACpC,QAAQ,CAAC;cAE5B,IAAIwC,KAAK,GAAG,IAAI,CAAC/D,cAAc,CAACC,EAAE,CAAC2C,UAAU,CAAC;cAE9C3C,EAAE,CAAC2C,UAAU,CAACoB,KAAK,CAAC1D,GAAG,GAAG,CAAC;cAC3BL,EAAE,CAAC2C,UAAU,CAACoB,KAAK,CAAC5D,IAAI,GAAG,CAAC;cAC5BH,EAAE,CAAC2C,UAAU,CAACoB,KAAK,CAAC7B,UAAU,GAAG,CAAC;cAClClC,EAAE,CAAC2C,UAAU,CAACoB,KAAK,CAAC/B,SAAS,GAAG,CAAC;cACjChC,EAAE,CAAC2C,UAAU,CAACoB,KAAK,CAACC,eAAe,GAAG,KAAK;cAC3ChE,EAAE,CAAC2C,UAAU,CAACoB,KAAK,CAACnB,SAAS,GAAG,IAAI,CAAC1D,IAAI,CAAC+E,iBAAiB,CAACjB,EAAE,CAAC1B,QAAQ,CAAC;cAExE,IAAI,CAACtC,IAAI,CAACgE,EAAE,EAAEhD,EAAE,CAAC2C,UAAU,EAAEmB,KAAK,CAAC;YACvC;UACJ;QACJ;QACA9D,EAAE,GAAGA,EAAE,CAAC2C,UAAU;MACtB;IACJ;;IAEA;AACJ;AACA;EAFI;IAAAtD,GAAA;IAAAC,KAAA,EAGA,SAAA4E,UAAUA,CAAA,EAAI;MACV,IAAI,CAACC,MAAM,GAAG,IAAI,CAAC5E,UAAU,CAAC,CAAC;MAC/B,IAAG,IAAI,CAACmB,MAAM,EAAE;MAChB,IAAI0D,GAAG,EAAElD,CAAC;MACV,IAAMmD,KAAK,GAAG,IAAI3F,kDAAM,CAAC,CAAC;MAC1B,KAAKwC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACnC,KAAK,CAACuF,MAAM,EAAEpD,CAAC,EAAE,EAClCmD,KAAK,CAACT,SAAS,CAAC,IAAI,CAAC7E,KAAK,CAACmC,CAAC,CAAC,CAACG,MAAM,CAACkD,WAAW,CAAC,CAAC,CAAC;MAEvD,KAAKrD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACnC,KAAK,CAACuF,MAAM,EAAEpD,CAAC,EAAE,EAAE;QACpCkD,GAAG,GAAG,IAAI,CAACrF,KAAK,CAACmC,CAAC,CAAC;QACnB,IAAIkD,GAAG,CAACnF,OAAO,CAACoE,SAAS,CAACC,QAAQ,CAAC,eAAe,CAAC,EAAE;UACjD,IAAI,CAAC5C,MAAM,GAAG0D,GAAG,CAACI,aAAa,CAAC9D,MAAM,CAAC+D,GAAG,CAACJ,KAAK,CAACE,WAAW,CAAC,CAAC,CAAC;UAC/D;QACJ;MACJ;IACJ;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAAlF,GAAA;IAAAC,KAAA,EAKA,SAAAN,IAAIA,CAACyD,CAAC,EAAEzC,EAAE,EAAE;MACR,IAAIyC,CAAC,YAAYe,aAAa,EAAE;QAC5B,IAAI,CAACzE,KAAK,CAAC2F,OAAO,CAAC;UAAErD,MAAM,EAAEoB,CAAC,CAACpB,MAAM;UAAEpC,OAAO,EAAEe,EAAE,IAAIyC,CAAC,CAACxD,OAAO;UAAE0F,IAAI,EAAElC,CAAC,CAACmC,KAAK,CAAC3F,OAAO,CAAC4F,OAAO;UAAEL,aAAa,EAAE/B;QAAE,CAAC,CAAC;MACvH;MACA,IAAIA,CAAC,YAAY/D,kDAAM,EAAE;QACrB,IAAI,CAACK,KAAK,CAAC2F,OAAO,CAAC;UAAErD,MAAM,EAAEoB,CAAC;UAAExD,OAAO,EAAEe,EAAE;UAAE2E,IAAI,EAAE,IAAI,CAAC5E,cAAc,CAACC,EAAE;QAAE,CAAC,CAAC;MACjF;IACJ;;IAEA;AACJ;AACA;AACA;EAHI;IAAAX,GAAA;IAAAC,KAAA,EAIA,SAAAwF,UAAUA,CAAA,EAAG;MACT,IAAIC,CAAC,GAAG,EAAE;MACV;MACA,IAAI,CAAChG,KAAK,CAACiC,OAAO,CAAC,UAAUC,CAAC,EAAEC,CAAC,EAAE;QAC/B,IAAIuB,CAAC,GAAGxB,CAAC,CAACuD,aAAa;UAAEQ,CAAC;UAAEC,EAAE;QAC9B,IAAI,CAACxC,CAAC,EACF,IAAIwC,EAAE,GAAGhE,CAAC,CAAChC,OAAO,CAACsE,YAAY,CAAC,uBAAuB,CAAC,EAAE;UACtDd,CAAC,GAAGe,aAAa,CAACC,QAAQ,CAACwB,EAAE,CAAC;UAC9BhE,CAAC,CAACuD,aAAa,GAAG/B,CAAC;QACvB;QAEJuC,CAAC,GAAGvC,CAAC,GAAGA,CAAC,CAACpB,MAAM,GAAGJ,CAAC,CAACI,MAAM;QAC3B0D,CAAC,CAACG,IAAI,CAAC;UACHxG,MAAM,EAAEsG,CAAC;UACTG,OAAO,EAAEH,CAAC,CAACI,OAAO,CAAC,CAAC;UACpBC,OAAO,EAAEpE,CAAC,CAAChC;QACf,CAAC,CAAC;MACN,CAAC,CAAC;MACF,OAAO8F,CAAC;IACZ;;IAEA;AACJ;AACA;AACA;EAHI;IAAA1F,GAAA;IAAAC,KAAA,EAIA,SAAAgG,gBAAgBA,CAACC,CAAC,EAAE;MAChB,IAAMC,GAAG,GAAG,IAAI,CAACC,SAAS,CAAC,CAAC;MAC5B,OAAO;QACH5E,WAAW,EAAE2E,GAAG,CAACE,cAAc,CAACH,CAAC,CAAC1E,WAAW,CAAC;QAC9CC,UAAU,EAAE0E,GAAG,CAACE,cAAc,CAACH,CAAC,CAACzE,UAAU,CAAC;QAC5CF,QAAQ,EAAE4E,GAAG,CAACE,cAAc,CAACH,CAAC,CAAC3E,QAAQ,CAAC;QACxCD,OAAO,EAAE6E,GAAG,CAACE,cAAc,CAACH,CAAC,CAAC5E,OAAO;MACzC,CAAC;IACL;;IAEA;AACJ;AACA;EAFI;IAAAtB,GAAA;IAAAC,KAAA,EAGA,SAAAqG,WAAWA,CAAA,EAAG;MACV,IAAMlD,CAAC,GAAG,IAAI;QAAEvB,CAAC,GAAGuB,CAAC,CAAC1D,KAAK;QAAEyD,CAAC,GAAGtB,CAAC,CAACoD,MAAM;MACzC,IAAMsB,GAAG,GAAGpD,CAAC,GAAG,CAAC,GAAGtB,CAAC,CAACsB,CAAC,GAAG,CAAC,CAAC,GAAG,KAAK;MAEpC,OAAOoD,GAAG;IACd;;IAEA;AACJ;AACA;EAFI;IAAAvG,GAAA;IAAAC,KAAA,EAGA,SAAAmG,SAASA,CAAA,EAAG;MACR,IAAID,GAAG,GAAG9G,kDAAM,CAACmH,QAAQ,CAAC,CAAC;MAC3B,IAAI,CAAC9G,KAAK,CAACiC,OAAO,CAAC,UAAUC,CAAC,EAAEC,CAAC,EAAE;QAC/BsE,GAAG,CAAC3B,QAAQ,CAAC5C,CAAC,CAACI,MAAM,CAACC,QAAQ,CAAC;MACnC,CAAC,CAAC;MACF,OAAOkE,GAAG;IACd;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAAnG,GAAA;IAAAC,KAAA,EAKA,SAAAwG,eAAeA,CAACC,CAAC,EAAEC,IAAI,EAAE;MACrBA,IAAI,GAAGA,IAAI,IAAI,IAAI,CAAClB,UAAU,CAAC,CAAC;MAChC,IAAI,CAACZ,UAAU,CAAC,CAAC;MACjB,IAAI+B,EAAE,GAAGF,CAAC;QAAE3B,GAAG;QAAEoB,GAAG,GAAG9G,kDAAM,CAACmH,QAAQ,CAAC,CAAC,CAACjC,SAAS,CAAC,IAAI,CAAClD,MAAM,CAAC;MAE/D,KAAK,IAAIQ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG8E,IAAI,CAAC1B,MAAM,EAAEpD,CAAC,EAAE,EAAE;QAClCkD,GAAG,GAAG4B,IAAI,CAAC9E,CAAC,CAAC;QACbsE,GAAG,CAAC3B,QAAQ,CAACO,GAAG,CAAC1F,MAAM,CAAC4C,QAAQ,CAAC;MACrC;MAEA,IAAM4E,MAAM,GAAGV,GAAG,CAACJ,OAAO,CAAC,CAAC;MAC5Ba,EAAE,GAAGC,MAAM,CAACR,cAAc,CAACO,EAAE,CAAC;MAE9B,OAAOA,EAAE;IACb;EAAC;AAAA;AAIL,iEAAerH,QAAQ,E;;;;;;;;;;;;;;;AC1SQ;AAE/B,IAAIF,OAAM,GAAG,SAATA,MAAMA,CAAayH,CAAC,EAAE;EACtB,IAAIA,CAAC,IAAI,IAAI,IAAI,OAAOA,CAAC,IAAI,WAAW,EACpC,OAAOzH,OAAM,CAACmH,QAAQ,CAAC,CAAC;EAE5B,IAAIM,CAAC,YAAYC,KAAK,EAAE;IACpB,IAAI,CAAC9E,QAAQ,GAAG6E,CAAC,CAACE,KAAK,CAAC,CAAC,CAAC;EAC9B,CAAC,MAAM;IACH,IAAGF,CAAC,YAAYzH,OAAM,EAAE;MACpB,IAAI,CAAC4C,QAAQ,GAAG6E,CAAC,CAAC7E,QAAQ,CAAC+E,KAAK,CAAC,CAAC,CAAC;IACvC,CAAC,MAAM;MACH,IAAIC,SAAS,CAAChC,MAAM,IAAI,CAAC,EAAE;QACvB,IAAI,CAAChD,QAAQ,GAAG,EAAE;QAClB,IAAIJ,CAAC,GAAG,CAAC;QACT,OAAOA,CAAC,GAAGoF,SAAS,CAAChC,MAAM,EACvB,IAAI,CAAChD,QAAQ,CAAC4D,IAAI,CAACoB,SAAS,CAACpF,CAAC,EAAE,CAAC,CAAC;MAC1C,CAAC,MACG,MAAM,IAAIqF,KAAK,CAAC,2FAA2F,CAAC;IACpH;EACJ;EACA,IAAI,CAACC,OAAO,GAAG;IAAEC,IAAI,EAAE,EAAE;IAAEC,IAAI,EAAE;EAAG,CAAC;EAErC,OAAO,IAAI;AACf,CAAC;AACDhI,OAAM,CAACmH,QAAQ,GAAG,YAAY;EAC1B,OAAO,IAAInH,OAAM,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AACzC,CAAC;AACDA,OAAM,CAACiI,SAAS,GAAG;EACfjB,cAAc,EAAE,SAAhBA,cAAcA,CAAY5C,EAAE,EAAE;IAC1B,IAAIkC,CAAC,GAAG,IAAI,CAAC1D,QAAQ;IAC3B,OAAO,IAAI3C,iDAAK,CACfmE,EAAE,CAAC8D,CAAC,GAAG5B,CAAC,CAAC,CAAC,CAAC,GAAGlC,EAAE,CAAC+D,CAAC,GAAG7B,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,EAChClC,EAAE,CAAC8D,CAAC,GAAG5B,CAAC,CAAC,CAAC,CAAC,GAAGlC,EAAE,CAAC+D,CAAC,GAAG7B,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAChC,CAAC;EACC,CAAC;EACDnB,QAAQ,EAAE,SAAVA,QAAQA,CAAWiD,GAAG,EAAE;IACpB,IAAIC,EAAE,GAAG,IAAI,CAACzF,QAAQ;IACtB,IAAI0F,EAAE,GAAGD,EAAE,CAAC,CAAC,CAAC;MACnBE,EAAE,GAAGF,EAAE,CAAC,CAAC,CAAC;MACVG,EAAE,GAAGH,EAAE,CAAC,CAAC,CAAC;MACVI,EAAE,GAAGJ,EAAE,CAAC,CAAC,CAAC;MACVK,EAAE,GAAGL,EAAE,CAAC,CAAC,CAAC;MACVM,EAAE,GAAGN,EAAE,CAAC,CAAC,CAAC;MACDO,EAAE,GAAGR,GAAG,CAAC,CAAC,CAAC;MACXS,EAAE,GAAGT,GAAG,CAAC,CAAC,CAAC;MACXU,EAAE,GAAGV,GAAG,CAAC,CAAC,CAAC;MACXW,EAAE,GAAGX,GAAG,CAAC,CAAC,CAAC;MACXY,EAAE,GAAGZ,GAAG,CAAC,CAAC,CAAC;MACXa,EAAE,GAAGb,GAAG,CAAC,CAAC,CAAC;;IAGrB;AACF;AACA;AACA;AACA;IACE,IAAI,CAACxF,QAAQ,GAAG,CACN0F,EAAE,GAAGM,EAAE,GAAGJ,EAAE,GAAGK,EAAE,EACjBN,EAAE,GAAGK,EAAE,GAAGH,EAAE,GAAGI,EAAE,EACjBP,EAAE,GAAGQ,EAAE,GAAGN,EAAE,GAAGO,EAAE,EACjBR,EAAE,GAAGO,EAAE,GAAGL,EAAE,GAAGM,EAAE,EACjBT,EAAE,GAAGU,EAAE,GAAGR,EAAE,GAAGS,EAAE,GAAGP,EAAE,EACtBH,EAAE,GAAGS,EAAE,GAAGP,EAAE,GAAGQ,EAAE,GAAGN,EAAE,CAC/B;IAED,OAAO,IAAI;EACT,CAAC;EACDO,aAAa,EAAE,SAAfA,aAAaA,CAAYzB,CAAC,EAAE0B,CAAC,EAAE;IAC3B,IAAI,CAAC1B,CAAC,IAAI,CAAC0B,CAAC,EAAE,OAAO,KAAK;IAC1B,OACA1B,CAAC,CAAC,CAAC,CAAC,IAAI0B,CAAC,CAAC,CAAC,CAAC,IACZ1B,CAAC,CAAC,CAAC,CAAC,IAAI0B,CAAC,CAAC,CAAC,CAAC,IACZ1B,CAAC,CAAC,CAAC,CAAC,IAAI0B,CAAC,CAAC,CAAC,CAAC,IACZ1B,CAAC,CAAC,CAAC,CAAC,IAAI0B,CAAC,CAAC,CAAC,CAAC,IACZ1B,CAAC,CAAC,CAAC,CAAC,IAAI0B,CAAC,CAAC,CAAC,CAAC,IACZ1B,CAAC,CAAC,CAAC,CAAC,IAAI0B,CAAC,CAAC,CAAC,CAAC;EAChB,CAAC;EACDC,IAAI,EAAE,SAANA,IAAIA,CAAYhB,GAAG,EAAE;IACjB,IAAItG,CAAC,GAAG,IAAI,CAACgG,OAAO;MAAEuB,IAAI;MACtBnG,CAAC,GAAG,OAAOkF,GAAG,KAAK,QAAQ,GAAGA,GAAG,GAAG,KAAK;IAE7C,IAAI,CAACA,GAAG,IAAIlF,CAAC,EACTkF,GAAG,GAAG,IAAI,CAACxF,QAAQ;IAEvByG,IAAI,GAAGvH,CAAC,CAACiG,IAAI,CAACjG,CAAC,CAACiG,IAAI,CAACnC,MAAM,GAAG,CAAC,CAAC;IAEhC,IAAI,CAAC,IAAI,CAACsD,aAAa,CAACd,GAAG,EAAEiB,IAAI,CAAC,EAAE;MAChC,IAAIvF,CAAC,GAAGhC,CAAC,CAACiG,IAAI,CAACvB,IAAI,CAAC4B,GAAG,CAACT,KAAK,CAAC,CAAC,CAAC,CAAC;MACjC7F,CAAC,CAACkG,IAAI,GAAG,EAAE;MACX,IAAI9E,CAAC,EACDpB,CAAC,CAACiG,IAAI,CAAC7E,CAAC,CAAC,GAAGpB,CAAC,CAACiG,IAAI,CAACjE,CAAC,GAAG,CAAC,CAAC;IACjC,CAAC,MACG,IAAIZ,CAAC,EAAE;MACHpB,CAAC,CAACiG,IAAI,CAAC7E,CAAC,CAAC,GAAGmG,IAAI;IACpB;EACR,CAAC;EACDtB,IAAI,EAAE,SAANA,IAAIA,CAAY7E,CAAC,EAAE;IACf,IAAIpB,CAAC,GAAG,IAAI,CAACgG,OAAO,CAACC,IAAI;MACrBuB,GAAG,GAAGxH,CAAC,CAAC8D,MAAM;MACdF,GAAG,GAAG5D,CAAC,CAACyH,GAAG,CAAC,CAAC;MACbC,IAAI,GAAG,OAAOtG,CAAC,IAAI,QAAQ,GAAGpB,CAAC,CAACoB,CAAC,CAAC,GAAGpB,CAAC,CAACA,CAAC,CAAC8D,MAAM,GAAG,CAAC,CAAC;IAExD,IAAIF,GAAG,EACH,IAAI,CAACoC,OAAO,CAACE,IAAI,CAAChC,OAAO,CAACN,GAAG,CAAC;IAElC,IAAI,CAAC9C,QAAQ,GAAG4G,IAAI,GAAGA,IAAI,CAAC7B,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC8B,QAAQ,CAAC,CAAC;EAC1D,CAAC;EACDzB,IAAI,EAAE,SAANA,IAAIA,CAAA,EAAc;IACd,IAAIlG,CAAC,GAAG,IAAI,CAACgG,OAAO,CAACE,IAAI;MACrBsB,GAAG,GAAGxH,CAAC,CAAC8D,MAAM;MACdF,GAAG,GAAG5D,CAAC,CAACyH,GAAG,CAAC,CAAC;MACbC,IAAI,GAAG1H,CAAC,CAACA,CAAC,CAAC8D,MAAM,GAAG,CAAC,CAAC;IAE1B,IAAIF,GAAG,EACH,IAAI,CAACoC,OAAO,CAACC,IAAI,CAAC/B,OAAO,CAACN,GAAG,CAAC;IAElC,IAAI,CAAC9C,QAAQ,GAAG4G,IAAI,GAAGA,IAAI,CAAC7B,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC8B,QAAQ,CAAC,CAAC;EAC1D,CAAC;EACDC,KAAK,EAAE,SAAPA,KAAKA,CAAA,EAAc;IACf,IAAI,CAAC9G,QAAQ,GAAG,IAAI,CAAC6G,QAAQ,CAAC,CAAC;IAC/B,OAAO,IAAI;EACf,CAAC;EACDE,WAAW,EAAE,SAAbA,WAAWA,CAAA,EAAc;IACrB,IAAIrD,CAAC,GAAG,IAAI,CAAC1D,QAAQ;IACrB,OAAO0D,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC,GAAGA,CAAC,CAAC,CAAC,CAAC;EACpC,CAAC;EACJI,OAAO,EAAE,SAATA,OAAOA,CAAA,EAAa;IAEnB,IAAI2B,EAAE,GAAG,IAAI,CAACzF,QAAQ;MACrB0D,CAAC,GAAI,IAAI,CAACmD,QAAQ,CAAC,CAAC;MACpBG,EAAE,GAAG,IAAI,CAACD,WAAW,CAAC,CAAC;IAExB,IAAIC,EAAE,GAAG,KAAK,EACb,MAAM,wBAAwB;IAE/BtD,CAAC,CAAC,CAAC,CAAC,GAAG+B,EAAE,CAAC,CAAC,CAAC,GAAGuB,EAAE;IACjBtD,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC+B,EAAE,CAAC,CAAC,CAAC,GAAGuB,EAAE;IAClBtD,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC+B,EAAE,CAAC,CAAC,CAAC,GAAGuB,EAAE;IAClBtD,CAAC,CAAC,CAAC,CAAC,GAAG+B,EAAE,CAAC,CAAC,CAAC,GAAGuB,EAAE;IACjBtD,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC+B,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE,CAAC,CAAC,CAAC,IAAIuB,EAAE;IAC3CtD,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE+B,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE,CAAC,CAAC,CAAC,CAAC,GAAGuB,EAAE;IAE5C,OAAO,IAAI5J,OAAM,CAACsG,CAAC,CAAC;EACrB,CAAC;EACDuD,MAAM,EAAE,SAARA,MAAMA,CAAA,EAAc;IACb,OAAO,IAAI,CAAC1E,QAAQ,CAAC,IAAI,CAACuB,OAAO,CAAC,CAAC,CAAC9D,QAAQ,CAAC;EACpD,CAAC;EACE6G,QAAQ,EAAE,SAAVA,QAAQA,CAAA,EAAc;IAClB,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAC7B,CAAC;EACDK,UAAU,EAAE,SAAZA,UAAUA,CAAA,EAAc;IACpB,IAAIxD,CAAC,GAAG,IAAI,CAAC1D,QAAQ;IACrB,OAAO0D,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAIA,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;EAC3F,CAAC;EACDpB,SAAS,EAAE,SAAXA,SAASA,CAAYgD,CAAC,EAAEC,CAAC,EAAE;IACvB,IAAID,CAAC,YAAYjI,iDAAK,IAAI,CAACkI,CAAC,EACxB,OAAO,IAAI,CAAChD,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE+C,CAAC,CAACA,CAAC,EAAEA,CAAC,CAACC,CAAC,CAAC,CAAC;IAEhD,OAAO,IAAI,CAAChD,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE+C,CAAC,EAAEC,CAAC,CAAC,CAAC;EAC5C,CAAC;EACD4B,KAAK,EAAE,SAAPA,KAAKA,CAAY3F,EAAE,EAAE4F,CAAC,EAAE;IACpB,IAAI,CAAC7E,QAAQ,CAAC,CAAC6E,CAAC,EAAE,CAAC,EAAE,CAAC,EAAEA,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IACjC,IAAIC,EAAE,GAAG7F,EAAE,CAAC2B,GAAG,CAAC3B,EAAE,CAAC2F,KAAK,CAACC,CAAC,CAAC,CAAC,CAACD,KAAK,CAAC,CAAC,GAACC,CAAC,CAAC,CAAC,CAAC;IACzC,OAAO,IAAI,CAAC9E,SAAS,CAAC+E,EAAE,CAAC;EAC7B,CAAC;EACDC,gBAAgB,EAAE,SAAlBA,gBAAgBA,CAAY9F,EAAE,EAAEqD,CAAC,EAAE;IAC/B,IAAIpB,CAAC,GAAGoB,CAAC,GAAG0C,IAAI,CAACC,EAAE,GAAG,GAAG;IACzB,OAAO,IAAI,CAACjF,QAAQ,CAAC,CACjBgF,IAAI,CAACE,GAAG,CAAChE,CAAC,CAAC,EACX8D,IAAI,CAACG,GAAG,CAACjE,CAAC,CAAC,EACX,CAAC8D,IAAI,CAACG,GAAG,CAACjE,CAAC,CAAC,EACZ8D,IAAI,CAACE,GAAG,CAAChE,CAAC,CAAC,EACXjC,EAAE,CAAC8D,CAAC,GAAGiC,IAAI,CAACE,GAAG,CAAChE,CAAC,CAAC,GAAGjC,EAAE,CAAC8D,CAAC,GAAG,CAACiC,IAAI,CAACG,GAAG,CAACjE,CAAC,CAAC,GAAGjC,EAAE,CAAC+D,CAAC,EAC/C/D,EAAE,CAAC+D,CAAC,GAAGgC,IAAI,CAACG,GAAG,CAACjE,CAAC,CAAC,GAAGjC,EAAE,CAAC8D,CAAC,GAAGiC,IAAI,CAACE,GAAG,CAAChE,CAAC,CAAC,GAAGjC,EAAE,CAAC+D,CAAC,CACjD,CAAC;EACN,CAAC;EACDoC,MAAM,EAAE,SAARA,MAAMA,CAAY9C,CAAC,EAAC0B,CAAC,EAAE;IACnB,IAAI1B,CAAC,YAAYxH,iDAAK,EAClB,OAAO,IAAI,CAACiK,gBAAgB,CAACzC,CAAC,EAAE0B,CAAC,CAAC;IAEtC,IAAI9C,CAAC,GAAGoB,CAAC,GAAG0C,IAAI,CAACC,EAAE,GAAG,GAAG;IACzB,OAAO,IAAI,CAACjF,QAAQ,CAAC,CAACgF,IAAI,CAACE,GAAG,CAAChE,CAAC,CAAC,EAAE8D,IAAI,CAACG,GAAG,CAACjE,CAAC,CAAC,EAAE,CAAC8D,IAAI,CAACG,GAAG,CAACjE,CAAC,CAAC,EAAE8D,IAAI,CAACE,GAAG,CAAChE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;EACrF,CAAC;EACDmE,YAAY,EAAE,SAAdA,YAAYA,CAAYnE,CAAC,EAAE;IACvB,OAAOA,CAAC,GAAG,CAAC,GAAGA,CAAC,GAAG,GAAG,GAAGA,CAAC;EAC9B,CAAC;EACDoE,QAAQ,EAAE,SAAVA,QAAQA,CAAYC,IAAI,EAAE;IACtB,IAAI5G,CAAC,GAAG,IAAI,CAAClB,QAAQ;MAAEyD,CAAC,GAAG8D,IAAI,CAACQ,KAAK,CAAC7G,CAAC,CAAC,CAAC,CAAC,EAAEA,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGqG,IAAI,CAACC,EAAE;IAEjE,OAAOM,IAAI,GAAG,IAAI,CAACF,YAAY,CAACnE,CAAC,CAAC,GAAGA,CAAC;EAC1C,CAAC;EACDuE,OAAO,EAAE,SAATA,OAAOA,CAAA,EAAc;IACjB,OAAOT,IAAI,CAACU,IAAI,CAACV,IAAI,CAACW,GAAG,CAAC,IAAI,CAAClI,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAGuH,IAAI,CAACW,GAAG,CAAC,IAAI,CAAClI,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EACnF,CAAC;EACDiD,WAAW,EAAE,SAAbA,WAAWA,CAAA,EAAc;IACrB,OAAO,IAAI5F,iDAAK,CAAC,IAAI,CAAC2C,QAAQ,CAAC,CAAC,CAAC,EAAE,IAAI,CAACA,QAAQ,CAAC,CAAC,CAAC,CAAC;EACxD;AACJ,CAAC;AAED,iEAAe5C,OAAM,E;;;;;;;;;;;;;;;;;;;;ICxMfC,KAAK;EACT,SAAAA,MAAYiI,CAAC,EAAS;IAAA,IAAPC,CAAC,GAAAP,SAAA,CAAAhC,MAAA,QAAAgC,SAAA,QAAAmD,SAAA,GAAAnD,SAAA,MAAGM,CAAC;IAAA9H,eAAA,OAAAH,KAAA;IAClB,IAAI,CAACiI,CAAC,GAAGA,CAAC;IACV,IAAI,CAACC,CAAC,GAAGA,CAAC;EACZ;EAAC,OAAAzH,YAAA,CAAAT,KAAA;IAAAU,GAAA;IAAAC,KAAA,EAED,SAAAmJ,KAAKA,CAACiB,MAAM,EAAE;MACZ,OAAO,IAAI/K,KAAK,CAAC,IAAI,CAACiI,CAAC,GAAG8C,MAAM,EAAE,IAAI,CAAC7C,CAAC,GAAG6C,MAAM,CAAC;IACpD;EAAC;IAAArK,GAAA;IAAAC,KAAA,EAED,SAAAqK,KAAKA,CAAA,EAAgB;MAAA,IAAfC,SAAS,GAAAtD,SAAA,CAAAhC,MAAA,QAAAgC,SAAA,QAAAmD,SAAA,GAAAnD,SAAA,MAAG,CAAC;MACjB,IAAMoD,MAAM,GAAGE,SAAS,GAAGf,IAAI,CAACW,GAAG,CAAC,EAAE,EAAEI,SAAS,CAAC,GAAG,CAAC;MACtD,OAAO,IAAIjL,KAAK,CACdkK,IAAI,CAACc,KAAK,CAAC,IAAI,CAAC/C,CAAC,GAAG8C,MAAM,CAAC,GAAGA,MAAM,EACpCb,IAAI,CAACc,KAAK,CAAC,IAAI,CAAC9C,CAAC,GAAG6C,MAAM,CAAC,GAAGA,MAChC,CAAC;IACH;EAAC;IAAArK,GAAA;IAAAC,KAAA,EAED,SAAAmF,GAAGA,CAACsB,CAAC,EAAE;MACL,OAAO,IAAIpH,KAAK,CAAC,IAAI,CAACiI,CAAC,GAAGb,CAAC,CAACa,CAAC,EAAE,IAAI,CAACC,CAAC,GAAGd,CAAC,CAACc,CAAC,CAAC;IAC9C;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAAuK,GAAGA,CAAC9D,CAAC,EAAE;MACL,OAAO,IAAIpH,KAAK,CAAC,IAAI,CAACiI,CAAC,GAAGb,CAAC,CAACa,CAAC,EAAE,IAAI,CAACC,CAAC,GAAGd,CAAC,CAACc,CAAC,CAAC;IAC9C;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAAwK,IAAIA,CAAC/D,CAAC,EAAE;MACN,OAAO,IAAIpH,KAAK,CAAC,IAAI,CAACiI,CAAC,GAAGb,CAAC,CAACa,CAAC,EAAE,IAAI,CAACC,CAAC,GAAGd,CAAC,CAACc,CAAC,CAAC;IAC9C;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAAyK,MAAMA,CAAChE,CAAC,EAAE;MACR,OAAO,IAAIpH,KAAK,CAAC,IAAI,CAACiI,CAAC,GAAGb,CAAC,CAACa,CAAC,EAAE,IAAI,CAACC,CAAC,GAAGd,CAAC,CAACc,CAAC,CAAC;IAC9C;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAA0K,OAAOA,CAAA,EAAG;MACR,OAAO,IAAI,CAACpD,CAAC,KAAK,CAAC,IAAI,IAAI,CAACC,CAAC,KAAK,CAAC;IACrC;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAA2K,MAAMA,CAAClE,CAAC,EAAE;MACR,OAAO,IAAI,CAACa,CAAC,KAAKb,CAAC,CAACa,CAAC,IAAI,IAAI,CAACC,CAAC,KAAKd,CAAC,CAACc,CAAC;IACzC;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAA4K,QAAQA,CAACnE,CAAC,EAAE;MACV,OAAO;QAAEa,CAAC,EAAE,IAAI,CAACA,CAAC,IAAIb,CAAC,CAACa,CAAC;QAAEC,CAAC,EAAE,IAAI,CAACA,CAAC,IAAId,CAAC,CAACc;MAAE,CAAC;IAC/C;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAA6K,QAAQA,CAACpE,CAAC,EAAE;MACV,OAAO;QAAEa,CAAC,EAAE,IAAI,CAACA,CAAC,IAAIb,CAAC,CAACa,CAAC;QAAEC,CAAC,EAAE,IAAI,CAACA,CAAC,IAAId,CAAC,CAACc;MAAE,CAAC;IAC/C;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAA8K,GAAGA,CAACrE,CAAC,EAAE;MACL,OAAO,IAAI,CAACa,CAAC,GAAGb,CAAC,CAACa,CAAC,GAAG,IAAI,CAACC,CAAC,GAAGd,CAAC,CAACc,CAAC;IACpC;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAED,SAAA+K,UAAUA,CAACC,EAAE,EAAEC,EAAE,EAAE;MACjB,IAAM3I,CAAC,GAAG,CAAC,CAAC2I,EAAE,CAAC1D,CAAC,GAAGyD,EAAE,CAACzD,CAAC,KAAK,IAAI,CAACD,CAAC,GAAG0D,EAAE,CAAC1D,CAAC,CAAC,GAAG,CAAC2D,EAAE,CAAC3D,CAAC,GAAG0D,EAAE,CAAC1D,CAAC,KAAK,IAAI,CAACC,CAAC,GAAGyD,EAAE,CAACzD,CAAC,CAAC,KACzEgC,IAAI,CAACW,GAAG,CAACe,EAAE,CAAC1D,CAAC,GAAGyD,EAAE,CAACzD,CAAC,EAAE,CAAC,CAAC,GAAGgC,IAAI,CAACW,GAAG,CAACe,EAAE,CAAC3D,CAAC,GAAG0D,EAAE,CAAC1D,CAAC,EAAE,CAAC,CAAC,CAAC;MACvD,IAAM4D,EAAE,GAAG,IAAI,CAAC5D,CAAC,GAAGhF,CAAC,IAAI2I,EAAE,CAAC1D,CAAC,GAAGyD,EAAE,CAACzD,CAAC,CAAC;MACrC,IAAM4D,EAAE,GAAG,IAAI,CAAC5D,CAAC,GAAGjF,CAAC,IAAI2I,EAAE,CAAC3D,CAAC,GAAG0D,EAAE,CAAC1D,CAAC,CAAC;MACrC,OAAO,IAAIjI,KAAK,CAAC6L,EAAE,EAAEC,EAAE,CAAC;IAC1B;EAAC;IAAApL,GAAA;IAAAC,KAAA,EAED,SAAAoL,GAAGA,CAAA,EAAG;MACJ,OAAO7B,IAAI,CAACU,IAAI,CAAC,IAAI,CAAC3C,CAAC,GAAG,IAAI,CAACA,CAAC,GAAG,IAAI,CAACC,CAAC,GAAG,IAAI,CAACA,CAAC,CAAC;IACrD;;IAEA;IACA;IACA;EAAA;AAAA;AAGF,iEAAelI,KAAK,E;;;;;;SCvEpB;SACA;;SAEA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;;SAEA;SACA;;SAEA;SACA;SACA;;;;;UCtBA;UACA;UACA;UACA;UACA,yCAAyC,wCAAwC;UACjF;UACA;UACA,E;;;;;UCPA,wF;;;;;UCAA;UACA;UACA;UACA,uDAAuD,iBAAiB;UACxE;UACA,gDAAgD,aAAa;UAC7D,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNkC;AACD;AACI;AACN;;AAE/B;AACA,CAAC,UAACa,MAAM,EAAEE,QAAQ,EAAK;EACnB,IAAIiL,MAAM,GAAG,EAAE;EACf,IAAIC,iBAAiB;;EAErB;EACA,IAAIpL,MAAM,CAACqL,gBAAgB,EAAE;IACzBD,iBAAiB,GAAG,kBAAkB;EAC1C,CAAC,MAAM;IACHA,iBAAiB,GAAG,aAAa;IACjCD,MAAM,GAAG,IAAI;EACjB;;EAEA;EACA,IAAMG,OAAO,GAAG,SAAS,IAAIpL,QAAQ,CAACqL,aAAa,CAAC,KAAK,CAAC,GAAG,OAAO;EAAG;EACvDrL,QAAQ,CAACsL,YAAY,KAAKvB,SAAS,GAAG,YAAY;EAAG;EACrD,gBAAgB,CAAC,CAAC;;EAElCjK,MAAM,CAACyL,gBAAgB,GAAG,UAACC,IAAI,EAAEC,QAAQ,EAAEC,UAAU,EAAK;IACtD,IAAMC,iBAAiB,GAAG,SAApBA,iBAAiBA,CAAIC,UAAU,EAAEC,SAAS,EAAEC,EAAE,EAAEC,OAAO,EAAK;MAC9DH,UAAU,CAACV,iBAAiB,CAAC,CAACD,MAAM,GAAGY,SAAS,EAAET,OAAO,KAAK,OAAO,GAAGU,EAAE,GAAG,UAACE,aAAa,EAAK;QAC5F,IAAMC,KAAK,GAAGD,aAAa,IAAIlM,MAAM,CAACmM,KAAK;;QAE3C;QACA,IAAMC,eAAe,GAAG;UACpBF,aAAa,EAAEC,KAAK;UACpBE,MAAM,EAAEF,KAAK,CAACE,MAAM,IAAIF,KAAK,CAACG,UAAU;UACxCC,IAAI,EAAE,OAAO;UACbC,SAAS,EAAEL,KAAK,CAACI,IAAI,KAAK,qBAAqB,GAAG,CAAC,GAAG,CAAC;UACvDE,MAAM,EAAE,CAAC;UACTC,MAAM,EAAE,CAAC;UACTC,MAAM,EAAE,CAAC;UACTC,cAAc,WAAdA,cAAcA,CAAA,EAAG;YACbT,KAAK,CAACS,cAAc,GAChBT,KAAK,CAACS,cAAc,CAAC,CAAC,GACtBT,KAAK,CAACU,WAAW,GAAG,KAAK;UACjC,CAAC;UACDC,eAAe,WAAfA,eAAeA,CAAA,EAAG;YACdX,KAAK,CAACW,eAAe,GACjBX,KAAK,CAACW,eAAe,CAAC,CAAC,GACvBX,KAAK,CAACU,WAAW,GAAG,KAAK;UACjC;QACJ,CAAC;;QAED;QACA,IAAIvB,OAAO,KAAK,YAAY,EAAE;UAC1Bc,eAAe,CAACM,MAAM,GAAG,CAAC,CAAC,GAAG,EAAE,GAAGP,KAAK,CAACY,UAAU;UACnD,IAAIZ,KAAK,CAACa,WAAW,EAAE;YACnBZ,eAAe,CAACK,MAAM,GAAG,CAAC,CAAC,GAAG,EAAE,GAAGN,KAAK,CAACa,WAAW;UACxD;QACJ,CAAC,MAAM;UACHZ,eAAe,CAACM,MAAM,GAAGP,KAAK,CAACc,MAAM;QACzC;QAEA,OAAOjB,EAAE,CAACI,eAAe,CAAC;MAC9B,CAAC,EAAEH,OAAO,IAAI,KAAK,CAAC;IACxB,CAAC;IAEDJ,iBAAiB,CAACH,IAAI,EAAEJ,OAAO,EAAEK,QAAQ,EAAEC,UAAU,CAAC;;IAEtD;IACA,IAAIN,OAAO,KAAK,gBAAgB,EAAE;MAC9BO,iBAAiB,CAACH,IAAI,EAAE,qBAAqB,EAAEC,QAAQ,EAAEC,UAAU,CAAC;IACxE;EACJ,CAAC;AACL,CAAC,EAAE5L,MAAM,EAAEE,QAAQ,CAAC;AAAC,IAEf8D,aAAa;EAWf;AACJ;AACA;AACA;AACA;EACI,SAAAA,cAAYxD,EAAE,EAAa;IAAA,IAAA0M,kBAAA;IAAA,IAAXC,IAAI,GAAArG,SAAA,CAAAhC,MAAA,QAAAgC,SAAA,QAAAmD,SAAA,GAAAnD,SAAA,MAAG,CAAC,CAAC;IAAAxH,eAAA,OAAA0E,aAAA;IACrB,IAAI,CAACvE,OAAO,GAAGe,EAAE,CAACsE,MAAM,GAAGtE,EAAE,CAAC,CAAC,CAAC,GAAGA,EAAE;IACrC,IAAI,CAAC4M,OAAO,GAAGD,IAAI;IAEnB,IAAI,CAAC1N,OAAO,CAACoE,SAAS,CAACwG,GAAG,CAAC,eAAe,CAAC;IAC3C,IAAI,CAACgD,MAAM,GAAG,IAAI,CAAC5N,OAAO,CAAC0D,UAAU;IAErC,IAAI,CAACmK,eAAe,CAAC,CAAC;IAEtB,IAAIH,IAAI,CAACtL,MAAM,EAAE;MAAA,IAAA0L,kBAAA,EAAAC,mBAAA;MACb,IAAMC,MAAM,GAAG;QAAErG,CAAC,EAAE,CAAC;QAAEC,CAAC,EAAE;MAAE,CAAC;MAC7B,IAAI,CAAAkG,kBAAA,GAAAJ,IAAI,CAACO,YAAY,cAAAH,kBAAA,eAAjBA,kBAAA,CAAmBxM,KAAK,KAAAyM,mBAAA,GAAIL,IAAI,CAACO,YAAY,cAAAF,mBAAA,eAAjBA,mBAAA,CAAmBG,KAAK,EAAE;QACtD,IAAMC,KAAK,GAAG;UACV7M,KAAK,EAAEoM,IAAI,CAACO,YAAY,CAAC3M,KAAK,IAAIoM,IAAI,CAACO,YAAY,CAACC,KAAK;UACzD1M,MAAM,EAAEkM,IAAI,CAACO,YAAY,CAACzM,MAAM,IAAIkM,IAAI,CAACO,YAAY,CAACG;QAC1D,CAAC;QACD,IAAMC,KAAK,GAAG,IAAI,CAAC1I,KAAK,CAAC3F,OAAO,CAAC4F,OAAO;QACxCoI,MAAM,CAACrG,CAAC,GAAG0G,KAAK,CAAC/M,KAAK,GAAG6M,KAAK,CAAC7M,KAAK;QACpC0M,MAAM,CAACpG,CAAC,GAAGyG,KAAK,CAAC7M,MAAM,GAAG2M,KAAK,CAAC3M,MAAM;MAC1C;MACA,IAAI2F,KAAK,CAACmH,OAAO,CAACZ,IAAI,CAACtL,MAAM,CAAC,IAAIsL,IAAI,CAACtL,MAAM,CAACiD,MAAM,KAAK,CAAC,EAAE;QACxDqI,IAAI,CAACtL,MAAM,CAAC,CAAC,CAAC,IAAI4L,MAAM,CAACrG,CAAC;QAC1B+F,IAAI,CAACtL,MAAM,CAAC,CAAC,CAAC,IAAI4L,MAAM,CAACpG,CAAC;QAC1B,IAAI,CAAC2G,UAAU,CAAC,IAAI9O,kDAAM,CAACiO,IAAI,CAACtL,MAAM,CAAC,CAAC;MAC5C,CAAC,MAAM,IAAIsL,IAAI,CAACtL,MAAM,YAAY3C,kDAAM,EAAE;QACtCiO,IAAI,CAACtL,MAAM,CAACC,QAAQ,CAAC,CAAC,CAAC,IAAI2L,MAAM,CAACrG,CAAC;QACnC+F,IAAI,CAACtL,MAAM,CAACC,QAAQ,CAAC,CAAC,CAAC,IAAI2L,MAAM,CAACpG,CAAC;QACnC,IAAI,CAAC2G,UAAU,CAACb,IAAI,CAACtL,MAAM,CAAC;MAChC;IACJ;IAEA,IAAI,CAACA,MAAM,GAAG,IAAI,CAACoM,UAAU,CAAC,CAAC;IAC/B,IAAI,CAACC,kBAAkB,GAAG,IAAI,CAACC,sBAAsB,CAAC,CAAC;IACvD,IAAI,CAAC/O,QAAQ,GAAG,IAAIA,oDAAQ,CAAC,IAAI,CAAC;IAElC,IAAI,CAACgP,UAAU,CAAC,CAAC;IACjB,IAAI,CAAChP,QAAQ,CAACsF,UAAU,CAAC,CAAC;IAE1B,IAAI,CAAC2J,QAAQ,GAAG,KAAK;IACrB,IAAI,CAACC,KAAK,GAAG,IAAI;IACjB,IAAI,CAACC,IAAI,GAAG,IAAI;IAChB,IAAI,CAACC,KAAK,GAAG,KAAK;IAElB,IAAI,CAACC,MAAM,GAAG;MACVH,KAAK,EAAEnB,IAAI,CAACmB,KAAK;MACjBI,IAAI,EAAEvB,IAAI,CAACuB,IAAI;MACfC,IAAI,EAAExB,IAAI,CAACwB,IAAI;MACfC,GAAG,EAAEzB,IAAI,CAACyB,GAAG;MACbC,UAAU,EAAE1B,IAAI,CAAC0B;IACrB,CAAC;IAED,IAAI,CAACpP,OAAO,CAACqP,YAAY,CAAC,uBAAuB,EAAE9K,aAAa,CAACC,QAAQ,CAACyB,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACzF,IAAI,CAACqJ,SAAS,CAACC,SAAS,CAACC,QAAQ,CAAC,MAAM,CAAC,EAAE;MACvC,IAAI,CAACxP,OAAO,CAACqP,YAAY,CAAC,WAAW,EAAE,OAAO,CAAC;IACnD;IAEA,IAAI,EAAA5B,kBAAA,GAACC,IAAI,CAAC+B,YAAY,cAAAhC,kBAAA,cAAAA,kBAAA,GAAI,IAAI,KAAKC,IAAI,CAACgC,QAAQ,KAAK,KAAK,EAAE;MAAA,IAAAC,aAAA;MACxD,IAAI,CAACC,UAAU,CAAC,CAAC;MACjB,IAAIlC,IAAI,CAACmC,MAAM,EAAE,IAAI,CAACC,mBAAmB,CAACpC,IAAI,CAACmC,MAAM,CAAC;MACtD,IAAI,GAAAF,aAAA,GAACjC,IAAI,CAACqC,OAAO,cAAAJ,aAAA,eAAZA,aAAA,CAAc3F,MAAM,GAAE,IAAI,CAACgG,mBAAmB,CAAC,CAAC;MACrD,IAAItC,IAAI,CAACuC,MAAM,IAAIvC,IAAI,CAACZ,IAAI,KAAK,aAAa,EAAE,IAAI,CAACoD,gBAAgB,CAACxC,IAAI,CAACuC,MAAM,CAAC;IACtF;EACJ;;EAEA;AACJ;AACA;AACA;EAHI,OAAA9P,YAAA,CAAAoE,aAAA;IAAAnE,GAAA;IAAAC,KAAA,EAIA,SAAAqO,sBAAsBA,CAAA,EAAG;MACrB,IAAMlL,CAAC,GAAGvC,gBAAgB,CAAC,IAAI,CAACjB,OAAO,CAAC,CAACoP,UAAU;MACnD,IAAI,CAAC5L,CAAC,EAAE,OAAO,EAAE;MACjB,OAAOA,CAAC,CAAC2M,KAAK,CAAC,GAAG,CAAC,CAACC,MAAM,CAAC,UAAAC,IAAI;QAAA,OAAI,CAACA,IAAI,CAACC,IAAI,CAAC,CAAC,CAACC,UAAU,CAAC,WAAW,CAAC;MAAA,EAAC,CAACC,IAAI,CAAC,GAAG,CAAC;IACtF;;IAEA;AACJ;AACA;AACA;EAHI;IAAApQ,GAAA;IAAAC,KAAA,EAIA,SAAAoQ,GAAGA,CAACC,GAAG,EAAE;MACL,IAAM5K,CAAC,GAAGrF,QAAQ,CAACqL,aAAa,CAAC,KAAK,CAAC;MACvChG,CAAC,CAAC6K,SAAS,GAAGD,GAAG;MACjB,OAAO5K,CAAC,CAAC8K,UAAU;IACvB;;IAEA;AACJ;AACA;AACA;EAHI;IAAAxQ,GAAA;IAAAC,KAAA,EAIA,SAAA2P,mBAAmBA,CAACa,GAAG,EAAE;MAAA,IAAAC,KAAA;MACrB,IAAID,GAAG,IAAIA,GAAG,KAAK,QAAQ,EAAE;MAE7B,IAAME,GAAG,GAAG,IAAI,CAACN,GAAG,CAAC,gDAAgD,CAAC;MACtE,IAAMO,GAAG,GAAG,IAAI,CAACP,GAAG,CAAC,0sDAA0sD,CAAC;MAChuD,IAAMQ,GAAG,GAAG,IAAI,CAACR,GAAG,CAAC,w/BAAw/B,CAAC;MAC9gC,IAAMS,GAAG,GAAG,IAAI,CAACT,GAAG,CAAC,iDAAiD,CAAC;MAEvEM,GAAG,CAACI,MAAM,CAACD,GAAG,EAAED,GAAG,EAAED,GAAG,EAAE,IAAI,CAACP,GAAG,CAAC,gDAAgD,CAAC,CAAC;MAErF,IAAI,IAAI,CAACzQ,OAAO,CAACoR,QAAQ,KAAK,KAAK,EAAE;QACjC,IAAI,CAACxD,MAAM,CAACyD,WAAW,CAACN,GAAG,CAAC;MAChC,CAAC,MAAM;QACH,IAAI,CAAC/Q,OAAO,CAACqR,WAAW,CAACN,GAAG,CAAC;MACjC;MAEAA,GAAG,CAACnF,gBAAgB,CAAC,OAAO,EAAE,UAAA0F,CAAC,EAAI;QAAEA,CAAC,CAACjE,eAAe,CAAC,CAAC;QAAE,OAAO,KAAK;MAAE,CAAC,CAAC;MAE1E,IAAI,CAACkE,UAAU,GAAG,IAAIhN,aAAa,CAACwM,GAAG,EAAE;QAAEjE,IAAI,EAAE,aAAa;QAAE0E,YAAY,EAAE,IAAI;QAAEvB,MAAM,EAAEe,GAAG;QAAEjB,OAAO,EAAE;UAAE0B,IAAI,EAAE,IAAI;UAAEzH,MAAM,EAAE,IAAI;UAAE6F,MAAM,EAAE;QAAK;MAAE,CAAC,CAAC;MAEvJ,IAAM6B,UAAU,GAAG,SAAbA,UAAUA,CAAA,EAAS;QAAA,IAAAC,gBAAA;QACrB,KAAAA,gBAAA,GAAIb,KAAI,CAACS,UAAU,cAAAI,gBAAA,eAAfA,gBAAA,CAAiB/D,MAAM,EAAE;UACzBkD,KAAI,CAACS,UAAU,CAAC3D,MAAM,CAACxJ,SAAS,CAACwN,MAAM,CAAC,yBAAyB,CAAC;QACtE;QACAd,KAAI,CAACe,GAAG,CAACpR,QAAQ,CAACuD,IAAI,EAAE,sBAAsB,CAAC;MACnD,CAAC;MACD,IAAM8N,YAAY,GAAG,SAAfA,YAAYA,CAAA,EAAS;QACvBhB,KAAI,CAACS,UAAU,CAAC3D,MAAM,CAACxJ,SAAS,CAACwG,GAAG,CAAC,yBAAyB,CAAC;QAC/DkG,KAAI,CAACiB,EAAE,CAACtR,QAAQ,CAACuD,IAAI,EAAE,sBAAsB,EAAE0N,UAAU,CAAC;MAC9D,CAAC;MACD,IAAMM,aAAa,GAAG,SAAhBA,aAAaA,CAAIV,CAAC,EAAK;QACzB,IAAIR,KAAI,CAACmB,UAAU,EAAEC,YAAY,CAACpB,KAAI,CAACmB,UAAU,CAAC;QAElDnB,KAAI,CAACqB,YAAY,GAAGC,UAAU,CAAC,YAAM;UACjCtB,KAAI,CAAC9Q,OAAO,CAACoE,SAAS,CAACwN,MAAM,CAAC,2BAA2B,CAAC;QAC9D,CAAC,EAAE,GAAG,CAAC;QAEPN,CAAC,CAACe,aAAa,CAACjO,SAAS,CAACwN,MAAM,CAAC,2BAA2B,EAAE,oBAAoB,CAAC;MACvF,CAAC;MACD,IAAMU,aAAa,GAAG,SAAhBA,aAAaA,CAAIC,GAAG,EAAK;QAC3B,IAAIA,GAAG,CAAClF,eAAe,EAAEkF,GAAG,CAAClF,eAAe,CAAC,CAAC;QAC9C,IAAIyD,KAAI,CAACqB,YAAY,EAAED,YAAY,CAACpB,KAAI,CAACqB,YAAY,CAAC;QAEtD,IAAMvF,MAAM,GAAGkE,KAAI,CAACS,UAAU,CAAC3D,MAAM;QACrChB,MAAM,CAACxI,SAAS,CAACwG,GAAG,CAAC,oBAAoB,EAAE,2BAA2B,CAAC;QAEvEkG,KAAI,CAACnR,QAAQ,CAACG,KAAK,CAACiC,OAAO,CAAC,UAAAC,CAAC,EAAI;UAC7B,IAAIA,CAAC,CAACiQ,UAAU,EAAEC,YAAY,CAAClQ,CAAC,CAACiQ,UAAU,CAAC;QAChD,CAAC,CAAC;QAEFnB,KAAI,CAACmB,UAAU,GAAGG,UAAU,CAAC,YAAM;UAC/B,IAAMI,EAAE,GAAG1B,KAAI,CAACS,UAAU;UAC1B,IAAIpQ,UAAU,CAACF,gBAAgB,CAACuR,EAAE,CAACxS,OAAO,CAAC,CAACsB,KAAK,CAAC,IAAI,EAAE,EAAE;YACtDkR,EAAE,CAAC5E,MAAM,CAACxJ,SAAS,CAACwG,GAAG,CAAC,2BAA2B,CAAC;UACxD;UACA,IAAMrH,CAAC,GAAGuN,KAAI,CAACnR,QAAQ,CAACG,KAAK,CAACuF,MAAM;UACpCyL,KAAI,CAACnR,QAAQ,CAACG,KAAK,CAACiC,OAAO,CAAC,UAACC,CAAC,EAAEC,CAAC,EAAK;YAClC,IAAIA,CAAC,GAAGsB,CAAC,GAAG,CAAC,EAAE;cACXvB,CAAC,CAAChC,OAAO,CAACoE,SAAS,CAACwN,MAAM,CAAC,2BAA2B,CAAC;YAC3D;UACJ,CAAC,CAAC;QACN,CAAC,EAAE,OAAOW,GAAG,KAAK,QAAQ,GAAGA,GAAG,GAAG,IAAI,CAAC;MAC5C,CAAC;MAED,IAAME,SAAS,GAAG,IAAI,CAAClB,UAAU,CAAC3D,MAAM;MACxC,IAAI,CAACmE,EAAE,CAACU,SAAS,EAAE,yBAAyB,EAAEH,aAAa,CAAC;MAC5D,IAAI,CAACP,EAAE,CAACU,SAAS,EAAE,yBAAyB,EAAET,aAAa,CAAC;MAC5D,IAAI,CAACD,EAAE,CAACU,SAAS,EAAE,wBAAwB,EAAEX,YAAY,CAAC;MAC1D,IAAI,CAACC,EAAE,CAACU,SAAS,EAAE,oBAAoB,EAAE;QAAA,OAAMH,aAAa,CAACI,IAAI,CAACD,SAAS,EAAE,CAAC,CAAC;MAAA,EAAC;IACpF;;IAEA;AACJ;AACA;AACA;EAHI;IAAArS,GAAA;IAAAC,KAAA,EAIA,SAAAyP,mBAAmBA,CAACe,GAAG,EAAE;MACrB,IAAIA,GAAG,KAAK,OAAO,EAAE;MAErB,IAAM8B,MAAM,GAAG,IAAI,CAAClC,GAAG,CAAC,8yEAA8yE,CAAC;MACv0E,IAAMmC,MAAM,GAAG,IAAI,CAACnC,GAAG,CAAC,6iDAA6iD,CAAC;MAEtkD,IAAMoC,GAAG,GAAG,IAAI,CAACpC,GAAG,CAAC,iDAAiD,CAAC;MACvE,IAAMqC,GAAG,GAAGD,GAAG,CAACE,SAAS,CAAC,CAAC;MAE3BF,GAAG,CAACzO,SAAS,CAACwG,GAAG,CAAC,IAAI,CAAC;MACvBiI,GAAG,CAACxB,WAAW,CAACsB,MAAM,CAAC;MACvBG,GAAG,CAAC1O,SAAS,CAACwG,GAAG,CAAC,IAAI,CAAC;MACvBkI,GAAG,CAACzB,WAAW,CAACuB,MAAM,CAAC;MAEvB,IAAI,CAACI,SAAS,GAAGH,GAAG;MACpB,IAAI,CAACI,SAAS,GAAGH,GAAG;MAEpB,IAAI,CAAC9S,OAAO,CAACqR,WAAW,CAACwB,GAAG,CAAC;MAC7B,IAAI,CAAC7S,OAAO,CAACqR,WAAW,CAACyB,GAAG,CAAC;MAC7B,IAAI,CAACI,gBAAgB,CAACL,GAAG,EAAEC,GAAG,CAAC;IACnC;;IAEA;AACJ;AACA;AACA;EAHI;IAAA1S,GAAA;IAAAC,KAAA,EAIA,SAAAoR,IAAIA,CAAC0B,GAAG,EAAE;MACN,IAAM1R,MAAM,GAAG,IAAI,CAAC9B,QAAQ,CAACkH,eAAe,CAAC,IAAI,CAACuM,mBAAmB,CAAC,CAAC,CAAC;MACxE,IAAI,CAAC5J,KAAK,CAAC/H,MAAM,EAAE,CAAC,GAAG0R,GAAG,GAAG,IAAI,CAAC;MAClC,OAAO,IAAI;IACf;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAA/S,GAAA;IAAAC,KAAA,EAKA,SAAAmJ,KAAKA,CAAC1C,CAAC,EAAE2C,CAAC,EAAE;MACR,IAAI,CAACrH,MAAM,CAACoH,KAAK,CAAC1C,CAAC,EAAE2C,CAAC,CAAC;MACvB,IAAI,CAAC4J,aAAa,CAAC,IAAI,CAAC;MACxB,IAAI,CAACC,cAAc,CAAC,CAAC;MACrB,OAAO,IAAI;IACf;;IAEA;AACJ;AACA;AACA;AACA;AACA;EALI;IAAAlT,GAAA;IAAAC,KAAA,EAMA,SAAAsE,SAASA,CAACgD,CAAC,EAAEC,CAAC,EAAEwH,UAAU,EAAE;MACxB,IAAI,CAAChN,MAAM,CAACuC,SAAS,CAACgD,CAAC,EAAEC,CAAC,CAAC;MAC3B,IAAI,CAACyL,aAAa,CAACjE,UAAU,CAAC;MAC9B,IAAI,CAACkE,cAAc,CAAC,CAAC;MACrB,OAAO,IAAI;IACf;;IAEA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EAPI;IAAAlT,GAAA;IAAAC,KAAA,EAQA,SAAA2J,MAAMA,CAAClD,CAAC,EAAEI,CAAC,EAAE9B,KAAK,EAAEmO,QAAQ,EAAE;MAC1B,IAAIC,aAAa,GAAG1M,CAAC;MACrB,IAAI,EAAE0M,aAAa,YAAY9T,iDAAK,CAAC,IAAI,CAAC8T,aAAa,EAAE;QACrDA,aAAa,GAAG,IAAI,CAAC7T,QAAQ,CAACkH,eAAe,CAAC,IAAI,CAACuM,mBAAmB,CAAC,CAAC,CAAC;MAC7E;MAEA,IAAII,aAAa,YAAY9T,iDAAK,IAAI6T,QAAQ,EAAE;QAC5CC,aAAa,GAAG,IAAI,CAAC7T,QAAQ,CAACkH,eAAe,CAAC2M,aAAa,CAAC;MAChE;MAEA,IAAI,CAACpR,MAAM,CAAC4H,MAAM,CAACwJ,aAAa,EAAEtM,CAAC,CAAC;MACpC,IAAI,CAACuM,iBAAiB,GAAGD,aAAa;MACtC,IAAI,OAAOpO,KAAK,KAAK,WAAW,IAAIA,KAAK,KAAK,KAAK,EAAE;QACjD,IAAI,CAACiO,aAAa,CAAC,KAAK,CAAC;MAC7B;MAEA,IAAI,CAACC,cAAc,CAAC,CAAC;MACrB,OAAO,IAAI;IACf;;IAEA;AACJ;AACA;EAFI;IAAAlT,GAAA;IAAAC,KAAA,EAGA,SAAAqT,UAAUA,CAAA,EAAG;MACT,IAAM5N,CAAC,GAAG,IAAI,CAAC1D,MAAM,CAAC8H,QAAQ,CAAC,CAAC;MAChC,IAAI,CAACF,MAAM,CAAC,IAAItK,iDAAK,CAAC,IAAI,CAACiG,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACtE,KAAK,GAAG,CAAC,EAAE,IAAI,CAACqE,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACpE,MAAM,GAAG,CAAC,CAAC,EAAE,CAACsE,CAAC,EAAE,IAAI,CAAC;MAC7G,OAAO,IAAI;IACf;;IAEA;AACJ;AACA;EAFI;IAAA1F,GAAA;IAAAC,KAAA,EAGA,SAAAsT,WAAWA,CAAA,EAAG;MACV,IAAMC,EAAE,GAAG,IAAIlU,iDAAK,CAAC,IAAI,CAACiG,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACtE,KAAK,EAAE,IAAI,CAACqE,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACpE,MAAM,CAAC;MACzF,IAAMyP,GAAG,GAAG,IAAI,CAACtR,QAAQ;MACzB,IAAMoH,IAAI,GAAGkK,GAAG,CAACpL,UAAU,CAAC,CAAC;MAC7B,IAAMgO,OAAO,GAAG5C,GAAG,CAACvK,WAAW,CAAC,CAAC;MACjC,IAAMoN,EAAE,GAAGD,OAAO,CAACnO,IAAI;MACvB,IAAMK,CAAC,GAAG,IAAI,CAAC3D,MAAM,CAAC+D,OAAO,CAAC,CAAC;MAC/B,IAAM4N,EAAE,GAAGhO,CAAC,CAACU,cAAc,CAACqN,EAAE,CAACpS,OAAO,CAAC;MACvC,IAAMsS,EAAE,GAAGjO,CAAC,CAACU,cAAc,CAACqN,EAAE,CAACnS,QAAQ,CAAC;MACxC,IAAMsS,EAAE,GAAGlO,CAAC,CAACU,cAAc,CAACqN,EAAE,CAACjS,UAAU,CAAC;MAC1C,IAAMqS,IAAI,GAAG,IAAIxU,iDAAK,CAAC,IAAI,CAACyU,sBAAsB,CAACJ,EAAE,EAAEC,EAAE,CAAC,EAAE,IAAI,CAACG,sBAAsB,CAACJ,EAAE,EAAEE,EAAE,CAAC,CAAC;MAEhG,IAAMG,EAAE,GAAGF,IAAI,CAACpJ,MAAM,CAAC8I,EAAE,CAAC;MAC1B,IAAMpK,KAAK,GAAGI,IAAI,CAACyK,GAAG,CAACD,EAAE,CAACzM,CAAC,EAAEyM,EAAE,CAACxM,CAAC,CAAC;MAClC,IAAI,CAAC4B,KAAK,CAAC,IAAI9J,iDAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE8J,KAAK,CAAC;MAClC,IAAI,CAAC8K,cAAc,CAAC,IAAI,EAAEvN,IAAI,CAAC;MAC/B,IAAI,CAAC2M,UAAU,CAAC,CAAC;MAEjB,OAAO,IAAI;IACf;;IAEA;AACJ;AACA;AACA;EAHI;IAAAtT,GAAA;IAAAC,KAAA,EAIA,SAAAkU,YAAYA,CAAA,EAAG;MACX,IAAMX,EAAE,GAAG,IAAIlU,iDAAK,CAAC,IAAI,CAACiG,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACtE,KAAK,EAAE,IAAI,CAACqE,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACpE,MAAM,CAAC;MACzF,IAAMyP,GAAG,GAAG,IAAI,CAACtR,QAAQ;MACzB,IAAMoH,IAAI,GAAGkK,GAAG,CAACpL,UAAU,CAAC,CAAC;MAC7B,IAAMgO,OAAO,GAAG5C,GAAG,CAACvK,WAAW,CAAC,CAAC;MACjC,IAAMoN,EAAE,GAAGD,OAAO,CAACnO,IAAI;MACvB,IAAMK,CAAC,GAAG,IAAI,CAAC3D,MAAM,CAAC+D,OAAO,CAAC,CAAC;MAC/B,IAAM4N,EAAE,GAAGhO,CAAC,CAACU,cAAc,CAACqN,EAAE,CAACpS,OAAO,CAAC;MACvC,IAAMsS,EAAE,GAAGjO,CAAC,CAACU,cAAc,CAACqN,EAAE,CAACnS,QAAQ,CAAC;MACxC,IAAMsS,EAAE,GAAGlO,CAAC,CAACU,cAAc,CAACqN,EAAE,CAACjS,UAAU,CAAC;MAC1C,IAAMqS,IAAI,GAAG,IAAIxU,iDAAK,CAAC,IAAI,CAACyU,sBAAsB,CAACJ,EAAE,EAAEC,EAAE,CAAC,EAAE,IAAI,CAACG,sBAAsB,CAACJ,EAAE,EAAEE,EAAE,CAAC,CAAC;MAEhG,IAAMG,EAAE,GAAGF,IAAI,CAACpJ,MAAM,CAAC8I,EAAE,CAAC;MAC1B,IAAMpK,KAAK,GAAGI,IAAI,CAAC4K,GAAG,CAACJ,EAAE,CAACzM,CAAC,EAAEyM,EAAE,CAACxM,CAAC,CAAC;MAElC,IAAI,CAAC4B,KAAK,CAAC,IAAI9J,iDAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE8J,KAAK,CAAC;MAClC,IAAI,CAAC8K,cAAc,CAAC,IAAI,EAAEvN,IAAI,CAAC;MAC/B,IAAI,CAAC2M,UAAU,CAAC,CAAC;MAEjB,OAAO,IAAI;IACf;;IAEA;AACJ;AACA;AACA;EAHI;IAAAtT,GAAA;IAAAC,KAAA,EAIA,SAAAoU,QAAQA,CAAC1T,EAAE,EAAE;MACT,OAAOA,EAAE,CAAC2T,qBAAqB,CAAC,CAAC;IACrC;;IAEA;AACJ;AACA;AACA;EAHI;IAAAtU,GAAA;IAAAC,KAAA,EAIA,SAAA8I,KAAKA,CAAC/D,KAAK,EAAE;MAAA,IAAAuP,MAAA;MACT,IAAI,CAAC,IAAI,CAACC,aAAa,EAAE;QACrB,IAAI,CAACxS,MAAM,CAAC+G,KAAK,CAAC,CAAC;MACvB,CAAC,MAAM;QACH,IAAI,CAAC/G,MAAM,CAACC,QAAQ,GAAAwS,kBAAA,CAAO,IAAI,CAACD,aAAa,CAAC;MAClD;MAEA,IAAI,CAACvB,aAAa,CAACjO,KAAK,aAALA,KAAK,cAALA,KAAK,GAAI,IAAI,CAAC;MACjC,IAAI,IAAI,CAACgK,UAAU,EAAE;QAAA,IAAA0F,WAAA,EAAAC,YAAA;QACjB,IAAI,CAAAD,WAAA,OAAI,CAACE,KAAK,cAAAF,WAAA,eAAVA,WAAA,CAAYnN,CAAC,KAAAoN,YAAA,GAAI,IAAI,CAACC,KAAK,cAAAD,YAAA,eAAVA,YAAA,CAAYnN,CAAC,EAAE;UAAE;UAClC,IAAI,CAAC5H,OAAO,CAACoE,SAAS,CAACwG,GAAG,CAAC,qBAAqB,CAAC;UACjD,IAAI,CAACmH,EAAE,CAAC,IAAI,CAAC/R,OAAO,EAAE,qBAAqB,EAAE,YAAM;YAC/C2U,MAAI,CAAC3U,OAAO,CAACoE,SAAS,CAACwN,MAAM,CAAC,qBAAqB,CAAC;YACpD+C,MAAI,CAAC9C,GAAG,CAAC8C,MAAI,CAAC3U,OAAO,EAAE,qBAAqB,CAAC;UACjD,CAAC,CAAC;QACN;MACJ;MACA,IAAI,CAACsT,cAAc,CAAC,CAAC;MACrB,OAAO,IAAI;IACf;;IAEA;AACJ;AACA;AACA;EAHI;IAAAlT,GAAA;IAAAC,KAAA,EAIA,SAAA4U,aAAaA,CAACtS,CAAC,EAAE;MACb,OAAOwE,KAAK,CAACmH,OAAO,CAAC,IAAI,CAAClM,MAAM,CAACmF,OAAO,CAACC,IAAI,CAAC7E,CAAC,CAAC,CAAC;IACrD;;IAEA;AACJ;AACA;AACA;EAHI;IAAAvC,GAAA;IAAAC,KAAA,EAIA,SAAAmH,IAAIA,CAAC7E,CAAC,EAAE;MACJ,IAAI,CAACP,MAAM,CAACoF,IAAI,CAAC7E,CAAC,CAAC;MACnB,IAAI,CAAC0Q,aAAa,CAAC,IAAI,CAAC;MACxB,IAAI,CAACC,cAAc,CAAC,CAAC;MACrB,OAAO,IAAI;IACf;;IAEA;AACJ;AACA;EAFI;IAAAlT,GAAA;IAAAC,KAAA,EAGA,SAAAoH,IAAIA,CAAA,EAAG;MACH,IAAI,CAACrF,MAAM,CAACqF,IAAI,CAAC,CAAC;MAClB,IAAI,CAAC4L,aAAa,CAAC,IAAI,CAAC;MACxB,IAAI,CAACC,cAAc,CAAC,CAAC;MACrB,OAAO,IAAI;IACf;;IAEA;AACJ;AACA;EAFI;IAAAlT,GAAA;IAAAC,KAAA,EAGA,SAAAwN,eAAeA,CAAA,EAAG;MACd,IAAI,IAAI,CAAClI,KAAK,EAAE;MAEhB,IAAM3E,EAAE,GAAGT,MAAM,CAACU,gBAAgB,CAAC,IAAI,CAACjB,OAAO,CAAC;MAChD,IAAMqB,CAAC,GAAGF,UAAU,CAACH,EAAE,CAACM,KAAK,CAAC;MAC9B,IAAMC,CAAC,GAAGJ,UAAU,CAACH,EAAE,CAACQ,MAAM,CAAC;MAC/B,IAAM+B,CAAC,GAAGpC,UAAU,CAACH,EAAE,CAACE,IAAI,CAAC;MAC7B,IAAMsC,CAAC,GAAGrC,UAAU,CAACH,EAAE,CAACI,GAAG,CAAC;MAE5B,IAAI,CAACuE,KAAK,GAAG;QACT3F,OAAO,EAAE;UACL4F,OAAO,EAAE;YACLnE,MAAM,EAAE,IAAI/B,iDAAK,CAAC6D,CAAC,EAAEC,CAAC,CAAC;YACvBlC,KAAK,EAAED,CAAC;YACRG,MAAM,EAAED,CAAC;YACTG,OAAO,EAAE,IAAIhC,iDAAK,CAAC,CAAC,EAAE,CAAC,CAAC;YACxBiC,QAAQ,EAAE,IAAIjC,iDAAK,CAAC2B,CAAC,EAAE,CAAC,CAAC;YACzBO,WAAW,EAAE,IAAIlC,iDAAK,CAAC2B,CAAC,EAAEE,CAAC,CAAC;YAC5BM,UAAU,EAAE,IAAInC,iDAAK,CAAC,CAAC,EAAE6B,CAAC;UAC9B;QACJ,CAAC;QACDhB,MAAM,EAAE;UAAEe,KAAK,EAAEH,UAAU,CAACF,gBAAgB,CAACR,QAAQ,CAACuD,IAAI,CAACN,UAAU,CAAC,CAACpC,KAAK;QAAE;MAClF,CAAC;IACL;;IAEA;AACJ;AACA;AACA;EAHI;IAAAlB,GAAA;IAAAC,KAAA,EAIA,SAAA6U,UAAUA,CAACnU,EAAE,EAAE;MACX,IAAMoU,EAAE,GAAG,IAAI,CAACV,QAAQ,CAAC1T,EAAE,CAAC;MAC5B,IAAMmE,MAAM,GAAG,IAAI,CAACvF,QAAQ,CAACW,UAAU,CAAC,CAAC;MACzC,IAAMU,EAAE,GAAGC,gBAAgB,CAACF,EAAE,CAAC;MAC/B,IAAMqU,GAAG,GAAG,IAAI1V,iDAAK,CAACyB,UAAU,CAACH,EAAE,CAACE,IAAI,CAAC,EAAEC,UAAU,CAACH,EAAE,CAACI,GAAG,CAAC,CAAC;MAC9D,IAAMiU,EAAE,GAAG,IAAI3V,iDAAK,CAACyV,EAAE,CAACjU,IAAI,GAAGgE,MAAM,CAACyC,CAAC,EAAEwN,EAAE,CAAC/T,GAAG,GAAG8D,MAAM,CAAC0C,CAAC,CAAC;MAC3D,IAAM0N,EAAE,GAAG,IAAI5V,iDAAK,CAACyV,EAAE,CAACI,KAAK,EAAEJ,EAAE,CAACK,MAAM,CAAC;MACzC,IAAMxB,EAAE,GAAG,IAAItU,iDAAK,CAACyV,EAAE,CAACI,KAAK,EAAEJ,EAAE,CAAC/T,GAAG,CAAC;MACtC,IAAM6S,EAAE,GAAG,IAAIvU,iDAAK,CAACyV,EAAE,CAACjU,IAAI,EAAEiU,EAAE,CAACK,MAAM,CAAC;MAExC,OAAO;QAAE/T,MAAM,EAAE4T,EAAE;QAAE3T,OAAO,EAAE2T,EAAE;QAAEzT,WAAW,EAAE0T,EAAE;QAAE3T,QAAQ,EAAEqS,EAAE;QAAEnS,UAAU,EAAEoS,EAAE;QAAEmB,GAAG,EAAEA;MAAI,CAAC;IAC/F;;IAEA;AACJ;AACA;EAFI;IAAAhV,GAAA;IAAAC,KAAA,EAGA,SAAAsO,UAAUA,CAAA,EAAG;MACT,IAAI,CAAC,IAAI,CAAClN,MAAM,EAAE;QACd,IAAMgU,GAAG,GAAG,IAAI,CAACP,UAAU,CAAC,IAAI,CAAClV,OAAO,EAAE,IAAI,CAAC;QAC/C,IAAI,CAACyB,MAAM,GAAGgU,GAAG,CAAChU,MAAM;QACxB,IAAI,CAACiU,aAAa,GAAGD,GAAG,CAAChU,MAAM;MACnC;IACJ;;IAEA;AACJ;AACA;AACA;EAHI;IAAArB,GAAA;IAAAC,KAAA,EAIA,SAAAqE,iBAAiBA,CAAClB,CAAC,EAAE;MACjB,IAAMmS,KAAK,GAAGnS,CAAC,CAACmS,KAAK,CAAC,aAAa,CAAC;MACpC,IAAI,CAACA,KAAK,EAAE,OAAO,EAAE;MACrB,OAAOA,KAAK,CAAC,CAAC,CAAC,CAACxF,KAAK,CAAC,IAAI,CAAC,CAACyF,GAAG,CAAC,UAAA5T,CAAC;QAAA,OAAIb,UAAU,CAACa,CAAC,CAAC;MAAA,EAAC;IACvD;;IAEA;AACJ;AACA;AACA;EAHI;IAAA5B,GAAA;IAAAC,KAAA,EAIA,SAAA2E,iBAAiBA,CAACkC,CAAC,EAAE;MACjB,iBAAA2O,MAAA,CAAiB3O,CAAC,CAACsJ,IAAI,CAAC,GAAG,CAAC;IAChC;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAApQ,GAAA;IAAAC,KAAA,EAKA,SAAAmO,UAAUA,CAACzN,EAAE,EAAE;MACX,IAAMkL,IAAI,GAAGlL,EAAE,IAAI,IAAI,CAACf,OAAO;MAC/B,IAAMgB,EAAE,GAAGC,gBAAgB,CAACgL,IAAI,CAAC;MACjC,IAAMxI,GAAG,GAAGxC,gBAAgB,CAAC,IAAI,CAAC2M,MAAM,CAAC;MACzC,IAAmBpK,CAAC,GAAuFxC,EAAE,CAArG2C,SAAS;QAAUmS,KAAK,GAA2E9U,EAAE,CAAvFI,GAAG;QAAe2U,MAAM,GAA6D/U,EAAE,CAA3EE,IAAI;QAAU6B,SAAS,GAAkD/B,EAAE,CAA7D+B,SAAS;QAAEE,UAAU,GAAsCjC,EAAE,CAAlDiC,UAAU;QAAE+S,cAAc,GAAsBhV,EAAE,CAAtCgV,cAAc;QAAEC,eAAe,GAAKjV,EAAE,CAAtBiV,eAAe;MAEtG,IAAM7U,GAAG,GAAG0U,KAAK,CAACtG,QAAQ,CAAC,GAAG,CAAC,GAAIrO,UAAU,CAACsC,GAAG,CAACjC,MAAM,CAAC,GAAGL,UAAU,CAAC2U,KAAK,CAAC,GAAG,GAAG,GAAI3U,UAAU,CAAC2U,KAAK,CAAC;MACxG,IAAM5U,IAAI,GAAG6U,MAAM,CAACvG,QAAQ,CAAC,GAAG,CAAC,GAAIrO,UAAU,CAACsC,GAAG,CAACnC,KAAK,CAAC,GAAGH,UAAU,CAAC4U,MAAM,CAAC,GAAG,GAAG,GAAI5U,UAAU,CAAC4U,MAAM,CAAC;MAC3G,IAAM7R,SAAS,GAAG/C,UAAU,CAAC4B,SAAS,CAAC;MACvC,IAAMoB,UAAU,GAAGhD,UAAU,CAAC8B,UAAU,CAAC;MACzC,IAAMiT,SAAS,GAAG/U,UAAU,CAAC6U,cAAc,CAAC;MAC5C,IAAMG,UAAU,GAAGhV,UAAU,CAAC8U,eAAe,CAAC;MAE9C,IAAIG,SAAS;MACb,IAAI,yBAAyB,CAACnS,IAAI,CAACT,CAAC,CAAC,EAAE;QACnC4S,SAAS,GAAG,IAAI,CAAC1R,iBAAiB,CAAClB,CAAC,CAAC;QACrC,IAAI,CAAC,IAAI,CAACoR,aAAa,EAAE;UACrB,IAAI,CAACA,aAAa,GAAAC,kBAAA,CAAOuB,SAAS,CAAC;QACvC;MACJ;MAEA,IAAMrQ,CAAC,GAAG,IAAItG,kDAAM,CAAC2W,SAAS,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;MAErD,IAAIlV,IAAI,IAAIE,GAAG,IAAI8C,SAAS,IAAIC,UAAU,IAAI+R,SAAS,IAAIC,UAAU,EAAE;QACnEpQ,CAAC,CAACpB,SAAS,CAACzD,IAAI,IAAI,CAAC,EAAEE,GAAG,IAAI,CAAC,CAAC;QAChC2E,CAAC,CAACpB,SAAS,CAACR,UAAU,IAAI,CAAC,EAAED,SAAS,IAAI,CAAC,CAAC;QAC5C6B,CAAC,CAACpB,SAAS,CAACwR,UAAU,IAAI,CAAC,EAAED,SAAS,IAAI,CAAC,CAAC;QAC5CG,MAAM,CAACC,MAAM,CAACrK,IAAI,CAACnH,KAAK,EAAE;UACtB/B,SAAS,EAAE,KAAK;UAChBE,UAAU,EAAE,KAAK;UACjB7B,GAAG,EAAE,KAAK;UACVF,IAAI,EAAE;QACV,CAAC,CAAC;QACF+K,IAAI,CAACnH,KAAK,CAAC/B,SAAS,GAAI,EAAEmT,SAAS,IAAI,CAAC,CAAC,GAAI,IAAI;QACjDjK,IAAI,CAACnH,KAAK,CAAC7B,UAAU,GAAI,EAAEiT,SAAS,IAAI,CAAC,CAAC,GAAI,IAAI;QAElD,IAAI,CAAC9T,MAAM,GAAG2D,CAAC;QACf,IAAI,CAACuN,cAAc,CAAC,CAAC;QACrB,IAAI,CAACsB,aAAa,GAAAC,kBAAA,CAAO9O,CAAC,CAAC1D,QAAQ,CAAC;MACxC;MACA,OAAO0D,CAAC;IACZ;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAA3F,GAAA;IAAAC,KAAA,EAKA,SAAAgT,aAAaA,CAACkD,IAAI,EAAE;MAChB,IAAI,OAAOA,IAAI,KAAK,SAAS,IAAI,IAAI,CAACnH,UAAU,KAAKmH,IAAI,EAAE;MAE3D,IAAMC,aAAa,GAAG,IAAI,CAAC/H,kBAAkB,GAAG,IAAI,CAACA,kBAAkB,CAAC0B,KAAK,CAAC,GAAG,CAAC,GAAG,EAAE;MACvF,IAAIoG,IAAI,EAAE;QACNC,aAAa,CAACvQ,IAAI,CAAC,gBAAgB,CAAC;MACxC,CAAC,MAAM;QACHuQ,aAAa,CAACvQ,IAAI,CAAC,cAAc,CAAC;MACtC;MACA,IAAI,CAACjG,OAAO,CAAC8E,KAAK,CAACsK,UAAU,GAAGoH,aAAa,CAAChG,IAAI,CAAC,GAAG,CAAC;MACvD,IAAI,CAACpB,UAAU,GAAGmH,IAAI;IAC1B;;IAEA;AACJ;AACA;EAFI;IAAAnW,GAAA;IAAAC,KAAA,EAGA,SAAAiT,cAAcA,CAAA,EAAG;MACb,IAAI,CAACtT,OAAO,CAAC8E,KAAK,CAACnB,SAAS,aAAAkS,MAAA,CAAa,IAAI,CAACzT,MAAM,CAACC,QAAQ,CAACmO,IAAI,CAAC,GAAG,CAAC,MAAG;IAC9E;;IAEA;AACJ;AACA;EAFI;IAAApQ,GAAA;IAAAC,KAAA,EAGA,SAAAoW,YAAYA,CAAA,EAAG;MACX,IAAI,CAACrU,MAAM,CAACyG,IAAI,CAAC,CAAC;IACtB;;IAEA;AACJ;AACA;AACA;EAHI;IAAAzI,GAAA;IAAAC,KAAA,EAIA,SAAAkO,UAAUA,CAACxI,CAAC,EAAE;MACV,IAAI,CAAC3D,MAAM,GAAG2D,CAAC;MACf,IAAI,CAACuN,cAAc,CAAC,CAAC;IACzB;;IAEA;AACJ;AACA;AACA;AACA;AACA;EALI;IAAAlT,GAAA;IAAAC,KAAA,EAMA,SAAAqW,UAAUA,CAACpF,CAAC,EAAEqF,OAAO,EAAE;MACnB,IAAIC,EAAE,EAAEC,GAAG,EAAExL,EAAE,EAAEC,EAAE;MACnB,IAAIqL,OAAO,EAAE;QACT,IAAIA,OAAO,CAACtR,MAAM,KAAK,CAAC,EAAE;UACtBuR,EAAE,GAAG,IAAI,CAACE,UAAU,CAACH,OAAO,CAAC;UAC7BE,GAAG,GAAG,IAAI,CAACE,YAAY,CAACJ,OAAO,CAAC;UAChCtL,EAAE,GAAG,IAAI3L,iDAAK,CAACiX,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,EAAEL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC;UAClD3L,EAAE,GAAG,IAAI5L,iDAAK,CAACiX,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,EAAEL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC;QACtD,CAAC,MAAM;UACHL,EAAE,GAAG,IAAIlX,iDAAK,CAACiX,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,EAAEL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC;UAClDJ,GAAG,GAAG,IAAI,CAACzU,MAAM,CAAC8H,QAAQ,CAAC,CAAC;QAChC;MACJ,CAAC,MAAM;QACH0M,EAAE,GAAG,IAAIlX,iDAAK,CAAC4R,CAAC,CAAC0F,KAAK,EAAE1F,CAAC,CAAC2F,KAAK,CAAC;QAChCJ,GAAG,GAAG,IAAI,CAACzU,MAAM,CAAC8H,QAAQ,CAAC,CAAC;MAChC;MACA,OAAO;QAAEgN,KAAK,EAAEN,EAAE;QAAEO,KAAK,EAAEN,GAAG;QAAExL,EAAE,EAAFA,EAAE;QAAEC,EAAE,EAAFA;MAAG,CAAC;IAC5C;;IAEA;AACJ;AACA;AACA;AACA;AACA;EALI;IAAAlL,GAAA;IAAAC,KAAA,EAMA,SAAA+W,UAAUA,CAAC9F,CAAC,EAAEqF,OAAO,EAAE;MACnB,IAAMU,GAAG,GAAG,IAAI,CAACX,UAAU,CAACpF,CAAC,EAAEqF,OAAO,CAAC;MACvC,IAAM1F,GAAG,GAAG,IAAI,CAACtR,QAAQ;MACzB,IAAMoH,IAAI,GAAGkK,GAAG,CAACpL,UAAU,CAAC,CAAC;MAC7B,IAAMmB,EAAE,GAAGiK,GAAG,CAACpK,eAAe,CAACwQ,GAAG,CAACH,KAAK,EAAEnQ,IAAI,CAAC;MAC/C,IAAMuQ,IAAI,GAAGD,GAAG,CAAChM,EAAE,IAAIgM,GAAG,CAAC/L,EAAE,GACzB,IAAI,CAAC6I,sBAAsB,CACvBlD,GAAG,CAACpK,eAAe,CAACwQ,GAAG,CAAChM,EAAE,EAAEtE,IAAI,CAAC,EACjCkK,GAAG,CAACpK,eAAe,CAACwQ,GAAG,CAAC/L,EAAE,EAAEvE,IAAI,CACpC,CAAC,GAAG,CAAC;MAET,IAAIwQ,OAAO,GAAG,IAAI;MAClB,IAAI,OAAOjG,CAAC,CAACtE,MAAM,KAAK,WAAW,EAAE;QACjCuK,OAAO,GAAG,IAAI7X,iDAAK,CAAC4R,CAAC,CAACtE,MAAM,EAAEsE,CAAC,CAACrE,MAAM,CAAC;MAC3C;MAEA,OAAO;QACHxL,MAAM,EAAEuF,EAAE;QACVwQ,MAAM,EAAEH,GAAG,CAACH,KAAK;QACjBF,KAAK,EAAEK,GAAG,CAACH,KAAK,CAACvP,CAAC;QAClBsP,KAAK,EAAEI,GAAG,CAACH,KAAK,CAACtP,CAAC;QAClBuP,KAAK,EAAEE,GAAG,CAACF,KAAK;QAChBM,QAAQ,EAAEH,IAAI;QACdC,OAAO,EAAPA;MACJ,CAAC;IACL;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAAnX,GAAA;IAAAC,KAAA,EAKA,SAAA8T,sBAAsBA,CAACjN,CAAC,EAAE0B,CAAC,EAAE;MACzB,IAAM8O,IAAI,GAAGxQ,CAAC,CAAC8P,KAAK,GAAG;QAAErP,CAAC,EAAE,OAAO;QAAEC,CAAC,EAAE;MAAQ,CAAC,GAAG;QAAED,CAAC,EAAE,GAAG;QAAEC,CAAC,EAAE;MAAI,CAAC;MACtE,OAAOgC,IAAI,CAACU,IAAI,CAACV,IAAI,CAACW,GAAG,CAACX,IAAI,CAAC+N,GAAG,CAAC/O,CAAC,CAAC8O,IAAI,CAAC/P,CAAC,CAAC,GAAGT,CAAC,CAACwQ,IAAI,CAAC/P,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAGiC,IAAI,CAACW,GAAG,CAACX,IAAI,CAAC+N,GAAG,CAAC/O,CAAC,CAAC8O,IAAI,CAAC9P,CAAC,CAAC,GAAGV,CAAC,CAACwQ,IAAI,CAAC9P,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IACjH;;IAEA;AACJ;AACA;AACA;EAHI;IAAAxH,GAAA;IAAAC,KAAA,EAIA,SAAAyW,UAAUA,CAACH,OAAO,EAAE;MAChB,IAAAiB,QAAA,GAAAC,cAAA,CAAyBlB,OAAO;QAAzBmB,MAAM,GAAAF,QAAA;QAAEG,MAAM,GAAAH,QAAA;MACrB,IAAMI,EAAE,GAAI,CAACD,MAAM,CAACf,KAAK,GAAGc,MAAM,CAACd,KAAK,IAAI,CAAC,GAAIc,MAAM,CAACd,KAAK;MAC7D,IAAMiB,EAAE,GAAI,CAACF,MAAM,CAACd,KAAK,GAAGa,MAAM,CAACb,KAAK,IAAI,CAAC,GAAIa,MAAM,CAACb,KAAK;MAC7D,OAAO,IAAIvX,iDAAK,CAACsY,EAAE,EAAEC,EAAE,CAAC;IAC5B;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAA7X,GAAA;IAAAC,KAAA,EAKA,SAAA6X,aAAaA,CAACvB,OAAO,EAAE5P,IAAI,EAAE;MACzB,IAAMkK,GAAG,GAAG,IAAI,CAACtR,QAAQ;MACzB,IAAMwY,cAAc,GAAGpR,IAAI,IAAIkK,GAAG,CAACpL,UAAU,CAAC,CAAC;MAC/C,IAAMuS,EAAE,GAAGnH,GAAG,CAACpK,eAAe,CAAC,IAAInH,iDAAK,CAACiX,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,EAAEL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC,EAAEkB,cAAc,CAAC;MAC7F,IAAME,EAAE,GAAGpH,GAAG,CAACpK,eAAe,CAAC,IAAInH,iDAAK,CAACiX,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,EAAEL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC,EAAEkB,cAAc,CAAC;MAC7F,OAAO,IAAI,CAAChE,sBAAsB,CAACiE,EAAE,EAAEC,EAAE,CAAC;IAC9C;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAAjY,GAAA;IAAAC,KAAA,EAKA,SAAA0W,YAAYA,CAACJ,OAAO,EAAExM,IAAI,EAAE;MACxB,IAAMrE,CAAC,GAAG8D,IAAI,CAACQ,KAAK,CAAC,CAACuM,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,IAAIN,OAAO,CAAC,CAAC,CAAC,CAAC/O,CAAC,KAAK+O,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,IAAIN,OAAO,CAAC,CAAC,CAAC,CAAC/O,CAAC,CAAC,EAAE,CAAC+O,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,IAAIL,OAAO,CAAC,CAAC,CAAC,CAAChP,CAAC,KAAKgP,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,IAAIL,OAAO,CAAC,CAAC,CAAC,CAAChP,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGiC,IAAI,CAACC,EAAE;MACtL,OAAOM,IAAI,GAAG,IAAI,CAAC/H,MAAM,CAAC6H,YAAY,CAACnE,CAAC,CAAC,GAAGA,CAAC;IACjD;;IAEA;AACJ;AACA;EAFI;IAAA1F,GAAA;IAAAC,KAAA,EAGA,SAAAiY,YAAYA,CAAA,EAAG;MAAA,IAAAC,qBAAA;MACX,KAAAA,qBAAA,GAAI,IAAI,CAAC5K,OAAO,CAACoC,OAAO,cAAAwI,qBAAA,eAApBA,qBAAA,CAAsBvO,MAAM,EAAE;MAElC,IAAIlE,CAAC,GAAG,IAAI,CAAC1D,MAAM,CAAC8H,QAAQ,CAAC,CAAC;MAC9B,IAAMnE,CAAC,GAAGD,CAAC,GAAI,EAAE,GAAG8D,IAAI,CAACc,KAAK,CAAC5E,CAAC,GAAG,EAAE,CAAE;MACvC,IAAM0S,EAAE,GAAG5O,IAAI,CAAC+N,GAAG,CAAC5R,CAAC,CAAC;MACtB,IAAM0S,GAAG,GAAG,IAAI,CAAC9S,KAAK,CAAC3F,OAAO,CAAC4F,OAAO;MACtC,IAAI,CAACyN,aAAa,CAAC,IAAI,CAAC;MAExB,IAAImF,EAAE,IAAI,CAAC,IAAIA,EAAE,GAAG,CAAC,EAAE;QACnB,IAAM3U,EAAE,GAAG,IAAI,CAAC4P,iBAAiB,IAAI,IAAI/T,iDAAK,CAAC+Y,GAAG,CAACnX,KAAK,GAAG,CAAC,EAAEmX,GAAG,CAACjX,MAAM,GAAG,CAAC,CAAC;QAC7E,IAAI,CAACwI,MAAM,CAACnG,EAAE,EAAE,CAACkC,CAAC,CAAC;QACnB,IAAI,CAAC2S,qBAAqB,GAAGlO,SAAS;QACtC,IAAI,CAACiM,YAAY,CAAC,CAAC;MACvB;MAEA3Q,CAAC,GAAG,IAAI,CAAC1D,MAAM,CAAC8H,QAAQ,CAAC,CAAC;MAC1B,IAAIyO,GAAG;MACP,QAAQ/O,IAAI,CAAC+N,GAAG,CAAC/N,IAAI,CAACc,KAAK,CAAC5E,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC;QACrC,KAAK,CAAC;QACN,KAAK,GAAG;UACJ6S,GAAG,GAAG,YAAY;UAClB;QACJ,KAAK,EAAE;UACHA,GAAG,GAAG,UAAU;UAChB;QACJ;UACIA,GAAG,gBAAA9C,MAAA,CAAgBjM,IAAI,CAACc,KAAK,CAAC5E,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,UAAO;MACzD;MACA,IAAI,CAAC8S,WAAW,CAACD,GAAG,EAAE,QAAQ,EAAE,IAAI,CAAC;IACzC;;IAEA;AACJ;AACA;AACA;AACA;AACA;EALI;IAAAvY,GAAA;IAAAC,KAAA,EAMA,SAAAuY,WAAWA,CAAC7S,CAAC,EAAEO,CAAC,EAAE9C,CAAC,EAAE;MACjBtB,OAAO,CAACC,GAAG,CAAC4D,CAAC,CAAC;IAClB;;IAEA;AACJ;AACA;EAFI;IAAA3F,GAAA;IAAAC,KAAA,EAGA,SAAA+S,mBAAmBA,CAAA,EAAG;MAClB,IAAMvO,KAAK,GAAG,IAAI,CAAC4P,QAAQ,CAAC,IAAI,CAAC7G,MAAM,CAAC;MACxC,OAAO,IAAIlO,iDAAK,CAACmF,KAAK,CAAC3D,IAAI,GAAG2D,KAAK,CAACvD,KAAK,GAAG,CAAC,EAAEuD,KAAK,CAACzD,GAAG,GAAGyD,KAAK,CAACrD,MAAM,GAAG,CAAC,CAAC;IAChF;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAApB,GAAA;IAAAC,KAAA,EAKA,SAAAiU,cAAcA,CAAClF,UAAU,EAAErI,IAAI,EAAE;MAC7B,IAAM8R,GAAG,GAAG,IAAI,CAACzJ,UAAU;MAC3B,IAAI,CAACiE,aAAa,CAACjE,UAAU,CAAC;MAC9B,IAAM+I,cAAc,GAAGpR,IAAI,IAAI,IAAI,CAACpH,QAAQ,CAACkG,UAAU,CAAC,CAAC;MACzD,IAAMpC,GAAG,GAAGxC,gBAAgB,CAAC,IAAI,CAAC2M,MAAM,CAAC;MACzC,IAAMkL,YAAY,GAAG,IAAIpZ,iDAAK,CAACyB,UAAU,CAACsC,GAAG,CAACnC,KAAK,CAAC,GAAG,CAAC,EAAEH,UAAU,CAACsC,GAAG,CAACjC,MAAM,CAAC,GAAG,CAAC,CAAC;MACrF,IAAMuX,YAAY,GAAG,IAAI,CAAC3W,MAAM,CAAC+D,OAAO,CAAC,CAAC,CAACM,cAAc,CAACqS,YAAY,CAAC;MACvE,IAAI,CAACnU,SAAS,CAACoU,YAAY,CAACvT,GAAG,CAAC,IAAI9F,iDAAK,CAAC,IAAI,CAACiG,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACtE,KAAK,GAAG,CAAC,EAAE,IAAI,CAACqE,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACpE,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;MACxH,IAAI,CAAC6R,aAAa,CAACwF,GAAG,CAAC;IAC3B;;IAEA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EAPI;IAAAzY,GAAA;IAAAC,KAAA,EAQA,SAAA2Y,gBAAgBA,CAAClS,CAAC,EAAEI,CAAC,EAAE0B,CAAC,EAAEtC,CAAC,EAAE2S,CAAC,EAAE;MAC5B,IAAMC,EAAE,GAAGtQ,CAAC,CAACpD,GAAG,CAAC0B,CAAC,CAAC;MACnB,IAAMiS,EAAE,GAAGrS,CAAC,CAACtB,GAAG,CAAC0B,CAAC,CAAC;MACnB,IAAMkS,EAAE,GAAG9S,CAAC,CAACd,GAAG,CAACoD,CAAC,CAAC;MACnB,IAAMyQ,EAAE,GAAGvS,CAAC,CAACtB,GAAG,CAACoD,CAAC,CAAC;MACnB,IAAM0Q,QAAQ,GAAGJ,EAAE,CAAC/N,GAAG,CAACgO,EAAE,CAAC;MAC3B,IAAMI,QAAQ,GAAGL,EAAE,CAAC/N,GAAG,CAAC+N,EAAE,CAAC;MAC3B,IAAMM,QAAQ,GAAGJ,EAAE,CAACjO,GAAG,CAACkO,EAAE,CAAC;MAC3B,IAAMI,QAAQ,GAAGL,EAAE,CAACjO,GAAG,CAACiO,EAAE,CAAC;MAC3B,OAAO;QACHE,QAAQ,EAARA,QAAQ;QACRC,QAAQ,EAARA,QAAQ;QACRC,QAAQ,EAARA,QAAQ;QACRC,QAAQ,EAARA,QAAQ;QACRC,EAAE,EAAE,CAAC,IAAIJ,QAAQ,IAAK1P,IAAI,CAACc,KAAK,CAAC4O,QAAQ,GAAG,EAAE,CAAC,GAAG,EAAE,IAAM1P,IAAI,CAACc,KAAK,CAAC6O,QAAQ,GAAG,EAAE,CAAC,GAAG,EAAG,IAAI,CAAC,IAAIC,QAAQ,IAAK5P,IAAI,CAACc,KAAK,CAAC8O,QAAQ,GAAG,EAAE,CAAC,GAAG,EAAE,IAAM5P,IAAI,CAACc,KAAK,CAAC+O,QAAQ,GAAG,EAAE,CAAC,GAAG;MACnL,CAAC;IACL;;IAEA;AACJ;AACA;AACA;AACA;AACA;AACA;EANI;IAAArZ,GAAA;IAAAC,KAAA,EAOA,SAAAsZ,OAAOA,CAACC,CAAC,EAAElN,KAAK,EAAE;MACd,IAAI,OAAO,IAAI,CAACsC,MAAM,CAAC4K,CAAC,CAAC,KAAK,UAAU,EAAE;QACtC,IAAI,CAAC5K,MAAM,CAAC4K,CAAC,CAAC,CAAClH,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC1S,OAAO,EAAE0M,KAAK,CAAC;MAClD;IACJ;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAAtM,GAAA;IAAAC,KAAA,EAKA,SAAAwZ,iBAAiBA,CAACvI,CAAC,EAAEvK,IAAI,EAAE;MACvB,IAAMkK,GAAG,GAAG,IAAI,CAACtR,QAAQ;MACzB,IAAMwY,cAAc,GAAGpR,IAAI,IAAIkK,GAAG,CAACpL,UAAU,CAAC,CAAC;MAC/CoL,GAAG,CAAChM,UAAU,CAAC,CAAC;MAChB,IAAM0R,OAAO,GAAGrF,CAAC,CAACqF,OAAO;MACzB,IAAMmD,MAAM,GAAGnD,OAAO,GAAG,IAAIjX,iDAAK,CAACiX,OAAO,CAAC,CAAC,CAAC,CAACK,KAAK,EAAEL,OAAO,CAAC,CAAC,CAAC,CAACM,KAAK,CAAC,GAAG,IAAIvX,iDAAK,CAAC4R,CAAC,CAAC0F,KAAK,EAAE1F,CAAC,CAAC2F,KAAK,CAAC;MACpG,IAAM8C,MAAM,GAAG,IAAI,CAACC,MAAM,CAACC,EAAE;MAC7B,IAAM9C,KAAK,GAAGvN,IAAI,CAACc,KAAK,CAAC,IAAI,CAACqM,YAAY,CAAC,CAACgD,MAAM,CAACnP,GAAG,CAACqG,GAAG,CAAC/L,MAAM,CAAC,EAAE4U,MAAM,CAAC,EAAE,KAAK,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG;MAChG,OAAO;QACHvC,OAAO,EAAE,IAAI;QACb9V,MAAM,EAAEwP,GAAG,CAACpK,eAAe,CAACiT,MAAM,EAAE3B,cAAc,CAAC;QACnDX,MAAM,EAAEsC,MAAM;QACd9C,KAAK,EAAE8C,MAAM,CAACnS,CAAC;QACfsP,KAAK,EAAE6C,MAAM,CAAClS,CAAC;QACfuP,KAAK,EAAEA,KAAK;QACZM,QAAQ,EAAE;MACd,CAAC;IACL;;IAEA;AACJ;AACA;AACA;EAHI;IAAArX,GAAA;IAAAC,KAAA,EAIA,SAAA6P,gBAAgBA,CAACgK,GAAG,EAAE;MAAA,IAAAC,MAAA;MAClB,IAAMC,QAAQ,GAAG,SAAXA,QAAQA,CAAG9I,CAAC,EAAI;QAClB,IAAI6I,MAAI,CAACxM,OAAO,CAAC0M,QAAQ,IAAIF,MAAI,CAACG,aAAa,EAAE;QAEjD,IAAG7Z,QAAQ,CAAC8Z,gBAAgB,CAAC,uBAAuB,CAAC,CAAClV,MAAM,IAAI,CAAC,EAC7D8U,MAAI,CAACna,OAAO,CAACoE,SAAS,CAACwG,GAAG,CAAC,sBAAsB,CAAC;QAEtD,IAAM7E,CAAC,GAAGoU,MAAI,CAAC/X,MAAM;QACrB+X,MAAI,CAACK,UAAU,GAAG;UACdpV,KAAK,EAAE,IAAI1F,iDAAK,CAACqG,CAAC,CAAC1D,QAAQ,CAAC,CAAC,CAAC,EAAE0D,CAAC,CAAC1D,QAAQ,CAAC,CAAC,CAAC,CAAC;UAC9C8U,KAAK,EAAEpR,CAAC,CAACmE,QAAQ,CAAC,IAAI,CAAC;UACvBV,KAAK,EAAEzD,CAAC,CAACsE,OAAO,CAAC;QACrB,CAAC;QAED,IAAMsM,OAAO,GAAGrF,CAAC,CAACqF,OAAO;QACzB,IAAI,CAAAA,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEtR,MAAM,MAAK,CAAC,EACrB,IAAIsR,OAAO,CAAC,CAAC,CAAC,CAAC/J,MAAM,IAAI+J,OAAO,CAAC,CAAC,CAAC,CAAC/J,MAAM,EACtC,IAAI+J,OAAO,CAAC,CAAC,CAAC,CAAC/J,MAAM,KAAK+J,OAAO,CAAC,CAAC,CAAC,CAAC/J,MAAM,EAAE;UACzC1K,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;UAChD,OAAO,KAAK;QAChB;QAERgY,MAAI,CAACH,MAAM,GAAGG,MAAI,CAACH,MAAM,IAAI,CAAC,CAAC;QAC/BG,MAAI,CAACH,MAAM,CAACS,UAAU,GAAGN,MAAI,CAAC1F,QAAQ,CAAC0F,MAAI,CAACna,OAAO,CAAC0a,aAAa,CAAC,6BAA6B,CAAC,CAAC;QACjGP,MAAI,CAACH,MAAM,CAACC,EAAE,GAAG,IAAIva,iDAAK,CAACya,MAAI,CAACH,MAAM,CAACS,UAAU,CAACvZ,IAAI,EAAEiZ,MAAI,CAACH,MAAM,CAACS,UAAU,CAACrZ,GAAG,CAAC;QACnF+Y,MAAI,CAACQ,WAAW,GAAGR,MAAI,CAACN,iBAAiB,CAACvI,CAAC,CAAC;QAC5C6I,MAAI,CAACQ,WAAW,CAACnR,KAAK,GAAG2Q,MAAI,CAACK,UAAU,CAAChR,KAAK;QAC9C2Q,MAAI,CAACS,aAAa,GAAG,IAAI;QACzBT,MAAI,CAACU,cAAc,GAAG,KAAK;QAC3BV,MAAI,CAAC9G,aAAa,CAAC,KAAK,CAAC;QACzB/B,CAAC,CAACjE,eAAe,CAAC,CAAC;QAEnB,IAAIiE,CAAC,CAACxE,IAAI,KAAK,WAAW,EAAE;UACxBqN,MAAI,CAACpI,EAAE,CAACtR,QAAQ,CAACuD,IAAI,EAAE,yBAAyB,EAAE8W,OAAO,CAAC;UAC1DX,MAAI,CAACpI,EAAE,CAACtR,QAAQ,CAACuD,IAAI,EAAE,6CAA6C,EAAE+W,OAAO,CAAC;QAClF;MACJ,CAAC;MAED,IAAMD,OAAO,GAAG,SAAVA,OAAOA,CAAGxJ,CAAC,EAAI;QAAA,IAAA0J,UAAA;QACjB,IAAI,CAACb,MAAI,CAACS,aAAa,EAAE;QACzBT,MAAI,CAACU,cAAc,GAAG,IAAI;QAC1BvJ,CAAC,CAACnE,cAAc,CAAC,CAAC;QAClBmE,CAAC,CAACjE,eAAe,CAAC,CAAC;QACnB,IAAI,EAAA2N,UAAA,GAAA1J,CAAC,CAACqF,OAAO,cAAAqE,UAAA,uBAATA,UAAA,CAAW3V,MAAM,MAAK,CAAC,EAAE;QAE7B,IAAM6R,KAAK,GAAGiD,MAAI,CAACN,iBAAiB,CAACvI,CAAC,CAAC;QACvC,IAAM0D,KAAK,GAAG;UAAEmC,KAAK,EAAEvN,IAAI,CAACc,KAAK,CAAC,CAACwM,KAAK,CAACC,KAAK,GAAGgD,MAAI,CAACQ,WAAW,CAACxD,KAAK,IAAI,GAAG,CAAC,GAAG;QAAI,CAAC;QAEvF,IAAInC,KAAK,CAACmC,KAAK,KAAK,CAAC,EAAE;UACnB,IAAIgD,MAAI,CAACvM,MAAM,KAAKuM,MAAI,CAACxM,OAAO,CAAC6D,YAAY,CAACxR,OAAO,EAAE;YACnDma,MAAI,CAAC/X,MAAM,CAACuH,gBAAgB,CAAC,IAAIjK,iDAAK,CAAC,CAAC,CAAC,EAAEsV,KAAK,CAACmC,KAAK,CAAC;YACvDgD,MAAI,CAAC7G,cAAc,CAAC,CAAC;UACzB;UACA,IAAI6G,MAAI,CAACxM,OAAO,CAAC6D,YAAY,YAAYjN,aAAa,EAAE;YACpD4V,MAAI,CAACxM,OAAO,CAAC6D,YAAY,CAACxH,MAAM,CAACmQ,MAAI,CAACH,MAAM,CAACC,EAAE,CAACrP,GAAG,CAACuP,MAAI,CAACxa,QAAQ,CAACuF,MAAM,CAAC,EAAE8P,KAAK,CAACmC,KAAK,EAAE,KAAK,EAAE,IAAI,CAAC;UACxG;QACJ;QACAgD,MAAI,CAACQ,WAAW,CAACxD,KAAK,GAAGD,KAAK,CAACC,KAAK;MACxC,CAAC;MAED,IAAM4D,OAAO,GAAG,SAAVA,OAAOA,CAAGzJ,CAAC,EAAI;QACjBA,CAAC,CAACnE,cAAc,CAAC,CAAC;QAClBmE,CAAC,CAACjE,eAAe,CAAC,CAAC;QACnB8M,MAAI,CAACna,OAAO,CAACoE,SAAS,CAACwN,MAAM,CAAC,sBAAsB,CAAC;QACrDuI,MAAI,CAACS,aAAa,GAAG,KAAK;QAC1BT,MAAI,CAACU,cAAc,GAAG,KAAK;QAC3BV,MAAI,CAACtI,GAAG,CAACpR,QAAQ,CAACuD,IAAI,EAAE,6CAA6C,CAAC;QAEtE,IAAImW,MAAI,CAACxM,OAAO,CAAC6D,YAAY,YAAYjN,aAAa,EAAE;UACpD,IAAI4V,MAAI,CAACxM,OAAO,CAAC6D,YAAY,CAACxC,MAAM,CAACE,IAAI,EACrCiL,MAAI,CAACxM,OAAO,CAAC6D,YAAY,CAACmI,OAAO,CAAC,MAAM,EAAErI,CAAC,CAAC;UAEhD6I,MAAI,CAACxM,OAAO,CAAC6D,YAAY,CAAC8G,YAAY,CAAC,CAAC;QAC5C;QACA,IAAI6B,MAAI,CAACnL,MAAM,CAACE,IAAI,EAChBiL,MAAI,CAACR,OAAO,CAAC,MAAM,EAAErI,CAAC,CAAC;QAE3B6I,MAAI,CAAC7B,YAAY,CAAC,CAAC;MACvB,CAAC;MAED,IAAI,CAACvG,EAAE,CAACmI,GAAG,EAAE,kDAAkD,EAAEE,QAAQ,CAAC;MAC1E,IAAI,CAACrI,EAAE,CAACmI,GAAG,EAAE,yBAAyB,EAAEY,OAAO,CAAC;MAChD,IAAI,CAAC/I,EAAE,CAACmI,GAAG,EAAE,wBAAwB,EAAEa,OAAO,CAAC;IACnD;;IAEA;AACJ;AACA;AACA;AACA;EAJI;IAAA3a,GAAA;IAAAC,KAAA,EAKA,SAAA6S,gBAAgBA,CAACL,GAAG,EAAEC,GAAG,EAAE;MAAA,IAAAmI,MAAA;MACvB,IAAMb,QAAQ,GAAG,SAAXA,QAAQA,CAAG9I,CAAC,EAAI;QAAA,IAAA4J,gBAAA;QAClB,IAAI,CAACza,QAAQ,CAACia,aAAa,CAAC,uBAAuB,CAAC,EAAE;UAClDO,MAAI,CAACjb,OAAO,CAACoE,SAAS,CAACwG,GAAG,CAAC,sBAAsB,CAAC;QACtD;QACA0G,CAAC,CAACnE,cAAc,CAAC,CAAC;QAClBmE,CAAC,CAACjE,eAAe,CAAC,CAAC;QACnB,IAAMtH,CAAC,GAAGkV,MAAI,CAAC7Y,MAAM;QACrB6Y,MAAI,CAACE,UAAU,GAAG;UACd/V,KAAK,EAAE,IAAI1F,iDAAK,CAACqG,CAAC,CAAC1D,QAAQ,CAAC,CAAC,CAAC,EAAE0D,CAAC,CAAC1D,QAAQ,CAAC,CAAC,CAAC,CAAC;UAC9C8U,KAAK,EAAEpR,CAAC,CAACmE,QAAQ,CAAC,CAAC;UACnBV,KAAK,EAAEzD,CAAC,CAACsE,OAAO,CAAC;QACrB,CAAC;QACD4Q,MAAI,CAACG,WAAW,GAAGH,MAAI,CAAC7D,UAAU,CAAC9F,CAAC,EAAEA,CAAC,CAACqF,OAAO,CAAC;QAChDsE,MAAI,CAACG,WAAW,CAAC5R,KAAK,GAAGyR,MAAI,CAACE,UAAU,CAAC3R,KAAK;QAC9CyR,MAAI,CAACX,aAAa,GAAG,IAAI;QACzBW,MAAI,CAACI,cAAc,GAAG,KAAK;QAC3B,IAAMra,EAAE,GAAGC,gBAAgB,CAACga,MAAI,CAACjb,OAAO,CAAC;QACzCib,MAAI,CAAC1Z,CAAC,GAAGJ,UAAU,CAACH,EAAE,CAACQ,MAAM,CAAC;QAC9ByZ,MAAI,CAAC5Z,CAAC,GAAGF,UAAU,CAACH,EAAE,CAACM,KAAK,CAAC;QAC7B2Z,MAAI,CAACK,SAAS,IAAAJ,gBAAA,GAAGD,MAAI,CAACK,SAAS,cAAAJ,gBAAA,cAAAA,gBAAA,GAAI,IAAI;QACvCD,MAAI,CAACtB,OAAO,CAAC,aAAa,EAAErI,CAAC,CAAC;QAC9B2J,MAAI,CAAC5H,aAAa,CAAC,KAAK,CAAC;QACzB,IAAI/B,CAAC,CAACxE,IAAI,KAAK,WAAW,EAAE;UACxBmO,MAAI,CAAClJ,EAAE,CAACtR,QAAQ,CAACuD,IAAI,EAAE,yBAAyB,EAAE8W,OAAO,CAAC;UAC1DG,MAAI,CAAClJ,EAAE,CAACtR,QAAQ,CAACuD,IAAI,EAAE,6CAA6C,EAAE+W,QAAO,CAAC;QAClF;MACJ,CAAC;MAED,IAAMD,OAAO,GAAG,SAAVA,OAAOA,CAAGxJ,CAAC,EAAI;QAAA,IAAAiK,WAAA;QACjB,IAAI,CAACN,MAAI,CAACjb,OAAO,CAACoE,SAAS,CAACC,QAAQ,CAAC,sBAAsB,CAAC,IAAI,CAAC4W,MAAI,CAACX,aAAa,EAAE;QACrFW,MAAI,CAACI,cAAc,GAAG,IAAI;QAC1B/J,CAAC,CAACnE,cAAc,CAAC,CAAC;QAClBmE,CAAC,CAACjE,eAAe,CAAC,CAAC;QACnB,IAAI,EAAAkO,WAAA,GAAAjK,CAAC,CAACqF,OAAO,cAAA4E,WAAA,uBAATA,WAAA,CAAWlW,MAAM,MAAK,CAAC,EAAE;QAE7B,IAAM6R,KAAK,GAAG+D,MAAI,CAAC7D,UAAU,CAAC9F,CAAC,EAAEA,CAAC,CAACqF,OAAO,CAAC;QAC3C,IAAM9H,KAAK,GAAGoM,MAAI,CAACG,WAAW;QAC9B,IAAMpG,KAAK,GAAG;UACV5P,KAAK,EAAE8R,KAAK,CAACzV,MAAM,CAAC+D,GAAG,CAACyV,MAAI,CAACG,WAAW,CAAC3Z,MAAM,CAAC;UAChD0V,KAAK,EAAEvN,IAAI,CAACc,KAAK,CAAC,CAACwM,KAAK,CAACC,KAAK,GAAGtI,KAAK,CAACsI,KAAK,IAAI,GAAG,CAAC,GAAG,GAAG;UAC1DM,QAAQ,EAAE5I,KAAK,CAAC4I,QAAQ,IAAI,CAAC,GAAG7N,IAAI,CAACc,KAAK,CAACwM,KAAK,CAACO,QAAQ,IAAI,CAAC5I,KAAK,CAAC4I,QAAQ,GAAGP,KAAK,CAACO,QAAQ,IAAE,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,IAAI,GAAG;QACvH,CAAC;QAED,IAAIzC,KAAK,CAAC5P,KAAK,CAAC2F,OAAO,CAAC,CAAC,EAAE;UACvB,IAAM/J,EAAE,GAAGC,gBAAgB,CAACga,MAAI,CAACjb,OAAO,CAAC;UACzC,IAAMuB,CAAC,GAAGJ,UAAU,CAACH,EAAE,CAACQ,MAAM,CAAC;UAC/B,IAAMH,CAAC,GAAGF,UAAU,CAACH,EAAE,CAACM,KAAK,CAAC;UAC9B,IAAMka,EAAE,GAAGP,MAAI,CAAC5Z,CAAC,GAAGA,CAAC;UACrB,IAAMoa,EAAE,GAAGR,MAAI,CAAC1Z,CAAC,GAAGA,CAAC;UACrB,IAAMma,IAAI,GAAGra,CAAC,GAAG2T,KAAK,CAAC5P,KAAK,CAACuC,CAAC,GAAG6T,EAAE;UACnC,IAAMG,IAAI,GAAGpa,CAAC,GAAGyT,KAAK,CAAC5P,KAAK,CAACwC,CAAC,GAAG6T,EAAE;UACnCR,MAAI,CAACjb,OAAO,CAAC8E,KAAK,CAACxD,KAAK,MAAAuU,MAAA,CAAM6F,IAAI,OAAI;UACtCT,MAAI,CAACjb,OAAO,CAAC8E,KAAK,CAACtD,MAAM,MAAAqU,MAAA,CAAM8F,IAAI,OAAI;UACvCV,MAAI,CAACtV,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAAChE,WAAW,GAAG,IAAIlC,iDAAK,CAACgc,IAAI,EAAEC,IAAI,CAAC;UAC9DV,MAAI,CAACtV,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACjE,QAAQ,CAACgG,CAAC,GAAG+T,IAAI;UAC5CT,MAAI,CAACtV,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAAC/D,UAAU,CAAC+F,CAAC,GAAG+T,IAAI;UAC9CV,MAAI,CAACtV,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACtE,KAAK,GAAGoa,IAAI;UACvCT,MAAI,CAACtV,KAAK,CAAC3F,OAAO,CAAC4F,OAAO,CAACpE,MAAM,GAAGma,IAAI;QAC5C;QACAV,MAAI,CAACG,WAAW,CAACjE,KAAK,GAAGD,KAAK,CAACC,KAAK;MACxC,CAAC;MAED,IAAM4D,QAAO,GAAG,SAAVA,OAAOA,CAAA,EAAS;QAClBE,MAAI,CAACpJ,GAAG,CAACpR,QAAQ,CAACuD,IAAI,EAAE,yBAAyB,EAAE8W,OAAO,CAAC;QAC3DG,MAAI,CAACpJ,GAAG,CAACpR,QAAQ,CAACuD,IAAI,EAAE,6CAA6C,EAAE+W,QAAO,CAAC;QAC/E,IAAIE,MAAI,CAACtN,OAAO,CAAC0M,QAAQ,EAAE;QAC3BY,MAAI,CAACjb,OAAO,CAACoE,SAAS,CAACwN,MAAM,CAAC,sBAAsB,CAAC;QACrDqJ,MAAI,CAACX,aAAa,GAAG,KAAK;QAC1BW,MAAI,CAACI,cAAc,GAAG,KAAK;MAC/B,CAAC;MAED,IAAI,CAACtJ,EAAE,CAACe,GAAG,EAAE,yBAAyB,EAAEsH,QAAQ,CAAC;MACjD,IAAI,CAACrI,EAAE,CAACe,GAAG,EAAE,0BAA0B,EAAEsH,QAAQ,CAAC;MAClD,IAAI,CAACrI,EAAE,CAACe,GAAG,EAAE,yBAAyB,EAAEgI,OAAO,CAAC;MAChD,IAAI,CAAC/I,EAAE,CAACe,GAAG,EAAE,wBAAwB,EAAEiI,QAAO,CAAC;IACnD;;IAEA;AACJ;AACA;AACA;EAHI;IAAA3a,GAAA;IAAAC,KAAA,EAIA,SAAAub,mBAAmBA,CAAC9V,CAAC,EAAE;MACnB,IAAMkL,GAAG,GAAG,CAAClL,CAAC,aAADA,CAAC,cAADA,CAAC,GAAI,IAAI,CAAC1D,MAAM,CAAC8H,QAAQ,CAAC,CAAC,IAAI,GAAG;MAC/C,IAAM2R,aAAa,GAAG7K,GAAG,GAAG,CAAC,GAAGA,GAAG,GAAG,GAAG,GAAGA,GAAG;MAC/C,OAAO;QAAE8K,KAAK,EAAED,aAAa;QAAEE,IAAI,EAAEnS,IAAI,CAACoS,KAAK,CAACH,aAAa,GAAG,EAAE,CAAC;QAAEI,KAAK,EAAEJ,aAAa,KAAK,CAAC,IAAIA,aAAa,KAAK,GAAG;QAAEK,IAAI,EAAEL,aAAa,KAAK,EAAE,IAAIA,aAAa,KAAK;MAAI,CAAC;IACnL;;IAEA;AACJ;AACA;AACA;EAHI;IAAAzb,GAAA;IAAAC,KAAA,EAIA,SAAAuP,UAAUA,CAAA,EAAG;MAAA,IAAAuM,MAAA;QAAAC,sBAAA;MACT,IAAI,OAAO,IAAI,CAACpN,MAAM,CAACI,UAAU,KAAK,UAAU,EAAE;QAC9C,IAAI,CAACpP,OAAO,CAAC4L,gBAAgB,CAAC,eAAe,EAAE,IAAI,CAACoD,MAAM,CAACI,UAAU,CAAC;MAC1E;MAEA,IAAMgL,QAAQ,GAAG,SAAXA,QAAQA,CAAG9I,CAAC,EAAI;QAClB,IAAI6K,MAAI,CAACxO,OAAO,CAAC0M,QAAQ,IAAI8B,MAAI,CAAC7B,aAAa,IAAI6B,MAAI,CAACvB,aAAa,EAAE;QACvE,IAAI,CAACna,QAAQ,CAACia,aAAa,CAAC,uBAAuB,CAAC,EAAE;UAClDyB,MAAI,CAACnc,OAAO,CAACoE,SAAS,CAACwG,GAAG,CAAC,sBAAsB,CAAC;QACtD;QACA,IAAIuR,MAAI,CAACxO,OAAO,CAACb,IAAI,KAAK,aAAa,EAAE;UACrC,IAAM0F,EAAE,GAAGlB,CAAC,CAAC1E,MAAM,CAACyP,OAAO,CAAC,KAAK,CAAC;UAClC,IAAI7J,EAAE,IAAI,CAACA,EAAE,CAACpO,SAAS,CAACC,QAAQ,CAAC,0BAA0B,CAAC,EACxD,OAAO,KAAK,CAAC,KAEbiN,CAAC,CAACjE,eAAe,CAAC,CAAC;QAC3B;QAEA,IAAMsJ,OAAO,GAAGrF,CAAC,CAACqF,OAAO;QACzBwF,MAAI,CAACtN,KAAK,GAAGsN,MAAI,CAAC/E,UAAU,CAAC9F,CAAC,EAAEqF,OAAO,CAAC;QACxC,IAAM2F,EAAE,GAAGH,MAAI,CAACxW,KAAK,CAACpF,MAAM;QAC5B,IAAI4b,MAAI,CAACtN,KAAK,CAACmI,KAAK,GAAG,EAAE,IAAImF,MAAI,CAACtN,KAAK,CAACmI,KAAK,GAAGsF,EAAE,CAAChb,KAAK,GAAG,EAAE,EAAE;UAAE;UAC7DY,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;UAC3B,OAAO,KAAK;QAChB;QACAga,MAAI,CAACnH,KAAK,GAAG;UAAErN,CAAC,EAAE,CAAC;UAAEC,CAAC,EAAE;QAAE,CAAC;QAC3B,IAAI,CAAA+O,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEtR,MAAM,MAAK,CAAC,EACrB,IAAIsR,OAAO,CAAC,CAAC,CAAC,CAAC/J,MAAM,IAAI+J,OAAO,CAAC,CAAC,CAAC,CAAC/J,MAAM,EACtC,IAAI+J,OAAO,CAAC,CAAC,CAAC,CAAC/J,MAAM,KAAK+J,OAAO,CAAC,CAAC,CAAC,CAAC/J,MAAM,EAAE;UACzC1K,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;UAChD,OAAO,KAAK;QAChB;QAER,IAAM4D,CAAC,GAAGoW,MAAI,CAAC/Z,MAAM;QACrB+Z,MAAI,CAACrN,IAAI,GAAG;UACR1J,KAAK,EAAE,IAAI1F,iDAAK,CAACqG,CAAC,CAAC1D,QAAQ,CAAC,CAAC,CAAC,EAAE0D,CAAC,CAAC1D,QAAQ,CAAC,CAAC,CAAC,CAAC;UAC9C8U,KAAK,EAAEpR,CAAC,CAACmE,QAAQ,CAAC,CAAC;UACnBV,KAAK,EAAEzD,CAAC,CAACsE,OAAO,CAAC;QACrB,CAAC;QACD8R,MAAI,CAACtN,KAAK,CAACrF,KAAK,GAAG2S,MAAI,CAACrN,IAAI,CAACtF,KAAK;QAClC2S,MAAI,CAACI,OAAO,GAAG,IAAI;QACnBJ,MAAI,CAACvN,QAAQ,GAAG,KAAK;QAErB,IAAIuN,MAAI,CAACnN,MAAM,CAACH,KAAK,EACjBsN,MAAI,CAACxC,OAAO,CAAC,OAAO,EAAErI,CAAC,CAAC;QAE5B6K,MAAI,CAAC9I,aAAa,CAAC,KAAK,CAAC;QAEzB,IAAI/B,CAAC,CAACxE,IAAI,KAAK,WAAW,EAAE;UACxBqP,MAAI,CAACpK,EAAE,CAACtR,QAAQ,CAACuD,IAAI,EAAE,yBAAyB,EAAE8W,OAAO,CAAC;UAC1DqB,MAAI,CAACpK,EAAE,CAACtR,QAAQ,CAACuD,IAAI,EAAE,6CAA6C,EAAE+W,QAAO,CAAC;QAClF;MACJ,CAAC;MAED,IAAMD,OAAO,GAAG,SAAVA,OAAOA,CAAGxJ,CAAC,EAAI;QACjB,IAAI6K,MAAI,CAACxO,OAAO,CAAC0M,QAAQ,IAAI,CAAC8B,MAAI,CAACnc,OAAO,CAACoE,SAAS,CAACC,QAAQ,CAAC,sBAAsB,CAAC,IAAI,CAAC8X,MAAI,CAACI,OAAO,IAAIJ,MAAI,CAAC7B,aAAa,IAAI6B,MAAI,CAACvB,aAAa,EAAE,OAAO,KAAK;QAChKuB,MAAI,CAACvN,QAAQ,GAAG,IAAI;QACpB0C,CAAC,CAACnE,cAAc,CAAC,CAAC;QAClBmE,CAAC,CAACjE,eAAe,CAAC,CAAC;;QAEnB;QACA;QACA,IAAMsJ,OAAO,GAAGrF,CAAC,CAACqF,OAAO;QACzB,IAAI6F,QAAQ,GAAG,KAAK;QAEpB,IAAI,CAAA7F,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEA,OAAO,CAACtR,MAAM,KAAI,CAAC,EAC5B,IAAIsR,OAAO,CAAC,CAAC,CAAC,CAAC/J,MAAM,IAAI+J,OAAO,CAAC,CAAC,CAAC,CAAC/J,MAAM,EACtC,IAAI+J,OAAO,CAAC,CAAC,CAAC,CAAC/J,MAAM,KAAK+J,OAAO,CAAC,CAAC,CAAC,CAAC/J,MAAM,EAAE;UACzC1K,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;UAChD,OAAO,KAAK;QAChB;QAER,IAAM4D,CAAC,GAAGoW,MAAI,CAAC/Z,MAAM;QACrB,IAAM2N,OAAO,GAAGoM,MAAI,CAACxO,OAAO,CAACoC,OAAO;QACpC,IAAM0M,SAAS,GAAGN,MAAI,CAACxO,OAAO,IAAIwO,MAAI,CAACxO,OAAO,CAAC+O,OAAO;QAEtD,IAAMC,WAAW,GAAG,CAAA5M,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAE0B,IAAI,MAAI1B,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEvG,KAAK;QACnD,IAAMoT,aAAa,GAAG7M,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAE/F,MAAM;QACrC,IAAM6S,gBAAgB,GAAG9M,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEpL,SAAS;QAE3C,IAAMuS,KAAK,GAAGiF,MAAI,CAAC/E,UAAU,CAAC9F,CAAC,EAAEqF,OAAO,CAAC;QACzC,IAAM7H,IAAI,GAAGqN,MAAI,CAACrN,IAAI;QACtB,IAAMD,KAAK,GAAGsN,MAAI,CAACtN,KAAK;QACxB,IAAMmG,KAAK,GAAG;UACV5P,KAAK,EAAE8R,KAAK,CAACzV,MAAM,CAAC+D,GAAG,CAACqJ,KAAK,CAACpN,MAAM,CAAC;UACrC0V,KAAK,EAAEvN,IAAI,CAACc,KAAK,CAAC,CAACwM,KAAK,CAACC,KAAK,GAAGtI,KAAK,CAACsI,KAAK,IAAI,GAAG,CAAC,GAAG,GAAG;UAC1DM,QAAQ,EAAE5I,KAAK,CAAC4I,QAAQ,KAAK,CAAC,GAAG7N,IAAI,CAACc,KAAK,CAACwM,KAAK,CAACO,QAAQ,IAAI,CAAC5I,KAAK,CAAC4I,QAAQ,GAAGP,KAAK,CAACO,QAAQ,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,IAAI,GAAG;QAC1H,CAAC;QAED,IAAIqF,IAAI,GAAGX,MAAI;QAEf,IAAIM,SAAS,IAAIzH,KAAK,CAACmC,KAAK,IAAI,CAAC,KAAK,CAACR,OAAO,IAAKA,OAAO,IAAIA,OAAO,CAACtR,MAAM,IAAI,CAAE,CAAC,EACnF;UACI,IACI0O,EAAE,EAAEC,EAAE,EAAEsB,EAAE,EAAErB,EAAE;UAClB,IACIhD,GAAG,GAAG6L,IAAI,CAACnd,QAAQ;YACnBkU,OAAO,GAAG5C,GAAG,CAACvK,WAAW,CAAC,CAAC;YAC3B7B,KAAK,GAAGgP,OAAO,CAACnO,IAAI;YACpBqX,GAAG,GAAGhX,CAAC,CAACI,OAAO,CAAC,CAAC;YACjB6W,GAAG,GAAGnY,KAAK,CAACnD,OAAO;YACnBub,GAAG,GAAGpY,KAAK,CAAClD,QAAQ;YACpBub,GAAG,GAAGrY,KAAK,CAACjD,WAAW;YACvBub,GAAG,GAAGtY,KAAK,CAAChD,UAAU;UAE1BkS,EAAE,GAAGgJ,GAAG,CAACtW,cAAc,CAACuW,GAAG,CAAC,CAACxX,GAAG,CAACwP,KAAK,CAAC5P,KAAK,CAAC;UAC7C4O,EAAE,GAAG+I,GAAG,CAACtW,cAAc,CAACwW,GAAG,CAAC,CAACzX,GAAG,CAACwP,KAAK,CAAC5P,KAAK,CAAC;UAC7CkQ,EAAE,GAAGyH,GAAG,CAACtW,cAAc,CAACyW,GAAG,CAAC,CAAC1X,GAAG,CAACwP,KAAK,CAAC5P,KAAK,CAAC;UAC7C6O,EAAE,GAAG8I,GAAG,CAACtW,cAAc,CAAC0W,GAAG,CAAC,CAAC3X,GAAG,CAACwP,KAAK,CAAC5P,KAAK,CAAC;UAE7C,IAAI,CAACyJ,KAAK,CAACuO,IAAI,EACXvO,KAAK,CAACuO,IAAI,GAAG,IAAI1d,iDAAK,CAACod,IAAI,CAAC3I,sBAAsB,CAACJ,EAAE,EAAEC,EAAE,CAAC,EAAE8I,IAAI,CAAC3I,sBAAsB,CAACJ,EAAE,EAAEE,EAAE,CAAC,CAAC,CAAC,KAEjGpF,KAAK,CAACuO,IAAI,GAAGpI,KAAK,CAACyC,QAAQ,IAAI,CAAC,GAC5B,IAAI/X,iDAAK,CAACod,IAAI,CAAC3I,sBAAsB,CAACJ,EAAE,EAAEC,EAAE,CAAC,EAAE8I,IAAI,CAAC3I,sBAAsB,CAACJ,EAAE,EAAEE,EAAE,CAAC,CAAC,GAEnFpF,KAAK,CAACuO,IAAI;UAElB,IAAIC,IAAI,GAAGP,IAAI,CAACnX,KAAK,CAAC3F,OAAO,CAAC4F,OAAO;UAErC,IAAI0X,WAAW;YAAE5P,IAAI,GAAGoP,IAAI,CAACnP,OAAO;UAEpC,IAAI8O,SAAS,IAAI,SAAS,EAAE;YACxB,IAAIc,QAAQ,GAAG;cACXxJ,EAAE,EAAE+I,IAAI,CAAC9D,gBAAgB,CAACqE,IAAI,CAAC3b,OAAO,EAAEqS,EAAE,EAAEC,EAAE,EAAEsB,EAAE,EAAErB,EAAE,CAAC;cACvDD,EAAE,EAAE8I,IAAI,CAAC9D,gBAAgB,CAACqE,IAAI,CAAC1b,QAAQ,EAAEoS,EAAE,EAAEC,EAAE,EAAEsB,EAAE,EAAErB,EAAE,CAAC;cACxDqB,EAAE,EAAEwH,IAAI,CAAC9D,gBAAgB,CAACqE,IAAI,CAACzb,WAAW,EAAEmS,EAAE,EAAEC,EAAE,EAAEsB,EAAE,EAAErB,EAAE,CAAC;cAC3DA,EAAE,EAAE6I,IAAI,CAAC9D,gBAAgB,CAACqE,IAAI,CAACxb,UAAU,EAAEkS,EAAE,EAAEC,EAAE,EAAEsB,EAAE,EAAErB,EAAE;YAC7D,CAAC;YAED,IAAIuJ,YAAY,GAAG,CAAC;YACpB,IAAGD,QAAQ,CAACxJ,EAAE,CAAC2F,EAAE,EACb8D,YAAY,EAAE;YAClB,IAAGD,QAAQ,CAACvJ,EAAE,CAAC0F,EAAE,EACb8D,YAAY,EAAE;YAClB,IAAGD,QAAQ,CAACjI,EAAE,CAACoE,EAAE,EACb8D,YAAY,EAAE;YAClB,IAAGD,QAAQ,CAACtJ,EAAE,CAACyF,EAAE,EACb8D,YAAY,EAAE;YAElB,IAAIlC,SAAS,GAAGkC,YAAY,IAAI,CAAC;YAEjC,IAAI,CAAClC,SAAS,EAAE;cACZ,IAAImC,IAAI,GAAGX,IAAI,CAAClB,mBAAmB,CAAC/M,KAAK,CAACsI,KAAK,CAAC;cAChD,QAAQsG,IAAI,CAAC1B,IAAI;gBACb,KAAK,CAAC;kBACF,IAAI0B,IAAI,CAAC3B,KAAK,IAAI,CAAC,EAAE;oBACjB,IAAI,CAACyB,QAAQ,CAACjI,EAAE,CAACoE,EAAE,EAAE;sBACjB,IAAIgE,GAAG,GAAGL,IAAI,CAACzb,WAAW,CAACwJ,UAAU,CAAC4I,EAAE,EAAEsB,EAAE,CAAC,CAAC9P,GAAG,CAAC6X,IAAI,CAACzb,WAAW,CAAC;wBAAE+b,GAAG,GAAGN,IAAI,CAACzb,WAAW,CAACwJ,UAAU,CAAC6I,EAAE,EAAEqB,EAAE,CAAC,CAAC9P,GAAG,CAAC6X,IAAI,CAACzb,WAAW,CAAC;sBACpI,IAAI8b,GAAG,CAAC/V,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAAC8S,GAAG,CAAC;sBACjD,IAAIC,GAAG,CAAC/V,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAAC+S,GAAG,CAAC;oBACrD;oBACA,IAAI,CAACJ,QAAQ,CAACxJ,EAAE,CAAC2F,EAAE,EAAE;sBACjB,IAAIkE,GAAG,GAAGP,IAAI,CAAC3b,OAAO,CAAC0J,UAAU,CAAC2I,EAAE,EAAEE,EAAE,CAAC;wBAAE4J,GAAG,GAAGR,IAAI,CAAC3b,OAAO,CAAC0J,UAAU,CAAC2I,EAAE,EAAEC,EAAE,CAAC;sBAChF,IAAI4J,GAAG,CAACjW,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACgT,GAAG,CAAC;sBACjD,IAAIC,GAAG,CAACjW,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACiT,GAAG,CAAC;oBACrD;kBACJ,CAAC,MAAM;oBACH,IAAI,CAACN,QAAQ,CAACtJ,EAAE,CAACyF,EAAE,EAAE;sBACjB,IAAIoE,GAAG,GAAGT,IAAI,CAACxb,UAAU,CAACuJ,UAAU,CAAC2I,EAAE,EAAEE,EAAE,CAAC,CAACzO,GAAG,CAAC6X,IAAI,CAACxb,UAAU,CAAC,CAAC,CAAC;;sBAEnE,IAAIic,GAAG,CAACnW,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACkT,GAAG,CAAC;oBACrD;oBACA,IAAI,CAACP,QAAQ,CAACjI,EAAE,CAACoE,EAAE,EAAE;sBACjB,IACIiE,GAAG,GAAGN,IAAI,CAACzb,WAAW,CAACwJ,UAAU,CAAC6I,EAAE,EAAEqB,EAAE,CAAC,CAAC9P,GAAG,CAAC6X,IAAI,CAACzb,WAAW,CAAC;sBACnE,IAAI+b,GAAG,CAAC/V,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAAC+S,GAAG,CAAC;oBACrD;oBACA,IAAI,CAACJ,QAAQ,CAACvJ,EAAE,CAAC0F,EAAE,EAAE;sBACjB,IAAIqE,GAAG,GAAGV,IAAI,CAAC1b,QAAQ,CAACyJ,UAAU,CAAC4I,EAAE,EAAEsB,EAAE,CAAC,CAAC9P,GAAG,CAAC6X,IAAI,CAAC1b,QAAQ,CAAC,CAAC,CAAC;sBAC/D,IAAIoc,GAAG,CAACpW,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACmT,GAAG,CAAC;oBACrD;oBACA,IAAI,CAACR,QAAQ,CAACxJ,EAAE,CAAC2F,EAAE,EAAE;sBACjB,IAAImE,GAAG,GAAGR,IAAI,CAAC3b,OAAO,CAAC0J,UAAU,CAAC2I,EAAE,EAAEC,EAAE,CAAC;sBACzC,IAAI6J,GAAG,CAACjW,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACiT,GAAG,CAAC;oBACrD;kBACJ;kBACA;gBACJ,KAAK,CAAC;kBACF,IAAIJ,IAAI,CAAC3B,KAAK,IAAI,GAAG,EAAE;oBACnB,IAAI,CAACyB,QAAQ,CAACxJ,EAAE,CAAC2F,EAAE,EAAE;sBACjB,IAAImE,GAAG,GAAGR,IAAI,CAAC3b,OAAO,CAAC0J,UAAU,CAAC2I,EAAE,EAAEE,EAAE,CAAC;wBACrC2J,GAAG,GAAGP,IAAI,CAAC3b,OAAO,CAAC0J,UAAU,CAAC6I,EAAE,EAAEqB,EAAE,CAAC;sBACzC,IAAIsI,GAAG,CAACjW,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACgT,GAAG,CAAC;sBACjD,IAAIC,GAAG,CAACjW,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACiT,GAAG,CAAC;oBACrD;oBACA,IAAI,CAACN,QAAQ,CAACjI,EAAE,CAACoE,EAAE,EAAE;sBACjB,IACIgE,GAAG,GAAGL,IAAI,CAACzb,WAAW,CAACwJ,UAAU,CAAC2I,EAAE,EAAEC,EAAE,CAAC,CAACxO,GAAG,CAAC6X,IAAI,CAACzb,WAAW,CAAC;wBAC/D+b,GAAG,GAAGN,IAAI,CAACzb,WAAW,CAACwJ,UAAU,CAACkK,EAAE,EAAEtB,EAAE,CAAC,CAACxO,GAAG,CAAC6X,IAAI,CAACzb,WAAW,CAAC;sBACnE,IAAI8b,GAAG,CAAC/V,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAAC8S,GAAG,CAAC;sBACjD,IAAIC,GAAG,CAAC/V,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAAC+S,GAAG,CAAC;oBACrD;kBACJ,CAAC,MAAM;oBACH,IAAI,CAACJ,QAAQ,CAACxJ,EAAE,CAAC2F,EAAE,EAAE;sBACjB,IAAIkE,GAAG,GAAGP,IAAI,CAAC3b,OAAO,CAAC0J,UAAU,CAAC2I,EAAE,EAAEE,EAAE,CAAC;sBACzC,IAAI2J,GAAG,CAACjW,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACgT,GAAG,CAAC;oBACrD;oBACA,IAAI,CAACL,QAAQ,CAACjI,EAAE,CAACoE,EAAE,EAAE;sBACjB,IAAIgE,GAAG,GAAGL,IAAI,CAACzb,WAAW,CAACwJ,UAAU,CAAC4I,EAAE,EAAEsB,EAAE,CAAC,CAAC9P,GAAG,CAAC6X,IAAI,CAACzb,WAAW,CAAC;sBACnE,IAAI8b,GAAG,CAAC/V,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAAC8S,GAAG,CAAC;oBACrD;oBACA,IAAI,CAACH,QAAQ,CAACvJ,EAAE,CAAC0F,EAAE,EAAE;sBACjB,IAAIsE,GAAG,GAAGX,IAAI,CAAC1b,QAAQ,CAACyJ,UAAU,CAAC2I,EAAE,EAAEC,EAAE,CAAC,CAACxO,GAAG,CAAC6X,IAAI,CAAC1b,QAAQ,CAAC;sBAC7D,IAAIqc,GAAG,CAACpW,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACoT,GAAG,CAAC;oBACrD;oBACA,IAAI,CAACT,QAAQ,CAACtJ,EAAE,CAACyF,EAAE,EAAE;sBACjB,IAAIuE,GAAG,GAAGZ,IAAI,CAACxb,UAAU,CAACuJ,UAAU,CAAC6I,EAAE,EAAEqB,EAAE,CAAC,CAAC9P,GAAG,CAAC6X,IAAI,CAACxb,UAAU,CAAC;sBACjE,IAAIoc,GAAG,CAACrW,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACqT,GAAG,CAAC;oBACrD;kBACJ;kBACA;gBACJ,KAAK,CAAC;kBACF,IAAIR,IAAI,CAAC3B,KAAK,IAAI,EAAE,EAAE;oBAAE;oBACpB,IAAI,CAACyB,QAAQ,CAACxJ,EAAE,CAAC2F,EAAE,EAAE;sBACjB,IAAIkE,GAAG,GAAGP,IAAI,CAAC3b,OAAO,CAAC0J,UAAU,CAAC4I,EAAE,EAAED,EAAE,CAAC;wBACrC8J,GAAG,GAAGR,IAAI,CAAC3b,OAAO,CAAC0J,UAAU,CAAC4I,EAAE,EAAEsB,EAAE,CAAC;sBAEzC,IAAIsI,GAAG,CAACjW,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACgT,GAAG,CAAC;sBACjD,IAAIC,GAAG,CAACjW,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACiT,GAAG,CAAC;oBACrD;oBACA,IAAI,CAACN,QAAQ,CAACjI,EAAE,CAACoE,EAAE,EAAE;sBACjB,IAAIgE,GAAG,GAAGL,IAAI,CAACzb,WAAW,CAACwJ,UAAU,CAACkK,EAAE,EAAErB,EAAE,CAAC,CAACzO,GAAG,CAAC6X,IAAI,CAACzb,WAAW,CAAC;wBAC/D+b,GAAG,GAAGN,IAAI,CAACzb,WAAW,CAACwJ,UAAU,CAAC2I,EAAE,EAAEE,EAAE,CAAC,CAACzO,GAAG,CAAC6X,IAAI,CAACzb,WAAW,CAAC;sBAEnE,IAAI8b,GAAG,CAAC/V,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAAC8S,GAAG,CAAC;sBACjD,IAAIC,GAAG,CAAC/V,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAAC+S,GAAG,CAAC;oBACrD;kBACJ,CAAC,MAAM;oBACH,IAAI,CAACJ,QAAQ,CAACxJ,EAAE,CAAC2F,EAAE,EAAE;sBACjB,IAAIkE,GAAG,GAAGP,IAAI,CAAC3b,OAAO,CAAC0J,UAAU,CAAC4I,EAAE,EAAEsB,EAAE,CAAC;sBACzC,IAAIsI,GAAG,CAACjW,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACgT,GAAG,CAAC;oBACrD;oBACA,IAAI,CAACL,QAAQ,CAACjI,EAAE,CAACoE,EAAE,EAAE;sBACjB,IAAIgE,GAAG,GAAGL,IAAI,CAACzb,WAAW,CAACwJ,UAAU,CAAC2I,EAAE,EAAEE,EAAE,CAAC,CAACzO,GAAG,CAAC6X,IAAI,CAACzb,WAAW,CAAC;sBACnE,IAAI8b,GAAG,CAAC/V,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAAC8S,GAAG,CAAC;oBACrD;oBACA,IAAI,CAACH,QAAQ,CAACvJ,EAAE,CAAC0F,EAAE,EAAE;sBACjB,IAAIsE,GAAG,GAAGX,IAAI,CAAC1b,QAAQ,CAACyJ,UAAU,CAAC6I,EAAE,EAAEqB,EAAE,CAAC,CAAC9P,GAAG,CAAC6X,IAAI,CAAC1b,QAAQ,CAAC;sBAC7D,IAAIqc,GAAG,CAACpW,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACoT,GAAG,CAAC;oBACrD;oBACA,IAAI,CAACT,QAAQ,CAACtJ,EAAE,CAACyF,EAAE,EAAE;sBACjB,IAAIuE,GAAG,GAAGZ,IAAI,CAACxb,UAAU,CAACuJ,UAAU,CAAC4I,EAAE,EAAED,EAAE,CAAC,CAACvO,GAAG,CAAC6X,IAAI,CAACxb,UAAU,CAAC;sBACjE,IAAIoc,GAAG,CAACrW,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACqT,GAAG,CAAC;oBACrD;kBACJ;kBACA;gBACJ,KAAK,CAAC;kBACF,IAAIR,IAAI,CAAC3B,KAAK,IAAI,GAAG,EAAE;oBAAE;oBACrB,IAAI,CAACyB,QAAQ,CAACxJ,EAAE,CAAC2F,EAAE,EAAE;sBACjB,IAAIkE,GAAG,GAAGP,IAAI,CAAC3b,OAAO,CAAC0J,UAAU,CAACkK,EAAE,EAAErB,EAAE,CAAC;wBACrC4J,GAAG,GAAGR,IAAI,CAAC3b,OAAO,CAAC0J,UAAU,CAAC2I,EAAE,EAAEE,EAAE,CAAC;sBACzC,IAAI2J,GAAG,CAAChW,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACgT,GAAG,CAAC;sBACjD,IAAIC,GAAG,CAACjW,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACiT,GAAG,CAAC;oBACrD;oBACA,IAAI,CAACN,QAAQ,CAACjI,EAAE,CAACoE,EAAE,EAAE;sBACjB,IACIgE,GAAG,GAAGL,IAAI,CAACzb,WAAW,CAACwJ,UAAU,CAAC4I,EAAE,EAAED,EAAE,CAAC,CAACvO,GAAG,CAAC6X,IAAI,CAACzb,WAAW,CAAC;wBAC/D+b,GAAG,GAAGN,IAAI,CAACzb,WAAW,CAACwJ,UAAU,CAAC4I,EAAE,EAAEsB,EAAE,CAAC,CAAC9P,GAAG,CAAC6X,IAAI,CAACzb,WAAW,CAAC;sBACnE,IAAI8b,GAAG,CAAC9V,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAAC8S,GAAG,CAAC;sBACjD,IAAIC,GAAG,CAAC/V,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAAC+S,GAAG,CAAC;oBACrD;kBACJ;kBACA,IAAI,CAACJ,QAAQ,CAACxJ,EAAE,CAAC2F,EAAE,EAAE;oBACjB,IAAIkE,GAAG,GAAGP,IAAI,CAAC3b,OAAO,CAAC0J,UAAU,CAACkK,EAAE,EAAErB,EAAE,CAAC;oBACzC,IAAI2J,GAAG,CAAChW,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACgT,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACL,QAAQ,CAACjI,EAAE,CAACoE,EAAE,EAAE;oBACjB,IAAIgE,GAAG,GAAGL,IAAI,CAACzb,WAAW,CAACwJ,UAAU,CAAC4I,EAAE,EAAED,EAAE,CAAC,CAACvO,GAAG,CAAC6X,IAAI,CAACzb,WAAW,CAAC,CAAC;oBACpE,IAAI8b,GAAG,CAAC9V,CAAC,GAAG,CAAC,EAAEoN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAAC8S,GAAG,CAAC;kBACrD;kBAEA,IAAI,CAACH,QAAQ,CAACvJ,EAAE,CAAC0F,EAAE,EAAE;oBACjB,IAAIsE,GAAG,GAAGX,IAAI,CAAC1b,QAAQ,CAACyJ,UAAU,CAAC2I,EAAE,EAAEE,EAAE,CAAC,CAACzO,GAAG,CAAC6X,IAAI,CAAC1b,QAAQ,CAAC;oBAC7D,IAAIqc,GAAG,CAACrW,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACoT,GAAG,CAAC;kBACrD;kBACA,IAAI,CAACT,QAAQ,CAACtJ,EAAE,CAACyF,EAAE,EAAE;oBACjB,IAAIuE,GAAG,GAAGZ,IAAI,CAACxb,UAAU,CAACuJ,UAAU,CAAC4I,EAAE,EAAEsB,EAAE,CAAC,CAAC9P,GAAG,CAAC6X,IAAI,CAACxb,UAAU,CAAC;oBACjE,IAAIoc,GAAG,CAACtW,CAAC,GAAG,CAAC,EAAEqN,KAAK,CAAC5P,KAAK,GAAG4P,KAAK,CAAC5P,KAAK,CAACwF,GAAG,CAACqT,GAAG,CAAC;kBACrD;kBACA;cACR;YACJ;UACJ;UACA,IAAIxB,SAAS,IAAI,OAAO,EAAE;YACtB,IAAIc,QAAQ,GAAG;cACXxJ,EAAE,EAAE+I,IAAI,CAAC9D,gBAAgB,CAACqE,IAAI,CAAC3b,OAAO,EAAEqS,EAAE,EAAEC,EAAE,EAAEsB,EAAE,EAAErB,EAAE,CAAC;cACvDD,EAAE,EAAE8I,IAAI,CAAC9D,gBAAgB,CAACqE,IAAI,CAAC1b,QAAQ,EAAEoS,EAAE,EAAEC,EAAE,EAAEsB,EAAE,EAAErB,EAAE,CAAC;cACxDqB,EAAE,EAAEwH,IAAI,CAAC9D,gBAAgB,CAACqE,IAAI,CAACzb,WAAW,EAAEmS,EAAE,EAAEC,EAAE,EAAEsB,EAAE,EAAErB,EAAE,CAAC;cAC3DA,EAAE,EAAE6I,IAAI,CAAC9D,gBAAgB,CAACqE,IAAI,CAACxb,UAAU,EAAEkS,EAAE,EAAEC,EAAE,EAAEsB,EAAE,EAAErB,EAAE;YAC7D,CAAC;YAED,IAAIiK,SAAS,GAAG,CAAC;YACjB,IAAI,CAACX,QAAQ,CAACxJ,EAAE,CAAC2F,EAAE,EAAEwE,SAAS,EAAE;YAChC,IAAI,CAACX,QAAQ,CAACvJ,EAAE,CAAC0F,EAAE,EAAEwE,SAAS,EAAE;YAChC,IAAI,CAACX,QAAQ,CAACjI,EAAE,CAACoE,EAAE,EAAEwE,SAAS,EAAE;YAChC,IAAI,CAACX,QAAQ,CAACtJ,EAAE,CAACyF,EAAE,EAAEwE,SAAS,EAAE;YAEhC,IAAK,CAACX,QAAQ,CAACxJ,EAAE,CAAC2F,EAAE,IAChB,CAAC6D,QAAQ,CAACvJ,EAAE,CAAC0F,EAAE,IACf,CAAC6D,QAAQ,CAACjI,EAAE,CAACoE,EAAE,IACf,CAAC6D,QAAQ,CAACtJ,EAAE,CAACyF,EAAE,IACZoD,IAAI,CAACqB,WAAW,IAAGD,SAAS,IAAI,CAAC,IAAIrP,KAAK,CAACsI,KAAK,IAAI,CAAE,EAAE;cAC3D2F,IAAI,CAACqB,WAAW,GAAG,IAAI;cACvB,IAAIV,IAAI,GAAGX,IAAI,CAAClB,mBAAmB,CAAC/M,KAAK,CAACsI,KAAK,CAAC;cAChD,QAAQsG,IAAI,CAAC1B,IAAI;gBACb,KAAK,CAAC;kBACF,IAAI/H,EAAE,CAACpM,CAAC,IAAI,CAAC,EACToN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,GAAGoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,GAAGoM,EAAE,CAACpM,CAAC;kBACxC,IAAIqM,EAAE,CAACrM,CAAC,IAAIyV,IAAI,CAACxb,UAAU,CAAC+F,CAAC,EACzBoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,GAAGoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,IAAIqM,EAAE,CAACrM,CAAC,GAAGyV,IAAI,CAACxb,UAAU,CAAC+F,CAAC,CAAC;kBAC9D,IAAI0N,EAAE,CAAC3N,CAAC,IAAI0V,IAAI,CAACzb,WAAW,CAAC+F,CAAC,EAC1BqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,GAAGqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,IAAI2N,EAAE,CAAC3N,CAAC,GAAG0V,IAAI,CAACzb,WAAW,CAAC+F,CAAC,CAAC;kBAC/D,IAAIoM,EAAE,CAACpM,CAAC,IAAI,CAAC,EACTqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,GAAGqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,GAAGoM,EAAE,CAACpM,CAAC;kBACxC;gBACJ,KAAK,CAAC;kBACF,IAAIoM,EAAE,CAACnM,CAAC,IAAIyV,IAAI,CAACxb,UAAU,CAAC+F,CAAC,EACzBoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,GAAGoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,IAAImM,EAAE,CAACnM,CAAC,GAAGyV,IAAI,CAACxb,UAAU,CAAC+F,CAAC,CAAC;kBAC9D,IAAIqM,EAAE,CAACtM,CAAC,IAAI0V,IAAI,CAAC1b,QAAQ,CAACgG,CAAC,EACvBqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,GAAGqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,IAAI0V,IAAI,CAAC1b,QAAQ,CAACgG,CAAC,GAAGsM,EAAE,CAACtM,CAAC,CAAC;kBAC5D,IAAI2N,EAAE,CAAC1N,CAAC,IAAI,CAAC;oBAAE;oBACXoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,GAAGoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,GAAG0N,EAAE,CAAC1N,CAAC;kBACxC,IAAIoM,EAAE,CAACrM,CAAC,IAAI,CAAC,EACTqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,GAAGqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,GAAGqM,EAAE,CAACrM,CAAC;kBACxC;gBACJ,KAAK,CAAC;kBACF,IAAIsM,EAAE,CAACrM,CAAC,IAAI,CAAC;oBAAE;oBACXoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,GAAGoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,GAAGqM,EAAE,CAACrM,CAAC;kBACxC,IAAImM,EAAE,CAACpM,CAAC,IAAI0V,IAAI,CAACzb,WAAW,CAAC+F,CAAC,EAC1BqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,GAAGqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,IAAI0V,IAAI,CAACzb,WAAW,CAAC+F,CAAC,GAAGoM,EAAE,CAACpM,CAAC,CAAC;kBAC/D,IAAIqM,EAAE,CAACpM,CAAC,IAAIyV,IAAI,CAACxb,UAAU,CAAC+F,CAAC,EACzBoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,GAAGoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,IAAIoM,EAAE,CAACpM,CAAC,GAAGyV,IAAI,CAACxb,UAAU,CAAC+F,CAAC,CAAC;kBAC9D,IAAI0N,EAAE,CAAC3N,CAAC,IAAI,CAAC,EACTqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,GAAGqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,GAAG2N,EAAE,CAAC3N,CAAC;kBACxC;kBACA;kBACA;kBACA;kBACA;kBACA;gBACJ,KAAK,CAAC;kBACF,IAAIoM,EAAE,CAACnM,CAAC,IAAI,CAAC;oBAAE;oBACXoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,GAAGoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,GAAGmM,EAAE,CAACnM,CAAC;kBACxC,IAAIqM,EAAE,CAACtM,CAAC,IAAI,CAAC,EACTqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,GAAGqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,GAAGsM,EAAE,CAACtM,CAAC;kBACxC,IAAI2N,EAAE,CAAC1N,CAAC,IAAIyV,IAAI,CAACzb,WAAW,CAACgG,CAAC;oBAAE;oBAC5BoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,GAAGoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC,IAAI0N,EAAE,CAAC1N,CAAC,GAAGyV,IAAI,CAACzb,WAAW,CAACgG,CAAC,CAAC;kBAC/D,IAAIoM,EAAE,CAACrM,CAAC,IAAI0V,IAAI,CAAC1b,QAAQ,CAACgG,CAAC,EACvBqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,GAAGqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC,IAAI0V,IAAI,CAAC1b,QAAQ,CAACgG,CAAC,GAAGqM,EAAE,CAACrM,CAAC,CAAC;kBAE5D;cACR;YACJ;UACJ;QACJ;QAEA,IAAIqN,KAAK,CAAC5P,KAAK,CAAC2F,OAAO,CAAC,CAAC,IAAI,CAAC8R,gBAAgB,EAAE;UAC5C9W,CAAC,CAACpB,SAAS,CAACqQ,KAAK,CAAC5P,KAAK,CAAC;UACxBoX,QAAQ,GAAG,IAAI;UACfM,IAAI,CAAC9H,KAAK,CAACrN,CAAC,IAAIqN,KAAK,CAAC5P,KAAK,CAACuC,CAAC;UAC7BmV,IAAI,CAAC9H,KAAK,CAACpN,CAAC,IAAIoN,KAAK,CAAC5P,KAAK,CAACwC,CAAC;QACjC;QAEA,IAAIoN,KAAK,CAACyC,QAAQ,IAAI,CAAC,IAAIzC,KAAK,CAACyC,QAAQ,IAAI,CAAC,IAAId,OAAO,EACrD,IAAIA,OAAO,CAACtR,MAAM,IAAI,CAAC,IAAI,CAACsX,WAAW,EAAE;UACrC5W,CAAC,CAACyD,KAAK,CAAC0N,KAAK,CAACzV,MAAM,EAAEuT,KAAK,CAACyC,QAAQ,CAAC;UAErC+E,QAAQ,GAAG,IAAI;QAEnB;QAEJ,IAAIxH,KAAK,CAACmC,KAAK,IAAI,CAAC,IAAI,CAACyF,aAAa,EAAE;UACpC7W,CAAC,CAAC4D,gBAAgB,CAACuN,KAAK,CAACzV,MAAM,EAAEuT,KAAK,CAACmC,KAAK,CAAC;UAC7CqF,QAAQ,GAAG,IAAI;QACnB;QAEA,IAAIA,QAAQ,EACRM,IAAI,CAACxJ,cAAc,CAACvN,CAAC,CAAC;QAE1B+W,IAAI,CAACjO,KAAK,CAACsI,KAAK,GAAGD,KAAK,CAACC,KAAK;QAE9B,IAAI2F,IAAI,CAAC9N,MAAM,CAACC,IAAI,EAChB6N,IAAI,CAACnD,OAAO,CAAC,MAAM,EAAErI,CAAC,CAAC;QAE3B,OAAO,KAAK;MAEhB,CAAC;MAED,IAAMyJ,QAAO,GAAG,SAAVA,OAAOA,CAAGzJ,CAAC,EAAI;QACjB6K,MAAI,CAACtK,GAAG,CAACpR,QAAQ,CAACuD,IAAI,EAAE,yBAAyB,EAAE8W,OAAO,CAAC;QAC3DqB,MAAI,CAACtK,GAAG,CAACpR,QAAQ,CAACuD,IAAI,EAAE,6CAA6C,EAAE+W,QAAO,CAAC;QAE/EoB,MAAI,CAACnc,OAAO,CAACoE,SAAS,CAACwN,MAAM,CAAC,sBAAsB,EAAE,qBAAqB,CAAC;QAE5E,IAAIuK,MAAI,CAACxO,OAAO,CAAC0M,QAAQ,EAAE,OAAO,KAAK;QAEvC8B,MAAI,CAACgC,WAAW,GAAG,KAAK;QACxB,IAAIhC,MAAI,CAACI,OAAO,IAAIJ,MAAI,CAACvN,QAAQ,EAAE;UAC/BuN,MAAI,CAAC1F,YAAY,CAAC,CAAC;UACnB0F,MAAI,CAAC7D,YAAY,CAAC,CAAC;QACvB;QACA,IAAI6D,MAAI,CAACI,OAAO,IAAI,CAACJ,MAAI,CAACvN,QAAQ,EAAE;UAChCuN,MAAI,CAACxC,OAAO,CAAC,KAAK,EAAErI,CAAC,CAAC;QAC1B;QACA6K,MAAI,CAACvN,QAAQ,GAAG,KAAK;QACrBuN,MAAI,CAACI,OAAO,GAAG,KAAK;QACpB,IAAIJ,MAAI,CAACnN,MAAM,CAACE,IAAI,EAChBiN,MAAI,CAACxC,OAAO,CAAC,MAAM,EAAErI,CAAC,CAAC;QAE3B6K,MAAI,CAAC9I,aAAa,CAAC,IAAI,CAAC;;QAExB;;QAEA,IAAIyJ,IAAI,GAAGX,MAAI;QACf,IACI3J,EAAE,GAAGsK,IAAI,CAACvL,UAAU;UACpBsB,GAAG,GAAGiK,IAAI,CAAC9J,SAAS;UACpBF,GAAG,GAAGgK,IAAI,CAAC7J,SAAS;QAExB,IAAIT,EAAE,EAAE;UACJ,IAAI4L,GAAG,GAAGtB,IAAI,CAAC1a,MAAM,CAACiI,OAAO,CAAC,CAAC;UAC/BmI,EAAE,CAAChJ,KAAK,CAAC,IAAI9J,iDAAK,CAAC,CAAC,CAAC,EAAG,CAAC,GAAG8S,EAAE,CAACpQ,MAAM,CAACiI,OAAO,CAAC,CAAC,IAAK,CAAC,GAAG+T,GAAG,CAAC,CAAC;QACjE;QACA,IAAIvL,GAAG,IAAIC,GAAG,EAAE;UACZ,IAAIuL,IAAI,GAAGD,GAAG,IAAItB,IAAI,CAAC1a,MAAM,CAACiI,OAAO,CAAC,CAAC,CAAC,CAAC;;UAEzCwI,GAAG,CAAC/N,KAAK,CAACnB,SAAS,GAAG,QAAQ,GAAI,CAAC,GAAG0a,IAAK,GAAG,GAAG;UACjDvL,GAAG,CAAChO,KAAK,CAACnB,SAAS,GAAG,QAAQ,GAAI,CAAC,GAAG0a,IAAK,GAAG,GAAG;QACrD;MACJ,CAAC;MAED,IAAMC,YAAY,GAAG,SAAfA,YAAYA,CAAGhN,CAAC,EAAI;QACtB,IAAI6K,MAAI,CAACxO,OAAO,CAAC0M,QAAQ,IAAI8B,MAAI,CAAC7B,aAAa,IAAI6B,MAAI,CAACvB,aAAa,IAAIuB,MAAI,CAACxO,OAAO,CAACb,IAAI,KAAK,aAAa,EAAE,OAAO,KAAK;QAE1HwE,CAAC,CAACnE,cAAc,CAAC,CAAC;QAClBmE,CAAC,CAACjE,eAAe,CAAC,CAAC;QAEnB,IAAMkR,GAAG,GAAGC,IAAI,CAACD,GAAG,CAAC,CAAC;QACtB,IAAME,GAAG,GAAGtC,MAAI,CAACuC,aAAa,GAAGH,GAAG,GAAGpC,MAAI,CAACuC,aAAa,GAAG,GAAG;QAE/D,IAAID,GAAG,GAAG,GAAG,IAAInP,SAAS,CAACC,SAAS,CAACC,QAAQ,CAAC,KAAK,CAAC,EAAE,OAAO,KAAK;QAElE,IAAI,CAAC/O,QAAQ,CAACia,aAAa,CAAC,uBAAuB,CAAC,EAAE;UAClDyB,MAAI,CAACnc,OAAO,CAACoE,SAAS,CAACwG,GAAG,CAAC,sBAAsB,CAAC;QACtD;QACA,IAAIuR,MAAI,CAAC5K,UAAU,EAAE;UACjB4K,MAAI,CAAC5K,UAAU,CAAC3D,MAAM,CAACxJ,SAAS,CAACwG,GAAG,CAAC,4BAA4B,CAAC;QACtE;QACA,IAAIuR,MAAI,CAACwC,WAAW,EAAEzM,YAAY,CAACiK,MAAI,CAACwC,WAAW,CAAC;QAEpD,IAAMzH,KAAK,GAAGiF,MAAI,CAAC/E,UAAU,CAAC9F,CAAC,CAAC;QAChC,IAAMvL,CAAC,GAAGoW,MAAI,CAAC/Z,MAAM;QAErB+Z,MAAI,CAAC9I,aAAa,CAAC,IAAI,CAAC;QAExB,IAAI6D,KAAK,CAACK,OAAO,CAAC3P,CAAC,KAAK,CAAC,EAAE;UACvB,IAAMgX,GAAG,GAAG1H,KAAK,CAACK,OAAO,CAAC3P,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;UACxC,IAAMiX,EAAE,GAAG,CAAC,GAAI,IAAI,GAAGD,GAAI;UAC3B7Y,CAAC,CAACyD,KAAK,CAAC0N,KAAK,CAACzV,MAAM,EAAEod,EAAE,CAAC;UACzB1C,MAAI,CAAC7I,cAAc,CAAC,CAAC;QACzB;QACA6I,MAAI,CAACnc,OAAO,CAACoE,SAAS,CAACwN,MAAM,CAAC,sBAAsB,CAAC;QAErDuK,MAAI,CAACwC,WAAW,GAAGvM,UAAU,CAAC,YAAM;UAChC+J,MAAI,CAAC1F,YAAY,CAAC,CAAC;UACnB,IAAI0F,MAAI,CAAC5K,UAAU,EAAE;YACjB4K,MAAI,CAAC5K,UAAU,CAAC3D,MAAM,CAACxJ,SAAS,CAACwN,MAAM,CAAC,4BAA4B,CAAC;UACzE;QACJ,CAAC,EAAE,GAAG,CAAC;QACPuK,MAAI,CAACuC,aAAa,GAAGH,GAAG;MAC5B,CAAC;MAED,IAAI,CAACxM,EAAE,CAAC,IAAI,CAAC/R,OAAO,EAAE,yBAAyB,EAAEoa,QAAQ,CAAC;MAC1D,IAAI,CAACrI,EAAE,CAAC,IAAI,CAAC/R,OAAO,EAAE,0BAA0B,EAAEoa,QAAQ,CAAC;MAC3D,IAAI,CAACrI,EAAE,CAAC,IAAI,CAAC/R,OAAO,EAAE,yBAAyB,EAAE8a,OAAO,CAAC;MACzD,IAAI,CAAC/I,EAAE,CAAC,IAAI,CAAC/R,OAAO,EAAE,wBAAwB,EAAE+a,QAAO,CAAC;MAExD,IAAI,CAAChJ,EAAE,CAAC,IAAI,CAAC/R,OAAO,EAAE,sBAAsB,EAAE,UAAAsR,CAAC,EAAI;QAC/CpP,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;QAC3BmP,CAAC,CAACnE,cAAc,CAAC,CAAC;QAAEmE,CAAC,CAACjE,eAAe,CAAC,CAAC;QAAE,OAAO,KAAK;MACzD,CAAC,CAAC;MAEF,IAAI,CAAC,IAAI,CAACM,OAAO,CAACoC,OAAO,KAAAqM,sBAAA,GAAI,IAAI,CAACzO,OAAO,CAACoC,OAAO,cAAAqM,sBAAA,eAApBA,sBAAA,CAAsB0C,KAAK,EACpD,IAAI,CAACxP,SAAS,CAACC,SAAS,CAACC,QAAQ,CAAC,QAAQ,CAAC;QAAE;QACzCxD,gBAAgB,CAAC,IAAI,CAAChM,OAAO,EAAEse,YAAY,CAAC;IACxD;;IAEA;AACJ;AACA;AACA;AACA;AACA;AACA;EANI;IAAAle,GAAA;IAAAC,KAAA,EAOA,SAAA0R,EAAEA,CAAChR,EAAE,EAAE2L,KAAK,EAAEqS,IAAI,EAAErR,IAAI,EAAE;MACtB;MACA;MACA;MACA;;MAEA;MACA;;MAEA;MACA;MACA;MACA;;MAEA,IAAIsB,MAAM,GAAGtC,KAAK,CAACyD,KAAK,CAAC,GAAG,CAAC;QAAElO,CAAC;QAAE+c,EAAE;QAAEC,EAAE;QAAEC,EAAE;QAAEC,EAAE;MAChD,KAAKld,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+M,MAAM,CAAC3J,MAAM,EAAEpD,CAAC,EAAE,EAAE;QAChC+c,EAAE,GAAGhQ,MAAM,CAAC/M,CAAC,CAAC,CAACkO,KAAK,CAAC,GAAG,CAAC,EAAE8O,EAAE,GAAGD,EAAE,CAAC,CAAC,CAAC,EAAEE,EAAE,GAAGF,EAAE,CAAC3Z,MAAM,GAAG,CAAC,GAAG2Z,EAAE,CAAC,CAAC,CAAC,GAAG,KAAK;QACzEje,EAAE,CAAC6K,gBAAgB,CAACqT,EAAE,EAAEF,IAAI,EAAErR,IAAI,IAAI,KAAK,CAAC;QAE5C,IAAI,CAACnJ,aAAa,CAAC6a,QAAQ,CAACC,UAAU,CAAC3S,KAAK,CAAC,EACzCnI,aAAa,CAAC6a,QAAQ,CAACC,UAAU,CAAC3S,KAAK,CAAC,GAAG,EAAE;QAEjD,IAAIwS,EAAE,EACF,IAAI,CAAC3a,aAAa,CAAC6a,QAAQ,CAACC,UAAU,CAACH,EAAE,CAAC,EACtC3a,aAAa,CAAC6a,QAAQ,CAACC,UAAU,CAACH,EAAE,CAAC,GAAG,EAAE;QAElDC,EAAE,GAAG5a,aAAa,CAAC6a,QAAQ,CAACC,UAAU,CAAC3S,KAAK,CAAC,CAACzG,IAAI,CAAC;UAAEyG,KAAK,EAAEuS,EAAE;UAAEF,IAAI,EAAEA,IAAI;UAAErR,IAAI,EAAEA,IAAI,IAAI;QAAM,CAAC,CAAC;QAClG,IAAIwR,EAAE,EACF3a,aAAa,CAAC6a,QAAQ,CAACC,UAAU,CAACH,EAAE,CAAC,CAACjZ,IAAI,CAAC1B,aAAa,CAAC6a,QAAQ,CAACC,UAAU,CAAC3S,KAAK,CAAC,CAACyS,EAAE,GAAG,CAAC,CAAC,CAAC;MACpG;IACJ;;IAEA;AACJ;AACA;AACA;AACA;AACA;EALI;IAAA/e,GAAA;IAAAC,KAAA,EAMA,SAAAwR,GAAGA,CAAC9Q,EAAE,EAAE2L,KAAK,EAAEgB,IAAI,EAAE;MACjB,IAAM4R,QAAQ,GAAG/a,aAAa,CAAC6a,QAAQ,CAACC,UAAU,CAAC3S,KAAK,CAAC;MACzD,IAAI4S,QAAQ,EAAE;QAAA,IAAAC,SAAA,GAAAC,0BAAA,CACYF,QAAQ;UAAAG,KAAA;QAAA;UAA9B,KAAAF,SAAA,CAAA9V,CAAA,MAAAgW,KAAA,GAAAF,SAAA,CAAA3F,CAAA,IAAA8F,IAAA,GAAgC;YAAA,IAArBC,OAAO,GAAAF,KAAA,CAAApf,KAAA;YACdU,EAAE,CAAC6e,mBAAmB,CAACD,OAAO,CAACjT,KAAK,EAAEiT,OAAO,CAACZ,IAAI,EAAEY,OAAO,CAACjS,IAAI,IAAI,KAAK,CAAC;UAC9E;QAAC,SAAAmS,GAAA;UAAAN,SAAA,CAAAjO,CAAA,CAAAuO,GAAA;QAAA;UAAAN,SAAA,CAAAO,CAAA;QAAA;MACL;IACJ;;IAEA;AACJ;AACA;EAFI;IAAA1f,GAAA;IAAAC,KAAA,EAGA,SAAAiC,OAAOA,CAAA,EAAG;MACN,IAAI,CAACqD,KAAK,GAAG6E,SAAS;MACtB,IAAI,CAACqD,eAAe,CAAC,CAAC;MACtB,IAAI,CAAClO,QAAQ,CAAC2C,OAAO,CAAC,CAAC;IAC3B;EAAC;AAAA;AA5+CD;AACJ;AACA;AACA;AAHIyd,eAAA,CADExb,aAAa,cAKG,EAAE;AACpB;AACJ;AACA;AAFIwb,eAAA,CANExb,aAAa,cASG;EAAE8a,UAAU,EAAE,CAAC;AAAE,CAAC;AAq+CvC;AAED,CAAC,YAAM;EACH,IAAIW,KAAK;EACT,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAqBA,CAAA,EAAS;IAChCxf,QAAQ,CAAC8Z,gBAAgB,CAAC,gBAAgB,CAAC,CAACxY,OAAO,CAAC,UAAAC,CAAC,EAAI;MACrD,IAAMC,CAAC,GAAGD,CAAC,CAACsC,YAAY,CAAC,uBAAuB,CAAC;MACjD,IAAMd,CAAC,GAAGvB,CAAC,GAAGsC,aAAa,CAACC,QAAQ,CAACvC,CAAC,CAAC,GAAG,IAAI;MAE9C,IAAIuB,CAAC,YAAYe,aAAa,EAAE;QAC5Bf,CAAC,CAAClB,OAAO,CAAC,CAAC;MACf;IACJ,CAAC,CAAC;EACN,CAAC;EAED/B,MAAM,CAACqL,gBAAgB,CAAC,QAAQ,EAAE,YAAM;IACpCsG,YAAY,CAAC8N,KAAK,CAAC;IACnBA,KAAK,GAAG5N,UAAU,CAAC6N,qBAAqB,EAAE,GAAG,CAAC;EAClD,CAAC,CAAC;AACN,CAAC,EAAE,CAAC;AACJ;AACA,IAAI,OAAO1f,MAAM,KAAK,WAAW,EAAE;EACjCA,MAAM,CAACgE,aAAa,GAAGA,aAAa;AACtC;AACA,iEAAeA,aAAa,E","sources":["webpack://transformable/./src/css/transformable.css?3b64","webpack://transformable/./src/js/Ancestry.js","webpack://transformable/./src/js/Matrix.js","webpack://transformable/./src/js/Point.js","webpack://transformable/webpack/bootstrap","webpack://transformable/webpack/runtime/define property getters","webpack://transformable/webpack/runtime/hasOwnProperty shorthand","webpack://transformable/webpack/runtime/make namespace object","webpack://transformable/./src/js/transformable.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport {};","import Matrix from './Matrix.js';\r\nimport Point from './Point.js';\r\n\r\nclass Ancestry {\r\n    constructor(self) {\r\n        this.Items = [];\r\n        this._add(self, self.element);\r\n        this.Self = self;\r\n        this._init();\r\n    }\r\n\r\n    _getScroll() {\r\n        return new Point(window.pageXOffset || document.documentElement.scrollLeft, window.pageYOffset || document.documentElement.scrollTop);\r\n    }\r\n\r\n    /**\r\n     * Gets size/positions from computed style\r\n     * @param {HtmlElement} el\r\n     * @param {CSSStyleDeclaration} cs If you just got the computed styles, pass them in.\r\n     */\r\n    GetElementSize(el, cs) {\r\n        cs = cs || getComputedStyle(el);\r\n\r\n        const left = parseFloat(cs.left);\r\n        const top = parseFloat(cs.top);\r\n        const w = parseFloat(cs.width);\r\n        const h = parseFloat(cs.height);\r\n\r\n        return {\r\n            offset: new Point(left || 0, top || 0),\r\n            width: w,\r\n            height: h,\r\n            topleft: new Point(0, 0),\r\n            topright: new Point(w, 0),\r\n            bottomright: new Point(w, h),\r\n            bottomleft: new Point(0, h)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Prints out the Ancestry to console\r\n     */\r\n    _debug() {\r\n        this.Items.forEach(function (v, i) {\r\n            console.log(v.matrix.elements);\r\n        });\r\n        this.Items.forEach(function (v, i) {\r\n            console.log([v.element]);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Automatically called after resizing the window.\r\n     * Or can be called manually if the resizable element has its position on \r\n     * the page changed by elements outside its Ancestry. E.g. content above, changes height\r\n     */\r\n    Refresh() {\r\n        this.Items = [];\r\n        this._add(this.Self, this.Self.element);\r\n        //this.scroll = Point.Point0;\r\n        this._init();\r\n    }\r\n\r\n    /**\r\n     * Checks a computed style value to see if it is in percent instead of px \r\n     * @param {String|Number} v\r\n     */\r\n    _ispercent(v) { return v.indexOf('%') > -1; }\r\n\r\n    /**\r\n     * Checks a computed style value to see if it is auto\r\n     * @param {String|Number} v\r\n     */\r\n    _isauto(v) { return v == 'auto'; }\r\n\r\n    /**\r\n     * Converts percentage values obtained from buggy browsers to pixels\r\n     * @param {String} k CSS style to calculate\r\n     * @param {String|Number} val The percentage value to convert to pixels\r\n     * @param {CSSStyleDeclaration} cs The computed styles of the parent element. E.g. getComputedStyle(parentElement);\r\n     */\r\n    _pixelFromParent(k, val, cs) {\r\n        if (val === '0%') return 0;\r\n        let v = parseFloat(val);\r\n        switch (k) {\r\n            case 'left':\r\n                v = parseFloat(cs.width) * v / 100;\r\n                break;\r\n            case 'top':\r\n                v = parseFloat(cs.height) * v / 100;\r\n                break;\r\n        }\r\n        return v;\r\n    }\r\n\r\n    /**\r\n     * Gets dimensions from computed styles and makes them all pixel based\r\n     * @param {HtmlElement} el\r\n     */\r\n    GetComputedDims(el) {\r\n        const cs = getComputedStyle(el);\r\n        const cmt = cs.marginTop;\r\n        const cml = cs.marginLeft;\r\n        let cl = cs.left;\r\n        let ct = cs.top;\r\n        const leftp = this._ispercent(cl);\r\n        const topp = this._ispercent(ct);\r\n        const pf = function (v) { return parseFloat(v); }\r\n        let l, t, pcs;\r\n\r\n        if (this._isauto(cl)) cl = 0;\r\n        if (this._isauto(ct)) ct = 0;\r\n\r\n        if (leftp || topp)\r\n            pcs = getComputedStyle(el.parentNode);\r\n\r\n        if (leftp) l = this._pixelFromParent('left', cl, pcs);\r\n        if (topp) t = this._pixelFromParent('top', ct, pcs);;\r\n\r\n        return {\r\n            left: typeof l != 'undefined' ? l : pf(cl),\r\n            top: typeof t != 'undefined' ? t : pf(ct),\r\n            marginLeft: pf(cml),\r\n            marginTop: pf(cmt),\r\n            transform: cs.transform\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Walks upwards through node hierarchy replacing any position/offset changing CSS with an equivalent matrix.\r\n     * This simplifies matrix calculations and means no CSS restrictions are required on elements you want to make transformable.\r\n     */\r\n    _init() {\r\n        let t, has, pt, tid, nm, el = this.Self.element;\r\n        while (el.parentNode && !el.parentNode.body) {\r\n\r\n            const cs = this.GetComputedDims(el.parentNode);\r\n            t = cs.transform;\r\n            has = /matrix\\(\\-?[0-9]+[^\\)]+\\)/.test(t);\r\n            \r\n            const top = cs.top;\r\n            let left = cs.left,\r\n            margintop = cs.marginTop,\r\n            marginleft = cs.marginLeft;\r\n\r\n            if (has || el.parentNode.classList.contains('transformable') || el.classList.contains('transformable')\r\n                || top != 0 || left != 0\r\n                || margintop != 0\r\n                || marginleft != 0\r\n                ) {\r\n                if (tid = el.parentNode.getAttribute('data-transformable-id')) {\r\n                    pt = Transformable.Instance[tid];\r\n                    if (pt)\r\n                        this._add(pt);\r\n                } else {\r\n                    let om = has ? new Matrix(this.Self._cssStringToArray(t)) : false;                \r\n\r\n                    if (has || top != 0 || left != 0 || margintop != 0 || marginleft != 0 || el.classList.contains('transformable')) {\r\n                        nm = new Matrix();\r\n                        nm.translate(left||0, top||0).translate(marginleft||0, margintop||0);\r\n\r\n                        if (om)\r\n                            nm.multiply(om.elements);\r\n\r\n                        let prect = this.GetElementSize(el.parentNode);\r\n\r\n                        el.parentNode.style.top = 0;\r\n                        el.parentNode.style.left = 0; \r\n                        el.parentNode.style.marginLeft = 0;\r\n                        el.parentNode.style.marginTop = 0;\r\n                        el.parentNode.style.transformOrigin = '0 0';\r\n                        el.parentNode.style.transform = this.Self._arrayToCssString(nm.elements);\r\n\r\n                        this._add(nm, el.parentNode, prect);\r\n                    }\r\n                }\r\n            }\r\n            el = el.parentNode;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets offset initially then updates scroll position data\r\n     */\r\n    _setoffset () {\r\n        this.scroll = this._getScroll();\r\n        if(this.offset) return;\r\n        let cur, i;\r\n        const trans = new Matrix();\r\n        for (i = 0; i < this.Items.length; i++)\r\n            trans.translate(this.Items[i].matrix.translation());\r\n\r\n        for (i = 0; i < this.Items.length; i++) {\r\n            cur = this.Items[i];\r\n            if (cur.element.classList.contains('transformable')) {\r\n                this.offset = cur.transformable.offset.sub(trans.translation());\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds an element/transformable element to the Ancestry of parent elements\r\n     * @param {Transformable|Matrix} t\r\n     * @param {HtmlElement} el\r\n     */\r\n    _add(t, el) {\r\n        if (t instanceof Transformable) {\r\n            this.Items.unshift({ matrix: t.matrix, element: el || t.element, rect: t.sizes.element.initial, transformable: t });\r\n        }\r\n        if (t instanceof Matrix) {\r\n            this.Items.unshift({ matrix: t, element: el, rect: this.GetElementSize(el) });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns Array of objects for each parent element.\r\n     * Gets the matrix, inverse matrix and the element for each parent.\r\n     */\r\n    GetParents() {\r\n        let r = [];\r\n        //this._setoffset();\r\n        this.Items.forEach(function (v, i) {\r\n            let t = v.transformable, m, ti;\r\n            if (!t)\r\n                if (ti = v.element.getAttribute('data-transformable-id')) {\r\n                    t = Transformable.Instance[ti];\r\n                    v.transformable = t;\r\n                }\r\n\r\n            m = t ? t.matrix : v.matrix\r\n            r.push({\r\n                Matrix: m,\r\n                Inverse: m.inverse(),\r\n                Element: v.element\r\n            });\r\n        });\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * Uses this instance's matrix to transform corner points\r\n     * @param {Object} c Named points of a rectangle\r\n     */\r\n    TransformCorners(c) {\r\n        const mat = this.GetMatrix();\r\n        return {\r\n            bottomright: mat.transformpoint(c.bottomright),\r\n            bottomleft: mat.transformpoint(c.bottomleft),\r\n            topright: mat.transformpoint(c.topright),\r\n            topleft: mat.transformpoint(c.topleft)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets data from Items for the outermost containing element.\r\n     */\r\n    FirstParent() {\r\n        const t = this, i = t.Items, l = i.length;\r\n        const par = l > 1 ? i[l - 2] : false;\r\n\r\n        return par;\r\n    }\r\n\r\n    /**\r\n     Gets the combined effective matrix based on all matrices that have an effect on the element\r\n     */\r\n    GetMatrix() {\r\n        let mat = Matrix.Identity();\r\n        this.Items.forEach(function (v, i) {\r\n            mat.multiply(v.matrix.elements);\r\n        });\r\n        return mat;\r\n    }\r\n\r\n    /**\r\n     * Gets the x,y coordinate on the transformable element for a given point\r\n     * @param {Point} p Coordinates in the window or from a mouse/touch event\r\n     * @param {Array of Object} pars Objects with matrix, inverse matrix and element\r\n     */\r\n    OffsetFromPoint(p, pars) {\r\n        pars = pars || this.GetParents();\r\n        this._setoffset();\r\n        let op = p, cur, mat = Matrix.Identity().translate(this.offset);\r\n\r\n        for (var i = 0; i < pars.length; i++) {\r\n            cur = pars[i];\r\n            mat.multiply(cur.Matrix.elements);\r\n        }\r\n\r\n        const matinv = mat.inverse();\r\n        op = matinv.transformpoint(op); \r\n\r\n        return op;\r\n    }\r\n\r\n}\r\n\r\nexport default Ancestry;\r\n","import Point from './Point.js';\r\n\r\nvar Matrix = function (a) {\r\n    if (a == null || typeof a == 'undefined')\r\n        return Matrix.Identity();\r\n\r\n    if (a instanceof Array) {\r\n        this.elements = a.slice(0);\r\n    } else {\r\n        if(a instanceof Matrix) {\r\n            this.elements = a.elements.slice(0);\r\n        } else {\r\n            if (arguments.length == 6) {\r\n                this.elements = [];\r\n                var i = 0;\r\n                while (i < arguments.length)\r\n                    this.elements.push(arguments[i++]);\r\n            } else\r\n                throw new Error(\"Can't create Matrix from supplied arguments. Array of 6 elements, Matrix or nothing only.\");\r\n        }\r\n    }\r\n    this.history = { undo: [], redo: [] };\r\n\r\n    return this;\r\n}\r\nMatrix.Identity = function () {\r\n    return new Matrix([1, 0, 0, 1, 0, 0]);\r\n}\r\nMatrix.prototype = {\r\n    transformpoint: function (pt) {\r\n        var m = this.elements;\r\n\t\treturn new Point(\r\n\t\t\tpt.x * m[0] + pt.y * m[2] + m[4],\r\n\t\t\tpt.x * m[1] + pt.y * m[3] + m[5]\r\n\t\t)\r\n    },\r\n    multiply: function(els) {\r\n        var me = this.elements;\r\n        var a1 = me[0],\r\n\t\t\tb1 = me[1],\r\n\t\t\tc1 = me[2],\r\n\t\t\td1 = me[3],\r\n\t\t\te1 = me[4],\r\n\t\t\tf1 = me[5],\r\n            a2 = els[0],\r\n            b2 = els[1],\r\n            c2 = els[2],\r\n            d2 = els[3],\r\n            e2 = els[4],\r\n            f2 = els[5];\r\n\r\n\r\n\t\t/* matrix order (canvas compatible):\r\n\t\t* ace\r\n\t\t* bdf\r\n\t\t* 001\r\n\t\t*/\r\n\t\tthis.elements = [\r\n            a1 * a2 + c1 * b2,\r\n            b1 * a2 + d1 * b2,\r\n            a1 * c2 + c1 * d2,\r\n            b1 * c2 + d1 * d2,\r\n            a1 * e2 + c1 * f2 + e1,\r\n            b1 * e2 + d1 * f2 + f1\r\n\t\t];\r\n\r\n\t\treturn this;\r\n    },\r\n    elementsequal: function (a, b) {\r\n        if (!a || !b) return false;\r\n        return (\r\n        a[0] == b[0] &&\r\n        a[1] == b[1] &&\r\n        a[2] == b[2] &&\r\n        a[3] == b[3] &&\r\n        a[4] == b[4] &&\r\n        a[5] == b[5]);\r\n    },\r\n    save: function (els) {\r\n        var h = this.history, last,\r\n            k = typeof els === 'string' ? els : false;\r\n\r\n        if (!els || k)\r\n            els = this.elements;\r\n\r\n        last = h.undo[h.undo.length - 1];\r\n\r\n        if (!this.elementsequal(els, last)) {\r\n            var l = h.undo.push(els.slice(0));\r\n            h.redo = [];\r\n            if (k)\r\n                h.undo[k] = h.undo[l - 1];\r\n        } else \r\n            if (k) {\r\n                h.undo[k] = last;\r\n            }\r\n    },\r\n    undo: function (k) {\r\n        var h = this.history.undo,\r\n            len = h.length,\r\n            cur = h.pop(),\r\n            prev = typeof k == 'string' ? h[k] : h[h.length - 1];\r\n        \r\n        if (cur)\r\n            this.history.redo.unshift(cur);\r\n\r\n        this.elements = prev ? prev.slice(0) : this.identity();\r\n    },\r\n    redo: function () {\r\n        var h = this.history.redo, \r\n            len = h.length, \r\n            cur = h.pop(),\r\n            prev = h[h.length - 1]\r\n        \r\n        if (cur)\r\n            this.history.undo.unshift(cur);\r\n\r\n        this.elements = prev ? prev.slice(0) : this.identity();\r\n    },\r\n    reset: function () {\r\n        this.elements = this.identity();\r\n        return this;\r\n    },\r\n    determinant: function () {\r\n        var m = this.elements;\r\n        return m[0] * m[3] - m[1] * m[2];\r\n    },\r\n\tinverse: function() {\r\n\r\n\t\tvar me = this.elements,\r\n\t\t\tm  = this.identity(),\r\n\t\t\tdt = this.determinant();\r\n\r\n\t\tif (dt < 1e-14)\r\n\t\t\tthrow \"Matrix not invertible.\";\r\n\r\n\t\tm[0] = me[3] / dt;\r\n\t\tm[1] = -me[1] / dt;\r\n\t\tm[2] = -me[2] / dt;\r\n\t\tm[3] = me[0] / dt;\r\n\t\tm[4] = (me[2] * me[5] - me[3] * me[4]) / dt;\r\n\t\tm[5] = -(me[0] * me[5] - me[1] * me[4]) / dt;\r\n\r\n\t\treturn new Matrix(m);\r\n\t},\r\n\tinvert: function () {\r\n        return this.multiply(this.inverse().elements);\r\n\t},\r\n    identity: function () {\r\n        return [1, 0, 0, 1, 0, 0];\r\n    },\r\n    isIdentity: function () {\r\n        var m = this.elements;\r\n        return m[0] === 1 && m[1] === 0 && m[2] === 0 && m[3] === 1 && m[4] === 0 && m[5] === 0;\r\n    },\r\n    translate: function (x, y) {\r\n        if (x instanceof Point && !y)\r\n            return this.multiply([1, 0, 0, 1, x.x, x.y]);\r\n\r\n        return this.multiply([1, 0, 0, 1, x, y]);\r\n    },\r\n    scale: function (pt, s) {\r\n        this.multiply([s, 0, 0, s, 0, 0]);\r\n        var dp = pt.sub(pt.scale(s)).scale(1/s); // keep pt in same place after scale from origin\r\n        return this.translate(dp);\r\n    },\r\n    rotateAboutPoint: function (pt, a) {\r\n        var r = a * Math.PI / 180;\r\n        return this.multiply([\r\n            Math.cos(r),\r\n            Math.sin(r),\r\n            -Math.sin(r),\r\n            Math.cos(r),\r\n            pt.x - Math.cos(r) * pt.x - -Math.sin(r) * pt.y,\r\n            pt.y - Math.sin(r) * pt.x - Math.cos(r) * pt.y\r\n        ]);\r\n    },\r\n    rotate: function (a,b) {\r\n        if (a instanceof Point)\r\n            return this.rotateAboutPoint(a, b);\r\n\r\n        var r = a * Math.PI / 180;\r\n        return this.multiply([Math.cos(r), Math.sin(r), -Math.sin(r), Math.cos(r), 0, 0]);\r\n    },\r\n    normaldegree: function (r) {\r\n        return r < 0 ? r + 360 : r;\r\n    },\r\n    rotation: function (norm) {\r\n        var l = this.elements, r = Math.atan2(l[1], l[0]) * 180 / Math.PI;\r\n\r\n        return norm ? this.normaldegree(r) : r;\r\n    },\r\n    scaling: function () {\r\n        return Math.sqrt(Math.pow(this.elements[0], 2) + Math.pow(this.elements[1], 2))\r\n    },\r\n    translation: function () {\r\n        return new Point(this.elements[4], this.elements[5]);\r\n    }\r\n}\r\n\r\nexport default Matrix;\r\n","class Point {\r\n  constructor(x, y = x) {\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n\r\n  scale(factor) {\r\n    return new Point(this.x * factor, this.y * factor);\r\n  }\r\n\r\n  round(precision = 0) {\r\n    const factor = precision ? Math.pow(10, precision) : 1;\r\n    return new Point(\r\n      Math.round(this.x * factor) / factor,\r\n      Math.round(this.y * factor) / factor\r\n    );\r\n  }\r\n\r\n  sub(p) {\r\n    return new Point(this.x - p.x, this.y - p.y);\r\n  }\r\n\r\n  add(p) {\r\n    return new Point(this.x + p.x, this.y + p.y);\r\n  }\r\n\r\n  mult(p) {\r\n    return new Point(this.x * p.x, this.y * p.y);\r\n  }\r\n\r\n  divide(p) {\r\n    return new Point(this.x / p.x, this.y / p.y);\r\n  }\r\n\r\n  nonzero() {\r\n    return this.x !== 0 || this.y !== 0;\r\n  }\r\n\r\n  equals(p) {\r\n    return this.x === p.x && this.y === p.y;\r\n  }\r\n\r\n  moreoreq(p) {\r\n    return { x: this.x >= p.x, y: this.y >= p.y };\r\n  }\r\n\r\n  lessoreq(p) {\r\n    return { x: this.x <= p.x, y: this.y <= p.y };\r\n  }\r\n\r\n  dot(p) {\r\n    return this.x * p.x + this.y * p.y;\r\n  }\r\n\r\n  perpOnLine(p1, p2) {\r\n    const k = ((p2.y - p1.y) * (this.x - p1.x) - (p2.x - p1.x) * (this.y - p1.y)) /\r\n      (Math.pow(p2.y - p1.y, 2) + Math.pow(p2.x - p1.x, 2));\r\n    const x4 = this.x - k * (p2.y - p1.y);\r\n    const y4 = this.y + k * (p2.x - p1.x);\r\n    return new Point(x4, y4);\r\n  }\r\n\r\n  mag() {\r\n    return Math.sqrt(this.x * this.x + this.y * this.y);\r\n  }\r\n\r\n  // toPos() {\r\n  //   return new Pos(this.x, this.y);\r\n  // }\r\n}\r\n\r\nexport default Point;\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import '../css/transformable.css';\r\nimport Matrix from './Matrix.js';\r\nimport Ancestry from './Ancestry.js';\r\nimport Point from './Point.js';\r\n\r\n// Wheel event polyfill (modernized slightly for scope, but logic preserved for compatibility)\r\n((window, document) => {\r\n    let prefix = \"\";\r\n    let _addEventListener;\r\n\r\n    // Detect event model\r\n    if (window.addEventListener) {\r\n        _addEventListener = \"addEventListener\";\r\n    } else {\r\n        _addEventListener = \"attachEvent\";\r\n        prefix = \"on\";\r\n    }\r\n\r\n    // Detect available wheel event\r\n    const support = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : // Modern browsers\r\n                    document.onmousewheel !== undefined ? \"mousewheel\" : // Webkit and IE\r\n                    \"DOMMouseScroll\"; // Older Firefox\r\n\r\n    window.addWheelListener = (elem, callback, useCapture) => {\r\n        const _addWheelListener = (targetElem, eventName, cb, capture) => {\r\n            targetElem[_addEventListener](prefix + eventName, support === \"wheel\" ? cb : (originalEvent) => {\r\n                const event = originalEvent || window.event;\r\n\r\n                // Create a normalized event object\r\n                const normalizedEvent = {\r\n                    originalEvent: event,\r\n                    target: event.target || event.srcElement,\r\n                    type: \"wheel\",\r\n                    deltaMode: event.type === \"MozMousePixelScroll\" ? 0 : 1,\r\n                    deltaX: 0,\r\n                    deltaY: 0,\r\n                    deltaZ: 0,\r\n                    preventDefault() {\r\n                        event.preventDefault ?\r\n                            event.preventDefault() :\r\n                            event.returnValue = false;\r\n                    },\r\n                    stopPropagation() {\r\n                        event.stopPropagation ?\r\n                            event.stopPropagation() :\r\n                            event.returnValue = false;\r\n                    },\r\n                };\r\n\r\n                // Calculate deltaY (and deltaX)\r\n                if (support === \"mousewheel\") {\r\n                    normalizedEvent.deltaY = -1 / 40 * event.wheelDelta;\r\n                    if (event.wheelDeltaX) {\r\n                        normalizedEvent.deltaX = -1 / 40 * event.wheelDeltaX;\r\n                    }\r\n                } else {\r\n                    normalizedEvent.deltaY = event.detail;\r\n                }\r\n\r\n                return cb(normalizedEvent);\r\n            }, capture || false);\r\n        };\r\n\r\n        _addWheelListener(elem, support, callback, useCapture);\r\n\r\n        // Handle MozMousePixelScroll in older Firefox\r\n        if (support === \"DOMMouseScroll\") {\r\n            _addWheelListener(elem, \"MozMousePixelScroll\", callback, useCapture);\r\n        }\r\n    };\r\n})(window, document);\r\n\r\nclass Transformable {\r\n    /**\r\n     * A store/lookup of all transformable instances.\r\n     * Each transformable element is given a data attribute for its id in this lookup.\r\n     */\r\n    static Instance = [];\r\n    /**\r\n     * Datastore for any namespaced events attached to elements by .on(....)\r\n     */\r\n    static Handlers = { Namespaces: {} };\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {HTMLElement} el\r\n     * @param {Object} opts\r\n     */\r\n    constructor(el, opts = {}) {\r\n        this.element = el.length ? el[0] : el;\r\n        this.options = opts;\r\n        \r\n        this.element.classList.add('transformable');\r\n        this.parent = this.element.parentNode;\r\n\r\n        this.setInitialSizes();\r\n\r\n        if (opts.matrix) {\r\n            const cscale = { x: 1, y: 1 };\r\n            if (opts.computedsize?.width || opts.computedsize?.Width) {\r\n                const precs = {\r\n                    width: opts.computedsize.width || opts.computedsize.Width,\r\n                    height: opts.computedsize.height || opts.computedsize.Height\r\n                };\r\n                const curcs = this.sizes.element.initial;\r\n                cscale.x = curcs.width / precs.width;\r\n                cscale.y = curcs.height / precs.height;\r\n            }\r\n            if (Array.isArray(opts.matrix) && opts.matrix.length === 6) {\r\n                opts.matrix[4] *= cscale.x;\r\n                opts.matrix[5] *= cscale.y;\r\n                this._setMatrix(new Matrix(opts.matrix));\r\n            } else if (opts.matrix instanceof Matrix) {\r\n                opts.matrix.elements[4] *= cscale.x;\r\n                opts.matrix.elements[5] *= cscale.y;\r\n                this._setMatrix(opts.matrix);\r\n            }\r\n        }\r\n        \r\n        this.matrix = this._getMatrix();\r\n        this.originalTransition = this._getOriginalTransition();\r\n        this.Ancestry = new Ancestry(this);\r\n\r\n        this._setOffset();\r\n        this.Ancestry._setoffset();\r\n\r\n        this.dragging = false;\r\n        this.start = null;\r\n        this.orig = null;\r\n        this.zooma = 0.001;\r\n\r\n        this.events = {\r\n            start: opts.start,\r\n            move: opts.move,\r\n            stop: opts.stop,\r\n            tap: opts.tap,\r\n            transition: opts.transition\r\n        };\r\n\r\n        this.element.setAttribute('data-transformable-id', Transformable.Instance.push(this) - 1);\r\n        if (!navigator.userAgent.includes('Edge')) {\r\n            this.element.setAttribute('draggable', 'false');\r\n        }\r\n\r\n        if ((opts.attachevents ?? true) && opts.editable !== false) {\r\n            this._addEvents();\r\n            if (opts.resize) this.createResizeHandles(opts.resize);\r\n            if (!opts.disable?.rotate) this.createRotateHandles();\r\n            if (opts.handle && opts.type === 'rotator-box') this._addRotateEvents(opts.handle);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets any existing CSS transition that exists on the element.\r\n     * It will be merged with transition changes to preserve existing effects\r\n     */\r\n    _getOriginalTransition() {\r\n        const t = getComputedStyle(this.element).transition;\r\n        if (!t) return '';\r\n        return t.split(',').filter(part => !part.trim().startsWith('transform')).join(',');\r\n    }\r\n\r\n    /**\r\n     * Creates an HTML Element from a string.\r\n     * @param {String} str E.g. span, div etc\r\n     */\r\n    tag(str) {\r\n        const r = document.createElement('div');\r\n        r.innerHTML = str;\r\n        return r.firstChild;\r\n    }\r\n\r\n    /**\r\n     * Adds rotation handles on to the transformable element and wires up their events\r\n     * @param {String} typ \r\n     */\r\n    createRotateHandles(typ) {\r\n        if (typ && typ !== 'rotate') return;\r\n\r\n        const box = this.tag('<div class=\"transformable-rotation-box\"></div>');\r\n        const rot = this.tag('<svg class=\"transformable-svg-rotator\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 96 96\" style=\"enable-background:new 0 0 96 96;\" xml:space=\"preserve\"><g><circle style=\"fill:#00A8DF;\" cx=\"48.3\" cy=\"48\" r=\"35.3\"/><g><path style=\"fill:#FFFFFF;\" d=\"M35.2,3.8l4.1,28.5c0.2,1.5,2,2.1,3,1l8.2-8.2c0.7-0.7,1.8-0.7,2.5,0l8.8,8.8c7.8,7.8,9.1,20.2,1.2,28.2l-10,10c-0.7,0.7-1.8,0.7-2.5,0L41,62.6c-1-1-2.8-0.4-3,1l-4.1,28.5c-0.2,1.2,0.8,2.2,2,2l28.5-4.1c1.5-0.2,2.1-2,1-3l-8.9-8.9c-0.7-0.7-0.7-1.8,0-2.5l10-10c9.8-9.8,8.5-25.6-1.2-35.2l-8.8-8.8c-0.7-0.7-0.7-1.8,0-2.5L66.7,8.9c1-1,0.4-2.8-1-3L37.2,1.8C36,1.6,35,2.6,35.2,3.8z\"/><g style=\"opacity:0.5;\"><path d=\"M36.9,1.8c0.1,0,0.2,0,0.3,0l28.5,4.1c1.5,0.2,2.1,2,1,3L56.6,19.1c-0.7,0.7-0.7,1.8,0,2.5l8.8,8.8c9.7,9.7,11,25.5,1.2,35.2l-10,10c-0.7,0.7-0.7,1.8,0,2.5l8.9,8.9c1,1,0.4,2.8-1,3l-28.5,4.1c-0.1,0-0.2,0-0.3,0c-1.1,0-1.9-1-1.8-2.1l4.1-28.5c0.1-1,0.9-1.5,1.8-1.5c0.4,0,0.9,0.2,1.3,0.5l9.5,9.5c0.4,0.4,0.8,0.5,1.3,0.5s0.9-0.2,1.3-0.5l10-10c8-8,6.7-20.3-1.2-28.2L53,25.2c-0.4-0.4-0.8-0.5-1.3-0.5s-0.9,0.2-1.3,0.5l-8.2,8.2c-0.4,0.4-0.8,0.5-1.3,0.5c-0.8,0-1.7-0.6-1.8-1.5L35.2,3.8C35,2.7,35.9,1.8,36.9,1.8 M36.9-0.2c-1.1,0-2.1,0.5-2.9,1.3c-0.7,0.8-1,1.9-0.9,3l4.1,28.5c0.3,1.9,1.9,3.3,3.8,3.3c1,0,2-0.4,2.7-1.1l8.1-8.1l8.7,8.7c7.4,7.4,8,18.6,1.2,25.3l-9.8,9.8l-9.3-9.3c-0.7-0.7-1.7-1.1-2.7-1.1c-1.9,0-3.5,1.4-3.8,3.3l-4.1,28.5c-0.2,1.1,0.2,2.2,0.9,3c0.7,0.8,1.8,1.3,2.9,1.3c0.2,0,0.4,0,0.5,0l28.5-4.1c1.4-0.2,2.6-1.2,3.1-2.6c0.5-1.4,0.1-2.9-0.9-3.9l-8.7-8.7l9.8-9.8c10.2-10.2,9.6-27.2-1.2-38.1l-8.7-8.7l10-10c1-1,1.4-2.5,0.9-3.9c-0.5-1.4-1.6-2.4-3.1-2.6L37.5-0.2C37.3-0.2,37.1-0.2,36.9-0.2L36.9-0.2z\"/></g></g></g></svg>');\r\n        const anc = this.tag('<svg class=\"transformable-svg-anchor\" version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 96 96\" style=\"enable-background:new 0 0 96 96;\" xml:space=\"preserve\"><g><circle style=\"fill:#00A8DF;\" cx=\"47.6\" cy=\"48.4\" r=\"17.6\"/><g><path style=\"fill:#FFFFFF;\" d=\"M69,46H50V27.2c0-1.4-1.1-2.4-2.5-2.4S45,25.9,45,27.2V46H26.6c-1.4,0-2.4,1.1-2.4,2.5s1.1,2.5,2.4,2.5H45v18.6c0,1.4,1.1,2.4,2.5,2.4s2.5-1.1,2.5-2.4V51h19c1.4,0,2.4-1.1,2.4-2.5S70.3,46,69,46z\"/><g style=\"opacity:0.5;\"><path d=\"M47.5,24.8c1.4,0,2.5,1.1,2.5,2.4V46h19c1.4,0,2.4,1.1,2.4,2.5c0,1.4-1.1,2.5-2.4,2.5H50v18.6c0,1.4-1.1,2.4-2.5,2.4S45,70.9,45,69.6V51H26.6c-1.4,0-2.4-1.1-2.4-2.5c0-1.4,1.1-2.5,2.4-2.5H45V27.2C45,25.9,46.1,24.8,47.5,24.8 M47.5,22.8c-2.5,0-4.5,2-4.5,4.4V44H26.6c-2.5,0-4.4,2-4.4,4.5c0,2.5,2,4.5,4.4,4.5H43v16.6c0,2.5,2,4.4,4.5,4.4s4.5-2,4.5-4.4V53h17c2.5,0,4.4-2,4.4-4.5c0-2.5-2-4.5-4.4-4.5H52V27.2C52,24.8,50,22.8,47.5,22.8L47.5,22.8z\"/></g></g></g></svg>');\r\n        const lin = this.tag('<div class=\"transformable-rotation-line\"></div>');\r\n\r\n        box.append(lin, anc, rot, this.tag('<div class=\"transformable-anchor-point\"></div>'));\r\n\r\n        if (this.element.nodeName === 'IMG') {\r\n            this.parent.appendChild(box);\r\n        } else {\r\n            this.element.appendChild(box);\r\n        }\r\n\r\n        box.addEventListener('click', e => { e.stopPropagation(); return false; });\r\n\r\n        this.rotatorBox = new Transformable(box, { type: 'rotator-box', rotatetarget: this, handle: rot, disable: { zoom: true, rotate: true, resize: true } });\r\n\r\n        const _domouseup = () => {\r\n            if (this.rotatorBox?.parent) {\r\n                this.rotatorBox.parent.classList.remove('transformable-mousedown');\r\n            }\r\n            this.off(document.body, 'mouseup.rotatormouse');\r\n        };\r\n        const _domousedown = () => {\r\n            this.rotatorBox.parent.classList.add('transformable-mousedown');\r\n            this.on(document.body, 'mouseup.rotatormouse', _domouseup);\r\n        };\r\n        const _domouseleave = (e) => {\r\n            if (this._overTimer) clearTimeout(this._overTimer);\r\n\r\n            this._resizeTimer = setTimeout(() => {\r\n                this.element.classList.remove('transformable-resize-over');\r\n            }, 500);\r\n\r\n            e.currentTarget.classList.remove('transformable-over-active', 'transformable-over');\r\n        };\r\n        const _domouseenter = (tim) => {\r\n            if (tim.stopPropagation) tim.stopPropagation();\r\n            if (this._resizeTimer) clearTimeout(this._resizeTimer);\r\n\r\n            const target = this.rotatorBox.parent;\r\n            target.classList.add('transformable-over', 'transformable-resize-over');\r\n\r\n            this.Ancestry.Items.forEach(v => {\r\n                if (v._overTimer) clearTimeout(v._overTimer);\r\n            });\r\n\r\n            this._overTimer = setTimeout(() => {\r\n                const rb = this.rotatorBox;\r\n                if (parseFloat(getComputedStyle(rb.element).width) >= 32) {\r\n                    rb.parent.classList.add('transformable-over-active');\r\n                }\r\n                const l = this.Ancestry.Items.length;\r\n                this.Ancestry.Items.forEach((v, i) => {\r\n                    if (i < l - 2) {\r\n                        v.element.classList.remove('transformable-over-active');\r\n                    }\r\n                });\r\n            }, typeof tim === 'number' ? tim : 1500);\r\n        };\r\n\r\n        const rotparent = this.rotatorBox.parent;\r\n        this.on(rotparent, 'mouseenter.rotatormouse', _domouseenter);\r\n        this.on(rotparent, 'mouseleave.rotatormouse', _domouseleave);\r\n        this.on(rotparent, 'mousedown.rotatormouse', _domousedown);\r\n        this.on(rotparent, 'click.rotatormouse', () => _domouseenter.call(rotparent, 0));\r\n    }\r\n    \r\n    /**\r\n     * Creates resize handles on the transformable element and wires up their events\r\n     * @param {String} typ\r\n     */\r\n    createResizeHandles(typ) {\r\n        if (typ !== 'tl-br') return;\r\n        \r\n        const tl_svg = this.tag('<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"-271 394.9 52 52\" style=\"enable-background:new -271 394.9 52 52;\" xml:space=\"preserve\"><g><path style=\"fill:#00A8DF;\" d=\"M-244.9,421L-244.9,421L-244.9,421L-244.9,421L-244.9,421l26,0.1c0-10.8-6.1-20-16-24.1 c-10-4.1-20.8-2-28.4,5.7c-7.6,7.6-9.7,18.5-5.6,28.4c4.2,10,13.4,16,24.2,15.9L-244.9,421z\"/><path style=\"fill:none;stroke:#FFFFFF;stroke-width:3;\" d=\"M-251.6,414.3\"/><path style=\"fill:none;stroke:#FFFFFF;stroke-width:3;\" d=\"M-236.6,414.3\"/></g><g><path style=\"fill:#FFFFFF;\" d=\"M-227,419.5l-7.6-4.4c-1.1-0.6-2.4,0.2-2.4,1.4v1.9h-5.6v-5.5h2c1.2,0,2-1.3,1.4-2.4l-4.4-7.6 c-0.6-1.1-2.1-1.1-2.7,0l-4.4,7.6c-0.6,1.1,0.2,2.4,1.4,2.4h2v5.5h-5.6v-1.9c0-1.2-1.3-2-2.4-1.4l-7.6,4.4c-1.1,0.6-1.1,2.1,0,2.7 l7.6,4.4c1.1,0.6,2.4-0.2,2.4-1.4v-2h5.6v5.6h-2c-1.2,0-2,1.3-1.4,2.4l4.4,7.6c0.6,1.1,2.1,1.1,2.7,0l4.4-7.6 c0.6-1.1-0.2-2.4-1.4-2.4h-2v-5.6h5.6v2c0,1.2,1.3,2,2.4,1.4l7.6-4.4C-225.9,421.7-225.9,420.1-227,419.5z\"/><path style=\"opacity:0.5;fill:#231F20;\" d=\"M-245,402.1c0.5,0,1.1,0.3,1.4,0.8l4.4,7.6c0.6,1.1-0.2,2.4-1.4,2.4h-2v5.5h5.6v-1.9 c0-0.9,0.8-1.6,1.6-1.6c0.3,0,0.5,0.1,0.8,0.2l7.6,4.4c1.1,0.6,1.1,2.1,0,2.7l-7.6,4.4c-0.3,0.1-0.5,0.2-0.8,0.2 c-0.8,0-1.6-0.7-1.6-1.6v-2h-5.6v5.6h2c1.2,0,2,1.3,1.4,2.4l-4.4,7.6c-0.3,0.5-0.8,0.8-1.4,0.8c-0.5,0-1.1-0.3-1.4-0.8l-4.4-7.6 c-0.6-1.1,0.2-2.4,1.4-2.4h2v-5.6h-5.6v2c0,0.9-0.8,1.6-1.6,1.6c-0.3,0-0.5-0.1-0.8-0.2l-7.6-4.4c-1.1-0.6-1.1-2.1,0-2.7l7.6-4.4 c0.3-0.1,0.5-0.2,0.8-0.2c0.8,0,1.6,0.7,1.6,1.6v1.9h5.6v-5.5h-2c-1.2,0-2-1.3-1.4-2.4l4.4-7.6C-246.1,402.3-245.5,402.1-245,402.1 M-245,400.6c-1.1,0-2.1,0.6-2.6,1.5l-4.4,7.6c-0.5,0.9-0.5,2.1,0,3c0.5,0.9,1.5,1.5,2.6,1.5h0.5v2.7h-2.7v-0.5c0-1.7-1.4-3-3-3 c-0.5,0-1,0.1-1.5,0.4l-7.6,4.4c-0.9,0.5-1.5,1.5-1.5,2.6c0,1.1,0.6,2.1,1.5,2.6l7.6,4.4c0.5,0.3,1,0.4,1.5,0.4c1.7,0,3-1.4,3-3\tv-0.6h2.7v2.8h-0.5c-1.1,0-2.1,0.6-2.6,1.5c-0.5,0.9-0.5,2.1,0,3l4.4,7.6c0.5,0.9,1.5,1.5,2.6,1.5c1.1,0,2.1-0.6,2.6-1.5l4.4-7.6 c0.5-0.9,0.5-2.1,0-3c-0.5-0.9-1.5-1.5-2.6-1.5h-0.5v-2.8h2.7v0.6c0,1.7,1.4,3,3,3c0.5,0,1-0.1,1.5-0.4l7.6-4.4\tc0.9-0.5,1.5-1.5,1.5-2.6c0-1.1-0.6-2.1-1.5-2.6l-7.6-4.4c-0.5-0.3-1-0.4-1.5-0.4c-1.7,0-3,1.4-3,3v0.5h-2.7v-2.7h0.5\tc1.1,0,2.1-0.6,2.6-1.5c0.5-0.9,0.5-2.1,0-3l-4.4-7.6C-242.9,401.2-243.9,400.6-245,400.6L-245,400.6z\"/></g></svg>');\r\n        const br_svg = this.tag('<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"-271 394.9 52 52\" style=\"enable-background:new -271 394.9 52 52;\" xml:space=\"preserve\"><g><path style=\"fill:#00A8DF;\" d=\"M-245,420.9L-245,420.9L-245,420.9L-245,420.9L-245,420.9l-26-0.1c0,10.8,6.1,20,16,24.1 c10,4.1,20.8,2,28.4-5.7c7.6-7.6,9.7-18.5,5.6-28.4c-4.2-10-13.4-16-24.2-15.9L-245,420.9z\"/></g><g><path style=\"fill:#FFFFFF;\" d=\"M-245.8,423l-2.5-2.5l-2.1,2.1c-0.9,0.9-2.3,0.5-2.6-0.7l-1.6-9.2c-0.3-1.2,0.8-2.3,1.9-1.9l9.2,1.6 c1.2,0.3,1.6,1.8,0.7,2.6l-2.1,2.1l2.5,2.5l2.7,2.7l-1-1l2.1-2.1c0.9-0.9,2.3-0.5,2.6,0.7l1.6,9.2c0.3,1.2-0.8,2.3-1.9,1.9 l-9.2-1.6c-1.2-0.3-1.6-1.8-0.7-2.6l2.1-2.1l-3.2-3.2L-245.8,423z\"/><path style=\"opacity:0.5;fill:#231F20;\" d=\"M-239.6,422.3l-1-1l2.1-2.1c0.7-0.7,1.7-0.6,2.2,0c0.2,0.2,0.3,0.4,0.4,0.7l1.6,9.2 c0.3,1.2-0.8,2.3-1.9,1.9l-9.2-1.6c-0.3-0.1-0.5-0.2-0.7-0.4c-0.6-0.6-0.7-1.6,0-2.2l2.1-2.1l-3.2-3.2l1.5,1.5l-2.5-2.5l-2.1,2.1 c-0.7,0.7-1.7,0.6-2.2,0c-0.2-0.2-0.3-0.4-0.4-0.7l-1.6-9.2c-0.3-1.2,0.8-2.3,1.9-1.9l9.2,1.6c0.3,0.1,0.5,0.2,0.7,0.4 c0.6,0.6,0.7,1.6,0,2.2l-2.1,2.1l2.5,2.5L-239.6,422.3z M-242.3,417.5l-0.5-0.5l1-1c1.2-1.2,1.2-3.1,0-4.3 c-0.4-0.4-0.8-0.6-1.4-0.8l-9.2-1.6c-1.1-0.3-2.1,0-2.9,0.8c-0.8,0.8-1.1,1.9-0.8,2.9l1.6,9.2c0.1,0.5,0.4,1,0.8,1.4 c1.2,1.2,3.1,1.2,4.3,0l1.1-1.1l0.5,0.5l0.5,0.5l1.2,1.2l-1.1,1.1c-1.2,1.2-1.2,3.1,0,4.3c0.4,0.4,0.8,0.6,1.4,0.8l9.2,1.6 c1.1,0.3,2.1,0,2.9-0.8c0.8-0.8,1.1-1.9,0.8-2.9l-1.6-9.2c-0.1-0.5-0.4-1-0.8-1.4c-1.2-1.2-3.1-1.2-4.3,0l-1,1l-1.2-1.2\"/></g></svg>');\r\n\r\n        const tlb = this.tag('<div class=\"transformable-resize-button\"></div>');\r\n        const brb = tlb.cloneNode();\r\n\r\n        tlb.classList.add('tl');\r\n        tlb.appendChild(tl_svg);\r\n        brb.classList.add('br');\r\n        brb.appendChild(br_svg);\r\n\r\n        this.resizertl = tlb;\r\n        this.resizerbr = brb;\r\n\r\n        this.element.appendChild(tlb);\r\n        this.element.appendChild(brb);\r\n        this._addResizeEvents(tlb, brb);\r\n    }\r\n    \r\n    /**\r\n     * Zooms the element centred on the middle of the parent element in increments of 5%.\r\n     * @param {Number} dir positive numbers make it bigger, negative make it smaller\r\n     */\r\n    zoom(dir) {\r\n        const offset = this.Ancestry.OffsetFromPoint(this._findCentreInWindow());\r\n        this.scale(offset, 1 + dir * 0.05);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Scales the transformable element at point p by s amount\r\n     * @param {Point} p Origin for the transform on the element\r\n     * @param {any} s scale amount\r\n     */\r\n    scale(p, s) {\r\n        this.matrix.scale(p, s);\r\n        this.setTransition(true);\r\n        this._updateElement();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Translates the element by x and y. Uses element pixels before any transform. Not window/screen pixels.\r\n     * @param {Number} x Pixels horizontal\r\n     * @param {Number} y Pixels vertical\r\n     * @param {Boolean} transition Use a transition\r\n     */\r\n    translate(x, y, transition) {\r\n        this.matrix.translate(x, y);\r\n        this.setTransition(transition);\r\n        this._updateElement();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Rotates the element about point p. Or about the centre of the element if p is not supplied. \r\n     * If inwindow==true, you can supply a Point in the window coordinate space and have the element rotate about that.\r\n     * @param {Point} p The origin of the rotation in pixels on the element. When inwindow == false or undefined\r\n     * @param {Number} a Angle in degrees\r\n     * @param {Boolean} trans Optional: Specify if a transition should be used\r\n     * @param {Boolean} inwindow Optional: If true, p should be treated like a window coordinate. \r\n     */\r\n    rotate(p, a, trans, inwindow) {\r\n        let rotationPoint = p;\r\n        if (!(rotationPoint instanceof Point) || !rotationPoint) {\r\n            rotationPoint = this.Ancestry.OffsetFromPoint(this._findCentreInWindow());\r\n        }\r\n\r\n        if (rotationPoint instanceof Point && inwindow) {\r\n            rotationPoint = this.Ancestry.OffsetFromPoint(rotationPoint);\r\n        }\r\n\r\n        this.matrix.rotate(rotationPoint, a);\r\n        this.lastrotationpoint = rotationPoint;\r\n        if (typeof trans === 'undefined' || trans === false) {\r\n            this.setTransition(false);\r\n        }\r\n\r\n        this._updateElement();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Makes a rotated element horizontal.\r\n     */\r\n    straighten() {\r\n        const r = this.matrix.rotation();\r\n        this.rotate(new Point(this.sizes.element.initial.width / 2, this.sizes.element.initial.height / 2), -r, true);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Scales the element to make the element's height or width match that of the parent element. Centres it and straightens out any rotation. \r\n     */\r\n    fittoparent() {\r\n        const sz = new Point(this.sizes.element.initial.width, this.sizes.element.initial.height);\r\n        const anc = this.Ancestry;\r\n        const pars = anc.GetParents();\r\n        const parentT = anc.FirstParent();\r\n        const pr = parentT.rect;\r\n        const m = this.matrix.inverse();\r\n        const tl = m.transformpoint(pr.topleft);\r\n        const tr = m.transformpoint(pr.topright);\r\n        const bl = m.transformpoint(pr.bottomleft);\r\n        const psiz = new Point(this._distanceBetweenPoints(tl, tr), this._distanceBetweenPoints(tl, bl));\r\n\r\n        const sc = psiz.divide(sz);\r\n        const scale = Math.min(sc.x, sc.y);\r\n        this.scale(new Point(0, 0), scale);\r\n        this.centreinparent(true, pars);\r\n        this.straighten();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Scales the element so its width and height is equal or greater than the parent element. \r\n     * Basically so you can't see any background in the parent element. Also centres and straightens it.\r\n     */\r\n    filltoparent() {\r\n        const sz = new Point(this.sizes.element.initial.width, this.sizes.element.initial.height);\r\n        const anc = this.Ancestry;\r\n        const pars = anc.GetParents();\r\n        const parentT = anc.FirstParent();\r\n        const pr = parentT.rect;\r\n        const m = this.matrix.inverse();\r\n        const tl = m.transformpoint(pr.topleft);\r\n        const tr = m.transformpoint(pr.topright);\r\n        const bl = m.transformpoint(pr.bottomleft);\r\n        const psiz = new Point(this._distanceBetweenPoints(tl, tr), this._distanceBetweenPoints(tl, bl));\r\n\r\n        const sc = psiz.divide(sz);\r\n        const scale = Math.max(sc.x, sc.y);\r\n\r\n        this.scale(new Point(0, 0), scale);\r\n        this.centreinparent(true, pars);\r\n        this.straighten();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Gets the boundingClientRect for supplied element.\r\n     * @param {HTMLElement} el\r\n     */\r\n    _getRect(el) {\r\n        return el.getBoundingClientRect();\r\n    }\r\n\r\n    /**\r\n     * Resets the transformation to its starting value. Undoing all changes since instantiation.\r\n     * @param {Boolean} trans Specify if a transition should be used\r\n     */\r\n    reset(trans) {\r\n        if (!this.InitialMatrix) {\r\n            this.matrix.reset();\r\n        } else {\r\n            this.matrix.elements = [...this.InitialMatrix];\r\n        }\r\n\r\n        this.setTransition(trans ?? true);\r\n        if (this.transition) {\r\n            if (this.delta?.x || this.delta?.y) { // has moved so will transition\r\n                this.element.classList.add('transformable-reset');\r\n                this.on(this.element, 'transitionend.reset', () => {\r\n                    this.element.classList.remove('transformable-reset');\r\n                    this.off(this.element, 'transitionend.reset');\r\n                });\r\n            }\r\n        }\r\n        this._updateElement();\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * Returns true if the undo stack contains a saved state named k\r\n     * @param {String} k\r\n     */\r\n    hasHistoryKey(k) {\r\n        return Array.isArray(this.matrix.history.undo[k]);\r\n    }\r\n    \r\n    /**\r\n     * Undo the last transformation or go back to a named state.\r\n     * @param {String} k Optional: the name of a saved state to go back to\r\n     */\r\n    undo(k) {\r\n        this.matrix.undo(k);\r\n        this.setTransition(true);\r\n        this._updateElement();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Redo the last thing that was undone.\r\n     */\r\n    redo() {\r\n        this.matrix.redo();\r\n        this.setTransition(true);\r\n        this._updateElement();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Sets initial sizes and positions of the element and window\r\n     */\r\n    setInitialSizes() {\r\n        if (this.sizes) return;\r\n        \r\n        const cs = window.getComputedStyle(this.element);\r\n        const w = parseFloat(cs.width);\r\n        const h = parseFloat(cs.height);\r\n        const l = parseFloat(cs.left);\r\n        const t = parseFloat(cs.top);\r\n\r\n        this.sizes = {\r\n            element: {\r\n                initial: {\r\n                    offset: new Point(l, t),\r\n                    width: w,\r\n                    height: h,\r\n                    topleft: new Point(0, 0),\r\n                    topright: new Point(w, 0),\r\n                    bottomright: new Point(w, h),\r\n                    bottomleft: new Point(0, h)\r\n                }\r\n            },\r\n            window: { width: parseFloat(getComputedStyle(document.body.parentNode).width) }\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Gets the offset of an element taking in to account scroll position of the window\r\n     * @param {HTMLElement} el Element to check\r\n     */\r\n    _getOffset(el) {\r\n        const cr = this._getRect(el);\r\n        const scroll = this.Ancestry._getScroll();\r\n        const cs = getComputedStyle(el);\r\n        const pos = new Point(parseFloat(cs.left), parseFloat(cs.top));\r\n        const os = new Point(cr.left + scroll.x, cr.top + scroll.y);\r\n        const br = new Point(cr.right, cr.bottom);\r\n        const tr = new Point(cr.right, cr.top);\r\n        const bl = new Point(cr.left, cr.bottom);\r\n\r\n        return { offset: os, topleft: os, bottomright: br, topright: tr, bottomleft: bl, pos: pos };\r\n    }\r\n    \r\n    /**\r\n     * Sets the initial offset.  \r\n     */\r\n    _setOffset() {\r\n        if (!this.offset) {\r\n            const too = this._getOffset(this.element, true);\r\n            this.offset = too.offset;\r\n            this.initialoffset = too.offset;\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Convert a string representation of a CSS transformation matrix in to an Array\r\n     * @param {String} t The CSS transformation\r\n     */\r\n    _cssStringToArray(t) {\r\n        const match = t.match(/[0-9e., -]+/);\r\n        if (!match) return [];\r\n        return match[0].split(\", \").map(v => parseFloat(v));\r\n    }\r\n    \r\n    /**\r\n     * Converts a 6 element Array in to a CSS transformation string.\r\n     * @param {Array} a \r\n     */\r\n    _arrayToCssString(a) {\r\n        return `matrix(${a.join(',')})`;\r\n    }\r\n\r\n    /**\r\n     * Creates a Matrix for the transformable element. \r\n     * Cancels out any CSS that affects the offset or position of the element and converts to an equivalent CSS transformation matrix.\r\n     * @param {HTMLElement} el\r\n     */\r\n    _getMatrix(el) {\r\n        const elem = el || this.element;\r\n        const cs = getComputedStyle(elem);\r\n        const pcs = getComputedStyle(this.parent);\r\n        const { transform: t, top: csTop, left: csLeft, marginTop, marginLeft, borderTopWidth, borderLeftWidth } = cs;\r\n        \r\n        const top = csTop.includes('%') ? (parseFloat(pcs.height) * parseFloat(csTop) / 100) : parseFloat(csTop);\r\n        const left = csLeft.includes('%') ? (parseFloat(pcs.width) * parseFloat(csLeft) / 100) : parseFloat(csLeft);\r\n        const margintop = parseFloat(marginTop);\r\n        const marginleft = parseFloat(marginLeft);\r\n        const bordertop = parseFloat(borderTopWidth);\r\n        const borderleft = parseFloat(borderLeftWidth);\r\n\r\n        let mElements;\r\n        if (/matrix\\(-?[0-9e., -]+\\)/.test(t)) {\r\n            mElements = this._cssStringToArray(t);\r\n            if (!this.InitialMatrix) {\r\n                this.InitialMatrix = [...mElements];\r\n            }\r\n        }\r\n        \r\n        const m = new Matrix(mElements || [1, 0, 0, 1, 0, 0]);\r\n        \r\n        if (left || top || margintop || marginleft || bordertop || borderleft) {\r\n            m.translate(left || 0, top || 0);\r\n            m.translate(marginleft || 0, margintop || 0);\r\n            m.translate(borderleft || 0, bordertop || 0);\r\n            Object.assign(elem.style, {\r\n                marginTop: '0px',\r\n                marginLeft: '0px',\r\n                top: '0px',\r\n                left: '0px'\r\n            });\r\n            elem.style.marginTop = (-(bordertop || 0)) + 'px';\r\n            elem.style.marginLeft = (-(bordertop || 0)) + 'px';\r\n\r\n            this.matrix = m;\r\n            this._updateElement();\r\n            this.InitialMatrix = [...m.elements];\r\n        }\r\n        return m;\r\n    }\r\n\r\n    /**\r\n     * Sets the transition to use for transforms. \r\n     * Retains any existing transition originally set by CSS\r\n     * @param {Boolean} bool If true will use a transition\r\n     */\r\n    setTransition(bool) {\r\n        if (typeof bool !== 'boolean' || this.transition === bool) return;\r\n\r\n        const currentSplits = this.originalTransition ? this.originalTransition.split(',') : [];\r\n        if (bool) {\r\n            currentSplits.push('transform 0.5s');\r\n        } else {\r\n            currentSplits.push('transform 0s');\r\n        }\r\n        this.element.style.transition = currentSplits.join(',');\r\n        this.transition = bool;\r\n    }\r\n\r\n    /**\r\n     * Sets the CSS transform on the element.\r\n     */\r\n    _updateElement() {\r\n        this.element.style.transform = `matrix(${this.matrix.elements.join(',')})`;\r\n    }\r\n\r\n    /**\r\n     * Adds the current matrix to the undo stack.\r\n     */\r\n    _pushhistory() {\r\n        this.matrix.save();\r\n    }\r\n\r\n    /**\r\n     * Sets the matrix property on this instance and applies the CSS.\r\n     * @param {Matrix} m\r\n     */\r\n    _setMatrix(m) {\r\n        this.matrix = m;\r\n        this._updateElement();\r\n    }\r\n\r\n    /**\r\n     * Gets the window coordinates of a mouse or touch event.\r\n     * Also gets the angle and centre point between two touches\r\n     * * @param {Event} e\r\n     * @param {Array} touches\r\n     */\r\n    _getPageXY(e, touches) {\r\n        let xy, ang, p1, p2;\r\n        if (touches) {\r\n            if (touches.length === 2) {\r\n                xy = this._getMiddle(touches);\r\n                ang = this._getRotation(touches);\r\n                p1 = new Point(touches[0].pageX, touches[0].pageY);\r\n                p2 = new Point(touches[1].pageX, touches[1].pageY);\r\n            } else {\r\n                xy = new Point(touches[0].pageX, touches[0].pageY);\r\n                ang = this.matrix.rotation();\r\n            }\r\n        } else {\r\n            xy = new Point(e.pageX, e.pageY);\r\n            ang = this.matrix.rotation();\r\n        }\r\n        return { point: xy, angle: ang, p1, p2 };\r\n    }\r\n\r\n    /**\r\n     * Gets offset (point in element coordinate space), \r\n     * window coordinates of the event and angle, distance and centre between two touches.\r\n     * @param {Event} e\r\n     * @param {Array} touches\r\n     */\r\n    _getPoint2(e, touches) {\r\n        const dat = this._getPageXY(e, touches);\r\n        const anc = this.Ancestry;\r\n        const pars = anc.GetParents();\r\n        const op = anc.OffsetFromPoint(dat.point, pars);\r\n        const dist = dat.p1 && dat.p2 ?\r\n            this._distanceBetweenPoints(\r\n                anc.OffsetFromPoint(dat.p1, pars),\r\n                anc.OffsetFromPoint(dat.p2, pars)\r\n            ) : 0;\r\n\r\n        let deltaXY = null;\r\n        if (typeof e.deltaX !== 'undefined') {\r\n            deltaXY = new Point(e.deltaX, e.deltaY);\r\n        }\r\n\r\n        return {\r\n            offset: op,\r\n            pageXY: dat.point,\r\n            pageX: dat.point.x,\r\n            pageY: dat.point.y,\r\n            angle: dat.angle,\r\n            distance: dist,\r\n            deltaXY\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Calculates the distance between two points\r\n     * @param {Point} a First point\r\n     * @param {Point} b Second point\r\n     */\r\n    _distanceBetweenPoints(a, b) {\r\n        const prop = a.pageX ? { x: 'pageX', y: 'pageY' } : { x: 'x', y: 'y' };\r\n        return Math.sqrt(Math.pow(Math.abs(b[prop.x] - a[prop.x]), 2) + Math.pow(Math.abs(b[prop.y] - a[prop.y]), 2));\r\n    }\r\n\r\n    /**\r\n     * Gets the centre point between two touches\r\n     * @param {Array} touches\r\n     */\r\n    _getMiddle(touches) {\r\n        const [touch1, touch2] = touches;\r\n        const mx = ((touch2.pageX - touch1.pageX) / 2) + touch1.pageX;\r\n        const my = ((touch2.pageY - touch1.pageY) / 2) + touch1.pageY;\r\n        return new Point(mx, my);\r\n    }\r\n\r\n    /**\r\n     * Gets distance between two touch points (in the window) relative to the element.\r\n     * @param {Array} touches\r\n     * @param {Array} pars\r\n     */\r\n    _getDistance2(touches, pars) {\r\n        const anc = this.Ancestry;\r\n        const parentElements = pars || anc.GetParents();\r\n        const t1 = anc.OffsetFromPoint(new Point(touches[0].pageX, touches[0].pageY), parentElements);\r\n        const t2 = anc.OffsetFromPoint(new Point(touches[1].pageX, touches[1].pageY), parentElements);\r\n        return this._distanceBetweenPoints(t1, t2);\r\n    }\r\n\r\n    /**\r\n     * Gets the angle in degrees between two touch points\r\n     * @param {Array} touches\r\n     * @param {Boolean} norm Optional: Normalise to be 0-365 degrees\r\n     */\r\n    _getRotation(touches, norm) {\r\n        const r = Math.atan2((touches[0].pageY || touches[0].y) - (touches[1].pageY || touches[1].y), (touches[0].pageX || touches[0].x) - (touches[1].pageX || touches[1].x)) * 180 / Math.PI;\r\n        return norm ? this.matrix.normaldegree(r) : r;\r\n    }\r\n    \r\n    /**\r\n     * Snaps the rotation to a multiple of 15 degrees if within 3 degrees of a multiple of 15 degrees.\r\n     */\r\n    snapRotation() {\r\n        if (this.options.disable?.rotate) return;\r\n\r\n        let r = this.matrix.rotation();\r\n        const m = r - (15 * Math.round(r / 15));\r\n        const am = Math.abs(m);\r\n        const siz = this.sizes.element.initial;\r\n        this.setTransition(true);\r\n\r\n        if (am <= 3 && am > 0) {\r\n            const pt = this.lastrotationpoint || new Point(siz.width / 2, siz.height / 2);\r\n            this.rotate(pt, -m);\r\n            this.lastlastrotationpoint = undefined;\r\n            this._pushhistory();\r\n        }\r\n        \r\n        r = this.matrix.rotation();\r\n        let msg;\r\n        switch (Math.abs(Math.round(r * 10) / 10)) {\r\n            case 0:\r\n            case 180:\r\n                msg = 'Horizontal';\r\n                break;\r\n            case 90:\r\n                msg = 'Vertical';\r\n                break;\r\n            default:\r\n                msg = `Rotation: ${Math.round(r * 10) / 10}&deg;`;\r\n        }\r\n        this.showMessage(msg, 'sticky', 2000);\r\n    }\r\n    \r\n    /**\r\n     * Writes info to the console\r\n     * @param {String} m\r\n     * @param {any} c Not implemented\r\n     * @param {any} t Not implemented\r\n     */\r\n    showMessage(m, c, t) {\r\n        console.log(m);\r\n    }\r\n\r\n    /**\r\n     * Gets the centre point of the element in window coordinates\r\n     */\r\n    _findCentreInWindow() {\r\n        const prect = this._getRect(this.parent);\r\n        return new Point(prect.left + prect.width / 2, prect.top + prect.height / 2);\r\n    }\r\n\r\n    /**\r\n     * Centres the element in the middle of its parent element\r\n     * @param {Boolean} transition Optional\r\n     * @param {Array} pars Optional but should always be supplied\r\n     */\r\n    centreinparent(transition, pars) {\r\n        const was = this.transition;\r\n        this.setTransition(transition);\r\n        const parentElements = pars || this.Ancestry.GetParents();\r\n        const pcs = getComputedStyle(this.parent);\r\n        const parentCentre = new Point(parseFloat(pcs.width) / 2, parseFloat(pcs.height) / 2);\r\n        const centreOnThis = this.matrix.inverse().transformpoint(parentCentre);\r\n        this.translate(centreOnThis.sub(new Point(this.sizes.element.initial.width / 2, this.sizes.element.initial.height / 2)));\r\n        this.setTransition(was);\r\n    }\r\n\r\n    /**\r\n     * Find out if point p is within the rectangle defined by points a,b,c,d\r\n     * @param {Point} p\r\n     * @param {Point} a\r\n     * @param {Point} b\r\n     * @param {Point} c\r\n     * @param {Point} d\r\n     */\r\n    pointInRectangle(p, a, b, c, d) {\r\n        const ab = b.sub(a);\r\n        const ap = p.sub(a);\r\n        const bc = c.sub(b);\r\n        const bp = p.sub(b);\r\n        const dot_abap = ab.dot(ap);\r\n        const dot_abab = ab.dot(ab);\r\n        const dot_bcbp = bc.dot(bp);\r\n        const dot_bcbc = bc.dot(bc);\r\n        return {\r\n            dot_abap,\r\n            dot_abab,\r\n            dot_bcbp,\r\n            dot_bcbc,\r\n            ok: 0 <= dot_abap && (Math.round(dot_abap * 10) / 10) <= (Math.round(dot_abab * 10) / 10) && 0 <= dot_bcbp && (Math.round(dot_bcbp * 10) / 10) <= (Math.round(dot_bcbc * 10) / 10)\r\n        };\r\n    }\r\n    \r\n    /**\r\n     * Triggers an event named n. \r\n     * In the handler, this will refer to the Transformable instance.\r\n     * The handler will receive the transformable element as first argument and a real event object as the second argument.\r\n     * @param {String} n\r\n     * @param {Event} event Pass in a real event object if you have one\r\n     */\r\n    trigger(n, event) {\r\n        if (typeof this.events[n] === \"function\") {\r\n            this.events[n].call(this, this.element, event);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets the points data needed to make rotation handles work\r\n     * @param {Event} e\r\n     * @param {Array} pars\r\n     */\r\n    _getRotatorPoints(e, pars) {\r\n        const anc = this.Ancestry;\r\n        const parentElements = pars || anc.GetParents();\r\n        anc._setoffset();\r\n        const touches = e.touches;\r\n        const rpoint = touches ? new Point(touches[0].pageX, touches[0].pageY) : new Point(e.pageX, e.pageY);\r\n        const apoint = this.anchor.TL;\r\n        const angle = Math.round(this._getRotation([apoint.add(anc.scroll), rpoint], false) * 100) / 100;\r\n        return {\r\n            deltaXY: null,\r\n            offset: anc.OffsetFromPoint(rpoint, parentElements),\r\n            pageXY: rpoint,\r\n            pageX: rpoint.x,\r\n            pageY: rpoint.y,\r\n            angle: angle,\r\n            distance: 0\r\n        };\r\n    }\r\n    \r\n    /**\r\n     * Attaches events for rotation interactions with rotation handles\r\n     * @param {HTMLElement} hdl The element to use as a rotation handle\r\n     */\r\n    _addRotateEvents(hdl) {\r\n        const _dostart = e => {\r\n            if (this.options.disabled || this.startedresize) return;\r\n            \r\n            if(document.querySelectorAll('.transformable-active').length == 0)\r\n                this.element.classList.add('transformable-active');\r\n\r\n            const m = this.matrix;\r\n            this.origrotate = {\r\n                trans: new Point(m.elements[4], m.elements[5]),\r\n                angle: m.rotation(true),\r\n                scale: m.scaling(),\r\n            };\r\n\r\n            const touches = e.touches;\r\n            if (touches?.length === 2)\r\n                if (touches[0].target && touches[1].target)\r\n                    if (touches[0].target !== touches[1].target) {\r\n                        console.log('Two active elements not supported');\r\n                        return false;\r\n                    }\r\n\r\n            this.anchor = this.anchor || {};\r\n            this.anchor.clientRect = this._getRect(this.element.querySelector('.transformable-anchor-point'));\r\n            this.anchor.TL = new Point(this.anchor.clientRect.left, this.anchor.clientRect.top);\r\n            this.startrotate = this._getRotatorPoints(e);\r\n            this.startrotate.scale = this.origrotate.scale;\r\n            this.startedrotate = true;\r\n            this.draggingrotate = false;\r\n            this.setTransition(false);\r\n            e.stopPropagation();\r\n\r\n            if (e.type === 'mousedown') {\r\n                this.on(document.body, 'mousemove.transformable', _domove);\r\n                this.on(document.body, 'mouseup.transformable dragend.transformable', _dostop);\r\n            }\r\n        };\r\n\r\n        const _domove = e => {\r\n            if (!this.startedrotate) return;\r\n            this.draggingrotate = true;\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            if (e.touches?.length === 2) return;\r\n\r\n            const point = this._getRotatorPoints(e);\r\n            const delta = { angle: Math.round((point.angle - this.startrotate.angle) * 100) / 100 };\r\n            \r\n            if (delta.angle !== 0) {\r\n                if (this.parent !== this.options.rotatetarget.element) {\r\n                    this.matrix.rotateAboutPoint(new Point(0), delta.angle);\r\n                    this._updateElement();\r\n                }\r\n                if (this.options.rotatetarget instanceof Transformable) {\r\n                    this.options.rotatetarget.rotate(this.anchor.TL.add(this.Ancestry.scroll), delta.angle, false, true);\r\n                }\r\n            }\r\n            this.startrotate.angle = point.angle;\r\n        };\r\n        \r\n        const _dostop = e => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            this.element.classList.remove('transformable-active');\r\n            this.startedrotate = false;\r\n            this.draggingrotate = false;\r\n            this.off(document.body, 'mouseup.transformable dragend.transformable');\r\n\r\n            if (this.options.rotatetarget instanceof Transformable) {\r\n                if (this.options.rotatetarget.events.stop)\r\n                    this.options.rotatetarget.trigger('stop', e);\r\n\r\n                this.options.rotatetarget.snapRotation();\r\n            }\r\n            if (this.events.stop)\r\n                this.trigger('stop', e);\r\n\r\n            this.snapRotation();\r\n        };\r\n\r\n        this.on(hdl, 'mousedown.transformable touchstart.transformable', _dostart);\r\n        this.on(hdl, 'touchmove.transformable', _domove);\r\n        this.on(hdl, 'touchend.transformable', _dostop);\r\n    }\r\n\r\n    /**\r\n     * Attaches events for resize interactions with resize handles\r\n     * @param {HTMLElement} tlb Top left button/handle used for moving the element\r\n     * @param {HTMLElement} brb Bottom right button/handle for resizing the element's width/height\r\n     */\r\n    _addResizeEvents(tlb, brb) {\r\n        const _dostart = e => {\r\n            if (!document.querySelector('.transformable-active')) {\r\n                this.element.classList.add('transformable-active');\r\n            }\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            const m = this.matrix;\r\n            this.origresize = {\r\n                trans: new Point(m.elements[4], m.elements[5]),\r\n                angle: m.rotation(),\r\n                scale: m.scaling()\r\n            };\r\n            this.startresize = this._getPoint2(e, e.touches);\r\n            this.startresize.scale = this.origresize.scale;\r\n            this.startedresize = true;\r\n            this.draggingresize = false;\r\n            const cs = getComputedStyle(this.element);\r\n            this.h = parseFloat(cs.height);\r\n            this.w = parseFloat(cs.width);\r\n            this.contained = this.contained ?? true;\r\n            this.trigger('startresize', e);\r\n            this.setTransition(false);\r\n            if (e.type === 'mousedown') {\r\n                this.on(document.body, 'mousemove.transformable', _domove);\r\n                this.on(document.body, 'mouseup.transformable dragend.transformable', _dostop);\r\n            }\r\n        };\r\n\r\n        const _domove = e => {\r\n            if (!this.element.classList.contains('transformable-active') || !this.startedresize) return;\r\n            this.draggingresize = true;\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            if (e.touches?.length === 2) return;\r\n\r\n            const point = this._getPoint2(e, e.touches);\r\n            const start = this.startresize;\r\n            const delta = { \r\n                trans: point.offset.sub(this.startresize.offset),\r\n                angle: Math.round((point.angle - start.angle) * 100) / 100,\r\n                distance: start.distance != 0 ? Math.round(point.distance / ((start.distance + point.distance)/2) * 1000) / 1000 : 0\r\n            };\r\n\r\n            if (delta.trans.nonzero()) {\r\n                const cs = getComputedStyle(this.element);\r\n                const h = parseFloat(cs.height);\r\n                const w = parseFloat(cs.width);\r\n                const dw = this.w - w;\r\n                const dh = this.h - h;\r\n                const neww = w + delta.trans.x + dw;\r\n                const newh = h + delta.trans.y + dh;\r\n                this.element.style.width = `${neww}px`;\r\n                this.element.style.height = `${newh}px`;\r\n                this.sizes.element.initial.bottomright = new Point(neww, newh);\r\n                this.sizes.element.initial.topright.x = neww;\r\n                this.sizes.element.initial.bottomleft.y = newh;\r\n                this.sizes.element.initial.width = neww;\r\n                this.sizes.element.initial.height = newh;\r\n            }\r\n            this.startresize.angle = point.angle;\r\n        };\r\n\r\n        const _dostop = () => {\r\n            this.off(document.body, 'mousemove.transformable', _domove);\r\n            this.off(document.body, 'mouseup.transformable dragend.transformable', _dostop);\r\n            if (this.options.disabled) return;\r\n            this.element.classList.remove('transformable-active');\r\n            this.startedresize = false;\r\n            this.draggingresize = false;\r\n        };\r\n\r\n        this.on(brb, 'mousedown.transformable', _dostart);\r\n        this.on(brb, 'touchstart.transformable', _dostart);\r\n        this.on(brb, 'touchmove.transformable', _domove);\r\n        this.on(brb, 'touchend.transformable', _dostop);\r\n    }\r\n    \r\n    /**\r\n     * Gets the quadrant based on angle r and wether the angle is horizontal or vertical\r\n     * @param {Number} r\r\n     */\r\n    getRotationQuadrant(r) {\r\n        const rot = (r ?? this.matrix.rotation()) % 360;\r\n        const normalizedRot = rot < 0 ? rot + 360 : rot;\r\n        return { Angle: normalizedRot, Quad: Math.floor(normalizedRot / 90), Horiz: normalizedRot === 0 || normalizedRot === 180, Vert: normalizedRot === 90 || normalizedRot === 270 };\r\n    }\r\n    \r\n    /**\r\n     * Attaches events for scaling, rotating and moving elements. \r\n     * Calculates and applies containment too.\r\n     */\r\n    _addEvents() {\r\n        if (typeof this.events.transition === 'function') {\r\n            this.element.addEventListener('transitionend', this.events.transition);\r\n        }\r\n\r\n        const _dostart = e => {\r\n            if (this.options.disabled || this.startedresize || this.startedrotate) return;\r\n            if (!document.querySelector('.transformable-active')) {\r\n                this.element.classList.add('transformable-active');\r\n            }\r\n            if (this.options.type === 'rotator-box') {\r\n                const rb = e.target.closest('svg');\r\n                if (rb && !rb.classList.contains('transformable-svg-anchor')) \r\n                    return false;\r\n                else\r\n                    e.stopPropagation();\r\n            }\r\n\r\n            const touches = e.touches;\r\n            this.start = this._getPoint2(e, touches);\r\n            const ww = this.sizes.window;\r\n            if (this.start.pageX < 40 || this.start.pageX > ww.width - 40) { // don't translate if history navigation can happen from swiping at the edges of webpage.  e.g. on a touch device\r\n                console.log('edge cancel.');\r\n                return false;\r\n            }\r\n            this.delta = { x: 0, y: 0 };\r\n            if (touches?.length === 2) \r\n                if (touches[0].target && touches[1].target)\r\n                    if (touches[0].target !== touches[1].target) {\r\n                        console.log('Two active elements not supported');\r\n                        return false;\r\n                    }\r\n\r\n            const m = this.matrix;\r\n            this.orig = {\r\n                trans: new Point(m.elements[4], m.elements[5]),\r\n                angle: m.rotation(),\r\n                scale: m.scaling(),\r\n            };\r\n            this.start.scale = this.orig.scale;\r\n            this.started = true;\r\n            this.dragging = false;\r\n\r\n            if (this.events.start)\r\n                this.trigger('start', e);\r\n\r\n            this.setTransition(false);\r\n\r\n            if (e.type === 'mousedown') {\r\n                this.on(document.body, 'mousemove.transformable', _domove);\r\n                this.on(document.body, 'mouseup.transformable dragend.transformable', _dostop);\r\n            }\r\n        };\r\n\r\n        const _domove = e => {\r\n            if (this.options.disabled || !this.element.classList.contains('transformable-active') || !this.started || this.startedresize || this.startedrotate) return false;\r\n            this.dragging = true;\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            \r\n            // Note: The logic for containment in this method is extremely complex and has been kept as close to the original as possible during refactoring.\r\n            // Modernizing it further would require a deep re-architecture of the containment algorithm itself.\r\n            const touches = e.touches;\r\n            let doupdate = false;\r\n\r\n            if (touches?.touches.length == 2)\r\n                if (touches[0].target && touches[1].target)\r\n                    if (touches[0].target !== touches[1].target) {\r\n                        console.log('Two active elements not supported');\r\n                        return false;\r\n                    }\r\n\r\n            const m = this.matrix;\r\n            const disable = this.options.disable;\r\n            const docontain = this.options && this.options.contain;\r\n\r\n            const disableZoom = disable?.zoom || disable?.scale;\r\n            const disableRotate = disable?.rotate;\r\n            const disableTranslate = disable?.translate;\r\n\r\n            const point = this._getPoint2(e, touches);\r\n            const orig = this.orig;\r\n            const start = this.start;\r\n            const delta = {\r\n                trans: point.offset.sub(start.offset),\r\n                angle: Math.round((point.angle - start.angle) * 100) / 100,\r\n                distance: start.distance !== 0 ? Math.round(point.distance / ((start.distance + point.distance) / 2) * 1000) / 1000 : 0\r\n            };\r\n\r\n            var that = this;\r\n\r\n            if (docontain && delta.angle == 0 && (!touches || (touches && touches.length == 1))) \r\n            {\r\n                var\r\n                    tl, tr, br, bl;\r\n                var\r\n                    anc = that.Ancestry,\r\n                    parentT = anc.FirstParent(),\r\n                    prect = parentT.rect,\r\n                    inv = m.inverse(),\r\n                    ptl = prect.topleft,\r\n                    ptr = prect.topright,\r\n                    pbr = prect.bottomright,\r\n                    pbl = prect.bottomleft;\r\n\r\n                tl = inv.transformpoint(ptl).sub(delta.trans);\r\n                tr = inv.transformpoint(ptr).sub(delta.trans);\r\n                br = inv.transformpoint(pbr).sub(delta.trans);\r\n                bl = inv.transformpoint(pbl).sub(delta.trans);\r\n\r\n                if (!start.size)\r\n                    start.size = new Point(that._distanceBetweenPoints(tl, tr), that._distanceBetweenPoints(tl, bl));\r\n                else\r\n                    start.size = delta.distance != 0 ?\r\n                        new Point(that._distanceBetweenPoints(tl, tr), that._distanceBetweenPoints(tl, bl))\r\n                        :\r\n                        start.size;\r\n\r\n                var csiz = that.sizes.element.initial;\r\n                \r\n                var containment, opts = that.options;\r\n\r\n                if (docontain == 'enclose') {\r\n                    var enclosed = {\r\n                        tl: that.pointInRectangle(csiz.topleft, tl, tr, br, bl),\r\n                        tr: that.pointInRectangle(csiz.topright, tl, tr, br, bl),\r\n                        br: that.pointInRectangle(csiz.bottomright, tl, tr, br, bl),\r\n                        bl: that.pointInRectangle(csiz.bottomleft, tl, tr, br, bl)\r\n                    };\r\n\r\n                    var containcount = 0;\r\n                    if(enclosed.tl.ok)\r\n                        containcount++;\r\n                    if(enclosed.tr.ok)\r\n                        containcount++;\r\n                    if(enclosed.br.ok)\r\n                        containcount++;\r\n                    if(enclosed.bl.ok)\r\n                        containcount++;\r\n\r\n                    var contained = containcount == 4;\r\n\r\n                    if (!contained) {\r\n                        var quad = that.getRotationQuadrant(start.angle);\r\n                        switch (quad.Quad) {\r\n                            case 0:\r\n                                if (quad.Angle == 0) {\r\n                                    if (!enclosed.br.ok) {\r\n                                        var brv = csiz.bottomright.perpOnLine(tr, br).sub(csiz.bottomright), brh = csiz.bottomright.perpOnLine(bl, br).sub(csiz.bottomright);\r\n                                        if (brv.x < 0) delta.trans = delta.trans.add(brv);\r\n                                        if (brh.y < 0) delta.trans = delta.trans.add(brh);\r\n                                    }\r\n                                    if (!enclosed.tl.ok) {\r\n                                        var tlv = csiz.topleft.perpOnLine(tl, bl), tlh = csiz.topleft.perpOnLine(tl, tr);\r\n                                        if (tlv.x > 0) delta.trans = delta.trans.add(tlv);\r\n                                        if (tlh.y > 0) delta.trans = delta.trans.add(tlh);\r\n                                    }\r\n                                } else {\r\n                                    if (!enclosed.bl.ok) {\r\n                                        var blv = csiz.bottomleft.perpOnLine(tl, bl).sub(csiz.bottomleft); //,\r\n\r\n                                        if (blv.x > 0) delta.trans = delta.trans.add(blv);\r\n                                    }\r\n                                    if (!enclosed.br.ok) {\r\n                                        var\r\n                                            brh = csiz.bottomright.perpOnLine(bl, br).sub(csiz.bottomright);\r\n                                        if (brh.y < 0) delta.trans = delta.trans.add(brh);\r\n                                    }\r\n                                    if (!enclosed.tr.ok) {\r\n                                        var trv = csiz.topright.perpOnLine(tr, br).sub(csiz.topright); //,\r\n                                        if (trv.x < 0) delta.trans = delta.trans.add(trv);\r\n                                    }\r\n                                    if (!enclosed.tl.ok) {\r\n                                        var tlh = csiz.topleft.perpOnLine(tl, tr);\r\n                                        if (tlh.y > 0) delta.trans = delta.trans.add(tlh);\r\n                                    }\r\n                                }\r\n                                break;\r\n                            case 3:\r\n                                if (quad.Angle == 270) {\r\n                                    if (!enclosed.tl.ok) {\r\n                                        var tlh = csiz.topleft.perpOnLine(tl, bl),\r\n                                            tlv = csiz.topleft.perpOnLine(bl, br);\r\n                                        if (tlv.x > 0) delta.trans = delta.trans.add(tlv);\r\n                                        if (tlh.y > 0) delta.trans = delta.trans.add(tlh);\r\n                                    }\r\n                                    if (!enclosed.br.ok) {\r\n                                        var\r\n                                            brv = csiz.bottomright.perpOnLine(tl, tr).sub(csiz.bottomright),\r\n                                            brh = csiz.bottomright.perpOnLine(br, tr).sub(csiz.bottomright);\r\n                                        if (brv.x < 0) delta.trans = delta.trans.add(brv);\r\n                                        if (brh.y < 0) delta.trans = delta.trans.add(brh);\r\n                                    }\r\n                                } else {\r\n                                    if (!enclosed.tl.ok) {\r\n                                        var tlv = csiz.topleft.perpOnLine(tl, bl);\r\n                                        if (tlv.x > 0) delta.trans = delta.trans.add(tlv);\r\n                                    }\r\n                                    if (!enclosed.br.ok) {\r\n                                        var brv = csiz.bottomright.perpOnLine(tr, br).sub(csiz.bottomright);\r\n                                        if (brv.x < 0) delta.trans = delta.trans.add(brv);\r\n                                    }\r\n                                    if (!enclosed.tr.ok) {\r\n                                        var trh = csiz.topright.perpOnLine(tl, tr).sub(csiz.topright);\r\n                                        if (trh.y > 0) delta.trans = delta.trans.add(trh);\r\n                                    }\r\n                                    if (!enclosed.bl.ok) {\r\n                                        var blh = csiz.bottomleft.perpOnLine(bl, br).sub(csiz.bottomleft);\r\n                                        if (blh.y < 0) delta.trans = delta.trans.add(blh);\r\n                                    }\r\n                                }\r\n                                break;\r\n                            case 1:\r\n                                if (quad.Angle == 90) { // can get away with 2 perp calcs instead of 4;\r\n                                    if (!enclosed.tl.ok) {\r\n                                        var tlv = csiz.topleft.perpOnLine(tr, tl),\r\n                                            tlh = csiz.topleft.perpOnLine(tr, br);\r\n\r\n                                        if (tlv.x > 0) delta.trans = delta.trans.add(tlv);\r\n                                        if (tlh.y > 0) delta.trans = delta.trans.add(tlh);\r\n                                    }\r\n                                    if (!enclosed.br.ok) {\r\n                                        var brv = csiz.bottomright.perpOnLine(br, bl).sub(csiz.bottomright),\r\n                                            brh = csiz.bottomright.perpOnLine(tl, bl).sub(csiz.bottomright);\r\n\r\n                                        if (brv.x < 0) delta.trans = delta.trans.add(brv);\r\n                                        if (brh.y < 0) delta.trans = delta.trans.add(brh);\r\n                                    }\r\n                                } else {\r\n                                    if (!enclosed.tl.ok) {\r\n                                        var tlv = csiz.topleft.perpOnLine(tr, br);\r\n                                        if (tlv.x > 0) delta.trans = delta.trans.add(tlv);\r\n                                    }\r\n                                    if (!enclosed.br.ok) {\r\n                                        var brv = csiz.bottomright.perpOnLine(tl, bl).sub(csiz.bottomright);\r\n                                        if (brv.x < 0) delta.trans = delta.trans.add(brv);\r\n                                    }\r\n                                    if (!enclosed.tr.ok) {\r\n                                        var trh = csiz.topright.perpOnLine(bl, br).sub(csiz.topright);\r\n                                        if (trh.y > 0) delta.trans = delta.trans.add(trh);\r\n                                    }\r\n                                    if (!enclosed.bl.ok) {\r\n                                        var blh = csiz.bottomleft.perpOnLine(tr, tl).sub(csiz.bottomleft);\r\n                                        if (blh.y < 0) delta.trans = delta.trans.add(blh);\r\n                                    }\r\n                                }\r\n                                break;\r\n                            case 2:\r\n                                if (quad.Angle == 180) { // can get away with 2 calcs instead of 4;\r\n                                    if (!enclosed.tl.ok) {\r\n                                        var tlv = csiz.topleft.perpOnLine(br, bl),\r\n                                            tlh = csiz.topleft.perpOnLine(tl, bl);\r\n                                        if (tlv.y > 0) delta.trans = delta.trans.add(tlv);\r\n                                        if (tlh.y > 0) delta.trans = delta.trans.add(tlh);\r\n                                    }\r\n                                    if (!enclosed.br.ok) {\r\n                                        var\r\n                                            brv = csiz.bottomright.perpOnLine(tr, tl).sub(csiz.bottomright),\r\n                                            brh = csiz.bottomright.perpOnLine(tr, br).sub(csiz.bottomright);\r\n                                        if (brv.y < 0) delta.trans = delta.trans.add(brv);\r\n                                        if (brh.y < 0) delta.trans = delta.trans.add(brh);\r\n                                    }\r\n                                }\r\n                                if (!enclosed.tl.ok) {\r\n                                    var tlv = csiz.topleft.perpOnLine(br, bl);\r\n                                    if (tlv.y > 0) delta.trans = delta.trans.add(tlv);\r\n                                }\r\n                                if (!enclosed.br.ok) {\r\n                                    var brv = csiz.bottomright.perpOnLine(tr, tl).sub(csiz.bottomright);//,\r\n                                    if (brv.y < 0) delta.trans = delta.trans.add(brv);\r\n                                }\r\n\r\n                                if (!enclosed.tr.ok) {\r\n                                    var trh = csiz.topright.perpOnLine(tl, bl).sub(csiz.topright);\r\n                                    if (trh.x < 0) delta.trans = delta.trans.add(trh);\r\n                                }\r\n                                if (!enclosed.bl.ok) {\r\n                                    var blh = csiz.bottomleft.perpOnLine(tr, br).sub(csiz.bottomleft);\r\n                                    if (blh.x > 0) delta.trans = delta.trans.add(blh);\r\n                                }\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n                if (docontain == 'cover') {\r\n                    var enclosed = {\r\n                        tl: that.pointInRectangle(csiz.topleft, tl, tr, br, bl),\r\n                        tr: that.pointInRectangle(csiz.topright, tl, tr, br, bl),\r\n                        br: that.pointInRectangle(csiz.bottomright, tl, tr, br, bl),\r\n                        bl: that.pointInRectangle(csiz.bottomleft, tl, tr, br, bl)\r\n                    };\r\n\r\n                    var okcorners = 0;\r\n                    if (!enclosed.tl.ok) okcorners++;\r\n                    if (!enclosed.tr.ok) okcorners++;\r\n                    if (!enclosed.br.ok) okcorners++;\r\n                    if (!enclosed.bl.ok) okcorners++;\r\n\r\n                    if ((!enclosed.tl.ok &&\r\n                        !enclosed.tr.ok &&\r\n                        !enclosed.br.ok &&\r\n                        !enclosed.bl.ok\r\n                        )||that.lockcontain||(okcorners == 3 && start.angle == 0)) {\r\n                        that.lockcontain = true;\r\n                        var quad = that.getRotationQuadrant(start.angle);\r\n                        switch (quad.Quad) {\r\n                            case 0:\r\n                                if (tr.y <= 0)\r\n                                    delta.trans.y = delta.trans.y + tr.y;\r\n                                if (bl.y >= csiz.bottomleft.y)\r\n                                    delta.trans.y = delta.trans.y + (bl.y - csiz.bottomleft.y);\r\n                                if (br.x >= csiz.bottomright.x)\r\n                                    delta.trans.x = delta.trans.x + (br.x - csiz.bottomright.x);\r\n                                if (tl.x <= 0)\r\n                                    delta.trans.x = delta.trans.x + tl.x;\r\n                                break;\r\n                            case 1:\r\n                                if (tl.y >= csiz.bottomleft.y)\r\n                                    delta.trans.y = delta.trans.y + (tl.y - csiz.bottomleft.y);\r\n                                if (bl.x >= csiz.topright.x)\r\n                                    delta.trans.x = delta.trans.x - (csiz.topright.x - bl.x);\r\n                                if (br.y <= 0) // works\r\n                                    delta.trans.y = delta.trans.y + br.y;\r\n                                if (tr.x <= 0)\r\n                                    delta.trans.x = delta.trans.x + tr.x;\r\n                                break;\r\n                            case 2:\r\n                                if (bl.y <= 0) // works\r\n                                    delta.trans.y = delta.trans.y + bl.y;\r\n                                if (tl.x >= csiz.bottomright.x)\r\n                                    delta.trans.x = delta.trans.x - (csiz.bottomright.x - tl.x);\r\n                                if (tr.y >= csiz.bottomleft.y)\r\n                                    delta.trans.y = delta.trans.y + (tr.y - csiz.bottomleft.y);\r\n                                if (br.x <= 0)\r\n                                    delta.trans.x = delta.trans.x + br.x;\r\n                                //console.log('points')\r\n                                //console.log(tl)\r\n                                //console.log(tr)\r\n                                //console.log(br)\r\n                                //console.log(bl)\r\n                                break;\r\n                            case 3:\r\n                                if (tl.y <= 0) // works\r\n                                    delta.trans.y = delta.trans.y + tl.y;\r\n                                if (bl.x <= 0)\r\n                                    delta.trans.x = delta.trans.x + bl.x;\r\n                                if (br.y >= csiz.bottomright.y) // works\r\n                                    delta.trans.y = delta.trans.y + (br.y - csiz.bottomright.y);\r\n                                if (tr.x >= csiz.topright.x)\r\n                                    delta.trans.x = delta.trans.x - (csiz.topright.x - tr.x);\r\n\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (delta.trans.nonzero() && !disableTranslate) {\r\n                m.translate(delta.trans);\r\n                doupdate = true;\r\n                that.delta.x += delta.trans.x;\r\n                that.delta.y += delta.trans.y;\r\n            }\r\n\r\n            if (delta.distance != 0 && delta.distance != 1 && touches)\r\n                if (touches.length == 2 && !disableZoom) {\r\n                    m.scale(point.offset, delta.distance);\r\n\r\n                    doupdate = true;\r\n\r\n                }\r\n\r\n            if (delta.angle != 0 && !disableRotate) {\r\n                m.rotateAboutPoint(point.offset, delta.angle);\r\n                doupdate = true;\r\n            }\r\n\r\n            if (doupdate)\r\n                that._updateElement(m);\r\n\r\n            that.start.angle = point.angle;\r\n\r\n            if (that.events.move)\r\n                that.trigger('move', e);\r\n\r\n            return false;\r\n\r\n        };\r\n        \r\n        const _dostop = e => {\r\n            this.off(document.body, 'mousemove.transformable', _domove);\r\n            this.off(document.body, 'mouseup.transformable dragend.transformable', _dostop);\r\n\r\n            this.element.classList.remove('transformable-active', 'transformable-reset');\r\n\r\n            if (this.options.disabled) return false;\r\n\r\n            this.lockcontain = false;\r\n            if (this.started && this.dragging) {\r\n                this._pushhistory();\r\n                this.snapRotation();\r\n            }\r\n            if (this.started && !this.dragging) {\r\n                this.trigger('tap', e);\r\n            }\r\n            this.dragging = false;\r\n            this.started = false;\r\n            if (this.events.stop)\r\n                this.trigger('stop', e);\r\n\r\n            this.setTransition(true);\r\n\r\n            // Scale handles on stop\r\n            \r\n            var that = this;\r\n            var\r\n                rb = that.rotatorBox,\r\n                tlb = that.resizertl,\r\n                brb = that.resizerbr;\r\n\r\n            if (rb) {\r\n                var nsc = that.matrix.scaling();\r\n                rb.scale(new Point(0), (1 / rb.matrix.scaling()) * (1 / nsc));\r\n            }\r\n            if (tlb && brb) {\r\n                var nscc = nsc || that.matrix.scaling(); //,\r\n\r\n                tlb.style.transform = 'scale(' + (1 / nscc) + ')';\r\n                brb.style.transform = 'scale(' + (1 / nscc) + ')';\r\n            }\r\n        };\r\n        \r\n        const _dowheelzoom = e => {\r\n            if (this.options.disabled || this.startedresize || this.startedrotate || this.options.type === 'rotator-box') return false;\r\n            \r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            const now = Date.now();\r\n            const dmw = this.lastwheelmove ? now - this.lastwheelmove : 150;\r\n\r\n            if (dmw < 150 && navigator.userAgent.includes('Mac')) return false;\r\n            \r\n            if (!document.querySelector('.transformable-active')) {\r\n                this.element.classList.add('transformable-active');\r\n            }\r\n            if (this.rotatorBox) {\r\n                this.rotatorBox.parent.classList.add('transformable-wheel-active');\r\n            }\r\n            if (this._wheelTimer) clearTimeout(this._wheelTimer);\r\n\r\n            const point = this._getPoint2(e);\r\n            const m = this.matrix;\r\n            \r\n            this.setTransition(true);\r\n\r\n            if (point.deltaXY.y !== 0) {\r\n                const acc = point.deltaXY.y < 0 ? 1 : -1;\r\n                const ds = 1 + (0.05 * acc);\r\n                m.scale(point.offset, ds);\r\n                this._updateElement();\r\n            }\r\n            this.element.classList.remove('transformable-active');\r\n\r\n            this._wheelTimer = setTimeout(() => {\r\n                this._pushhistory();\r\n                if (this.rotatorBox) {\r\n                    this.rotatorBox.parent.classList.remove('transformable-wheel-active');\r\n                }\r\n            }, 750);\r\n            this.lastwheelmove = now;\r\n        };\r\n\r\n        this.on(this.element, 'mousedown.transformable', _dostart);\r\n        this.on(this.element, 'touchstart.transformable', _dostart);\r\n        this.on(this.element, 'touchmove.transformable', _domove);\r\n        this.on(this.element, 'touchend.transformable', _dostop);\r\n        \r\n        this.on(this.element, 'scroll.transformable', e => { \r\n            console.log('tried scroll');\r\n            e.preventDefault(); e.stopPropagation(); return false; \r\n        });\r\n\r\n        if (!this.options.disable || this.options.disable?.wheel)\r\n            if (!navigator.userAgent.includes('Mac OS')) // some issues with wild zoom on magic mouse, so turn it off\r\n                addWheelListener(this.element, _dowheelzoom);\r\n    }\r\n\r\n    /**\r\n     * attaches events to an element\r\n     * @param {HTMLElement} el The element to attach the event to\r\n     * @param {String} event Type of event with optional namespace. E.g. touchstart.mynamespace\r\n     * @param {Function} func Handler function\r\n     * @param {Object} opts Options to use when attaching the event\r\n     */\r\n    on(el, event, func, opts) {\r\n        //const events = event.split(' ');\r\n        //for (const evt of events) {\r\n        //    const [ev, ns] = evt.split('.');\r\n        //    el.addEventListener(ev, func, opts || false);\r\n\r\n        //    Transformable.Handlers.Namespaces[evt] = Transformable.Handlers.Namespaces[evt] || [];\r\n        //    if (ns) Transformable.Handlers.Namespaces[ns] = Transformable.Handlers.Namespaces[ns] || [];\r\n            \r\n        //    const handler = { event: ev, func, opts: opts || false };\r\n        //    Transformable.Handlers.Namespaces[evt].push(handler);\r\n        //    if (ns) Transformable.Handlers.Namespaces[ns].push(handler);\r\n        //}\r\n\r\n        var events = event.split(' '), i, sp, ev, ns, pl;\r\n        for (i = 0; i < events.length; i++) {\r\n            sp = events[i].split('.'), ev = sp[0], ns = sp.length > 1 ? sp[1] : false;\r\n            el.addEventListener(ev, func, opts || false);\r\n\r\n            if (!Transformable.Handlers.Namespaces[event])\r\n                Transformable.Handlers.Namespaces[event] = [];\r\n\r\n            if (ns)\r\n                if (!Transformable.Handlers.Namespaces[ns])\r\n                    Transformable.Handlers.Namespaces[ns] = [];\r\n\r\n            pl = Transformable.Handlers.Namespaces[event].push({ event: ev, func: func, opts: opts || false });\r\n            if (ns)\r\n                Transformable.Handlers.Namespaces[ns].push(Transformable.Handlers.Namespaces[event][pl - 1]);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Removes an event previously added with .on(...)\r\n     * @param {HTMLElement} el The element to remove the event from\r\n     * @param {String} event Handler function to remove\r\n     * @param {Object} opts Options to use when removing the event\r\n     */\r\n    off(el, event, opts) {\r\n        const handlers = Transformable.Handlers.Namespaces[event];\r\n        if (handlers) {\r\n            for (const handler of handlers) {\r\n                el.removeEventListener(handler.event, handler.func, handler.opts || false);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Resets/updates the instance.\r\n     */\r\n    Refresh() {\r\n        this.sizes = undefined;\r\n        this.setInitialSizes();\r\n        this.Ancestry.Refresh();\r\n    }\r\n};\r\n\r\n(() => {        \r\n    let timer;\r\n    const refreshtransformables = () => { \r\n        document.querySelectorAll('.transformable').forEach(v => {\r\n            const i = v.getAttribute('data-transformable-id');\r\n            const t = i ? Transformable.Instance[i] : null;\r\n\r\n            if (t instanceof Transformable) {\r\n                t.Refresh();\r\n            }\r\n        });\r\n    };\r\n    \r\n    window.addEventListener('resize', () => {\r\n        clearTimeout(timer);\r\n        timer = setTimeout(refreshtransformables, 150);\r\n    });\r\n})();\r\n// Ensure Transformable is available as a global for UMD/browser builds\r\nif (typeof window !== 'undefined') {\r\n  window.Transformable = Transformable;\r\n}\r\nexport default Transformable;"],"names":["Matrix","Point","Ancestry","self","_classCallCheck","Items","_add","element","Self","_init","_createClass","key","value","_getScroll","window","pageXOffset","document","documentElement","scrollLeft","pageYOffset","scrollTop","GetElementSize","el","cs","getComputedStyle","left","parseFloat","top","w","width","h","height","offset","topleft","topright","bottomright","bottomleft","_debug","forEach","v","i","console","log","matrix","elements","Refresh","_ispercent","indexOf","_isauto","_pixelFromParent","k","val","GetComputedDims","cmt","marginTop","cml","marginLeft","cl","ct","leftp","topp","pf","l","t","pcs","parentNode","transform","has","pt","tid","nm","body","test","margintop","marginleft","classList","contains","getAttribute","Transformable","Instance","om","_cssStringToArray","translate","multiply","prect","style","transformOrigin","_arrayToCssString","_setoffset","scroll","cur","trans","length","translation","transformable","sub","unshift","rect","sizes","initial","GetParents","r","m","ti","push","Inverse","inverse","Element","TransformCorners","c","mat","GetMatrix","transformpoint","FirstParent","par","Identity","OffsetFromPoint","p","pars","op","matinv","a","Array","slice","arguments","Error","history","undo","redo","prototype","x","y","els","me","a1","b1","c1","d1","e1","f1","a2","b2","c2","d2","e2","f2","elementsequal","b","save","last","len","pop","prev","identity","reset","determinant","dt","invert","isIdentity","scale","s","dp","rotateAboutPoint","Math","PI","cos","sin","rotate","normaldegree","rotation","norm","atan2","scaling","sqrt","pow","undefined","factor","round","precision","add","mult","divide","nonzero","equals","moreoreq","lessoreq","dot","perpOnLine","p1","p2","x4","y4","mag","prefix","_addEventListener","addEventListener","support","createElement","onmousewheel","addWheelListener","elem","callback","useCapture","_addWheelListener","targetElem","eventName","cb","capture","originalEvent","event","normalizedEvent","target","srcElement","type","deltaMode","deltaX","deltaY","deltaZ","preventDefault","returnValue","stopPropagation","wheelDelta","wheelDeltaX","detail","_opts$attachevents","opts","options","parent","setInitialSizes","_opts$computedsize","_opts$computedsize2","cscale","computedsize","Width","precs","Height","curcs","isArray","_setMatrix","_getMatrix","originalTransition","_getOriginalTransition","_setOffset","dragging","start","orig","zooma","events","move","stop","tap","transition","setAttribute","navigator","userAgent","includes","attachevents","editable","_opts$disable","_addEvents","resize","createResizeHandles","disable","createRotateHandles","handle","_addRotateEvents","split","filter","part","trim","startsWith","join","tag","str","innerHTML","firstChild","typ","_this","box","rot","anc","lin","append","nodeName","appendChild","e","rotatorBox","rotatetarget","zoom","_domouseup","_this$rotatorBox","remove","off","_domousedown","on","_domouseleave","_overTimer","clearTimeout","_resizeTimer","setTimeout","currentTarget","_domouseenter","tim","rb","rotparent","call","tl_svg","br_svg","tlb","brb","cloneNode","resizertl","resizerbr","_addResizeEvents","dir","_findCentreInWindow","setTransition","_updateElement","inwindow","rotationPoint","lastrotationpoint","straighten","fittoparent","sz","parentT","pr","tl","tr","bl","psiz","_distanceBetweenPoints","sc","min","centreinparent","filltoparent","max","_getRect","getBoundingClientRect","_this2","InitialMatrix","_toConsumableArray","_this$delta","_this$delta2","delta","hasHistoryKey","_getOffset","cr","pos","os","br","right","bottom","too","initialoffset","match","map","concat","csTop","csLeft","borderTopWidth","borderLeftWidth","bordertop","borderleft","mElements","Object","assign","bool","currentSplits","_pushhistory","_getPageXY","touches","xy","ang","_getMiddle","_getRotation","pageX","pageY","point","angle","_getPoint2","dat","dist","deltaXY","pageXY","distance","prop","abs","_touches","_slicedToArray","touch1","touch2","mx","my","_getDistance2","parentElements","t1","t2","snapRotation","_this$options$disable","am","siz","lastlastrotationpoint","msg","showMessage","was","parentCentre","centreOnThis","pointInRectangle","d","ab","ap","bc","bp","dot_abap","dot_abab","dot_bcbp","dot_bcbc","ok","trigger","n","_getRotatorPoints","rpoint","apoint","anchor","TL","hdl","_this3","_dostart","disabled","startedresize","querySelectorAll","origrotate","clientRect","querySelector","startrotate","startedrotate","draggingrotate","_domove","_dostop","_e$touches","_this4","_this4$contained","origresize","startresize","draggingresize","contained","_e$touches2","dw","dh","neww","newh","getRotationQuadrant","normalizedRot","Angle","Quad","floor","Horiz","Vert","_this5","_this$options$disable2","closest","ww","started","doupdate","docontain","contain","disableZoom","disableRotate","disableTranslate","that","inv","ptl","ptr","pbr","pbl","size","csiz","containment","enclosed","containcount","quad","brv","brh","tlv","tlh","blv","trv","trh","blh","okcorners","lockcontain","nsc","nscc","_dowheelzoom","now","Date","dmw","lastwheelmove","_wheelTimer","acc","ds","wheel","func","sp","ev","ns","pl","Handlers","Namespaces","handlers","_iterator","_createForOfIteratorHelper","_step","done","handler","removeEventListener","err","f","_defineProperty","timer","refreshtransformables"],"sourceRoot":""}