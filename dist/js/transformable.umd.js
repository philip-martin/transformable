!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Transformable=e():t.Transformable=e()}(this,function(){return function(){"use strict";var t={d:function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},e={};t.d(e,{default:function(){return h}});var n=function(t,e){void 0===e&&(e=t),this.x=t,this.y=e};n.prototype={scale:function(t){return new n(this.x*t,this.y*t)},round:function(t){t=t?Math.pow(10,t):1;return new n(Math.round(this.x*t)/t,Math.round(this.y*t)/t)},sub:function(t){return new n(this.x-t.x,this.y-t.y)},add:function(t){return new n(this.x+t.x,this.y+t.y)},mult:function(t){return new n(this.x*t.x,this.y*t.y)},divide:function(t){return new n(this.x/t.x,this.y/t.y)},nonzero:function(){return 0!=this.x||0!=this.y},equals:function(t){return this.x===t.x&&this.y===t.y},moreoreq:function(t){return{x:this.x>=t.x,y:this.y>=t.y}},lessoreq:function(t){return{x:this.x<=t.x,y:this.y<=t.y}},dot:function(t){return this.x*t.x+this.y*t.y},perpOnLine:function(t,e){var r=((e.y-t.y)*(this.x-t.x)-(e.x-t.x)*(this.y-t.y))/(Math.pow(e.y-t.y,2)+Math.pow(e.x-t.x,2)),o=this.x-r*(e.y-t.y),s=this.y+r*(e.x-t.x);return new n(o,s)},mag:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}};var r=n,o=function(t){if(null==t||void 0===t)return o.Identity();if(t instanceof Array)this.elements=t.slice(0);else if(t instanceof o)this.elements=t.elements.slice(0);else{if(6!=arguments.length)throw new Error("Can't create Matrix from supplied arguments. Array of 6 elements, Matrix or nothing only.");this.elements=[];for(var e=0;e<arguments.length;)this.elements.push(arguments[e++])}return this.history={undo:[],redo:[]},this};o.Identity=function(){return new o([1,0,0,1,0,0])},o.prototype={transformpoint:function(t){var e=this.elements;return new r(t.x*e[0]+t.y*e[2]+e[4],t.x*e[1]+t.y*e[3]+e[5])},multiply:function(t){var e=this.elements,n=e[0],r=e[1],o=e[2],s=e[3],i=e[4],a=e[5],l=t[0],h=t[1],p=t[2],c=t[3],f=t[4],d=t[5];return this.elements=[n*l+o*h,r*l+s*h,n*p+o*c,r*p+s*c,n*f+o*d+i,r*f+s*d+a],this},elementsequal:function(t,e){return!(!t||!e)&&(t[0]==e[0]&&t[1]==e[1]&&t[2]==e[2]&&t[3]==e[3]&&t[4]==e[4]&&t[5]==e[5])},save:function(t){var e,n=this.history,r="string"==typeof t&&t;if(t&&!r||(t=this.elements),e=n.undo[n.undo.length-1],this.elementsequal(t,e))r&&(n.undo[r]=e);else{var o=n.undo.push(t.slice(0));n.redo=[],r&&(n.undo[r]=n.undo[o-1])}},undo:function(t){var e=this.history.undo,n=(e.length,e.pop()),r="string"==typeof t?e[t]:e[e.length-1];n&&this.history.redo.unshift(n),this.elements=r?r.slice(0):this.identity()},redo:function(){var t=this.history.redo,e=(t.length,t.pop()),n=t[t.length-1];e&&this.history.undo.unshift(e),this.elements=n?n.slice(0):this.identity()},reset:function(){return this.elements=this.identity(),this},determinant:function(){var t=this.elements;return t[0]*t[3]-t[1]*t[2]},inverse:function(){var t=this.elements,e=this.identity(),n=this.determinant();if(n<1e-14)throw"Matrix not invertible.";return e[0]=t[3]/n,e[1]=-t[1]/n,e[2]=-t[2]/n,e[3]=t[0]/n,e[4]=(t[2]*t[5]-t[3]*t[4])/n,e[5]=-(t[0]*t[5]-t[1]*t[4])/n,new o(e)},invert:function(){return this.multiply(this.inverse().elements)},identity:function(){return[1,0,0,1,0,0]},isIdentity:function(){var t=this.elements;return 1===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&0===t[4]&&0===t[5]},translate:function(t,e){return t instanceof r&&!e?this.multiply([1,0,0,1,t.x,t.y]):this.multiply([1,0,0,1,t,e])},scale:function(t,e){this.multiply([e,0,0,e,0,0]);var n=t.sub(t.scale(e)).scale(1/e);return this.translate(n)},rotateAboutPoint:function(t,e){var n=e*Math.PI/180;return this.multiply([Math.cos(n),Math.sin(n),-Math.sin(n),Math.cos(n),t.x-Math.cos(n)*t.x- -Math.sin(n)*t.y,t.y-Math.sin(n)*t.x-Math.cos(n)*t.y])},rotate:function(t,e){if(t instanceof r)return this.rotateAboutPoint(t,e);var n=t*Math.PI/180;return this.multiply([Math.cos(n),Math.sin(n),-Math.sin(n),Math.cos(n),0,0])},normaldegree:function(t){return t<0?t+360:t},rotation:function(t){var e=this.elements,n=180*Math.atan2(e[1],e[0])/Math.PI;return t?this.normaldegree(n):n},scaling:function(){return Math.sqrt(Math.pow(this.elements[0],2)+Math.pow(this.elements[1],2))},translation:function(){return new r(this.elements[4],this.elements[5])}};var s=o,i=function(t){this.Items=[],this._add(t,t.element),this.Self=t,this._init()};i.prototype._getScroll=function(){return new r(window.pageXOffset||document.documentElement.scrollLeft,window.pageYOffset||document.documentElement.scrollTop)},i.prototype.GetElementSize=function(t,e){e=e||getComputedStyle(t);var n=parseFloat(e.left),o=parseFloat(e.top),s=parseFloat(e.width),i=parseFloat(e.height);return{offset:new r(n||0,o||0),width:s,height:i,topleft:new r(0,0),topright:new r(s,0),bottomright:new r(s,i),bottomleft:new r(0,i)}},i.prototype._debug=function(){this.Items.forEach(function(t,e){console.log(t.matrix.elements)}),this.Items.forEach(function(t,e){console.log([t.element])})},i.prototype.Refresh=function(){this.Items=[],this._add(this.Self,this.Self.element),this.Init()},i.prototype._ispercent=function(t){return t.indexOf("%")>-1},i.prototype._isauto=function(t){return"auto"==t},i.prototype._pixelFromParent=function(t,e,n){if("0%"===e)return 0;var r=parseFloat(e);switch(t){case"left":r=parseFloat(n.width)*r/100;break;case"top":r=parseFloat(n.height)*r/100}return r},i.prototype.GetComputedDims=function(t){var e,n,r,o=getComputedStyle(t),s=o.left,i=o.top,a=o.marginTop,l=o.marginLeft,h=this._ispercent(s),p=this._ispercent(i),c=function(t){return parseFloat(t)};return this._isauto(s)&&(s=0),this._isauto(i)&&(i=0),(h||p)&&(r=getComputedStyle(t.parentNode)),h&&(e=this._pixelFromParent("left",s,r)),p&&(n=this._pixelFromParent("top",i,r)),{left:void 0!==e?e:c(s),top:void 0!==n?n:c(i),marginLeft:c(l),marginTop:c(a),transform:o.transform}},i.prototype._init=function(){for(var t,e,n,r=this.Self.element;r.parentNode&&!r.parentNode.body;){var o,i=(o=this.GetComputedDims(r.parentNode)).transform,a=/matrix\(\-?[0-9]+[^\)]+\)/.test(i),l=o.top,h=o.left,p=o.marginTop,c=o.marginLeft;if(a||r.parentNode.classList.contains("transformable")||r.classList.contains("transformable")||0!=l||0!=h||0!=p||0!=c)if(e=r.parentNode.getAttribute("data-transformable-id"))(t=Transformable.Instance[e])&&this._add(t);else{var f=!!a&&new s(this.Self._cssStringToArray(i));if(a||0!=l||0!=h||0!=p||0!=c||r.classList.contains("transformable")){(n=new s).translate(h||0,l||0).translate(c||0,p||0),f&&n.multiply(f.elements);var d=this.GetElementSize(r.parentNode);r.parentNode.style.top=0,r.parentNode.style.left=0,r.parentNode.style.marginLeft=0,r.parentNode.style.marginTop=0,r.parentNode.style.transformOrigin="0 0",r.parentNode.style.transform=this.Self._arrayToCssString(n.elements),this._add(n,r.parentNode,d)}}r=r.parentNode}},i.prototype._setoffset=function(){if(this.scroll=this._getScroll(),!this.offset){var t,e,n=new s;for(e=0;e<this.Items.length;e++)n.translate(this.Items[e].matrix.translation());for(e=0;e<this.Items.length;e++)if((t=this.Items[e]).element.classList.contains("transformable")){this.offset=t.transformable.offset.sub(n.translation());break}}},i.prototype._add=function(t,e){t instanceof Transformable&&this.Items.unshift({matrix:t.matrix,element:e||t.element,rect:t.sizes.element.initial,transformable:t}),t instanceof s&&this.Items.unshift({matrix:t,element:e,rect:this.GetElementSize(e)})},i.prototype.GetParents=function(){var t=[];return this.Items.forEach(function(e,n){var r,o=e.transformable;o||(r=e.element.getAttribute("data-transformable-id"))&&(o=Transformable.Instance[r],e.transformable=o);var s=o?o.matrix:e.matrix;t.push({Matrix:s,Inverse:s.inverse(),Element:e.element})}),t},i.prototype.TransformCorners=function(t){var e=this.GetMatrix();return{bottomright:e.transformpoint(t.bottomright),bottomleft:e.transformpoint(t.bottomleft),topright:e.transformpoint(t.topright),topleft:e.transformpoint(t.topleft)}},i.prototype.FirstParent=function(){var t=this.Items,e=t.length;return e>1&&t[e-2]},i.prototype.GetMatrix=function(){var t=s.Identity();return this.Items.forEach(function(e,n){t.multiply(e.matrix.elements)}),t},i.prototype.OffsetFromPoint=function(t,e){e=e||this.GetParents();this._setoffset();for(var n,r=t,o=s.Identity().translate(this.offset),i=0;i<e.length;i++)n=e[i],o.multiply(n.Matrix.elements);return r=o.inverse().transformpoint(r)};var a=i;!function(t,e){var n,r,o="";function s(e,s,i,a){e[n](o+s,"wheel"==r?i:function(e){!e&&(e=t.event);var n={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==e.type?0:1,deltaX:0,deltaY:0,deltaZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){e.stopPropagation?e.stopPropagation():e.returnValue=!1}};return"mousewheel"==r?(n.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(n.deltaX=-1/40*e.wheelDeltaX)):n.deltaY=e.detail,i(n)},a||!1)}t.addEventListener?n="addEventListener":(n="attachEvent",o="on"),r="onwheel"in e.createElement("div")?"wheel":void 0!==e.onmousewheel?"mousewheel":"DOMMouseScroll",t.addWheelListener=function(t,e,n){s(t,r,e,n),"DOMMouseScroll"==r&&s(t,"MozMousePixelScroll",e,n)}}(window,document);var l=function(t,e){if(e=e||{},t.length&&(t=t[0]),this.options=e,this.element=t,this.element.classList.add("transformable"),this.parent=t.parentNode,this.setInitialSizes(),e&&e.matrix){var n={x:1,y:1};if(e.computedsize&&(e.computedsize.width||e.computedsize.Width)){var r={width:e.computedsize.width||e.computedsize.Width,height:e.computedsize.height||e.computedsize.Height},o=this.sizes.element.initial;n.x=o.width/r.width,n.y=o.height/r.height}e.matrix instanceof Array&&6==e.matrix.length?(e.matrix[4]*=n.x,e.matrix[5]*=n.y,this._setMatrix(new s(e.matrix))):e.matrix instanceof s&&(e.matrix.elements[4]*=n.x,e.matrix.elements[5]*=n.y,this._setMatrix(e.matrix))}this.matrix=this._getMatrix(),this.originalTransition=this._getOriginalTransition(),this.Ancestry=new a(this),this._setOffset(),this.Ancestry._setoffset(),this.dragging=!1,this.start=null,this.orig=null,this.zooma=.001,this.events={start:e.start,move:e.move,stop:e.stop,tap:e.tap,transition:e.transition},this.element.setAttribute("data-transformable-id",l.Instance.push(this)-1),-1==navigator.userAgent.indexOf("Edge")&&this.element.setAttribute("draggable",!1),void 0!==e.attachevents&&!0!==e.attachevents||!1===e.editable||(this._addEvents(),e.resize&&this.createResizeHandles(e.resize),(!e.disable||e.disable&&!e.disable.rotate)&&this.createRotateHandles(),e.handle&&"rotator-box"==e.type&&this._addRotateEvents(e.handle))};l.Instance=[],l.prototype._getOriginalTransition=function(){var t=getComputedStyle(this.element).transition.split(","),e=[];for(var n in t)-1==t[n].indexOf("transform ")&&e.push(t[n]);return e.join(",")},l.prototype.tag=function(t){var e=document.createElement("div");return e.innerHTML=t,e.firstChild},l.prototype.createRotateHandles=function(t){if(!t||"rotate"==t){var e=this.tag('<div class="transformable-rotation-box"></div>'),n=this.tag('<svg class="transformable-svg-rotator" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 96 96" style="enable-background:new 0 0 96 96;" xml:space="preserve"><g><circle style="fill:#00A8DF;" cx="48.3" cy="48" r="35.3"/><g><path style="fill:#FFFFFF;" d="M35.2,3.8l4.1,28.5c0.2,1.5,2,2.1,3,1l8.2-8.2c0.7-0.7,1.8-0.7,2.5,0l8.8,8.8c7.8,7.8,9.1,20.2,1.2,28.2l-10,10c-0.7,0.7-1.8,0.7-2.5,0L41,62.6c-1-1-2.8-0.4-3,1l-4.1,28.5c-0.2,1.2,0.8,2.2,2,2l28.5-4.1c1.5-0.2,2.1-2,1-3l-8.9-8.9c-0.7-0.7-0.7-1.8,0-2.5l10-10c9.8-9.8,8.5-25.6-1.2-35.2l-8.8-8.8c-0.7-0.7-0.7-1.8,0-2.5L66.7,8.9c1-1,0.4-2.8-1-3L37.2,1.8C36,1.6,35,2.6,35.2,3.8z"/><g style="opacity:0.5;"><path d="M36.9,1.8c0.1,0,0.2,0,0.3,0l28.5,4.1c1.5,0.2,2.1,2,1,3L56.6,19.1c-0.7,0.7-0.7,1.8,0,2.5l8.8,8.8c9.7,9.7,11,25.5,1.2,35.2l-10,10c-0.7,0.7-0.7,1.8,0,2.5l8.9,8.9c1,1,0.4,2.8-1,3l-28.5,4.1c-0.1,0-0.2,0-0.3,0c-1.1,0-1.9-1-1.8-2.1l4.1-28.5c0.1-1,0.9-1.5,1.8-1.5c0.4,0,0.9,0.2,1.3,0.5l9.5,9.5c0.4,0.4,0.8,0.5,1.3,0.5s0.9-0.2,1.3-0.5l10-10c8-8,6.7-20.3-1.2-28.2L53,25.2c-0.4-0.4-0.8-0.5-1.3-0.5s-0.9,0.2-1.3,0.5l-8.2,8.2c-0.4,0.4-0.8,0.5-1.3,0.5c-0.8,0-1.7-0.6-1.8-1.5L35.2,3.8C35,2.7,35.9,1.8,36.9,1.8 M36.9-0.2c-1.1,0-2.1,0.5-2.9,1.3c-0.7,0.8-1,1.9-0.9,3l4.1,28.5c0.3,1.9,1.9,3.3,3.8,3.3c1,0,2-0.4,2.7-1.1l8.1-8.1l8.7,8.7c7.4,7.4,8,18.6,1.2,25.3l-9.8,9.8l-9.3-9.3c-0.7-0.7-1.7-1.1-2.7-1.1c-1.9,0-3.5,1.4-3.8,3.3l-4.1,28.5c-0.2,1.1,0.2,2.2,0.9,3c0.7,0.8,1.8,1.3,2.9,1.3c0.2,0,0.4,0,0.5,0l28.5-4.1c1.4-0.2,2.6-1.2,3.1-2.6c0.5-1.4,0.1-2.9-0.9-3.9l-8.7-8.7l9.8-9.8c10.2-10.2,9.6-27.2-1.2-38.1l-8.7-8.7l10-10c1-1,1.4-2.5,0.9-3.9c-0.5-1.4-1.6-2.4-3.1-2.6L37.5-0.2C37.3-0.2,37.1-0.2,36.9-0.2L36.9-0.2z"/></g></g></g></svg>'),r=this.tag('<svg class="transformable-svg-anchor" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 96 96" style="enable-background:new 0 0 96 96;" xml:space="preserve"><g><circle style="fill:#00A8DF;" cx="47.6" cy="48.4" r="17.6"/><g><path style="fill:#FFFFFF;" d="M69,46H50V27.2c0-1.4-1.1-2.4-2.5-2.4S45,25.9,45,27.2V46H26.6c-1.4,0-2.4,1.1-2.4,2.5s1.1,2.5,2.4,2.5H45v18.6c0,1.4,1.1,2.4,2.5,2.4s2.5-1.1,2.5-2.4V51h19c1.4,0,2.4-1.1,2.4-2.5S70.3,46,69,46z"/><g style="opacity:0.5;"><path d="M47.5,24.8c1.4,0,2.5,1.1,2.5,2.4V46h19c1.4,0,2.4,1.1,2.4,2.5c0,1.4-1.1,2.5-2.4,2.5H50v18.6c0,1.4-1.1,2.4-2.5,2.4S45,70.9,45,69.6V51H26.6c-1.4,0-2.4-1.1-2.4-2.5c0-1.4,1.1-2.5,2.4-2.5H45V27.2C45,25.9,46.1,24.8,47.5,24.8 M47.5,22.8c-2.5,0-4.5,2-4.5,4.4V44H26.6c-2.5,0-4.4,2-4.4,4.5c0,2.5,2,4.5,4.4,4.5H43v16.6c0,2.5,2,4.4,4.5,4.4s4.5-2,4.5-4.4V53h17c2.5,0,4.4-2,4.4-4.5c0-2.5-2-4.5-4.4-4.5H52V27.2C52,24.8,50,22.8,47.5,22.8L47.5,22.8z"/></g></g></g></svg>'),o=this.tag('<div class="transformable-rotation-line"></div>'),s=this;e.appendChild(o),e.appendChild(r),e.appendChild(n),e.appendChild(this.tag('<div class="transformable-anchor-point"></div>')),"IMG"==this.element.nodeName?this.parent.appendChild(e):this.element.appendChild(e),e.addEventListener("click",function(t){return t.stopPropagation(),!1}),this.rotatorBox=new l(e,{type:"rotator-box",rotatetarget:this,handle:n,disable:{zoom:!0,rotate:!0,resize:!0}});var i=function(){s.rotatorBox&&s.rotatorBox.parent&&s.rotatorBox.parent.classList.remove("transformable-mousedown");var t=document.querySelector("body");s.off(t,"mouseup.rotatormouse")},a=function(t){t.stopPropagation&&t.stopPropagation(),s._resizeTimer&&clearTimeout(s._resizeTimer),this.classList.add("transformable-over"),this.classList.add("transformable-resize-over"),s.Ancestry.Items.forEach(function(t,e){t._overTimer&&clearTimeout(t._overTimer)}),s._overTimer=setTimeout(function(){var t=s.rotatorBox,e=t.Ancestry;e.FirstParent();parseFloat(getComputedStyle(t.element).width)>=32&&t.parent.classList.add("transformable-over-active");var n=e.Items.length;e.Items.forEach(function(t,e){e<n-2&&t.element.classList.remove("transformable-over-active")})},"number"==typeof t?t:1500)},h=this.rotatorBox.parent;this.on(h,"mouseenter.rotatormouse",a),this.on(h,"mouseleave.rotatormouse",function(){s._overTimer&&clearTimeout(s._overTimer),s._resizeTimer=setTimeout(function(){s.element.classList.remove("transformable-resize-over")},500),this.classList.remove("transformable-over-active"),this.classList.remove("transformable-over")}),this.on(h,"mousedown.rotatormouse",function(){this.classList.add("transformable-mousedown");var t=document.querySelector("body");s.on(t,"mouseup.rotatormouse",i)}),this.on(h,"click.rotatormouse",function(){a.apply(this,[0])})}},l.prototype.createResizeHandles=function(t){if("tl-br"==t){var e=this.tag('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="-271 394.9 52 52" style="enable-background:new -271 394.9 52 52;" xml:space="preserve"><g><path style="fill:#00A8DF;" d="M-244.9,421L-244.9,421L-244.9,421L-244.9,421L-244.9,421l26,0.1c0-10.8-6.1-20-16-24.1 c-10-4.1-20.8-2-28.4,5.7c-7.6,7.6-9.7,18.5-5.6,28.4c4.2,10,13.4,16,24.2,15.9L-244.9,421z"/><path style="fill:none;stroke:#FFFFFF;stroke-width:3;" d="M-251.6,414.3"/><path style="fill:none;stroke:#FFFFFF;stroke-width:3;" d="M-236.6,414.3"/></g><g><path style="fill:#FFFFFF;" d="M-227,419.5l-7.6-4.4c-1.1-0.6-2.4,0.2-2.4,1.4v1.9h-5.6v-5.5h2c1.2,0,2-1.3,1.4-2.4l-4.4-7.6 c-0.6-1.1-2.1-1.1-2.7,0l-4.4,7.6c-0.6,1.1,0.2,2.4,1.4,2.4h2v5.5h-5.6v-1.9c0-1.2-1.3-2-2.4-1.4l-7.6,4.4c-1.1,0.6-1.1,2.1,0,2.7 l7.6,4.4c1.1,0.6,2.4-0.2,2.4-1.4v-2h5.6v5.6h-2c-1.2,0-2,1.3-1.4,2.4l4.4,7.6c0.6,1.1,2.1,1.1,2.7,0l4.4-7.6 c0.6-1.1-0.2-2.4-1.4-2.4h-2v-5.6h5.6v2c0,1.2,1.3,2,2.4,1.4l7.6-4.4C-225.9,421.7-225.9,420.1-227,419.5z"/><path style="opacity:0.5;fill:#231F20;" d="M-245,402.1c0.5,0,1.1,0.3,1.4,0.8l4.4,7.6c0.6,1.1-0.2,2.4-1.4,2.4h-2v5.5h5.6v-1.9 c0-0.9,0.8-1.6,1.6-1.6c0.3,0,0.5,0.1,0.8,0.2l7.6,4.4c1.1,0.6,1.1,2.1,0,2.7l-7.6,4.4c-0.3,0.1-0.5,0.2-0.8,0.2 c-0.8,0-1.6-0.7-1.6-1.6v-2h-5.6v5.6h2c1.2,0,2,1.3,1.4,2.4l-4.4,7.6c-0.3,0.5-0.8,0.8-1.4,0.8c-0.5,0-1.1-0.3-1.4-0.8l-4.4-7.6 c-0.6-1.1,0.2-2.4,1.4-2.4h2v-5.6h-5.6v2c0,0.9-0.8,1.6-1.6,1.6c-0.3,0-0.5-0.1-0.8-0.2l-7.6-4.4c-1.1-0.6-1.1-2.1,0-2.7l7.6-4.4 c0.3-0.1,0.5-0.2,0.8-0.2c0.8,0,1.6,0.7,1.6,1.6v1.9h5.6v-5.5h-2c-1.2,0-2-1.3-1.4-2.4l4.4-7.6C-246.1,402.3-245.5,402.1-245,402.1 M-245,400.6c-1.1,0-2.1,0.6-2.6,1.5l-4.4,7.6c-0.5,0.9-0.5,2.1,0,3c0.5,0.9,1.5,1.5,2.6,1.5h0.5v2.7h-2.7v-0.5c0-1.7-1.4-3-3-3 c-0.5,0-1,0.1-1.5,0.4l-7.6,4.4c-0.9,0.5-1.5,1.5-1.5,2.6c0,1.1,0.6,2.1,1.5,2.6l7.6,4.4c0.5,0.3,1,0.4,1.5,0.4c1.7,0,3-1.4,3-3\tv-0.6h2.7v2.8h-0.5c-1.1,0-2.1,0.6-2.6,1.5c-0.5,0.9-0.5,2.1,0,3l4.4,7.6c0.5,0.9,1.5,1.5,2.6,1.5c1.1,0,2.1-0.6,2.6-1.5l4.4-7.6 c0.5-0.9,0.5-2.1,0-3c-0.5-0.9-1.5-1.5-2.6-1.5h-0.5v-2.8h2.7v0.6c0,1.7,1.4,3,3,3c0.5,0,1-0.1,1.5-0.4l7.6-4.4\tc0.9-0.5,1.5-1.5,1.5-2.6c0-1.1-0.6-2.1-1.5-2.6l-7.6-4.4c-0.5-0.3-1-0.4-1.5-0.4c-1.7,0-3,1.4-3,3v0.5h-2.7v-2.7h0.5\tc1.1,0,2.1-0.6,2.6-1.5c0.5-0.9,0.5-2.1,0-3l-4.4-7.6C-242.9,401.2-243.9,400.6-245,400.6L-245,400.6z"/></g></svg>'),n=this.tag('<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="-271 394.9 52 52" style="enable-background:new -271 394.9 52 52;" xml:space="preserve"><g><path style="fill:#00A8DF;" d="M-245,420.9L-245,420.9L-245,420.9L-245,420.9L-245,420.9l-26-0.1c0,10.8,6.1,20,16,24.1 c10,4.1,20.8,2,28.4-5.7c7.6-7.6,9.7-18.5,5.6-28.4c-4.2-10-13.4-16-24.2-15.9L-245,420.9z"/></g><g><path style="fill:#FFFFFF;" d="M-245.8,423l-2.5-2.5l-2.1,2.1c-0.9,0.9-2.3,0.5-2.6-0.7l-1.6-9.2c-0.3-1.2,0.8-2.3,1.9-1.9l9.2,1.6 c1.2,0.3,1.6,1.8,0.7,2.6l-2.1,2.1l2.5,2.5l2.7,2.7l-1-1l2.1-2.1c0.9-0.9,2.3-0.5,2.6,0.7l1.6,9.2c0.3,1.2-0.8,2.3-1.9,1.9 l-9.2-1.6c-1.2-0.3-1.6-1.8-0.7-2.6l2.1-2.1l-3.2-3.2L-245.8,423z"/><path style="opacity:0.5;fill:#231F20;" d="M-239.6,422.3l-1-1l2.1-2.1c0.7-0.7,1.7-0.6,2.2,0c0.2,0.2,0.3,0.4,0.4,0.7l1.6,9.2 c0.3,1.2-0.8,2.3-1.9,1.9l-9.2-1.6c-0.3-0.1-0.5-0.2-0.7-0.4c-0.6-0.6-0.7-1.6,0-2.2l2.1-2.1l-3.2-3.2l1.5,1.5l-2.5-2.5l-2.1,2.1 c-0.7,0.7-1.7,0.6-2.2,0c-0.2-0.2-0.3-0.4-0.4-0.7l-1.6-9.2c-0.3-1.2,0.8-2.3,1.9-1.9l9.2,1.6c0.3,0.1,0.5,0.2,0.7,0.4 c0.6,0.6,0.7,1.6,0,2.2l-2.1,2.1l2.5,2.5L-239.6,422.3z M-242.3,417.5l-0.5-0.5l1-1c1.2-1.2,1.2-3.1,0-4.3 c-0.4-0.4-0.8-0.6-1.4-0.8l-9.2-1.6c-1.1-0.3-2.1,0-2.9,0.8c-0.8,0.8-1.1,1.9-0.8,2.9l1.6,9.2c0.1,0.5,0.4,1,0.8,1.4 c1.2,1.2,3.1,1.2,4.3,0l1.1-1.1l0.5,0.5l0.5,0.5l1.2,1.2l-1.1,1.1c-1.2,1.2-1.2,3.1,0,4.3c0.4,0.4,0.8,0.6,1.4,0.8l9.2,1.6 c1.1,0.3,2.1,0,2.9-0.8c0.8-0.8,1.1-1.9,0.8-2.9l-1.6-9.2c-0.1-0.5-0.4-1-0.8-1.4c-1.2-1.2-3.1-1.2-4.3,0l-1,1l-1.2-1.2"/></g></svg>'),r=this.tag('<div class="transformable-resize-button"></div>'),o=r.cloneNode();r.classList.add("tl"),r.appendChild(e),o.classList.add("br"),o.appendChild(n),this.resizertl=r,this.resizerbr=o,this.element.appendChild(r),this.element.appendChild(o),this._addResizeEvents(r,o)}},l.prototype.zoom=function(t){var e=this.Ancestry.OffsetFromPoint(this._findCentreInWindow());return this.scale(e,1+.05*t),this},l.prototype.scale=function(t,e){return this.matrix.scale(t,e),this.setTransition(!0),this._updateElement(),this},l.prototype.translate=function(t,e,n){return this.matrix.translate(t,e),this.setTransition(n),this._updateElement(),this},l.prototype.rotate=function(t,e,n,o){return t instanceof r&&t&&void 0!==t||(t=this.Ancestry.OffsetFromPoint(this._findCentreInWindow())),t instanceof r&&o&&(t=this.Ancestry.OffsetFromPoint(t)),this.matrix.rotate(t,e),this.lastrotationpoint=t,void 0!==n&&!1!==n||this.setTransition(!1),this._updateElement(),this},l.prototype.straighten=function(){var t=this.matrix.rotation();return this.rotate(new r(this.sizes.element.initial.width/2,this.sizes.element.initial.height/2),-t,!0),this},l.prototype.fittoparent=function(){var t=new r(this.sizes.element.initial.width,this.sizes.element.initial.height),e=this.Ancestry,n=e.GetParents(),o=e.FirstParent().rect,s=this.matrix.inverse(),i=s.transformpoint(o.topleft),a=s.transformpoint(o.topright),l=s.transformpoint(o.bottomleft),h=(s.transformpoint(o.bottomright),new r(this._distanceBetweenPoints(i,a),this._distanceBetweenPoints(i,l)).divide(t)),p=Math.min(h.x,h.y);return this.scale(new r(0,0),p),this.centreinparent(!0,n),this.straighten(),this},l.prototype.filltoparent=function(){var t=new r(this.sizes.element.initial.width,this.sizes.element.initial.height),e=this.Ancestry,n=e.GetParents(),o=e.FirstParent().rect,s=this.matrix.inverse(),i=s.transformpoint(o.topleft),a=s.transformpoint(o.topright),l=s.transformpoint(o.bottomleft),h=(s.transformpoint(o.bottomright),new r(this._distanceBetweenPoints(i,a),this._distanceBetweenPoints(i,l)).divide(t)),p=Math.max(h.x,h.y);return this.scale(new r(0,0),p),this.centreinparent(!0,n),this.straighten(),this},l.prototype._getRect=function(t){return t.getBoundingClientRect()},l.prototype.reset=function(t){if(this.InitialMatrix?this.matrix.elements=this.InitialMatrix.slice(0):this.matrix.reset(),this.setTransition(void 0===t||t),this.transition){var e=this;this.delta&&(this.delta.x||this.delta.y)&&(this.element.classList.add("transformable-reset"),this.on(this.element,"transitionend.reset",function(){this.classList.remove("transformable-reset"),e.off(this,"transitionend.reset")}))}return this._updateElement(),this},l.prototype.hasHistoryKey=function(t){return this.matrix.history.undo[t]instanceof Array},l.prototype.undo=function(t){return this.matrix.undo(t),this.setTransition(!0),this._updateElement(),this},l.prototype.redo=function(){return this.matrix.redo(),this.setTransition(!0),this._updateElement(),this},l.prototype.setInitialSizes=function(){if(!this.sizes){var t=window.getComputedStyle(this.element),e=parseFloat(t.width),n=parseFloat(t.height),o=parseFloat(t.left),s=parseFloat(t.top);this.sizes={element:{initial:{offset:new r(o,s),width:e,height:n,topleft:new r(0,0),topright:new r(e,0),bottomright:new r(e,n),bottomleft:new r(0,n)}},window:{width:parseFloat(getComputedStyle(document.body.parentNode).width)}}}},l.prototype._getOffset=function(t){var e=this._getRect(t),n=this.Ancestry._getScroll(),o=getComputedStyle(t),s=new r(parseFloat(o.left),parseFloat(o.top)),i=new r(e.left+n.x,e.top+n.y);return{offset:i,topleft:i,bottomright:new r(e.right,e.bottom),topright:new r(e.right,e.top),bottomleft:new r(e.left,e.bottom),pos:s}},l.prototype._setOffset=function(){if(!this.offset){var t=this._getOffset(this.element,!0);return this.offset=t.offset,void(this.initialoffset=t.offset)}},l.prototype._cssStringToArray=function(t){var e=t.match(/[0-9e., -]+/)[0].split(", ");return e.forEach(function(t,n){e[n]=parseFloat(t)}),e},l.prototype._arrayToCssString=function(t){return"matrix("+t.join(",")+")"},l.prototype._getMatrix=function(t){var e=t||this.element,n=getComputedStyle(e),r=getComputedStyle(this.parent),o=n.transform,i=n.top.indexOf("%")>-1?parseFloat(r.height)*parseFloat(n.top)/100:parseFloat(n.top),a=n.left.indexOf("%")>-1?parseFloat(r.width)*parseFloat(n.left)/100:parseFloat(n.left),l=parseFloat(n.marginTop),h=parseFloat(n.marginLeft),p=parseFloat(n.borderTopWidth),c=parseFloat(n.borderLeftWidth);if(/matrix\(\-?[0-9]+[^\)]+\)/.test(o)){var f=this._cssStringToArray(o);this.InitialMatrix||(this.InitialMatrix=f.slice(0))}f=new s(f||[1,0,0,1,0,0]);this.options.type;return(a||i||l||h||p||c)&&(f.translate(a||0,i||0),f.translate(h||0,l||0),f.translate(c||0,p||0),e.style.marginTop=0,e.style.marginLeft=0,e.style.top=0,e.style.left=0,e.style.marginTop=-(p||0)+"px",e.style.marginLeft=-(p||0)+"px",this.matrix=f,this._updateElement(),this.InitialMatrix=f.elements.slice(0)),f},l.prototype.setTransition=function(t){if("boolean"==typeof t){var e=this.transition,n=this.originalTransition,r=n?n.split(","):[];1==t&&e!=t&&(r.push("transform 0.5s"),this.element.style.transition=r.join(",")),0==t&&e!=t&&(r.push("transform 0s"),this.element.style.transition=r.join(",")),this.transition=t}},l.prototype._updateElement=function(){var t="matrix("+this.matrix.elements.join(",")+")";this.element.style.transform=t},l.prototype._pushhistory=function(){this.matrix.save()},l.prototype._setMatrix=function(t){this.matrix=t,this._updateElement(t)},l.prototype._getPageXY=function(t,e){var n,o,s,i;return e?2==e.length?(n=this._getMiddle(e),o=this._getRotation(e),s=new r(e[0].pageX,e[0].pageY),i=new r(e[1].pageX,e[1].pageY)):(n=new r(e[0].pageX,e[0].pageY),o=this.matrix.rotation()):(n=new r(t.pageX,t.pageY),o=this.matrix.rotation()),{point:n,angle:o,p1:s,p2:i}},l.prototype._getPoint2=function(t,e){var n=this._getPageXY(t,e),o=null,s=this.Ancestry,i=s.GetParents(),a=s.OffsetFromPoint(n.point,i),l=n.p1&&n.p2?this._distanceBetweenPoints(s.OffsetFromPoint(n.p1,i),s.OffsetFromPoint(n.p2,i)):0;return void 0!==t.deltaX&&(o=new r(t.deltaX,t.deltaY)),{offset:a,pageXY:n.point,pageX:n.point.x,pageY:n.point.y,angle:n.angle,distance:l,deltaXY:o}},l.prototype._distanceBetweenPoints=function(t,e){var n=t.pageX?{x:"pageX",y:"pageX"}:{x:"x",y:"y"};return Math.sqrt(Math.pow(Math.abs(e[n.x]-t[n.x]),2)+Math.pow(Math.abs(e[n.y]-t[n.y]),2))},l.prototype._getMiddle=function(t){var e=t[0],n=t[1],o=(n.pageX-e.pageX)/2+e.pageX,s=(n.pageY-e.pageY)/2+e.pageY;return new r(o,s)},l.prototype._getDistance2=function(t,e){var n=this.Ancestry;e=e||n.GetParents();var o=n.OffsetFromPoint(new r(t[0].pageX,t[0].pageY),e),s=n.OffsetFromPoint(new r(t[1].pageX,t[1].pageY),e);return this._distanceBetweenPoints(o,s)},l.prototype._getRotation=function(t,e){var n;return n=180*Math.atan2((t[0].pageY||t[0].y)-(t[1].pageY||t[1].y),(t[0].pageX||t[0].x)-(t[1].pageX||t[1].x))/Math.PI,e?this.matrix.normaldegree(n):n},l.prototype.snapRotation=function(){if(!this.options.disable||!this.options.disable.rotate){var t,e=this.matrix.rotation(),n=e-15*Math.round(e/15),o=Math.abs(n),s=this.sizes.element.initial;if(this.setTransition(!0),o<=3&&o>0){var i=this.lastrotationpoint||new r(s.width/2,s.height/2);this.rotate(i,-n),this.lastlastrotationpoint=void 0,this._pushhistory()}switch(e=this.matrix.rotation(),Math.abs(Math.round(10*e)/10)){case 0:case 180:t="Horizontal";break;case 90:t="Vertical";break;default:t="Rotation: "+Math.round(10*e)/10+"&deg;"}this.showMessage(t,"sticky",2e3)}},l.prototype.showMessage=function(t,e,n){console.log(t)},l.prototype._findCentreInWindow=function(){var t=this._getRect(this.parent);return new r(t.left+t.width/2,t.top+t.height/2)},l.prototype.centreinparent=function(t,e){var n=this.transition,o=this.Ancestry;this.setTransition(t),e=e||o.GetParents();var s=getComputedStyle(this.parent),i=new r(parseFloat(s.width)/2,parseFloat(s.height)/2),a=this.matrix.inverse().transformpoint(i);this.translate(a.sub(new r(this.sizes.element.initial.width/2,this.sizes.element.initial.height/2))),this.setTransition(n)},l.prototype.pointInRectangle=function(t,e,n,r,o){var s=n.sub(e),i=t.sub(e),a=r.sub(n),l=t.sub(n),h=s.dot(i),p=s.dot(s),c=a.dot(l),f=a.dot(a);return{dot_abap:h,dot_abab:p,dot_bcbp:c,dot_bcbc:f,ok:0<=h&&Math.round(10*h)/10<=Math.round(10*p)/10&&0<=c&&Math.round(10*c)/10<=Math.round(10*f)/10}},l.prototype.trigger=function(t,e){"function"==typeof this.events[t]&&this.events[t].apply(this,[this.element,e])},l.prototype._getRotatorPoints=function(t,e){var n,o=this.anchor.TL,s=t.touches,i=this.Ancestry;e=e||i.GetParents(),i._setoffset(),n=s?new r(s[0].pageX,s[0].pageY):new r(t.pageX,t.pageY);var a=Math.round(100*this._getRotation([o.add(i.scroll),n],!1))/100;return{deltaXY:null,offset:i.OffsetFromPoint(n,e),pageXY:n,pageX:n.x,pageY:n.y,angle:a,distance:0}},l.prototype._addRotateEvents=function(t){var e=this,n=function(t){if(!e.startedrotate)return!1;e.draggingrotate=!0,t.preventDefault(),t.stopPropagation();var n=t.touches,o=!1;if(n&&2==n.length)return!1;var s=e._getRotatorPoints(t),i=(e.origrotate,e.startrotate),a=e.matrix,h={angle:Math.round(100*(s.angle-i.angle))/100};0!=h.angle&&(e.parent!=e.options.rotatetarget.element&&(a.rotateAboutPoint(new r(0),h.angle),o=!0),e.options.rotatetarget instanceof l&&e.options.rotatetarget.rotate(e.anchor.TL.add(e.Ancestry.scroll),h.angle,!1,!0)),o&&e._updateElement(a),e.startrotate.angle=s.angle},o=function(t){t.preventDefault(),t.stopPropagation(),e.element.classList.remove("transformable-active"),e.startedrotate=!1,e.draggingrotate=!1,e.off(document.querySelector("body"),"mouseup.transformable dragend.transformable",o),e.options.rotatetarget instanceof l&&(e.options.rotatetarget.events.stop&&e.options.rotatetarget.trigger("stop",t),e.options.rotatetarget.snapRotation()),e.events.stop&&e.trigger("stop",t),e.snapRotation()};this.on(t,"mousedown.transformable touchstart.transformable",function(t){if(!0===e.options.disabled)return!1;if(e.startedresize)return!1;0==document.querySelectorAll(".transformable-active").length&&e.element.classList.add("transformable-active");var s=e.matrix;e.origrotate={trans:new r(s.elements[4],s.elements[5]),angle:s.rotation(!0),scale:s.scaling()};var i=t.touches;if(i&&2==i.length&&i[0].target&&i[1].target&&i[0].target!==i[1].target)return console.log("Two active elements not supported"),!1;e.anchor=e.anchor||{},e.anchor.clientRect=e._getRect(e.element.querySelector(".transformable-anchor-point")),e.anchor.TL=new r(e.anchor.clientRect.left,e.anchor.clientRect.top),e.startrotate=e._getRotatorPoints(t),e.startrotate.scale=e.origrotate.scale,e.startedrotate=!0,e.draggingrotate=!1,e.setTransition(!1),t.stopPropagation();var a=document.querySelector("body");"mousedown"==t.type&&(e.on(a,"mousemove.transformable",n),e.on(a,"mouseup.transformable dragend.transformable",o))}),this.on(t,"touchmove.transformable",n),this.on(t,"touchend.transformable",o)},l.prototype._addResizeEvents=function(t,e){var n=this,o=this.element,s=(n.options,function(t){if(!n.element.classList.contains("transformable-active"))return!1;if(!n.startedresize)return!1;n.draggingresize=!0,t.preventDefault(),t.stopPropagation();var e=t.touches;if(e&&2==e.length)return!1;var s=n._getPoint2(t,e),i=(n.origresize,n.startresize),a=getComputedStyle(o),l={trans:s.offset.sub(i.offset),angle:Math.round(100*(s.angle-i.angle))/100,distance:0!=i.distance?Math.round(s.distance/((i.distance+s.distance)/2)*1e3)/1e3:0};if(l.trans.nonzero()){var h=parseFloat(a.height),p=parseFloat(a.width),c=n.w-p,f=n.h-h,d=p+l.trans.x+c,m=h+l.trans.y+f;o.style.width=d+"px",o.style.height=m+"px",n.sizes.element.initial.bottomright=new r(d,m),n.sizes.element.initial.topright.x=d,n.sizes.element.initial.bottomleft.y=m,n.sizes.element.initial.width=d,n.sizes.element.initial.height=m}return n.startresize.angle=s.angle,!1}),i=function(t){0==document.querySelectorAll(".transformable-active").length&&n.element.classList.add("transformable-active"),console.log("_resize.start"),t.preventDefault(),t.stopPropagation();var e=n.matrix;n.origresize={trans:new r(e.elements[4],e.elements[5]),angle:e.rotation(),scale:e.scaling()};var i=t.touches;n.startresize=n._getPoint2(t,i),n.startresize.scale=n.origresize.scale,n.startedresize=!0,n.draggingresize=!1;var l=getComputedStyle(o);if(n.h=parseFloat(l.height),n.w=parseFloat(l.width),void 0===n.contained&&(n.contained=!0),n.events.startresize&&n.trigger("startresize",t),n.setTransition(!1),"mousedown"==t.type){var h=document.querySelector("body");n.on(h,"mousemove.transformable",s),n.on(h,"mouseup.transformable dragend.transformable",a)}return!1},a=function(){var t=document.querySelector("body");if(n.off(t,"mousemove.transformable",s),n.off(t,"mouseup.transformable dragend.transformable",a),!0===n.options.disabled)return!1;n.element.classList.remove("transformable-active"),n.startedresize=!1,n.draggingresize=!1};n.on(e,"mousedown.transformable",i),n.on(e,"touchstart.transformable",i),n.on(e,"touchmove.transformable",s),n.on(e,"touchend.transformable",a)},l.prototype.getRotationQuadrant=function(t){var e=(void 0!==t?t:this.matrix.rotation())%360;return e<0&&(e+=360),{Angle:e,Quad:Math.floor(e/90),Horiz:0==e||180==e,Vert:90==e||270==e}},l.prototype._addEvents=function(){var t=this,e=this.element,n=this.options&&this.options.contain;"function"==typeof this.events.transition&&e.addEventListener("transitionend",this.events.transition);var o=function(e){if(!0===t.options.disabled)return!1;if(!t.element.classList.contains("transformable-active"))return!1;if(!t.started||t.startedresize||t.startedrotate)return!1;t.dragging=!0,e.preventDefault(),e.stopPropagation();var o=e.touches,s=!1;if(o&&2==o.length&&o[0].target&&o[1].target&&o[0].target!==o[1].target)return console.log("Two active elements not supported"),!1;var i=t.matrix,a=(i.rotation(),t.options.disable),l=!1,h=!1,p=!1;a&&(l=a.zoom||a.scale,p=a.rotate,h=a.translate);var c=t._getPoint2(e,o),f=(t.orig,t.start),d={trans:c.offset.sub(f.offset),angle:Math.round(100*(c.angle-f.angle))/100,distance:0!=f.distance?Math.round(c.distance/((f.distance+c.distance)/2)*1e3)/1e3:0};if(n&&0==d.angle&&(!o||o&&1==o.length)){var m,u,g,y,v=t.Ancestry.FirstParent().rect,b=i.inverse(),x=v.topleft,w=v.topright,_=v.bottomright,L=v.bottomleft;m=b.transformpoint(x).sub(d.trans),u=b.transformpoint(w).sub(d.trans),g=b.transformpoint(_).sub(d.trans),y=b.transformpoint(L).sub(d.trans),f.size?f.size=0!=d.distance?new r(t._distanceBetweenPoints(m,u),t._distanceBetweenPoints(m,y)):f.size:f.size=new r(t._distanceBetweenPoints(m,u),t._distanceBetweenPoints(m,y));var M=t.sizes.element.initial;t.options;if("enclose"==n){var z=0;if((E={tl:t.pointInRectangle(M.topleft,m,u,g,y),tr:t.pointInRectangle(M.topright,m,u,g,y),br:t.pointInRectangle(M.bottomright,m,u,g,y),bl:t.pointInRectangle(M.bottomleft,m,u,g,y)}).tl.ok&&z++,E.tr.ok&&z++,E.br.ok&&z++,E.bl.ok&&z++,!(4==z))switch((R=t.getRotationQuadrant(f.angle)).Quad){case 0:if(0==R.Angle){if(!E.br.ok){var F=M.bottomright.perpOnLine(u,g).sub(M.bottomright),P=M.bottomright.perpOnLine(y,g).sub(M.bottomright);F.x<0&&(d.trans=d.trans.add(F)),P.y<0&&(d.trans=d.trans.add(P))}if(!E.tl.ok){var k=M.topleft.perpOnLine(m,y),T=M.topleft.perpOnLine(m,u);k.x>0&&(d.trans=d.trans.add(k)),T.y>0&&(d.trans=d.trans.add(T))}}else{if(!E.bl.ok){var O=M.bottomleft.perpOnLine(m,y).sub(M.bottomleft);O.x>0&&(d.trans=d.trans.add(O))}if(!E.br.ok)(P=M.bottomright.perpOnLine(y,g).sub(M.bottomright)).y<0&&(d.trans=d.trans.add(P));if(!E.tr.ok){var S=M.topright.perpOnLine(u,g).sub(M.topright);S.x<0&&(d.trans=d.trans.add(S))}if(!E.tl.ok)(T=M.topleft.perpOnLine(m,u)).y>0&&(d.trans=d.trans.add(T))}break;case 3:if(270==R.Angle){if(!E.tl.ok){T=M.topleft.perpOnLine(m,y);(k=M.topleft.perpOnLine(y,g)).x>0&&(d.trans=d.trans.add(k)),T.y>0&&(d.trans=d.trans.add(T))}if(!E.br.ok){F=M.bottomright.perpOnLine(m,u).sub(M.bottomright),P=M.bottomright.perpOnLine(g,u).sub(M.bottomright);F.x<0&&(d.trans=d.trans.add(F)),P.y<0&&(d.trans=d.trans.add(P))}}else{if(!E.tl.ok)(k=M.topleft.perpOnLine(m,y)).x>0&&(d.trans=d.trans.add(k));if(!E.br.ok)(F=M.bottomright.perpOnLine(u,g).sub(M.bottomright)).x<0&&(d.trans=d.trans.add(F));if(!E.tr.ok)(I=M.topright.perpOnLine(m,u).sub(M.topright)).y>0&&(d.trans=d.trans.add(I));if(!E.bl.ok)(A=M.bottomleft.perpOnLine(y,g).sub(M.bottomleft)).y<0&&(d.trans=d.trans.add(A))}break;case 1:if(90==R.Angle){if(!E.tl.ok){k=M.topleft.perpOnLine(u,m),T=M.topleft.perpOnLine(u,g);k.x>0&&(d.trans=d.trans.add(k)),T.y>0&&(d.trans=d.trans.add(T))}if(!E.br.ok){F=M.bottomright.perpOnLine(g,y).sub(M.bottomright),P=M.bottomright.perpOnLine(m,y).sub(M.bottomright);F.x<0&&(d.trans=d.trans.add(F)),P.y<0&&(d.trans=d.trans.add(P))}}else{if(!E.tl.ok)(k=M.topleft.perpOnLine(u,g)).x>0&&(d.trans=d.trans.add(k));if(!E.br.ok)(F=M.bottomright.perpOnLine(m,y).sub(M.bottomright)).x<0&&(d.trans=d.trans.add(F));if(!E.tr.ok)(I=M.topright.perpOnLine(y,g).sub(M.topright)).y>0&&(d.trans=d.trans.add(I));if(!E.bl.ok)(A=M.bottomleft.perpOnLine(u,m).sub(M.bottomleft)).y<0&&(d.trans=d.trans.add(A))}break;case 2:if(180==R.Angle){if(!E.tl.ok){k=M.topleft.perpOnLine(g,y),T=M.topleft.perpOnLine(m,y);k.y>0&&(d.trans=d.trans.add(k)),T.y>0&&(d.trans=d.trans.add(T))}if(!E.br.ok){F=M.bottomright.perpOnLine(u,m).sub(M.bottomright),P=M.bottomright.perpOnLine(u,g).sub(M.bottomright);F.y<0&&(d.trans=d.trans.add(F)),P.y<0&&(d.trans=d.trans.add(P))}}var I,A;if(!E.tl.ok)(k=M.topleft.perpOnLine(g,y)).y>0&&(d.trans=d.trans.add(k));if(!E.br.ok)(F=M.bottomright.perpOnLine(u,m).sub(M.bottomright)).y<0&&(d.trans=d.trans.add(F));if(!E.tr.ok)(I=M.topright.perpOnLine(m,y).sub(M.topright)).x<0&&(d.trans=d.trans.add(I));if(!E.bl.ok)(A=M.bottomleft.perpOnLine(u,g).sub(M.bottomleft)).x>0&&(d.trans=d.trans.add(A))}}if("cover"==n){var E,R,C=0;if((E={tl:t.pointInRectangle(M.topleft,m,u,g,y),tr:t.pointInRectangle(M.topright,m,u,g,y),br:t.pointInRectangle(M.bottomright,m,u,g,y),bl:t.pointInRectangle(M.bottomleft,m,u,g,y)}).tl.ok||C++,E.tr.ok||C++,E.br.ok||C++,E.bl.ok||C++,!E.tl.ok&&!E.tr.ok&&!E.br.ok&&!E.bl.ok||t.lockcontain||3==C&&0==f.angle)switch(t.lockcontain=!0,(R=t.getRotationQuadrant(f.angle)).Quad){case 0:u.y<=0&&(d.trans.y=d.trans.y+u.y),y.y>=M.bottomleft.y&&(d.trans.y=d.trans.y+(y.y-M.bottomleft.y)),g.x>=M.bottomright.x&&(d.trans.x=d.trans.x+(g.x-M.bottomright.x)),m.x<=0&&(d.trans.x=d.trans.x+m.x);break;case 1:m.y>=M.bottomleft.y&&(d.trans.y=d.trans.y+(m.y-M.bottomleft.y)),y.x>=M.topright.x&&(d.trans.x=d.trans.x-(M.topright.x-y.x)),g.y<=0&&(d.trans.y=d.trans.y+g.y),u.x<=0&&(d.trans.x=d.trans.x+u.x);break;case 2:y.y<=0&&(d.trans.y=d.trans.y+y.y),m.x>=M.bottomright.x&&(d.trans.x=d.trans.x-(M.bottomright.x-m.x)),u.y>=M.bottomleft.y&&(d.trans.y=d.trans.y+(u.y-M.bottomleft.y)),g.x<=0&&(d.trans.x=d.trans.x+g.x);break;case 3:m.y<=0&&(d.trans.y=d.trans.y+m.y),y.x<=0&&(d.trans.x=d.trans.x+y.x),g.y>=M.bottomright.y&&(d.trans.y=d.trans.y+(g.y-M.bottomright.y)),u.x>=M.topright.x&&(d.trans.x=d.trans.x-(M.topright.x-u.x))}}}return d.trans.nonzero()&&!h&&(i.translate(d.trans),s=!0,t.delta.x+=d.trans.x,t.delta.y+=d.trans.y),0!=d.distance&&1!=d.distance&&o&&(2!=o.length||l||(i.scale(c.offset,d.distance),s=!0)),0==d.angle||p||(i.rotateAboutPoint(c.offset,d.angle),s=!0),s&&t._updateElement(i),t.start.angle=c.angle,t.events.move&&t.trigger("move",e),!1},s=function(e){if(!0===t.options.disabled)return!1;if(t.startedresize||t.startedrotate)return!1;if(0==document.querySelectorAll(".transformable-active").length&&t.element.classList.add("transformable-active"),"rotator-box"==t.options.type){var n=e.target.closest("svg");if(n&&!n.classList.contains("transformable-svg-anchor"))return!1;e.stopPropagation()}var s=e.touches;t.start=t._getPoint2(e,s);var a=t.sizes.window;if(t.start.pageX<40||t.start.pageX>a.width-40)return console.log("edge cancel."),!1;if(t.delta={x:0,y:0},s&&2==s.length&&s[0].target&&s[1].target&&s[0].target!==s[1].target)return console.log("Two active elements not supported"),!1;var l=t.matrix;if(t.orig={trans:new r(l.elements[4],l.elements[5]),angle:l.rotation(),scale:l.scaling()},t.start.scale=t.orig.scale,t.started=!0,t.dragging=!1,t.events.start&&t.trigger("start",e),t.setTransition(!1),"mousedown"==e.type){var h=document.querySelector("body");t.on(h,"mousemove.transformable",o),t.on(h,"mouseup.transformable dragend.transformable",i)}},i=function(e){var n=document.querySelector("body");if(t.off(n,"mousemove.transformable",o),t.off(n,"mouseup.transformable dragend.transformable",i),t.element.classList.remove("transformable-active"),t.element.classList.remove("transformable-reset"),!0===t.options.disabled)return!1;t.lockcontain=!1,!0===t.started&&!0===t.dragging&&(t._pushhistory(),t.snapRotation()),!0===t.started&&!1===t.dragging&&t.events.tap&&t.trigger("tap",e),t.dragging=!1,t.started=!1,t.events.stop&&t.trigger("stop",e),t.setTransition(!0);var s=t.rotatorBox,a=t.resizertl,l=t.resizerbr;if(s){var h=t.matrix.scaling();s.scale(new r(0),1/s.matrix.scaling()*(1/h))}if(a&&l){var p=h||t.matrix.scaling();a.style.transform="scale("+1/p+")",l.style.transform="scale("+1/p+")"}};t.on(e,"mousedown.transformable",s),t.on(e,"touchstart.transformable",s),t.on(e,"touchmove.transformable",o),t.on(e,"touchend.transformable",i),t.on(e,"scroll.transformable",function(t){return console.log("tried scroll"),t.preventDefault(),t.stopPropagation(),!1}),(!this.options.disable||this.options.disable&&!this.options.disable.wheel)&&-1==navigator.userAgent.indexOf("Mac OS")&&addWheelListener(e,function(e){if(!0===t.options.disabled)return!1;if(t.startedresize||t.startedrotate)return!1;if("rotator-box"==t.options.type)return!1;e.preventDefault(),e.stopPropagation();var n=Date.now();if((t.lastwheelmove?n-t.lastwheelmove:150)<150&&navigator.userAgent.indexOf("Mac")>-1)return!1;0==document.querySelectorAll(".transformable-active").length&&t.element.classList.add("transformable-active"),t.rotatorBox&&t.rotatorBox.parent.classList.add("transformable-wheel-active"),t._wheelTimer&&clearTimeout(t._wheelTimer);var r,o=t._getPoint2(e),s=t.matrix,i=(s.scaling(),o.deltaXY.y<0?1:-1);t.setTransition(!0),0!=o.deltaXY.y&&(r=1+.05*i,s.scale(o.offset,r),t._updateElement()),t.element.classList.remove("transformable-active"),t._wheelTimer=setTimeout(function(){t._pushhistory(),t.rotatorBox&&t.rotatorBox.parent.classList.remove("transformable-wheel-active")},750),t.lastwheelmove=n})},l.Handlers={Namespaces:{}},l.prototype.on=function(t,e,n,r){var o,s,i,a,h,p=e.split(" ");for(o=0;o<p.length;o++)i=(s=p[o].split("."))[0],a=s.length>1&&s[1],t.addEventListener(i,n,r||!1),l.Handlers.Namespaces[e]||(l.Handlers.Namespaces[e]=[]),a&&(l.Handlers.Namespaces[a]||(l.Handlers.Namespaces[a]=[])),h=l.Handlers.Namespaces[e].push({event:i,func:n,opts:r||!1}),a&&l.Handlers.Namespaces[a].push(l.Handlers.Namespaces[e][h-1])},l.prototype.off=function(t,e,n){var r,o=l.Handlers.Namespaces[e];if(o)for(var s=0;s<o.length;s++)r=o[s],t.removeEventListener(r.event,r.func,r.opts)},l.prototype.Refresh=function(){this.sizes=void 0,this.setInitialSizes(),this.Ancestry.Refresh()},function(){var t;window.addEventListener("resize",function(){clearTimeout(t),t=setTimeout(e,150)});var e=function(){document.querySelectorAll(".transformable").forEach(function(t,e){var n=!!(e=t.getAttribute("data-transformable-id"))&&l.Instance[e];n instanceof l&&n.Refresh()})}}(),"undefined"!=typeof window&&(window.Transformable=l);var h=l;return e=e.default}()});