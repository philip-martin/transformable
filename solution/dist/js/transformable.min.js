var Ancestry=function(t){this.Items=[],this._add(t,t.element),this.Self=t,this._init()};Ancestry.prototype._getScroll=function(){return new Point(window.pageXOffset||document.documentElement.scrollLeft,window.pageYOffset||document.documentElement.scrollTop)},Ancestry.prototype.GetElementSize=function(t,e){e=e||getComputedStyle(t);var n=parseFloat(e.left),r=parseFloat(e.top),i=parseFloat(e.width),o=parseFloat(e.height);return{offset:new Point(n||0,r||0),width:i,height:o,topleft:new Point(0,0),topright:new Point(i,0),bottomright:new Point(i,o),bottomleft:new Point(0,o)}},Ancestry.prototype._debug=function(){this.Items.forEach(function(t,e){console.log(t.matrix.elements)}),this.Items.forEach(function(t,e){console.log([t.element])})},Ancestry.prototype.Refresh=function(){this.Items=[],this._add(this.Self,this.Self.element),this.Init()},Ancestry.prototype._ispercent=function(t){return t.indexOf("%")>-1},Ancestry.prototype._isauto=function(t){return"auto"==t},Ancestry.prototype._pixelFromParent=function(t,e,n){if("0%"===e)return 0;var r=parseFloat(e);switch(t){case"left":r=parseFloat(n.width)*r/100;break;case"top":r=parseFloat(n.height)*r/100}return r},Ancestry.prototype.GetComputedDims=function(t){var e,n,r,i=getComputedStyle(t),o=i.left,a=i.top,s=i.marginTop,l=i.marginLeft,h=this._ispercent(o),c=this._ispercent(a),p=function(t){return parseFloat(t)};return this._isauto(o)&&(o=0),this._isauto(a)&&(a=0),(h||c)&&(r=getComputedStyle(t.parentNode)),h&&(e=this._pixelFromParent("left",o,r)),c&&(n=this._pixelFromParent("top",a,r)),{left:void 0!==e?e:p(o),top:void 0!==n?n:p(a),marginLeft:p(l),marginTop:p(s),transform:i.transform}},Ancestry.prototype._init=function(){for(var t,e,n,r,i,o,a=this.Self.element;a.parentNode&&!a.parentNode.body;){var e=this.GetComputedDims(a.parentNode),t=e.transform,n=/matrix\(\-?[0-9]+[^\)]+\)/.test(t),s=e.top,l=e.left,h=e.marginTop,c=e.marginLeft;if(n||a.parentNode.classList.contains("transformable")||a.classList.contains("transformable")||0!=s||0!=l||0!=h||0!=c)if(i=a.parentNode.getAttribute("data-transformable-id"))(r=Transformable.Instance[i])&&this._add(r);else{var p=!!n&&new Matrix(this.Self._cssStringToArray(t));if(n||0!=s||0!=l||0!=h||0!=c||a.classList.contains("transformable")){o=new Matrix,o.translate(l||0,s||0).translate(c||0,h||0),p&&o.multiply(p.elements);var f=this.GetElementSize(a.parentNode);a.parentNode.style.top=0,a.parentNode.style.left=0,a.parentNode.style.marginLeft=0,a.parentNode.style.marginTop=0,a.parentNode.style.transformOrigin="0 0",a.parentNode.style.transform=this.Self._arrayToCssString(o.elements),this._add(o,a.parentNode,f)}}a=a.parentNode}},Ancestry.prototype._setoffset=function(){if(this.scroll=this._getScroll(),!this.offset){var t,e,n=new Matrix;for(e=0;e<this.Items.length;e++)n.translate(this.Items[e].matrix.translation());for(e=0;e<this.Items.length;e++)if(t=this.Items[e],t.element.classList.contains("transformable")){this.offset=t.transformable.offset.sub(n.translation());break}}},Ancestry.prototype._add=function(t,e){t instanceof Transformable&&this.Items.unshift({matrix:t.matrix,element:e||t.element,rect:t.sizes.element.initial,transformable:t}),t instanceof Matrix&&this.Items.unshift({matrix:t,element:e,rect:this.GetElementSize(e)})},Ancestry.prototype.GetParents=function(){var t=[];return this.Items.forEach(function(e,n){var r,i,o=e.transformable;o||(i=e.element.getAttribute("data-transformable-id"))&&(o=Transformable.Instance[i],e.transformable=o);var r=o?o.matrix:e.matrix;t.push({Matrix:r,Inverse:r.inverse(),Element:e.element})}),t},Ancestry.prototype.TransformCorners=function(t){var e=this.GetMatrix();return{bottomright:e.transformpoint(t.bottomright),bottomleft:e.transformpoint(t.bottomleft),topright:e.transformpoint(t.topright),topleft:e.transformpoint(t.topleft)}},Ancestry.prototype.FirstParent=function(){var t=this,e=t.Items,n=e.length;return n>1&&e[n-2]},Ancestry.prototype.GetMatrix=function(){var t=Matrix.Identity();return this.Items.forEach(function(e,n){t.multiply(e.matrix.elements)}),t},Ancestry.prototype.OffsetFromPoint=function(t,e){var e=e||this.GetParents();this._setoffset();for(var n,r=t,i=Matrix.Identity().translate(this.offset),o=0;o<e.length;o++)n=e[o],i.multiply(n.Matrix.elements);return r=i.inverse().transformpoint(r)};var Matrix=function(t){if(null==t||void 0===t)return Matrix.Identity();if(t instanceof Array)this.elements=t.slice(0);else if(t instanceof Matrix)this.elements=t.elements.slice(0);else{if(6!=arguments.length)throw new Error("Can't create Matrix from supplied arguments. Array of 6 elements, Matrix or nothing only.");this.elements=[];for(var e=0;e<arguments.length;)this.elements.push(arguments[e++])}return this.history={undo:[],redo:[]},this};Matrix.Identity=function(){return new Matrix([1,0,0,1,0,0])},Matrix.prototype={transformpoint:function(t){var e=this.elements;return new Point(t.x*e[0]+t.y*e[2]+e[4],t.x*e[1]+t.y*e[3]+e[5])},multiply:function(t){var e=this.elements,n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=t[0],h=t[1],c=t[2],p=t[3],f=t[4],m=t[5];return this.elements=[n*l+i*h,r*l+o*h,n*c+i*p,r*c+o*p,n*f+i*m+a,r*f+o*m+s],this},elementsequal:function(t,e){return!(!t||!e)&&(t[0]==e[0]&&t[1]==e[1]&&t[2]==e[2]&&t[3]==e[3]&&t[4]==e[4]&&t[5]==e[5])},save:function(t){var e,n=this.history,r="string"==typeof t&&t;if(t&&!r||(t=this.elements),e=n.undo[n.undo.length-1],this.elementsequal(t,e))r&&(n.undo[r]=e);else{var i=n.undo.push(t.slice(0));n.redo=[],r&&(n.undo[r]=n.undo[i-1])}},undo:function(t){var e=this.history.undo,n=(e.length,e.pop()),r="string"==typeof t?e[t]:e[e.length-1];n&&this.history.redo.unshift(n),this.elements=r?r.slice(0):this.identity()},redo:function(){var t=this.history.redo,e=(t.length,t.pop()),n=t[t.length-1];e&&this.history.undo.unshift(e),this.elements=n?n.slice(0):this.identity()},reset:function(){return this.elements=this.identity(),this},determinant:function(){var t=this.elements;return t[0]*t[3]-t[1]*t[2]},inverse:function(){var t=this.elements,e=this.identity(),n=this.determinant();if(n<1e-14)throw"Matrix not invertible.";return e[0]=t[3]/n,e[1]=-t[1]/n,e[2]=-t[2]/n,e[3]=t[0]/n,e[4]=(t[2]*t[5]-t[3]*t[4])/n,e[5]=-(t[0]*t[5]-t[1]*t[4])/n,new Matrix(e)},invert:function(){return this.multiply(this.inverse().elements)},identity:function(){return[1,0,0,1,0,0]},isIdentity:function(){var t=this.elements;return 1===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&0===t[4]&&0===t[5]},translate:function(t,e){return t instanceof Point&&!e?this.multiply([1,0,0,1,t.x,t.y]):this.multiply([1,0,0,1,t,e])},scale:function(t,e){this.multiply([e,0,0,e,0,0]);var n=t.sub(t.scale(e)).scale(1/e);return this.translate(n)},rotateAboutPoint:function(t,e){var n=e*Math.PI/180;return this.multiply([Math.cos(n),Math.sin(n),-Math.sin(n),Math.cos(n),t.x-Math.cos(n)*t.x- -Math.sin(n)*t.y,t.y-Math.sin(n)*t.x-Math.cos(n)*t.y])},rotate:function(t,e){if(t instanceof Point)return this.rotateAboutPoint(t,e);var n=t*Math.PI/180;return this.multiply([Math.cos(n),Math.sin(n),-Math.sin(n),Math.cos(n),0,0])},normaldegree:function(t){return t<0?t+360:t},rotation:function(t){var e=this.elements,n=180*Math.atan2(e[1],e[0])/Math.PI;return t?this.normaldegree(n):n},scaling:function(){return Math.sqrt(Math.pow(this.elements[0],2)+Math.pow(this.elements[1],2))},translation:function(){return new Point(this.elements[4],this.elements[5])}};var Point=function(t,e){void 0===e&&(e=t),this.x=t,this.y=e};Point.prototype={scale:function(t){return new Point(this.x*t,this.y*t)},round:function(t){var t=t?Math.pow(10,t):1;return new Point(Math.round(this.x*t)/t,Math.round(this.y*t)/t)},sub:function(t){return new Point(this.x-t.x,this.y-t.y)},add:function(t){return new Point(this.x+t.x,this.y+t.y)},mult:function(t){return new Point(this.x*t.x,this.y*t.y)},divide:function(t){return new Point(this.x/t.x,this.y/t.y)},nonzero:function(){return 0!=this.x||0!=this.y},equals:function(t){return this.x===t.x&&this.y===t.y},moreoreq:function(t){return{x:this.x>=t.x,y:this.y>=t.y}},lessoreq:function(t){return{x:this.x<=t.x,y:this.y<=t.y}},dot:function(t){return this.x*t.x+this.y*t.y},perpOnLine:function(t,e){var n=((e.y-t.y)*(this.x-t.x)-(e.x-t.x)*(this.y-t.y))/(Math.pow(e.y-t.y,2)+Math.pow(e.x-t.x,2)),r=this.x-n*(e.y-t.y),i=this.y+n*(e.x-t.x);return new Point(r,i)},mag:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}};var PolygonMath={fitWithin:function(t,e,n,r){var i=t/e;return n/r>i?new Size(r*i,r):new Size(n,n/i)},clamp:function(t,e,n){return Math.min(n,Math.max(e,t))},rotatePoly:function(t,e,n){for(var r=0;r<t.length;r++)t[r]=this.rotatePoint(t[r],n,e);return t},rotatePoint:function(t,e,n){var r=Math.cos(n*Math.PI/180)*(t.x-e.x)-Math.sin(n*Math.PI/180)*(t.y-e.y)+e.x,i=Math.sin(n*Math.PI/180)*(t.x-e.x)+Math.cos(n*Math.PI/180)*(t.y-e.y)+e.y;return new Point(r,i)},zoomRotate:function(t,e){},normaliseAngle:function(t){var e=t%360;return e<0&&(e+=360),e}};Size=function(t,e){switch(typeof t){case"object":return this.Width=t.Width,void(this.Height=t.Height);case"number":void 0===e&&(e=t)}this.Width=t,this.Height=e},Size.prototype={Aspect:function(){return this.Width/this.Height},Mult:function(t){return void 0===t.Width&&(t=new Size(t,t)),new Size(this.Width*t.Width,this.Height*t.Height)},Divide:function(t){return void 0===t.Width&&(t=new Size(t,t)),new Size(this.Width/t.Width,this.Height/t.Height)},Sub:function(t){return void 0===t.Width&&(t=new Size(t,t)),new Size(this.Width-t.Width,this.Height-t.Height)},Add:function(t){return void 0===t.Width&&(t=new Size(t,t)),new Size(this.Width+t.Width,this.Height+t.Height)},ToCSS:function(t){var e=t?"px":"%";return{width:this.Width+e,height:this.Height+e}},ToPercent:function(t){return new Size(this.Width/t.Width*100,this.Height/t.Height*100)},ToQueryString:function(){return String.format("w={0}&amp;h={1}",this.Width,this.Height)},Round:function(t){if(!t&&0!==t)return this;var e=10;return 0==t&&(e=1,t=1),new Size(Math.round(this.Width*(t*e))/(t*e),Math.round(this.Height*(t*e))/(t*e))},RoundUp:function(t){var e=Math.ceil(this.Height/t)*t,n=e*this.Aspect();return new Size(n,e)},Equals:function(t){return this.Width==t.Width&&this.Height==t.Height},SwapSign:function(){return new Size(-this.Width,-this.Height)},Scale:function(t){return new Size(this.Width*t,this.Height*t)},BiggerOrEqual:function(t){return this.Width*this.Height>=t.Width*t.Height},SwapVals:function(t){return t?t%180==0?this:t%90==0?new Size(this.Height,this.Width):this:new Size(this.Height,this.Width)},IsValid:function(){return!(null==this.Width||isNaN(this.Width)||null==this.Height||isNaN(this.Height))},BiggestDim:function(){return Math.max(this.Width,this.Height)}},Size.Size0=new Size(0,0),Size.Size05=new Size(.5,.5),Size.Size1=new Size(1,1),Size.Size2=new Size(2,2),Size.Size3=new Size(3,3),Size.Size4=new Size(4,4),Size.Size5=new Size(5,5),Size.Size6=new Size(6,6),Size.Size100=new Size(100,100),function(t,e){function n(e,n,a,s){e[r](o+n,"wheel"==i?a:function(e){!e&&(e=t.event);var n={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==e.type?0:1,deltaX:0,deltaY:0,deltaZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){e.stopPropagation?e.stopPropagation():e.returnValue=!1}};return"mousewheel"==i?(n.deltaY=-.025*e.wheelDelta,e.wheelDeltaX&&(n.deltaX=-.025*e.wheelDeltaX)):n.deltaY=e.detail,a(n)},s||!1)}var r,i,o="";t.addEventListener?r="addEventListener":(r="attachEvent",o="on"),i="onwheel"in e.createElement("div")?"wheel":void 0!==e.onmousewheel?"mousewheel":"DOMMouseScroll",t.addWheelListener=function(t,e,r){n(t,i,e,r),"DOMMouseScroll"==i&&n(t,"MozMousePixelScroll",e,r)}}(window,document);var Transformable=function(t,e){if(e=e||{},t.length&&(t=t[0]),this.options=e,this.element=t,this.element.classList.add("transformable"),this.parent=t.parentNode,this.setInitialSizes(),e&&e.matrix){var n={x:1,y:1};if(e.computedsize&&(e.computedsize.width||e.computedsize.Width)){var r={width:e.computedsize.width||e.computedsize.Width,height:e.computedsize.height||e.computedsize.Height},i=this.sizes.element.initial;n.x=i.width/r.width,n.y=i.height/r.height}e.matrix instanceof Array&&6==e.matrix.length?(e.matrix[4]*=n.x,e.matrix[5]*=n.y,this._setMatrix(new Matrix(e.matrix))):e.matrix instanceof Matrix&&(e.matrix.elements[4]*=n.x,e.matrix.elements[5]*=n.y,this._setMatrix(e.matrix))}this.matrix=this._getMatrix(),this.originalTransition=this._getOriginalTransition(),this.Ancestry=new Ancestry(this),this._setOffset(),this.Ancestry._setoffset(),this.dragging=!1,this.start=null,this.orig=null,this.zooma=.001,this.events={start:e.start,move:e.move,stop:e.stop,tap:e.tap,transition:e.transition},this.element.setAttribute("data-transformable-id",Transformable.Instance.push(this)-1),-1==navigator.userAgent.indexOf("Edge")&&this.element.setAttribute("draggable",!1),void 0!==e.attachevents&&!0!==e.attachevents||!1===e.editable||(this._addEvents(),e.resize&&this.createResizeHandles(e.resize),(!e.disable||e.disable&&!e.disable.rotate)&&this.createRotateHandles(),e.handle&&"rotator-box"==e.type&&this._addRotateEvents(e.handle))};Transformable.Instance=[],Transformable.prototype._getOriginalTransition=function(){var t=getComputedStyle(this.element).transition,e=t.split(","),n=[];for(var r in e)-1==e[r].indexOf("transform ")&&n.push(e[r]);return n.join(",")},Transformable.prototype.tag=function(t){var e=document.createElement("div");return e.innerHTML=t,e.firstChild},Transformable.prototype.createRotateHandles=function(t){if(!t||"rotate"==t){var e=this.tag('<div class="transformable-rotation-box"></div>'),n=this.tag('<svg class="transformable-svg-rotator" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 96 96" style="enable-background:new 0 0 96 96;" xml:space="preserve"><g><circle style="fill:#00A8DF;" cx="48.3" cy="48" r="35.3"/><g><path style="fill:#FFFFFF;" d="M35.2,3.8l4.1,28.5c0.2,1.5,2,2.1,3,1l8.2-8.2c0.7-0.7,1.8-0.7,2.5,0l8.8,8.8c7.8,7.8,9.1,20.2,1.2,28.2l-10,10c-0.7,0.7-1.8,0.7-2.5,0L41,62.6c-1-1-2.8-0.4-3,1l-4.1,28.5c-0.2,1.2,0.8,2.2,2,2l28.5-4.1c1.5-0.2,2.1-2,1-3l-8.9-8.9c-0.7-0.7-0.7-1.8,0-2.5l10-10c9.8-9.8,8.5-25.6-1.2-35.2l-8.8-8.8c-0.7-0.7-0.7-1.8,0-2.5L66.7,8.9c1-1,0.4-2.8-1-3L37.2,1.8C36,1.6,35,2.6,35.2,3.8z"/><g style="opacity:0.5;"><path d="M36.9,1.8c0.1,0,0.2,0,0.3,0l28.5,4.1c1.5,0.2,2.1,2,1,3L56.6,19.1c-0.7,0.7-0.7,1.8,0,2.5l8.8,8.8c9.7,9.7,11,25.5,1.2,35.2l-10,10c-0.7,0.7-0.7,1.8,0,2.5l8.9,8.9c1,1,0.4,2.8-1,3l-28.5,4.1c-0.1,0-0.2,0-0.3,0c-1.1,0-1.9-1-1.8-2.1l4.1-28.5c0.1-1,0.9-1.5,1.8-1.5c0.4,0,0.9,0.2,1.3,0.5l9.5,9.5c0.4,0.4,0.8,0.5,1.3,0.5s0.9-0.2,1.3-0.5l10-10c8-8,6.7-20.3-1.2-28.2L53,25.2c-0.4-0.4-0.8-0.5-1.3-0.5s-0.9,0.2-1.3,0.5l-8.2,8.2c-0.4,0.4-0.8,0.5-1.3,0.5c-0.8,0-1.7-0.6-1.8-1.5L35.2,3.8C35,2.7,35.9,1.8,36.9,1.8 M36.9-0.2c-1.1,0-2.1,0.5-2.9,1.3c-0.7,0.8-1,1.9-0.9,3l4.1,28.5c0.3,1.9,1.9,3.3,3.8,3.3c1,0,2-0.4,2.7-1.1l8.1-8.1l8.7,8.7c7.4,7.4,8,18.6,1.2,25.3l-9.8,9.8l-9.3-9.3c-0.7-0.7-1.7-1.1-2.7-1.1c-1.9,0-3.5,1.4-3.8,3.3l-4.1,28.5c-0.2,1.1,0.2,2.2,0.9,3c0.7,0.8,1.8,1.3,2.9,1.3c0.2,0,0.4,0,0.5,0l28.5-4.1c1.4-0.2,2.6-1.2,3.1-2.6c0.5-1.4,0.1-2.9-0.9-3.9l-8.7-8.7l9.8-9.8c10.2-10.2,9.6-27.2-1.2-38.1l-8.7-8.7l10-10c1-1,1.4-2.5,0.9-3.9c-0.5-1.4-1.6-2.4-3.1-2.6L37.5-0.2C37.3-0.2,37.1-0.2,36.9-0.2L36.9-0.2z"/></g></g></g></svg>'),r=this.tag('<svg class="transformable-svg-anchor" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 96 96" style="enable-background:new 0 0 96 96;" xml:space="preserve"><g><circle style="fill:#00A8DF;" cx="47.6" cy="48.4" r="17.6"/><g><path style="fill:#FFFFFF;" d="M69,46H50V27.2c0-1.4-1.1-2.4-2.5-2.4S45,25.9,45,27.2V46H26.6c-1.4,0-2.4,1.1-2.4,2.5s1.1,2.5,2.4,2.5H45v18.6c0,1.4,1.1,2.4,2.5,2.4s2.5-1.1,2.5-2.4V51h19c1.4,0,2.4-1.1,2.4-2.5S70.3,46,69,46z"/><g style="opacity:0.5;"><path d="M47.5,24.8c1.4,0,2.5,1.1,2.5,2.4V46h19c1.4,0,2.4,1.1,2.4,2.5c0,1.4-1.1,2.5-2.4,2.5H50v18.6c0,1.4-1.1,2.4-2.5,2.4S45,70.9,45,69.6V51H26.6c-1.4,0-2.4-1.1-2.4-2.5c0-1.4,1.1-2.5,2.4-2.5H45V27.2C45,25.9,46.1,24.8,47.5,24.8 M47.5,22.8c-2.5,0-4.5,2-4.5,4.4V44H26.6c-2.5,0-4.4,2-4.4,4.5c0,2.5,2,4.5,4.4,4.5H43v16.6c0,2.5,2,4.4,4.5,4.4s4.5-2,4.5-4.4V53h17c2.5,0,4.4-2,4.4-4.5c0-2.5-2-4.5-4.4-4.5H52V27.2C52,24.8,50,22.8,47.5,22.8L47.5,22.8z"/></g></g></g></svg>'),i=this.tag('<div class="transformable-rotation-line"></div>'),o=this;e.appendChild(i),e.appendChild(r),e.appendChild(n),e.appendChild(this.tag('<div class="transformable-anchor-point"></div>')),"IMG"==this.element.nodeName?this.parent.appendChild(e):this.element.appendChild(e),e.addEventListener("click",function(t){return t.stopPropagation(),!1}),this.rotatorBox=new Transformable(e,{type:"rotator-box",rotatetarget:this,handle:n,disable:{zoom:!0,rotate:!0,resize:!0}});var a=function(){o.rotatorBox&&o.rotatorBox.parent&&o.rotatorBox.parent.classList.remove("transformable-mousedown");var t=document.querySelector("body");o.off(t,"mouseup.rotatormouse")},s=function(){this.classList.add("transformable-mousedown");var t=document.querySelector("body");o.on(t,"mouseup.rotatormouse",a)},l=function(){o._overTimer&&clearTimeout(o._overTimer),o._resizeTimer=setTimeout(function(){o.element.classList.remove("transformable-resize-over")},500),this.classList.remove("transformable-over-active"),this.classList.remove("transformable-over")},h=function(t){t.stopPropagation&&t.stopPropagation(),o._resizeTimer&&clearTimeout(o._resizeTimer),this.classList.add("transformable-over"),this.classList.add("transformable-resize-over"),o.Ancestry.Items.forEach(function(t,e){t._overTimer&&clearTimeout(t._overTimer)}),o._overTimer=setTimeout(function(){var t=o.rotatorBox,e=t.Ancestry;e.FirstParent();parseFloat(getComputedStyle(t.element).width)>=32&&t.parent.classList.add("transformable-over-active");var n=e.Items.length;e.Items.forEach(function(t,e){e<n-2&&t.element.classList.remove("transformable-over-active")})},"number"==typeof t?t:1500)},c=this.rotatorBox.parent;this.on(c,"mouseenter.rotatormouse",h),this.on(c,"mouseleave.rotatormouse",l),this.on(c,"mousedown.rotatormouse",s),this.on(c,"click.rotatormouse",function(){h.apply(this,[0])})}},Transformable.prototype.createResizeHandles=function(t){if("tl-br"==t){var e=this.tag('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="-271 394.9 52 52" style="enable-background:new -271 394.9 52 52;" xml:space="preserve"><g><path style="fill:#00A8DF;" d="M-244.9,421L-244.9,421L-244.9,421L-244.9,421L-244.9,421l26,0.1c0-10.8-6.1-20-16-24.1 c-10-4.1-20.8-2-28.4,5.7c-7.6,7.6-9.7,18.5-5.6,28.4c4.2,10,13.4,16,24.2,15.9L-244.9,421z"/><path style="fill:none;stroke:#FFFFFF;stroke-width:3;" d="M-251.6,414.3"/><path style="fill:none;stroke:#FFFFFF;stroke-width:3;" d="M-236.6,414.3"/></g><g><path style="fill:#FFFFFF;" d="M-227,419.5l-7.6-4.4c-1.1-0.6-2.4,0.2-2.4,1.4v1.9h-5.6v-5.5h2c1.2,0,2-1.3,1.4-2.4l-4.4-7.6 c-0.6-1.1-2.1-1.1-2.7,0l-4.4,7.6c-0.6,1.1,0.2,2.4,1.4,2.4h2v5.5h-5.6v-1.9c0-1.2-1.3-2-2.4-1.4l-7.6,4.4c-1.1,0.6-1.1,2.1,0,2.7 l7.6,4.4c1.1,0.6,2.4-0.2,2.4-1.4v-2h5.6v5.6h-2c-1.2,0-2,1.3-1.4,2.4l4.4,7.6c0.6,1.1,2.1,1.1,2.7,0l4.4-7.6 c0.6-1.1-0.2-2.4-1.4-2.4h-2v-5.6h5.6v2c0,1.2,1.3,2,2.4,1.4l7.6-4.4C-225.9,421.7-225.9,420.1-227,419.5z"/><path style="opacity:0.5;fill:#231F20;" d="M-245,402.1c0.5,0,1.1,0.3,1.4,0.8l4.4,7.6c0.6,1.1-0.2,2.4-1.4,2.4h-2v5.5h5.6v-1.9 c0-0.9,0.8-1.6,1.6-1.6c0.3,0,0.5,0.1,0.8,0.2l7.6,4.4c1.1,0.6,1.1,2.1,0,2.7l-7.6,4.4c-0.3,0.1-0.5,0.2-0.8,0.2 c-0.8,0-1.6-0.7-1.6-1.6v-2h-5.6v5.6h2c1.2,0,2,1.3,1.4,2.4l-4.4,7.6c-0.3,0.5-0.8,0.8-1.4,0.8c-0.5,0-1.1-0.3-1.4-0.8l-4.4-7.6 c-0.6-1.1,0.2-2.4,1.4-2.4h2v-5.6h-5.6v2c0,0.9-0.8,1.6-1.6,1.6c-0.3,0-0.5-0.1-0.8-0.2l-7.6-4.4c-1.1-0.6-1.1-2.1,0-2.7l7.6-4.4 c0.3-0.1,0.5-0.2,0.8-0.2c0.8,0,1.6,0.7,1.6,1.6v1.9h5.6v-5.5h-2c-1.2,0-2-1.3-1.4-2.4l4.4-7.6C-246.1,402.3-245.5,402.1-245,402.1 M-245,400.6c-1.1,0-2.1,0.6-2.6,1.5l-4.4,7.6c-0.5,0.9-0.5,2.1,0,3c0.5,0.9,1.5,1.5,2.6,1.5h0.5v2.7h-2.7v-0.5c0-1.7-1.4-3-3-3 c-0.5,0-1,0.1-1.5,0.4l-7.6,4.4c-0.9,0.5-1.5,1.5-1.5,2.6c0,1.1,0.6,2.1,1.5,2.6l7.6,4.4c0.5,0.3,1,0.4,1.5,0.4c1.7,0,3-1.4,3-3\tv-0.6h2.7v2.8h-0.5c-1.1,0-2.1,0.6-2.6,1.5c-0.5,0.9-0.5,2.1,0,3l4.4,7.6c0.5,0.9,1.5,1.5,2.6,1.5c1.1,0,2.1-0.6,2.6-1.5l4.4-7.6 c0.5-0.9,0.5-2.1,0-3c-0.5-0.9-1.5-1.5-2.6-1.5h-0.5v-2.8h2.7v0.6c0,1.7,1.4,3,3,3c0.5,0,1-0.1,1.5-0.4l7.6-4.4\tc0.9-0.5,1.5-1.5,1.5-2.6c0-1.1-0.6-2.1-1.5-2.6l-7.6-4.4c-0.5-0.3-1-0.4-1.5-0.4c-1.7,0-3,1.4-3,3v0.5h-2.7v-2.7h0.5\tc1.1,0,2.1-0.6,2.6-1.5c0.5-0.9,0.5-2.1,0-3l-4.4-7.6C-242.9,401.2-243.9,400.6-245,400.6L-245,400.6z"/></g></svg>'),n=this.tag('<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="-271 394.9 52 52" style="enable-background:new -271 394.9 52 52;" xml:space="preserve"><g><path style="fill:#00A8DF;" d="M-245,420.9L-245,420.9L-245,420.9L-245,420.9L-245,420.9l-26-0.1c0,10.8,6.1,20,16,24.1 c10,4.1,20.8,2,28.4-5.7c7.6-7.6,9.7-18.5,5.6-28.4c-4.2-10-13.4-16-24.2-15.9L-245,420.9z"/></g><g><path style="fill:#FFFFFF;" d="M-245.8,423l-2.5-2.5l-2.1,2.1c-0.9,0.9-2.3,0.5-2.6-0.7l-1.6-9.2c-0.3-1.2,0.8-2.3,1.9-1.9l9.2,1.6 c1.2,0.3,1.6,1.8,0.7,2.6l-2.1,2.1l2.5,2.5l2.7,2.7l-1-1l2.1-2.1c0.9-0.9,2.3-0.5,2.6,0.7l1.6,9.2c0.3,1.2-0.8,2.3-1.9,1.9 l-9.2-1.6c-1.2-0.3-1.6-1.8-0.7-2.6l2.1-2.1l-3.2-3.2L-245.8,423z"/><path style="opacity:0.5;fill:#231F20;" d="M-239.6,422.3l-1-1l2.1-2.1c0.7-0.7,1.7-0.6,2.2,0c0.2,0.2,0.3,0.4,0.4,0.7l1.6,9.2 c0.3,1.2-0.8,2.3-1.9,1.9l-9.2-1.6c-0.3-0.1-0.5-0.2-0.7-0.4c-0.6-0.6-0.7-1.6,0-2.2l2.1-2.1l-3.2-3.2l1.5,1.5l-2.5-2.5l-2.1,2.1 c-0.7,0.7-1.7,0.6-2.2,0c-0.2-0.2-0.3-0.4-0.4-0.7l-1.6-9.2c-0.3-1.2,0.8-2.3,1.9-1.9l9.2,1.6c0.3,0.1,0.5,0.2,0.7,0.4 c0.6,0.6,0.7,1.6,0,2.2l-2.1,2.1l2.5,2.5L-239.6,422.3z M-242.3,417.5l-0.5-0.5l1-1c1.2-1.2,1.2-3.1,0-4.3 c-0.4-0.4-0.8-0.6-1.4-0.8l-9.2-1.6c-1.1-0.3-2.1,0-2.9,0.8c-0.8,0.8-1.1,1.9-0.8,2.9l1.6,9.2c0.1,0.5,0.4,1,0.8,1.4 c1.2,1.2,3.1,1.2,4.3,0l1.1-1.1l0.5,0.5l0.5,0.5l1.2,1.2l-1.1,1.1c-1.2,1.2-1.2,3.1,0,4.3c0.4,0.4,0.8,0.6,1.4,0.8l9.2,1.6 c1.1,0.3,2.1,0,2.9-0.8c0.8-0.8,1.1-1.9,0.8-2.9l-1.6-9.2c-0.1-0.5-0.4-1-0.8-1.4c-1.2-1.2-3.1-1.2-4.3,0l-1,1l-1.2-1.2"/></g></svg>'),r=this.tag('<div class="transformable-resize-button"></div>'),i=r.cloneNode();r.classList.add("tl"),r.appendChild(e),i.classList.add("br"),i.appendChild(n),this.resizertl=r,this.resizerbr=i,this.element.appendChild(r),this.element.appendChild(i),this._addResizeEvents(r,i)}},Transformable.prototype.zoom=function(t){var e=this.Ancestry.OffsetFromPoint(this._findCentreInWindow());return this.scale(e,1+.05*t),this},Transformable.prototype.scale=function(t,e){return this.matrix.scale(t,e),this.setTransition(!0),this._updateElement(),this},Transformable.prototype.translate=function(t,e,n){return this.matrix.translate(t,e),this.setTransition(n),this._updateElement(),this},Transformable.prototype.rotate=function(t,e,n,r){return t instanceof Point&&t&&void 0!==t||(t=this.Ancestry.OffsetFromPoint(this._findCentreInWindow())),t instanceof Point&&r&&(t=this.Ancestry.OffsetFromPoint(t)),this.matrix.rotate(t,e),this.lastrotationpoint=t,void 0!==n&&!1!==n||this.setTransition(!1),this._updateElement(),this},Transformable.prototype.straighten=function(){var t=this.matrix.rotation();return this.rotate(new Point(this.sizes.element.initial.width/2,this.sizes.element.initial.height/2),-t,!0),this},Transformable.prototype.fittoparent=function(){var t=new Point(this.sizes.element.initial.width,this.sizes.element.initial.height),e=this.Ancestry,n=e.GetParents(),r=e.FirstParent(),i=r.rect,o=this.matrix.inverse(),a=o.transformpoint(i.topleft),s=o.transformpoint(i.topright),l=o.transformpoint(i.bottomleft),h=(o.transformpoint(i.bottomright),new Point(this._distanceBetweenPoints(a,s),this._distanceBetweenPoints(a,l))),c=h.divide(t),p=Math.min(c.x,c.y);return this.scale(new Point(0,0),p),this.centreinparent(!0,n),this.straighten(),this},Transformable.prototype.filltoparent=function(t){var e=new Point(this.sizes.element.initial.width,this.sizes.element.initial.height),n=this.Ancestry,r=n.GetParents(),i=n.FirstParent(),o=i.rect,a=this.matrix.inverse(),s=a.transformpoint(o.topleft),l=a.transformpoint(o.topright),h=a.transformpoint(o.bottomleft),c=(a.transformpoint(o.bottomright),new Point(this._distanceBetweenPoints(s,l),this._distanceBetweenPoints(s,h))),p=c.divide(e),f=Math.max(p.x,p.y);return this.scale(new Point(0,0),f),this.centreinparent(!0,r),this.straighten(),this},Transformable.prototype._getRect=function(t){return t.getBoundingClientRect()},Transformable.prototype.reset=function(t){if(this.InitialMatrix?this.matrix.elements=this.InitialMatrix.slice(0):this.matrix.reset(),this.setTransition(void 0===t||t),this.transition){var e=this;this.delta&&(this.delta.x||this.delta.y)&&(this.element.classList.add("transformable-reset"),this.on(this.element,"transitionend.reset",function(){this.classList.remove("transformable-reset"),e.off(this,"transitionend.reset")}))}return this._updateElement(),this},Transformable.prototype.hasHistoryKey=function(t){return this.matrix.history.undo[t]instanceof Array},Transformable.prototype.undo=function(t){return this.matrix.undo(t),this.setTransition(!0),this._updateElement(),this},Transformable.prototype.redo=function(){return this.matrix.redo(),this.setTransition(!0),this._updateElement(),this},Transformable.prototype.setInitialSizes=function(){if(!this.sizes){var t=window.getComputedStyle(this.element),e=parseFloat(t.width),n=parseFloat(t.height),r=parseFloat(t.left),i=parseFloat(t.top);this.sizes={element:{initial:{offset:new Point(r,i),width:e,height:n,topleft:new Point(0,0),topright:new Point(e,0),bottomright:new Point(e,n),bottomleft:new Point(0,n)}},window:{width:parseFloat(getComputedStyle(document.body.parentNode).width)}}}},Transformable.prototype._getOffset=function(t,e){var n=this._getRect(t),r=this.Ancestry._getScroll(),i=getComputedStyle(t),o=new Point(parseFloat(i.left),parseFloat(i.top)),a=new Point(n.left+r.x,n.top+r.y);return{offset:a,topleft:a,bottomright:new Point(n.right,n.bottom),topright:new Point(n.right,n.top),bottomleft:new Point(n.left,n.bottom),pos:o}},Transformable.prototype._setOffset=function(){if(!this.offset){var t=this._getOffset(this.element,!0);return this.offset=t.offset,void(this.initialoffset=t.offset)}},Transformable.prototype._getParentMatrix=function(){var t=this.element.parentElement.closest(".transformable");return this.parentmatrix=null==t?Matrix.Identity():this._getMatrix(t),this.parentmatrix},Transformable.prototype._cssStringToArray=function(t){var e=t.match(/[0-9e., -]+/)[0].split(", ");return e.forEach(function(t,n){e[n]=parseFloat(t)}),e},Transformable.prototype._arrayToCssString=function(t){return"matrix("+t.join(",")+")"},Transformable.prototype._getMatrix=function(t){var e,n=t||this.element,r=getComputedStyle(n),i=getComputedStyle(this.parent),o=r.transform,a=r.top.indexOf("%")>-1?parseFloat(i.height)*parseFloat(r.top)/100:parseFloat(r.top),s=r.left.indexOf("%")>-1?parseFloat(i.width)*parseFloat(r.left)/100:parseFloat(r.left),l=parseFloat(r.marginTop),h=parseFloat(r.marginLeft),c=parseFloat(r.borderTopWidth),p=parseFloat(r.borderLeftWidth);if(/matrix\(\-?[0-9]+[^\)]+\)/.test(o)){var e=this._cssStringToArray(o);this.InitialMatrix||(this.InitialMatrix=e.slice(0))}e=new Matrix(e||[1,0,0,1,0,0]);this.options.type;return(s||a||l||h||c||p)&&(e.translate(s||0,a||0),e.translate(h||0,l||0),e.translate(p||0,c||0),n.style.marginTop=0,n.style.marginLeft=0,n.style.top=0,n.style.left=0,n.style.marginTop=-(c||0)+"px",n.style.marginLeft=-(c||0)+"px",this.matrix=e,this._updateElement(),this.InitialMatrix=e.elements.slice(0)),e},Transformable.prototype.setTransition=function(t){if("boolean"==typeof t){var e=this.transition,n=this.originalTransition,r=n?n.split(","):[];1==t&&e!=t&&(r.push("transform 0.5s"),this.element.style.transition=r.join(",")),0==t&&e!=t&&(r.push("transform 0s"),this.element.style.transition=r.join(",")),this.transition=t}},Transformable.prototype._updateElement=function(){var t=this.matrix,e="matrix("+t.elements.join(",")+")";this.element.style.transform=e},Transformable.prototype._pushhistory=function(){this.matrix.save()},Transformable.prototype._setMatrix=function(t){this.matrix=t,this._updateElement(t)},Transformable.prototype._getPageXY=function(t,e){var n,r,i,o;return e?2==e.length?(n=this._getMiddle(e),r=this._getRotation(e),i=new Point(e[0].pageX,e[0].pageY),o=new Point(e[1].pageX,e[1].pageY)):(n=new Point(e[0].pageX,e[0].pageY),r=this.matrix.rotation()):(n=new Point(t.pageX,t.pageY),r=this.matrix.rotation()),{point:n,angle:r,p1:i,p2:o}},Transformable.prototype._getPoint2=function(t,e){var n=this._getPageXY(t,e),r=null,i=this.Ancestry,o=i.GetParents(),a=i.OffsetFromPoint(n.point,o),s=n.p1&&n.p2?this._distanceBetweenPoints(i.OffsetFromPoint(n.p1,o),i.OffsetFromPoint(n.p2,o)):0;return void 0!==t.deltaX&&(r=new Point(t.deltaX,t.deltaY)),{offset:a,pageXY:n.point,pageX:n.point.x,pageY:n.point.y,angle:n.angle,distance:s,deltaXY:r}},Transformable.prototype._distanceBetweenPoints=function(t,e){var n=t.pageX?{x:"pageX",y:"pageX"}:{x:"x",y:"y"};return Math.sqrt(Math.pow(Math.abs(e[n.x]-t[n.x]),2)+Math.pow(Math.abs(e[n.y]-t[n.y]),2))},Transformable.prototype._getMiddle=function(t){var e=t[0],n=t[1],r=(n.pageX-e.pageX)/2+e.pageX,i=(n.pageY-e.pageY)/2+e.pageY;return new Point(r,i)},Transformable.prototype._getDistance2=function(t,e){var n=this.Ancestry;e=e||n.GetParents();var r=n.OffsetFromPoint(new Point(t[0].pageX,t[0].pageY),e),i=n.OffsetFromPoint(new Point(t[1].pageX,t[1].pageY),e);return this._distanceBetweenPoints(r,i)},Transformable.prototype._getRotation=function(t,e){var n;return n=180*Math.atan2((t[0].pageY||t[0].y)-(t[1].pageY||t[1].y),(t[0].pageX||t[0].x)-(t[1].pageX||t[1].x))/Math.PI,e?this.matrix.normaldegree(n):n},Transformable.prototype.snapRotation=function(){if(!this.options.disable||!this.options.disable.rotate){var t=this.matrix.rotation(),e=t-15*Math.round(t/15),n=Math.abs(e),r=this.sizes.element.initial;if(this.setTransition(!0),n<=3&&n>0){var i=this.lastrotationpoint||new Point(r.width/2,r.height/2);this.rotate(i,-e),this.lastlastrotationpoint=void 0,this._pushhistory()}var o;switch(t=this.matrix.rotation(),Math.abs(Math.round(10*t)/10)){case 0:case 180:o="Horizontal";break;case 90:o="Vertical";break;default:o="Rotation: "+Math.round(10*t)/10+"&deg;"}this.showMessage(o,"sticky",2e3)}},Transformable.prototype.showMessage=function(t,e,n){console.log(t)},Transformable.prototype._findCentreInWindow=function(){var t=this._getRect(this.parent);return new Point(t.left+t.width/2,t.top+t.height/2)},Transformable.prototype.centreinparent=function(t,e){var n=this.transition,r=this.Ancestry;this.setTransition(t),e=e||r.GetParents();var i=getComputedStyle(this.parent),o=new Point(parseFloat(i.width)/2,parseFloat(i.height)/2),a=this.matrix.inverse().transformpoint(o);this.translate(a.sub(new Point(this.sizes.element.initial.width/2,this.sizes.element.initial.height/2))),this.setTransition(n)},Transformable.prototype.pointInRectangle=function(t,e,n,r,i){var o=n.sub(e),a=t.sub(e),s=r.sub(n),l=t.sub(n),h=o.dot(a),c=o.dot(o),p=s.dot(l),f=s.dot(s);return{dot_abap:h,dot_abab:c,dot_bcbp:p,dot_bcbc:f,ok:0<=h&&Math.round(10*h)/10<=Math.round(10*c)/10&&0<=p&&Math.round(10*p)/10<=Math.round(10*f)/10}},Transformable.prototype.trigger=function(t,e){"function"==typeof this.events[t]&&this.events[t].apply(this,[this.element,e])},Transformable.prototype._getRotatorPoints=function(t,e){var n,r=this.anchor.TL,i=t.touches,o=this.Ancestry;e=e||o.GetParents(),o._setoffset(),n=i?new Point(i[0].pageX,i[0].pageY):new Point(t.pageX,t.pageY);var a=Math.round(100*this._getRotation([r.add(o.scroll),n],!1))/100;return{deltaXY:null,offset:o.OffsetFromPoint(n,e),pageXY:n,pageX:n.x,pageY:n.y,angle:a,distance:0}},Transformable.prototype._addRotateEvents=function(t){var e=this,n=function(t){if(!e.startedrotate)return!1;e.draggingrotate=!0,
t.preventDefault(),t.stopPropagation();var n=t.touches,r=!1;if(n&&2==n.length)return!1;var i=e._getRotatorPoints(t),o=(e.origrotate,e.startrotate),a=e.matrix,s={angle:Math.round(100*(i.angle-o.angle))/100};0!=s.angle&&(e.parent!=e.options.rotatetarget.element&&(a.rotateAboutPoint(new Point(0),s.angle),r=!0),e.options.rotatetarget instanceof Transformable&&e.options.rotatetarget.rotate(e.anchor.TL.add(e.Ancestry.scroll),s.angle,!1,!0)),r&&e._updateElement(a),e.startrotate.angle=i.angle},r=function(t){t.preventDefault(),t.stopPropagation(),e.element.classList.remove("transformable-active"),e.startedrotate=!1,e.draggingrotate=!1,e.off(document.querySelector("body"),"mouseup.transformable dragend.transformable",r),e.options.rotatetarget instanceof Transformable&&(e.options.rotatetarget.events.stop&&e.options.rotatetarget.trigger("stop",t),e.options.rotatetarget.snapRotation()),e.events.stop&&e.trigger("stop",t),e.snapRotation()};_dostart=function(t){if(!0===e.options.disabled)return!1;if(e.startedresize)return!1;0==document.querySelectorAll(".transformable-active").length&&e.element.classList.add("transformable-active");var i=e.matrix;e.origrotate={trans:new Point(i.elements[4],i.elements[5]),angle:i.rotation(!0),scale:i.scaling()};var o=t.touches;if(o&&2==o.length&&o[0].target&&o[1].target&&o[0].target!==o[1].target)return console.log("Two active elements not supported"),!1;e.anchor=e.anchor||{},e.anchor.clientRect=e._getRect(e.element.querySelector(".transformable-anchor-point")),e.anchor.TL=new Point(e.anchor.clientRect.left,e.anchor.clientRect.top),e.startrotate=e._getRotatorPoints(t),e.startrotate.scale=e.origrotate.scale,e.startedrotate=!0,e.draggingrotate=!1,e.setTransition(!1),t.stopPropagation();var a=document.querySelector("body");"mousedown"==t.type&&(e.on(a,"mousemove.transformable",n),e.on(a,"mouseup.transformable dragend.transformable",r))},this.on(t,"mousedown.transformable touchstart.transformable",_dostart),this.on(t,"touchmove.transformable",n),this.on(t,"touchend.transformable",r)},Transformable.prototype._addResizeEvents=function(t,e){var n=this,r=this.element,i=(n.options,function(t){if(!n.element.classList.contains("transformable-active"))return!1;if(!n.startedresize)return!1;n.draggingresize=!0,t.preventDefault(),t.stopPropagation();var e=t.touches;if(e&&2==e.length)return!1;var i=n._getPoint2(t,e),o=(n.origresize,n.startresize),a=getComputedStyle(r),s={trans:i.offset.sub(o.offset),angle:Math.round(100*(i.angle-o.angle))/100,distance:0!=o.distance?Math.round(i.distance/((o.distance+i.distance)/2)*1e3)/1e3:0};if(s.trans.nonzero()){var l=parseFloat(a.height),h=parseFloat(a.width),c=n.w-h,p=n.h-l,f=h+s.trans.x+c,m=l+s.trans.y+p;r.style.width=f+"px",r.style.height=m+"px",n.sizes.element.initial.bottomright=new Point(f,m),n.sizes.element.initial.topright.x=f,n.sizes.element.initial.bottomleft.y=m,n.sizes.element.initial.width=f,n.sizes.element.initial.height=m}return n.startresize.angle=i.angle,!1}),o=function(t){0==document.querySelectorAll(".transformable-active").length&&n.element.classList.add("transformable-active"),console.log("_resize.start"),t.preventDefault(),t.stopPropagation();var e=n.matrix;n.origresize={trans:new Point(e.elements[4],e.elements[5]),angle:e.rotation(),scale:e.scaling()};var o=t.touches;n.startresize=n._getPoint2(t,o),n.startresize.scale=n.origresize.scale,n.startedresize=!0,n.draggingresize=!1;var s=getComputedStyle(r);if(n.h=parseFloat(s.height),n.w=parseFloat(s.width),void 0===n.contained&&(n.contained=!0),n.events.startresize&&n.trigger("startresize",t),n.setTransition(!1),"mousedown"==t.type){var l=document.querySelector("body");n.on(l,"mousemove.transformable",i),n.on(l,"mouseup.transformable dragend.transformable",a)}return!1},a=function(){var t=document.querySelector("body");if(n.off(t,"mousemove.transformable",i),n.off(t,"mouseup.transformable dragend.transformable",a),!0===n.options.disabled)return!1;n.element.classList.remove("transformable-active"),n.startedresize=!1,n.draggingresize=!1};n.on(e,"mousedown.transformable",o),n.on(e,"touchstart.transformable",o),n.on(e,"touchmove.transformable",i),n.on(e,"touchend.transformable",a)},Transformable.prototype.getRotationQuadrant=function(t){var e=(void 0!==t?t:this.matrix.rotation())%360;return e<0&&(e+=360),{Angle:e,Quad:Math.floor(e/90),Horiz:0==e||180==e,Vert:90==e||270==e}},Transformable.prototype._addEvents=function(){var t=this,e=this.element,n=this.options&&this.options.contain;"function"==typeof this.events.transition&&e.addEventListener("transitionend",this.events.transition);var r=function(e){if(!0===t.options.disabled)return!1;if(!t.element.classList.contains("transformable-active"))return!1;if(!t.started||t.startedresize||t.startedrotate)return!1;t.dragging=!0,e.preventDefault(),e.stopPropagation();var r=e.touches,i=!1;if(r&&2==r.length&&r[0].target&&r[1].target&&r[0].target!==r[1].target)return console.log("Two active elements not supported"),!1;var o=t.matrix,a=(o.rotation(),t.options.disable),s=!1,l=!1,h=!1;a&&(s=a.zoom||a.scale,h=a.rotate,l=a.translate);var c=t._getPoint2(e,r),p=(t.orig,t.start),f={trans:c.offset.sub(p.offset),angle:Math.round(100*(c.angle-p.angle))/100,distance:0!=p.distance?Math.round(c.distance/((p.distance+c.distance)/2)*1e3)/1e3:0};if(n&&0==f.angle&&(!r||r&&1==r.length)){var m,d,u,g,y=t.Ancestry,v=y.FirstParent(),b=v.rect,x=o.inverse(),w=b.topleft,P=b.topright,z=b.bottomright,M=b.bottomleft;m=x.transformpoint(w).sub(f.trans),d=x.transformpoint(P).sub(f.trans),u=x.transformpoint(z).sub(f.trans),g=x.transformpoint(M).sub(f.trans),p.size?p.size=0!=f.distance?new Point(t._distanceBetweenPoints(m,d),t._distanceBetweenPoints(m,g)):p.size:p.size=new Point(t._distanceBetweenPoints(m,d),t._distanceBetweenPoints(m,g));var T=t.sizes.element.initial;t.options;if("enclose"==n){var _={tl:t.pointInRectangle(T.topleft,m,d,u,g),tr:t.pointInRectangle(T.topright,m,d,u,g),br:t.pointInRectangle(T.bottomright,m,d,u,g),bl:t.pointInRectangle(T.bottomleft,m,d,u,g)},L=0;_.tl.ok&&L++,_.tr.ok&&L++,_.br.ok&&L++,_.bl.ok&&L++;if(!(4==L)){var S=t.getRotationQuadrant(p.angle);switch(S.Quad){case 0:if(0==S.Angle){if(!_.br.ok){var F=T.bottomright.perpOnLine(d,u).sub(T.bottomright),A=T.bottomright.perpOnLine(g,u).sub(T.bottomright);F.x<0&&(f.trans=f.trans.add(F)),A.y<0&&(f.trans=f.trans.add(A))}if(!_.tl.ok){var k=T.topleft.perpOnLine(m,g),O=T.topleft.perpOnLine(m,d);k.x>0&&(f.trans=f.trans.add(k)),O.y>0&&(f.trans=f.trans.add(O))}}else{if(!_.bl.ok){var I=T.bottomleft.perpOnLine(m,g).sub(T.bottomleft);I.x>0&&(f.trans=f.trans.add(I))}if(!_.br.ok){var A=T.bottomright.perpOnLine(g,u).sub(T.bottomright);A.y<0&&(f.trans=f.trans.add(A))}if(!_.tr.ok){var H=T.topright.perpOnLine(d,u).sub(T.topright);H.x<0&&(f.trans=f.trans.add(H))}if(!_.tl.ok){var O=T.topleft.perpOnLine(m,d);O.y>0&&(f.trans=f.trans.add(O))}}break;case 3:if(270==S.Angle){if(!_.tl.ok){var O=T.topleft.perpOnLine(m,g),k=T.topleft.perpOnLine(g,u);k.x>0&&(f.trans=f.trans.add(k)),O.y>0&&(f.trans=f.trans.add(O))}if(!_.br.ok){var F=T.bottomright.perpOnLine(m,d).sub(T.bottomright),A=T.bottomright.perpOnLine(u,d).sub(T.bottomright);F.x<0&&(f.trans=f.trans.add(F)),A.y<0&&(f.trans=f.trans.add(A))}}else{if(!_.tl.ok){var k=T.topleft.perpOnLine(m,g);k.x>0&&(f.trans=f.trans.add(k))}if(!_.br.ok){var F=T.bottomright.perpOnLine(d,u).sub(T.bottomright);F.x<0&&(f.trans=f.trans.add(F))}if(!_.tr.ok){var E=T.topright.perpOnLine(m,d).sub(T.topright);E.y>0&&(f.trans=f.trans.add(E))}if(!_.bl.ok){var R=T.bottomleft.perpOnLine(g,u).sub(T.bottomleft);R.y<0&&(f.trans=f.trans.add(R))}}break;case 1:if(90==S.Angle){if(!_.tl.ok){var k=T.topleft.perpOnLine(d,m),O=T.topleft.perpOnLine(d,u);k.x>0&&(f.trans=f.trans.add(k)),O.y>0&&(f.trans=f.trans.add(O))}if(!_.br.ok){var F=T.bottomright.perpOnLine(u,g).sub(T.bottomright),A=T.bottomright.perpOnLine(m,g).sub(T.bottomright);F.x<0&&(f.trans=f.trans.add(F)),A.y<0&&(f.trans=f.trans.add(A))}}else{if(!_.tl.ok){var k=T.topleft.perpOnLine(d,u);k.x>0&&(f.trans=f.trans.add(k))}if(!_.br.ok){var F=T.bottomright.perpOnLine(m,g).sub(T.bottomright);F.x<0&&(f.trans=f.trans.add(F))}if(!_.tr.ok){var E=T.topright.perpOnLine(g,u).sub(T.topright);E.y>0&&(f.trans=f.trans.add(E))}if(!_.bl.ok){var R=T.bottomleft.perpOnLine(d,m).sub(T.bottomleft);R.y<0&&(f.trans=f.trans.add(R))}}break;case 2:if(180==S.Angle){if(!_.tl.ok){var k=T.topleft.perpOnLine(u,g),O=T.topleft.perpOnLine(m,g);k.y>0&&(f.trans=f.trans.add(k)),O.y>0&&(f.trans=f.trans.add(O))}if(!_.br.ok){var F=T.bottomright.perpOnLine(d,m).sub(T.bottomright),A=T.bottomright.perpOnLine(d,u).sub(T.bottomright);F.y<0&&(f.trans=f.trans.add(F)),A.y<0&&(f.trans=f.trans.add(A))}}if(!_.tl.ok){var k=T.topleft.perpOnLine(u,g);k.y>0&&(f.trans=f.trans.add(k))}if(!_.br.ok){var F=T.bottomright.perpOnLine(d,m).sub(T.bottomright);F.y<0&&(f.trans=f.trans.add(F))}if(!_.tr.ok){var E=T.topright.perpOnLine(m,g).sub(T.topright);E.x<0&&(f.trans=f.trans.add(E))}if(!_.bl.ok){var R=T.bottomleft.perpOnLine(d,u).sub(T.bottomleft);R.x>0&&(f.trans=f.trans.add(R))}}}}if("cover"==n){var _={tl:t.pointInRectangle(T.topleft,m,d,u,g),tr:t.pointInRectangle(T.topright,m,d,u,g),br:t.pointInRectangle(T.bottomright,m,d,u,g),bl:t.pointInRectangle(T.bottomleft,m,d,u,g)},C=0;if(_.tl.ok||C++,_.tr.ok||C++,_.br.ok||C++,_.bl.ok||C++,!_.tl.ok&&!_.tr.ok&&!_.br.ok&&!_.bl.ok||t.lockcontain||3==C&&0==p.angle){t.lockcontain=!0;var S=t.getRotationQuadrant(p.angle);switch(S.Quad){case 0:d.y<=0&&(f.trans.y=f.trans.y+d.y),g.y>=T.bottomleft.y&&(f.trans.y=f.trans.y+(g.y-T.bottomleft.y)),u.x>=T.bottomright.x&&(f.trans.x=f.trans.x+(u.x-T.bottomright.x)),m.x<=0&&(f.trans.x=f.trans.x+m.x);break;case 1:m.y>=T.bottomleft.y&&(f.trans.y=f.trans.y+(m.y-T.bottomleft.y)),g.x>=T.topright.x&&(f.trans.x=f.trans.x-(T.topright.x-g.x)),u.y<=0&&(f.trans.y=f.trans.y+u.y),d.x<=0&&(f.trans.x=f.trans.x+d.x);break;case 2:g.y<=0&&(f.trans.y=f.trans.y+g.y),m.x>=T.bottomright.x&&(f.trans.x=f.trans.x-(T.bottomright.x-m.x)),d.y>=T.bottomleft.y&&(f.trans.y=f.trans.y+(d.y-T.bottomleft.y)),u.x<=0&&(f.trans.x=f.trans.x+u.x);break;case 3:m.y<=0&&(f.trans.y=f.trans.y+m.y),g.x<=0&&(f.trans.x=f.trans.x+g.x),u.y>=T.bottomright.y&&(f.trans.y=f.trans.y+(u.y-T.bottomright.y)),d.x>=T.topright.x&&(f.trans.x=f.trans.x-(T.topright.x-d.x))}}}}return f.trans.nonzero()&&!l&&(o.translate(f.trans),i=!0,t.delta.x+=f.trans.x,t.delta.y+=f.trans.y),0!=f.distance&&1!=f.distance&&r&&(2!=r.length||s||(o.scale(c.offset,f.distance),i=!0)),0==f.angle||h||(o.rotateAboutPoint(c.offset,f.angle),i=!0),i&&t._updateElement(o),t.start.angle=c.angle,t.events.move&&t.trigger("move",e),!1},i=function(e){if(!0===t.options.disabled)return!1;if(t.startedresize||t.startedrotate)return!1;if(0==document.querySelectorAll(".transformable-active").length&&t.element.classList.add("transformable-active"),"rotator-box"==t.options.type){var n=e.target.closest("svg");if(n&&!n.classList.contains("transformable-svg-anchor"))return!1;e.stopPropagation()}var i=e.touches;t.start=t._getPoint2(e,i);var a=t.sizes.window;if(t.start.pageX<40||t.start.pageX>a.width-40)return console.log("edge cancel."),!1;if(t.delta={x:0,y:0},i&&2==i.length&&i[0].target&&i[1].target&&i[0].target!==i[1].target)return console.log("Two active elements not supported"),!1;var s=t.matrix;if(t.orig={trans:new Point(s.elements[4],s.elements[5]),angle:s.rotation(),scale:s.scaling()},t.start.scale=t.orig.scale,t.started=!0,t.dragging=!1,t.events.start&&t.trigger("start",e),t.setTransition(!1),"mousedown"==e.type){var l=document.querySelector("body");t.on(l,"mousemove.transformable",r),t.on(l,"mouseup.transformable dragend.transformable",o)}},o=function(e){var n=document.querySelector("body");if(t.off(n,"mousemove.transformable",r),t.off(n,"mouseup.transformable dragend.transformable",o),t.element.classList.remove("transformable-active"),t.element.classList.remove("transformable-reset"),!0===t.options.disabled)return!1;t.lockcontain=!1,!0===t.started&&!0===t.dragging&&(t._pushhistory(),t.snapRotation()),!0===t.started&&!1===t.dragging&&t.events.tap&&t.trigger("tap",e),t.dragging=!1,t.started=!1,t.events.stop&&t.trigger("stop",e),t.setTransition(!0);var i=t.rotatorBox,a=t.resizertl,s=t.resizerbr;if(i){var l=t.matrix.scaling();i.scale(new Point(0),1/i.matrix.scaling()*(1/l))}if(a&&s){var h=l||t.matrix.scaling();a.style.transform="scale("+1/h+")",s.style.transform="scale("+1/h+")"}},a=function(e){if(!0===t.options.disabled)return!1;if(t.startedresize||t.startedrotate)return!1;if("rotator-box"==t.options.type)return!1;e.preventDefault(),e.stopPropagation();var n=Date.now();if((t.lastwheelmove?n-t.lastwheelmove:150)<150&&navigator.userAgent.indexOf("Mac")>-1)return!1;0==document.querySelectorAll(".transformable-active").length&&t.element.classList.add("transformable-active"),t.rotatorBox&&t.rotatorBox.parent.classList.add("transformable-wheel-active"),t._wheelTimer&&clearTimeout(t._wheelTimer);var r,i=t._getPoint2(e),o=t.matrix,a=(o.scaling(),i.deltaXY.y<0?1:-1);t.setTransition(!0),0!=i.deltaXY.y&&(r=1+.05*a,o.scale(i.offset,r),t._updateElement()),t.element.classList.remove("transformable-active"),t._wheelTimer=setTimeout(function(){t._pushhistory(),t.rotatorBox&&t.rotatorBox.parent.classList.remove("transformable-wheel-active")},750),t.lastwheelmove=n};t.on(e,"mousedown.transformable",i),t.on(e,"touchstart.transformable",i),t.on(e,"touchmove.transformable",r),t.on(e,"touchend.transformable",o),t.on(e,"scroll.transformable",function(t){return console.log("tried scroll"),t.preventDefault(),t.stopPropagation(),!1}),(!this.options.disable||this.options.disable&&!this.options.disable.wheel)&&-1==navigator.userAgent.indexOf("Mac OS")&&addWheelListener(e,a)},Transformable.Handlers={Namespaces:{}},Transformable.prototype.on=function(t,e,n,r){var i,o,a,s,l,h=e.split(" ");for(i=0;i<h.length;i++)o=h[i].split("."),a=o[0],s=o.length>1&&o[1],t.addEventListener(a,n,r||!1),Transformable.Handlers.Namespaces[e]||(Transformable.Handlers.Namespaces[e]=[]),s&&(Transformable.Handlers.Namespaces[s]||(Transformable.Handlers.Namespaces[s]=[])),l=Transformable.Handlers.Namespaces[e].push({event:a,func:n,opts:r||!1}),s&&Transformable.Handlers.Namespaces[s].push(Transformable.Handlers.Namespaces[e][l-1])},Transformable.prototype.off=function(t,e,n){var r,i=Transformable.Handlers.Namespaces[e];if(i)for(var o=0;o<i.length;o++)r=i[o],t.removeEventListener(r.event,r.func,r.opts)},Transformable.prototype.Refresh=function(){this.sizes=void 0,this.setInitialSizes(),this.Ancestry.Refresh()},function(){var t;window.addEventListener("resize",function(){clearTimeout(t),t=setTimeout(e,150)});var e=function(){document.querySelectorAll(".transformable").forEach(function(t,e){var e=t.getAttribute("data-transformable-id"),n=!!e&&Transformable.Instance[e];n instanceof Transformable&&n.Refresh()})}}();